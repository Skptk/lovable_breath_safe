[{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\.lighthouserc.cjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\postcss.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\AQIDataCharts.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":1,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"useEffect"},"fix":{"range":[17,28],"text":""},"desc":"Remove unused variable 'useEffect'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":1,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":29},{"ruleId":"no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"Button"},"fix":{"range":[198,246],"text":""},"desc":"Remove unused variable 'Button'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":16},{"ruleId":"no-unused-vars","severity":1,"message":"'TrendingDown' is defined but never used.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingDown"},"fix":{"range":[505,522],"text":""},"desc":"Remove unused variable 'TrendingDown'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingDown' is defined but never used.","line":19,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'Droplets' is defined but never used.","line":24,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":11,"suggestions":[{"messageId":"removeVar","data":{"varName":"Droplets"},"fix":{"range":[566,578],"text":""},"desc":"Remove unused variable 'Droplets'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Droplets' is defined but never used.","line":24,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":11},{"ruleId":"no-unused-vars","severity":1,"message":"'getRealHistoricalData' is assigned a value but never used.","line":92,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":92,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"getRealHistoricalData"},"fix":{"range":[2285,2615],"text":""},"desc":"Remove unused variable 'getRealHistoricalData'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getRealHistoricalData' is assigned a value but never used.","line":92,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":92,"endColumn":30},{"ruleId":"no-unused-vars","severity":1,"message":"'closeModal' is assigned a value but never used.","line":261,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":261,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"closeModal"},"fix":{"range":[9224,9314],"text":""},"desc":"Remove unused variable 'closeModal'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'closeModal' is assigned a value but never used.","line":261,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":261,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from \"@/components/ui/GlassCard\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { \n  LineChart, \n  Line, \n  XAxis, \n  YAxis, \n  CartesianGrid, \n  Tooltip, \n  ResponsiveContainer,\n  Area,\n  AreaChart\n} from \"recharts\";\nimport { \n  TrendingUp, \n  TrendingDown, \n  AlertTriangle, \n  Info,\n  Wind,\n  Cloud,\n  Droplets,\n  Zap,\n  Flame,\n  Eye\n} from \"lucide-react\";\nimport { getAQIColor, getAQILabel } from \"@/config/maps\";\n\ninterface PollutantData {\n  name: string;\n  value: number;\n  unit: string;\n  description: string;\n  healthEffects: string[];\n  sources: string[];\n  icon: React.ReactNode;\n  color: string;\n  category: 'particulate' | 'gas' | 'weather';\n}\n\ninterface AQIDataChartsProps {\n  aqi: number;\n  pm25: number;\n  pm10: number;\n  no2: number;\n  so2: number;\n  co: number;\n  o3: number;\n  timestamp: string;\n}\n\nexport default function AQIDataCharts({ \n  aqi, \n  pm25, \n  pm10, \n  no2, \n  so2, \n  co, \n  o3, \n  timestamp \n}: AQIDataChartsProps): JSX.Element {\n  const [selectedPollutant, setSelectedPollutant] = useState<PollutantData | null>(null);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n\n  // Remove mock historical data generation - only use real data from database\n  // const generateHistoricalData = (currentValue: number, pollutantName: string) => {\n  //   const data = [];\n  //   const now = new Date();\n  //   \n  //   for (let i = 23; i >= 0; i--) {\n  //     const time = new Date(now.getTime() - i * 60 * 60 * 1000); // Last 24 hours\n  //     const variation = (Math.random() - 0.5) * 0.2; // ±10% variation\n  //     const value = Math.max(0, currentValue * (1 + variation));\n  //     \n  //     data.push({\n  //       time: time.toLocaleTimeString('en-US', { \n  //         hour: '2-digit', \n  //         minute: '2-digit',\n  //         hour12: false \n  //       }),\n  //       value: Math.round(value * 100) / 100,\n  //       pollutant: pollutantName\n  //     });\n  //   }\n  //   \n  //   return data;\n  // };\n\n  // Function to get real historical data from database (to be implemented)\n  const getRealHistoricalData = async (pollutantName: string): Promise<any[]> => {\n    // TODO: Implement real historical data fetching from database\n    // This should query the air_quality_readings table for historical data\n    console.log(`[AQIDataCharts] Fetching real historical data for ${pollutantName}`);\n    return [];\n  };\n\n  const pollutants: PollutantData[] = [\n    {\n      name: 'PM2.5',\n      value: pm25,\n      unit: 'μg/m³',\n      description: 'Fine particulate matter smaller than 2.5 micrometers in diameter',\n      healthEffects: [\n        'Can penetrate deep into the lungs and bloodstream',\n        'Linked to respiratory and cardiovascular diseases',\n        'May cause premature death in people with heart or lung disease'\n      ],\n      sources: [\n        'Vehicle emissions',\n        'Industrial processes',\n        'Burning of fossil fuels',\n        'Wildfires and dust storms'\n      ],\n      icon: <Cloud className=\"h-5 w-5\" />,\n      color: '#3B82F6',\n      category: 'particulate'\n    },\n    {\n      name: 'PM10',\n      value: pm10,\n      unit: 'μg/m³',\n      description: 'Coarse particulate matter smaller than 10 micrometers in diameter',\n      healthEffects: [\n        'Can irritate the eyes, nose, and throat',\n        'May cause coughing and difficulty breathing',\n        'Can aggravate existing respiratory conditions'\n      ],\n      sources: [\n        'Road dust',\n        'Construction activities',\n        'Agricultural operations',\n        'Industrial emissions'\n      ],\n      icon: <Cloud className=\"h-5 w-5\" />,\n      color: '#10B981',\n      category: 'particulate'\n    },\n    {\n      name: 'NO₂',\n      value: no2,\n      unit: 'ppb',\n      description: 'Nitrogen dioxide, a reddish-brown gas with a sharp, biting odor',\n      healthEffects: [\n        'Can cause respiratory irritation and inflammation',\n        'May increase susceptibility to respiratory infections',\n        'Can aggravate asthma and other respiratory conditions'\n      ],\n      sources: [\n        'Vehicle exhaust',\n        'Power plants',\n        'Industrial boilers',\n        'Gas stoves and heaters'\n      ],\n      icon: <Wind className=\"h-5 w-5\" />,\n      color: '#F59E0B',\n      category: 'gas'\n    },\n    {\n      name: 'SO₂',\n      value: so2,\n      unit: 'ppb',\n      description: 'Sulfur dioxide, a colorless gas with a pungent, irritating odor',\n      healthEffects: [\n        'Can cause breathing difficulties and respiratory irritation',\n        'May aggravate asthma and other respiratory conditions',\n        'Can cause eye irritation and throat discomfort'\n      ],\n      sources: [\n        'Burning of coal and oil',\n        'Industrial processes',\n        'Volcanic eruptions',\n        'Ship emissions'\n      ],\n      icon: <Flame className=\"h-5 w-5\" />,\n      color: '#EF4444',\n      category: 'gas'\n    },\n    {\n      name: 'CO',\n      value: co,\n      unit: 'ppb',\n      description: 'Carbon monoxide, a colorless, odorless, and tasteless gas',\n      healthEffects: [\n        'Can reduce oxygen delivery to the body',\n        'May cause headaches, dizziness, and confusion',\n        'High levels can be fatal'\n      ],\n      sources: [\n        'Vehicle exhaust',\n        'Burning of fossil fuels',\n        'Industrial processes',\n        'Residential heating'\n      ],\n      icon: <Zap className=\"h-5 w-5\" />,\n      color: '#8B5CF6',\n      category: 'gas'\n    },\n    {\n      name: 'O₃',\n      value: o3,\n      unit: 'ppb',\n      description: 'Ground-level ozone, a harmful air pollutant and greenhouse gas',\n      healthEffects: [\n        'Can cause respiratory irritation and inflammation',\n        'May reduce lung function and cause breathing difficulties',\n        'Can aggravate asthma and other respiratory conditions'\n      ],\n      sources: [\n        'Chemical reactions between pollutants in sunlight',\n        'Vehicle emissions',\n        'Industrial emissions',\n        'Natural sources'\n      ],\n      icon: <Eye className=\"h-5 w-5\" />,\n      color: '#06B6D4',\n      category: 'gas'\n    }\n  ];\n\n  const getPollutantStatus = (value: number, pollutant: string) => {\n    switch (pollutant.toLowerCase()) {\n      case 'pm2.5':\n        if (value <= 12) return { status: 'Good', color: 'text-green-600', severity: 'low' };\n        if (value <= 35.4) return { status: 'Moderate', color: 'text-yellow-600', severity: 'medium' };\n        if (value <= 55.4) return { status: 'Unhealthy for Sensitive Groups', color: 'text-orange-600', severity: 'high' };\n        if (value <= 150.4) return { status: 'Unhealthy', color: 'text-red-600', severity: 'very-high' };\n        if (value <= 250.4) return { status: 'Very Unhealthy', color: 'text-purple-600', severity: 'hazardous' };\n        return { status: 'Hazardous', color: 'text-red-800', severity: 'extreme' };\n      case 'pm10':\n        if (value <= 54) return { status: 'Good', color: 'text-green-600', severity: 'low' };\n        if (value <= 154) return { status: 'Moderate', color: 'text-yellow-600', severity: 'medium' };\n        if (value <= 254) return { status: 'Unhealthy for Sensitive Groups', color: 'text-orange-600', severity: 'high' };\n        if (value <= 354) return { status: 'Unhealthy', color: 'text-red-600', severity: 'very-high' };\n        if (value <= 424) return { status: 'Very Unhealthy', color: 'text-purple-600', severity: 'hazardous' };\n        return { status: 'Hazardous', color: 'text-red-800', severity: 'extreme' };\n      case 'no2':\n        if (value <= 53) return { status: 'Good', color: 'text-green-600', severity: 'low' };\n        if (value <= 100) return { status: 'Moderate', color: 'text-yellow-600', severity: 'medium' };\n        if (value <= 360) return { status: 'Unhealthy for Sensitive Groups', color: 'text-orange-600', severity: 'high' };\n        if (value <= 649) return { status: 'Unhealthy', color: 'text-red-600', severity: 'very-high' };\n        if (value <= 1249) return { status: 'Very Unhealthy', color: 'text-purple-600', severity: 'hazardous' };\n        return { status: 'Hazardous', color: 'text-red-800', severity: 'extreme' };\n      case 'o3':\n        if (value <= 54) return { status: 'Good', color: 'text-green-600', severity: 'low' };\n        if (value <= 70) return { status: 'Moderate', color: 'text-yellow-600', severity: 'medium' };\n        if (value <= 85) return { status: 'Unhealthy for Sensitive Groups', color: 'text-orange-600', severity: 'high' };\n        if (value <= 105) return { status: 'Unhealthy', color: 'text-red-600', severity: 'very-high' };\n        if (value <= 200) return { status: 'Very Unhealthy', color: 'text-purple-600', severity: 'hazardous' };\n        return { status: 'Hazardous', color: 'text-red-800', severity: 'extreme' };\n      default: return { status: 'Unknown', color: 'text-slate-600', severity: 'low' };\n    }\n  };\n\n  const handlePollutantClick = (pollutant: PollutantData) => {\n    setSelectedPollutant(pollutant);\n    setIsModalOpen(true);\n  };\n\n  const closeModal = () => {\n    setIsModalOpen(false);\n    setSelectedPollutant(null);\n  };\n\n  return (\n    <>\n      {/* Main AQI Card */}\n      <GlassCard className=\"floating-card shadow-card border-0 mb-6\">\n        <GlassCardHeader className=\"text-center pb-4\">\n          <div className=\"flex items-center justify-center gap-2 mb-2\">\n            <TrendingUp className=\"w-5 h-5 text-primary\" />\n            <h2 className=\"text-2xl font-black text-primary\">Air Quality Index</h2>\n          </div>\n          <p className=\"text-muted-foreground\">\n            Last updated: {new Date(timestamp).toLocaleString()}\n          </p>\n        </GlassCardHeader>\n        <GlassCardContent className=\"text-center space-y-6\">\n          <div className=\"flex items-center justify-center gap-8\">\n            <div className=\"text-center\">\n              <div \n                className=\"text-6xl font-bold mb-2\"\n                style={{ color: getAQIColor(aqi) }}\n              >\n                {aqi}\n              </div>\n              <Badge \n                variant=\"outline\" \n                className=\"px-4 py-2 text-sm font-semibold\"\n                style={{ \n                  borderColor: getAQIColor(aqi), \n                  color: getAQIColor(aqi),\n                  backgroundColor: `${getAQIColor(aqi)}10`\n                }}\n              >\n                {getAQILabel(aqi)}\n              </Badge>\n            </div>\n          </div>\n        </GlassCardContent>\n      </GlassCard>\n\n      {/* Pollutant Charts Grid */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n        {pollutants.map((pollutant) => {\n          const status = getPollutantStatus(pollutant.value, pollutant.name);\n          // const historicalData = generateHistoricalData(pollutant.value, pollutant.name);\n          \n          return (\n            <GlassCard \n              key={pollutant.name}\n              className=\"shadow-card hover:shadow-lg transition-all duration-200 cursor-pointer hover:scale-105\"\n              onClick={() => handlePollutantClick(pollutant)}\n            >\n              <GlassCardHeader className=\"pb-3\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-2\">\n                    <div className=\"p-2 rounded-lg\" style={{ backgroundColor: `${pollutant.color}20` }}>\n                      <div style={{ color: pollutant.color }}>\n                        {pollutant.icon}\n                      </div>\n                    </div>\n                    <div>\n                      <GlassCardTitle className=\"text-lg font-bold\">{pollutant.name}</GlassCardTitle>\n                      <p className=\"text-sm text-muted-foreground\">{pollutant.unit}</p>\n                    </div>\n                  </div>\n                  <Badge \n                    variant=\"outline\" \n                    className={status.color}\n                    style={{ borderColor: status.color }}\n                  >\n                    {status.status}\n                  </Badge>\n                </div>\n              </GlassCardHeader>\n              <GlassCardContent className=\"pt-0\">\n                {/* Mini Chart */}\n                <div className=\"h-24 mb-3\">\n                  <ResponsiveContainer width=\"100%\" height=\"100%\">\n                    <AreaChart data={[]}>\n                      <defs>\n                        <linearGradient id={`gradient-${pollutant.name}`} x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                          <stop offset=\"5%\" stopColor={pollutant.color} stopOpacity={0.3}/>\n                          <stop offset=\"95%\" stopColor={pollutant.color} stopOpacity={0.1}/>\n                        </linearGradient>\n                      </defs>\n                      <Area\n                        type=\"monotone\"\n                        dataKey=\"value\"\n                        stroke={pollutant.color}\n                        strokeWidth={2}\n                        fill={`url(#gradient-${pollutant.name})`}\n                      />\n                    </AreaChart>\n                  </ResponsiveContainer>\n                </div>\n                \n                {/* Current Value */}\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold\" style={{ color: pollutant.color }}>\n                    {pollutant.value.toFixed(2)}\n                  </div>\n                  <p className=\"text-xs text-muted-foreground\">\n                    Current reading\n                  </p>\n                </div>\n              </GlassCardContent>\n            </GlassCard>\n          );\n        })}\n      </div>\n\n      {/* Pollutant Detail Modal */}\n      <Dialog open={isModalOpen} onOpenChange={setIsModalOpen}>\n        <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              {selectedPollutant?.icon}\n              {selectedPollutant?.name} - Detailed Analysis\n            </DialogTitle>\n          </DialogHeader>\n          \n          {selectedPollutant && (\n            <div className=\"space-y-6\">\n              {/* Current Status */}\n              <div className=\"text-center p-4 bg-muted/30 rounded-lg\">\n                <div className=\"text-3xl font-bold mb-2\" style={{ color: selectedPollutant.color }}>\n                  {selectedPollutant.value.toFixed(2)} {selectedPollutant.unit}\n                </div>\n                <Badge \n                  variant=\"outline\" \n                  className={getPollutantStatus(selectedPollutant.value, selectedPollutant.name).color}\n                  style={{ borderColor: getPollutantStatus(selectedPollutant.value, selectedPollutant.name).color }}\n                >\n                  {getPollutantStatus(selectedPollutant.value, selectedPollutant.name).status}\n                </Badge>\n              </div>\n\n              {/* Description */}\n              <div>\n                <h3 className=\"text-lg font-semibold mb-2\">Description</h3>\n                <p className=\"text-muted-foreground\">{selectedPollutant.description}</p>\n              </div>\n\n              {/* Health Effects */}\n              <div>\n                <h3 className=\"text-lg font-semibold mb-2 flex items-center gap-2\">\n                  <AlertTriangle className=\"h-5 w-5 text-orange-500\" />\n                  Health Effects\n                </h3>\n                <ul className=\"space-y-2\">\n                  {selectedPollutant.healthEffects.map((effect, index) => (\n                    <li key={index} className=\"flex items-start gap-2\">\n                      <div className=\"w-2 h-2 bg-orange-500 rounded-full mt-2 flex-shrink-0\"></div>\n                      <span className=\"text-muted-foreground\">{effect}</span>\n                    </li>\n                  ))}\n                </ul>\n              </div>\n\n              {/* Sources */}\n              <div>\n                <h3 className=\"text-lg font-semibold mb-2 flex items-center gap-2\">\n                  <Info className=\"h-5 w-5 text-blue-500\" />\n                  Common Sources\n                </h3>\n                <ul className=\"space-y-2\">\n                  {selectedPollutant.sources.map((source, index) => (\n                    <li key={index} className=\"flex items-start gap-2\">\n                      <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\n                      <span className=\"text-muted-foreground\">{source}</span>\n                    </li>\n                  ))}\n                </ul>\n              </div>\n\n              {/* Historical Chart */}\n              <div>\n                <h3 className=\"text-lg font-semibold mb-4\">24-Hour Trend</h3>\n                <div className=\"h-64\">\n                  <ResponsiveContainer width=\"100%\" height=\"100%\">\n                    <LineChart data={[]}>\n                      <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#374151\" />\n                      <XAxis \n                        dataKey=\"time\" \n                        stroke=\"#6B7280\"\n                        fontSize={12}\n                      />\n                      <YAxis \n                        stroke=\"#6B7280\"\n                        fontSize={12}\n                        label={{ \n                          value: `${selectedPollutant.name} (${selectedPollutant.unit})`, \n                          angle: -90, \n                          position: 'insideLeft',\n                          style: { textAnchor: 'middle' }\n                        }}\n                      />\n                      <Tooltip \n                        contentStyle={{ \n                          backgroundColor: '#1F2937', \n                          border: '1px solid #374151',\n                          borderRadius: '8px'\n                        }}\n                        labelStyle={{ color: '#F9FAFB' }}\n                      />\n                      <Line\n                        type=\"monotone\"\n                        dataKey=\"value\"\n                        stroke={selectedPollutant.color}\n                        strokeWidth={3}\n                        dot={{ fill: selectedPollutant.color, strokeWidth: 2, r: 4 }}\n                        activeDot={{ r: 6, stroke: selectedPollutant.color, strokeWidth: 2 }}\n                      />\n                    </LineChart>\n                  </ResponsiveContainer>\n                </div>\n              </div>\n\n              {/* Category Information */}\n              <div className=\"text-center p-4 bg-muted/30 rounded-lg\">\n                <h3 className=\"text-lg font-semibold mb-2\">Pollutant Category</h3>\n                <Badge variant=\"secondary\" className=\"capitalize\">\n                  {selectedPollutant.category}\n                </Badge>\n                <p className=\"text-sm text-muted-foreground mt-2\">\n                  This pollutant is classified as {selectedPollutant.category} matter\n                </p>\n              </div>\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n    </>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\AirQualityDashboard.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":1,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"useState"},"fix":{"range":[16,25],"text":""},"desc":"Remove unused variable 'useState'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":1,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'useMemo' is defined but never used.","line":1,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"useMemo"},"fix":{"range":[24,33],"text":""},"desc":"Remove unused variable 'useMemo'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useMemo' is defined but never used.","line":1,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":34},{"ruleId":"no-unused-vars","severity":1,"message":"'useCallback' is defined but never used.","line":1,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":47,"suggestions":[{"messageId":"removeVar","data":{"varName":"useCallback"},"fix":{"range":[33,46],"text":""},"desc":"Remove unused variable 'useCallback'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useCallback' is defined but never used.","line":1,"column":36,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":47},{"ruleId":"no-unused-vars","severity":1,"message":"'route' is defined but never used.","line":24,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"route"},"fix":{"range":[1193,1206],"text":""},"desc":"Remove unused variable 'route'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useMemo, useCallback } from \"react\";\nimport { useAirQuality } from \"@/hooks/useAirQuality\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { useUserPoints } from \"@/hooks/useUserPoints\";\nimport { useRefreshCountdown } from \"@/hooks/useRefreshCountdown\";\nimport { useLocationContext } from \"@/contexts\";\nimport { RefreshProgressBar } from \"@/components/ui/RefreshProgressBar\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { TrendingDown, RefreshCw, MapPin } from \"lucide-react\";\n\nimport Header from \"@/components/Header\";\nimport DataSourceValidator from \"./DataSourceValidator\";\nimport { Button } from \"@/components/ui/button\";\n\n// Import components directly to avoid circular dependencies\nimport { LoadingState } from \"./AirQualityDashboard/LoadingState\";\nimport { PermissionRequest } from \"./AirQualityDashboard/PermissionRequest\";\nimport { PollutantModal } from \"./AirQualityDashboard/PollutantModal\";\nimport { AQICard } from \"./AirQualityDashboard/AQICard\";\nimport { PointsGrid } from \"./AirQualityDashboard/PointsGrid\";\nimport { WeatherSection } from \"./AirQualityDashboard/WeatherSection\";\n\ninterface AirQualityDashboardProps {\n  onNavigate?: (route: string) => void;\n  showMobileMenu?: boolean;\n  onMobileMenuToggle?: () => void;\n  isDemoMode?: boolean;\n}\n\n/**\n * Hook: small permission timeout helper\n * returns boolean `timedOut` that becomes true after `ms` if `hasRequestedPermission` is still false\n */\nfunction usePermissionTimeout(hasRequestedPermission: boolean, ms: number = 3000) {\n  const [timedOut, setTimedOut] = React.useState(false);\n\n  React.useEffect(() => {\n    if (hasRequestedPermission) return;\n\n    const timer = setTimeout(() => {\n      setTimedOut(true);\n    }, ms);\n\n    return () => clearTimeout(timer);\n  }, [hasRequestedPermission, ms]);\n\n  return timedOut;\n}\n\n/**\n * The content wrapper component - extracted for testability\n */\ntype AirQualityDashboardContentProps = AirQualityDashboardProps & { user: any; locationContext: any };\n\nfunction AirQualityDashboardContent({\n  user,\n  locationContext,\n  onNavigate,\n  showMobileMenu,\n  onMobileMenuToggle,\n  isDemoMode = false,\n}: AirQualityDashboardContentProps) {\n  // Hooks\n  const { data, isRefreshing, isLoading, error, refreshData } = useAirQuality();\n  const { userPoints, isLoading: pointsLoading } = useUserPoints();\n  const { timeUntilRefresh } = useRefreshCountdown();\n  const { toast } = useToast();\n\n  const {\n    hasUserConsent = false,\n    hasRequestedPermission = false,\n    isRequestingPermission = false,\n    requestLocationPermission,\n  } = locationContext || {};\n\n  // Local UI state\n  const [selectedPollutant, setSelectedPollutant] = React.useState<null | {\n    name: string;\n    value: number;\n    unit: string;\n    description: string;\n    color: string;\n  }>(null);\n\n  const userName = React.useMemo(() => {\n    return user?.user_metadata?.full_name || user?.email?.split(\"@\")[0] || \"User\";\n  }, [user]);\n\n  // Use permission timeout hook (replaces forceDisplay pattern)\n  const permissionTimeoutReached = usePermissionTimeout(hasRequestedPermission, 3000);\n\n  // Memoize coordinates with proper typing and null checks\n  const coordinates = React.useMemo(() => {\n    if (!data?.coordinates?.lat || !data?.coordinates?.lon) return null;\n    return { \n      latitude: data.coordinates.lat, \n      longitude: data.coordinates.lon \n    };\n  }, [data?.coordinates?.lat, data?.coordinates?.lon]);\n\n  // Request location permission handler\n  const handleRequestLocationPermission = React.useCallback(async () => {\n    if (isRequestingPermission) return;\n    try {\n      const success = await requestLocationPermission();\n      if (success) {\n        toast({\n          title: \"Location Access Granted\",\n          description: \"Air quality data will now be fetched for your location.\",\n          variant: \"default\",\n        });\n      } else {\n        toast({ \n          title: \"Location Access Failed\", \n          description: \"Unable to get location permission. Please try again.\", \n          variant: \"destructive\" \n        });\n      }\n    } catch (err: any) {\n      const message = err?.message ?? \"Failed to get location permission\";\n      let errorMessage = message;\n      if (message.includes(\"permission denied\")) {\n        errorMessage = \"Location permission denied. Please enable location access in your browser settings.\";\n      } else if (message.includes(\"unavailable\")) {\n        errorMessage = \"Location services unavailable. Please check your device settings.\";\n      } else if (message.includes(\"timed out\")) {\n        errorMessage = \"Location request timed out. Please try again.\";\n      }\n      toast({ \n        title: \"Location Access Failed\", \n        description: errorMessage, \n        variant: \"destructive\" \n      });\n    }\n  }, [isRequestingPermission, requestLocationPermission, toast]);\n\n  // Manual refresh handler - respects consent\n  const handleRefresh = React.useCallback(() => {\n    if (hasUserConsent) {\n      refreshData();\n    } else {\n      console.log(\"Refresh skipped - user consent not granted\");\n    }\n  }, [hasUserConsent, refreshData]);\n\n  // Permission check UI - brief loading while waiting for permission or timeout\n  if (!hasRequestedPermission && !permissionTimeoutReached) {\n    return <LoadingState title={`Hello, ${userName}!`} subtitle=\"Checking location permissions...\" />;\n  }\n\n  // Show permission request if not consented\n  if (!hasUserConsent) {\n    return (\n      <PermissionRequest\n        onRequest={handleRequestLocationPermission}\n        requesting={isRequestingPermission}\n        userName={userName}\n        showMobileMenu={showMobileMenu}\n        onMobileMenuToggle={onMobileMenuToggle}\n      />\n    );\n  }\n\n  // If there's data, show the dashboard\n  if (data) {\n    return (\n      <div className=\"space-y-6 lg:space-y-8\">\n        <Header \n          title={`Hello, ${userName}!`} \n          subtitle={`Air quality in ${data.location ?? \"your area\"}`} \n          showMobileMenu={showMobileMenu} \n          onMobileMenuToggle={onMobileMenuToggle} \n        />\n\n        <RefreshProgressBar \n          timeUntilRefresh={timeUntilRefresh} \n          isRefreshing={isRefreshing} \n          onManualRefresh={handleRefresh} \n        />\n\n        {data && (\n          <DataSourceValidator \n            dataSource={data.dataSource} \n            aqi={data.aqi} \n            location={data.location} \n            timestamp={data.timestamp} \n            userLocation={data.location} \n          />\n        )}\n\n        {isDemoMode && (\n          <div className=\"bg-gradient-to-r from-blue-500 to-purple-600 text-white p-4 rounded-lg shadow-lg\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <h3 className=\"font-semibold\">Demo Mode Active</h3>\n                <p className=\"text-blue-100 text-sm\">Showing sample data for demonstration purposes</p>\n              </div>\n              <span className=\"bg-white/20 text-white text-xs font-medium px-2.5 py-0.5 rounded\">\n                DEMO\n              </span>\n            </div>\n          </div>\n        )}\n\n        <AQICard\n          data={data}\n          timeUntilRefresh={timeUntilRefresh}\n          isRefreshing={isRefreshing}\n          onRefresh={handleRefresh}\n          onNavigate={onNavigate}\n          showMobileMenu={showMobileMenu}\n          onMobileMenuToggle={onMobileMenuToggle}\n          isDemoMode={isDemoMode}\n          setSelectedPollutant={setSelectedPollutant}\n        />\n\n        {!pointsLoading && userPoints && (\n          <PointsGrid userPoints={userPoints} onNavigate={onNavigate} />\n        )}\n\n        <WeatherSection coordinates={coordinates} />\n\n        <PollutantModal \n          pollutant={selectedPollutant} \n          onClose={() => setSelectedPollutant(null)} \n        />\n      </div>\n    );\n  }\n\n  // Loading while fetching data\n  if (isLoading) {\n    return <LoadingState title={`Hello, ${userName}!`} subtitle=\"Loading air quality data...\" />;\n  }\n\n  // Error state with retry wired to refreshData\n  if (error) {\n    return (\n      <div className=\"space-y-6 lg:space-y-8\">\n        <Header \n          title={`Hello, ${userName}!`} \n          subtitle=\"Error loading air quality data\" \n          showMobileMenu={showMobileMenu} \n          onMobileMenuToggle={onMobileMenuToggle} \n        />\n        <div className=\"text-center py-12\">\n          <div className=\"max-w-md mx-auto space-y-6\">\n            <div className=\"w-24 h-24 bg-destructive/10 rounded-full flex items-center justify-center mx-auto\">\n              <TrendingDown className=\"w-12 h-12 text-destructive\" />\n            </div>\n\n            <div className=\"space-y-3\">\n              <h3 className=\"text-xl font-semibold\">Failed to Load Data</h3>\n              <p className=\"text-muted-foreground\">\n                {error.message || \"Unable to fetch air quality data. Please try again.\"}\n              </p>\n            </div>\n\n            <div className=\"space-y-3\">\n              <Button \n                onClick={handleRefresh} \n                disabled={isRefreshing} \n                className=\"w-full\" \n                size=\"lg\"\n              >\n                {isRefreshing ? (\n                  <>\n                    <RefreshCw className=\"w-4 h-4 animate-spin mr-2\" />\n                    Retrying...\n                  </>\n                ) : (\n                  <>\n                    <RefreshCw className=\"w-4 h-4 mr-2\" />\n                    Try Again\n                  </>\n                )}\n              </Button>\n\n              <Button \n                variant=\"outline\" \n                onClick={handleRequestLocationPermission} \n                className=\"w-full\"\n              >\n                <MapPin className=\"w-4 h-4 mr-2\" />\n                Re-check Location\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Fallback\n  return (\n    <div className=\"space-y-6 lg:space-y-8\">\n      <Header \n        title={`Hello, ${userName}!`} \n        subtitle=\"Something went wrong\" \n        showMobileMenu={showMobileMenu} \n        onMobileMenuToggle={onMobileMenuToggle} \n      />\n      <div className=\"text-center py-12\">\n        <p className=\"text-muted-foreground\">\n          Unable to display dashboard. Please refresh the page.\n        </p>\n      </div>\n    </div>\n  );\n}\n\n/**\n * Main wrapper that ties into location + auth contexts\n */\nexport function AirQualityDashboard({\n  onNavigate,\n  showMobileMenu,\n  onMobileMenuToggle,\n  isDemoMode = false,\n}: AirQualityDashboardProps) {\n  const { user } = useAuth();\n  const locationContext = useLocationContext();\n\n  return (\n    <AirQualityDashboardContent\n      user={user}\n      locationContext={locationContext}\n      onNavigate={onNavigate}\n      showMobileMenu={showMobileMenu}\n      onMobileMenuToggle={onMobileMenuToggle}\n      isDemoMode={isDemoMode}\n    />\n  );\n}\n\nexport default AirQualityDashboard;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\AirQualityDashboard\\AQICard.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'route' is defined but never used.","line":44,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":44,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"route"},"fix":{"range":[1056,1069],"text":""},"desc":"Remove unused variable 'route'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'p' is defined but never used.","line":48,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":48,"endColumn":45,"suggestions":[{"messageId":"removeVar","data":{"varName":"p"},"fix":{"range":[1192,1211],"text":""},"desc":"Remove unused variable 'p'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\nimport { motion } from 'framer-motion';\nimport { GlassCard, GlassCardContent, GlassCardHeader } from '@/components/ui/GlassCard';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { TrendingUp, RefreshCw, Clock, User, Satellite } from 'lucide-react';\nimport { getAQIColor, getAQILabel } from '@/config/maps';\n\n// Define interfaces at the top level to avoid hoisting issues\nexport interface Pollutant {\n  name: string;\n  value: number;\n  unit: string;\n  color: string;\n  description?: string;\n}\n\nexport interface AQIData {\n  aqi?: number;\n  pm25?: number;\n  pm10?: number;\n  no2?: number;\n  so2?: number;\n  co?: number;\n  o3?: number;\n  timestamp?: string;\n  dataSource?: string;\n  coordinates?: {\n    lat: number;\n    lon: number;\n  };\n  userCoordinates?: {\n    lat: number;\n    lon: number;\n  };\n  location?: string;\n}\n\nexport interface AQICardProps {\n  data: AQIData | null;\n  timeUntilRefresh: number;\n  isRefreshing: boolean;\n  onRefresh: () => void;\n  onNavigate?: (route: string) => void;\n  showMobileMenu?: boolean;\n  onMobileMenuToggle?: () => void;\n  isDemoMode?: boolean;\n  setSelectedPollutant: (p: Pollutant | null) => void;\n}\n\nfunction formatRefreshCountdown(seconds: number) {\n  const safeSeconds = Number.isFinite(seconds) ? Math.max(0, seconds) : 0;\n  const minutes = Math.floor(safeSeconds / 60);\n  const remainingSeconds = safeSeconds % 60;\n  return `${minutes}:${remainingSeconds.toString().padStart(2, \"0\")}`;\n}\n\n// Export the component as a named function to help with debugging\nfunction AQICardComponent(props: AQICardProps) {\n  const {\n    data,\n    timeUntilRefresh,\n    isRefreshing,\n    onRefresh,\n    onNavigate,\n    setSelectedPollutant,\n  } = props;\n  const aqiColor = getAQIColor(data?.aqi ?? 0);\n  const aqiLabel = getAQILabel(data?.aqi ?? 0);\n\n  const isUserLocation =\n    data?.dataSource === \"OpenWeatherMap API\" &&\n    data?.coordinates?.lat === data?.userCoordinates?.lat &&\n    data?.coordinates?.lon === data?.userCoordinates?.lon;\n\n  const locationSource = isUserLocation ? \"Your Location\" : \"Nearest Sensor\";\n  const locationIcon = isUserLocation ? User : Satellite;\n\n  const formattedRefreshCountdown = React.useMemo(\n    () => formatRefreshCountdown(timeUntilRefresh),\n    [timeUntilRefresh]\n  );\n\n  // Create pollutants array directly to avoid potential issues with useMemo\n  const pollutants: Pollutant[] = React.useMemo(() => [\n    { \n      name: \"PM2.5\", \n      value: data?.pm25 ?? 0, \n      unit: \"μg/m³\", \n      color: \"text-blue-500\",\n      description: \"Fine particulate matter (PM2.5) can penetrate deep into the lungs and even enter the bloodstream.\"\n    },\n    { \n      name: \"PM10\", \n      value: data?.pm10 ?? 0, \n      unit: \"μg/m³\", \n      color: \"text-green-500\",\n      description: \"Coarse particulate matter (PM10) can irritate the eyes, nose, and throat.\"\n    },\n    { \n      name: \"NO₂\", \n      value: data?.no2 ?? 0, \n      unit: \"μg/m³\", \n      color: \"text-orange-500\",\n      description: \"Nitrogen dioxide (NO₂) can cause respiratory problems and contributes to the formation of smog.\"\n    },\n    { \n      name: \"SO₂\", \n      value: data?.so2 ?? 0, \n      unit: \"μg/m³\", \n      color: \"text-red-500\",\n      description: \"Sulfur dioxide (SO₂) can cause breathing problems and aggravate existing heart and lung diseases.\"\n    },\n    { \n      name: \"CO\", \n      value: data?.co ?? 0, \n      unit: \"μg/m³\", \n      color: \"text-purple-500\",\n      description: \"Carbon monoxide (CO) reduces oxygen delivery to the body's organs and tissues.\"\n    },\n    { \n      name: \"O₃\", \n      value: data?.o3 ?? 0, \n      unit: \"μg/m³\", \n      color: \"text-yellow-500\",\n      description: \"Ground-level ozone (O₃) can cause breathing problems, trigger asthma, and reduce lung function.\"\n    },\n  ], [data]);\n\n  // Early return if no data is available\n  if (!data) {\n    return (\n      <motion.div \n        initial={{ opacity: 0, y: 20 }} \n        animate={{ opacity: 1, y: 0 }} \n        transition={{ duration: 0.6, ease: \"easeOut\" }}\n      >\n        <GlassCard variant=\"elevated\" className=\"p-6\">\n          <GlassCardHeader className=\"text-center\">\n            <h2 className=\"text-2xl font-black text-primary\">Air Quality Data Unavailable</h2>\n          </GlassCardHeader>\n          <GlassCardContent className=\"text-center py-6\">\n            <p className=\"text-muted-foreground mb-4\">Unable to load air quality data at this time.</p>\n            <Button \n              onClick={onRefresh} \n              disabled={isRefreshing} \n              variant=\"outline\"\n              className=\"mt-2\"\n            >\n              {isRefreshing ? (\n                <>\n                  <RefreshCw className=\"w-4 h-4 animate-spin mr-2\" />\n                  Refreshing...\n                </>\n              ) : (\n                <>\n                  <RefreshCw className=\"w-4 h-4 mr-2\" />\n                  Try Again\n                </>\n              )}\n            </Button>\n          </GlassCardContent>\n        </GlassCard>\n      </motion.div>\n    );\n  }\n\n  return (\n    <motion.div \n      initial={{ opacity: 0, y: 20 }} \n      animate={{ opacity: 1, y: 0 }} \n      transition={{ duration: 0.6, ease: \"easeOut\" }}\n      aria-live=\"polite\"\n      aria-atomic=\"true\"\n    >\n      <GlassCard variant=\"elevated\" className=\"p-4 md:p-6\">\n        <GlassCardHeader className=\"text-center pb-4\">\n          <div className=\"flex flex-col items-center gap-2 mb-2\">\n            <div className=\"flex items-center gap-2\">\n              <TrendingUp className=\"w-5 h-5 text-primary\" aria-hidden=\"true\" />\n              <h2 className=\"text-xl md:text-2xl font-black text-primary\">\n                Current Air Quality\n              </h2>\n            </div>\n            {data.timestamp && (\n              <p className=\"text-sm text-muted-foreground\">\n                Last updated: {new Date(data.timestamp).toLocaleString()}\n              </p>\n            )}\n          </div>\n        </GlassCardHeader>\n        \n        <GlassCardContent className=\"space-y-6\">\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 md:gap-8 items-start\">\n            {/* AQI Display */}\n            <div className=\"text-center space-y-4\">\n              <div \n                className=\"text-5xl md:text-6xl font-bold mb-2 transition-colors duration-300\" \n                style={{ color: aqiColor }}\n                aria-label={`Air Quality Index: ${data.aqi} - ${aqiLabel}`}\n              >\n                {data.aqi ?? \"—\"}\n              </div>\n              \n              <Badge \n                variant=\"outline\" \n                className=\"px-4 py-2 text-sm font-semibold transition-colors duration-300\"\n                style={{ \n                  borderColor: aqiColor, \n                  color: aqiColor, \n                  backgroundColor: `${aqiColor}10`,\n                  minWidth: '120px'\n                }}\n                aria-label={`Air Quality: ${aqiLabel}`}\n              >\n                {aqiLabel}\n              </Badge>\n\n              <div className=\"space-y-2 text-sm\">\n                <div className=\"flex items-center justify-center gap-2 text-muted-foreground\">\n                  {React.createElement(locationIcon, { \n                    className: \"w-4 h-4\",\n                    'aria-hidden': 'true'\n                  })}\n                  <span>{locationSource}</span>\n                </div>\n                \n                {data.dataSource && (\n                  <div className=\"text-xs text-muted-foreground\">\n                    Data source: {data.dataSource}\n                  </div>\n                )}\n                \n                <div className=\"text-xs text-muted-foreground\">\n                  Next auto refresh in {formattedRefreshCountdown}\n                </div>\n              </div>\n\n              <div className=\"flex flex-col sm:flex-row gap-2 justify-center pt-2\">\n                <Button \n                  onClick={onRefresh} \n                  disabled={isRefreshing} \n                  variant=\"outline\" \n                  size=\"sm\" \n                  className=\"flex-1 sm:flex-none\"\n                  aria-label=\"Refresh air quality data\"\n                >\n                  {isRefreshing ? (\n                    <>\n                      <RefreshCw className=\"w-4 h-4 animate-spin mr-2\" />\n                      Refreshing...\n                    </>\n                  ) : (\n                    <>\n                      <RefreshCw className=\"w-4 h-4 mr-2\" />\n                      Refresh Now\n                    </>\n                  )}\n                </Button>\n\n                {onNavigate && (\n                  <Button \n                    onClick={() => onNavigate(\"history\")} \n                    variant=\"outline\" \n                    size=\"sm\" \n                    className=\"flex-1 sm:flex-none\"\n                    aria-label=\"View air quality history\"\n                  >\n                    <Clock className=\"w-4 h-4 mr-2\" />\n                    View History\n                  </Button>\n                )}\n              </div>\n            </div>\n\n            {/* Pollutant Breakdown */}\n            <div className=\"space-y-4\">\n              <h3 className=\"text-lg font-semibold text-center\">\n                Pollutant Breakdown\n              </h3>\n              \n              <div className=\"grid grid-cols-2 gap-3\">\n                {pollutants.map((pollutant) => (\n                  <div\n                    key={pollutant.name}\n                    className=\"cursor-pointer hover:scale-105 transition-transform\"\n                    onClick={() => setSelectedPollutant({\n                      ...pollutant,\n                      description: pollutant.description || `Detailed information about ${pollutant.name}`\n                    })}\n                    role=\"button\"\n                    tabIndex={0}\n                    onKeyDown={(e) => {\n                      if (e.key === 'Enter' || e.key === ' ') {\n                        e.preventDefault();\n                        setSelectedPollutant({\n                          ...pollutant,\n                          description: pollutant.description || `Detailed information about ${pollutant.name}`\n                        });\n                      }\n                    }}\n                    aria-label={`${pollutant.name}: ${pollutant.value} ${pollutant.unit}`}\n                  >\n                    <GlassCard\n                      variant=\"subtle\"\n                      className=\"p-3 text-center h-full flex flex-col justify-center\"\n                    >\n                      <div className={`text-lg font-bold ${pollutant.color} mb-1`}>\n                        {pollutant.value.toFixed(1)}\n                      </div>\n                      <div className=\"text-sm font-medium\">\n                        {pollutant.name}\n                      </div>\n                      <div className=\"text-xs text-muted-foreground\">\n                        {pollutant.unit}\n                      </div>\n                    </GlassCard>\n                  </div>\n                ))}\n              </div>\n              \n              <div className=\"text-xs text-muted-foreground mt-2 text-center\">\n                Click on a pollutant for more information\n              </div>\n            </div>\n          </div>\n        </GlassCardContent>\n      </GlassCard>\n    </motion.div>\n  );\n}\n\n// Memoize the component to prevent unnecessary re-renders\nexport const AQICard = React.memo(AQICardComponent, (prevProps, nextProps) => {\n  // Only re-render if data or refresh status changes\n  return (\n    prevProps.data === nextProps.data &&\n    prevProps.isRefreshing === nextProps.isRefreshing &&\n    prevProps.timeUntilRefresh === nextProps.timeUntilRefresh\n  );\n});\n\nAQICard.displayName = 'AQICard';\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\AirQualityDashboard\\LoadingState.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\AirQualityDashboard\\PermissionRequest.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\AirQualityDashboard\\PointsGrid.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'route' is defined but never used.","line":8,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"route"},"fix":{"range":[239,252],"text":""},"desc":"Remove unused variable 'route'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { motion } from 'framer-motion';\nimport { Award, Zap, TrendingUp } from 'lucide-react';\nimport { StatCard } from '@/components/ui/StatCard';\n\ninterface PointsGridProps {\n  userPoints: any;\n  onNavigate?: (route: string) => void;\n}\n\nfunction PointsGridComponent({\n  userPoints,\n  onNavigate,\n}: PointsGridProps) {\n  if (!userPoints) return null;\n\n  return (\n    <motion.div \n      initial={{ opacity: 0, y: 20 }} \n      animate={{ opacity: 1, y: 0 }} \n      transition={{ duration: 0.6, ease: \"easeOut\", delay: 0.2 }} \n      className=\"grid grid-cols-1 md:grid-cols-3 gap-4\"\n    >\n      <div \n        onClick={() => onNavigate?.(\"rewards\")} \n        className=\"cursor-pointer hover:scale-105 transition-transform\"\n      >\n        <StatCard \n          title=\"Total Points\" \n          value={(userPoints.totalPoints || 0).toLocaleString()} \n          icon={<Award className=\"w-5 h-5\" />} \n          subtitle=\"Earned from air quality monitoring\" \n        />\n      </div>\n\n      <div \n        onClick={() => onNavigate?.(\"history\")} \n        className=\"cursor-pointer hover:scale-105 transition-transform\"\n      >\n        <StatCard \n          title=\"Today's Readings\" \n          value={userPoints.todayReadings || 0} \n          icon={<Zap className=\"w-5 h-5\" />} \n          subtitle=\"Air quality readings today\" \n        />\n      </div>\n\n      <div \n        onClick={() => onNavigate?.(\"history\")} \n        className=\"cursor-pointer hover:scale-105 transition-transform\"\n      >\n        <StatCard \n          title=\"Weekly Activity\" \n          value={userPoints.weeklyReadings || 0} \n          icon={<TrendingUp className=\"w-5 h-5\" />} \n          subtitle=\"Readings this week\" \n        />\n      </div>\n    </motion.div>\n  );\n}\n\nexport const PointsGrid: React.FC<PointsGridProps> = React.memo(PointsGridComponent);\n\nPointsGrid.displayName = 'PointsGrid';\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\AirQualityDashboard\\PollutantModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'getHealthImpact' was used before it was defined.","line":123,"column":22,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":123,"endColumn":37}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { X } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport { GlassCard } from '@/components/ui/GlassCard';\n\n// Re-export the Pollutant interface for consistency\nimport type { Pollutant } from './AQICard';\n\nexport interface PollutantModalProps {\n  /**\n   * The pollutant data to display in the modal.\n   * When null, the modal will not be rendered.\n   */\n  pollutant: Pollutant | null;\n  \n  /**\n   * Callback function called when the modal is closed\n   */\n  onClose: () => void;\n}\n\n/**\n * A modal dialog that displays detailed information about a specific air pollutant.\n * Includes animations, keyboard navigation, and focus management for accessibility.\n */\nexport const PollutantModal: React.FC<PollutantModalProps> = React.memo(({\n  pollutant,\n  onClose,\n}) => {\n  const modalRef = React.useRef<HTMLDivElement>(null);\n  \n  // Close modal on Escape key press\n  React.useEffect(() => {\n    const handleEscape = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        onClose();\n      }\n    };\n    \n    document.addEventListener('keydown', handleEscape);\n    return () => document.removeEventListener('keydown', handleEscape);\n  }, [onClose]);\n  \n  // Focus trap for accessibility\n  React.useEffect(() => {\n    if (pollutant && modalRef.current) {\n      // Focus the modal when it opens\n      modalRef.current.focus();\n    }\n  }, [pollutant]);\n\n  return (\n    <AnimatePresence>\n      {pollutant && (\n        <motion.div\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          exit={{ opacity: 0 }}\n          transition={{ duration: 0.2 }}\n          className=\"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50\"\n          onClick={onClose}\n          role=\"dialog\"\n          aria-modal=\"true\"\n          aria-labelledby=\"pollutant-modal-title\"\n          aria-describedby=\"pollutant-modal-description\"\n        >\n          <motion.div\n            ref={modalRef}\n            initial={{ scale: 0.95, opacity: 0, y: 20 }}\n            animate={{ scale: 1, opacity: 1, y: 0 }}\n            exit={{ scale: 0.95, opacity: 0, y: 20 }}\n            transition={{ type: 'spring', damping: 25, stiffness: 400 }}\n            className=\"relative max-w-md w-full mx-4 focus:outline-none\"\n            onClick={(e) => e.stopPropagation()}\n            tabIndex={-1}\n          >\n            <GlassCard \n              variant=\"elevated\" \n              className=\"relative p-6 shadow-xl\"\n            >\n              {/* Close button */}\n              <button\n                onClick={onClose}\n                className=\"absolute top-4 right-4 p-1 rounded-full hover:bg-muted/50 transition-colors\"\n                aria-label=\"Close modal\"\n              >\n                <X className=\"w-5 h-5\" />\n              </button>\n              \n              <div className=\"text-center space-y-5\">\n                {/* Pollutant Value */}\n                <div \n                  className={`text-5xl font-bold ${pollutant.color} transition-colors`}\n                  aria-label={`${pollutant.value.toFixed(1)} ${pollutant.unit}`}\n                >\n                  {pollutant.value.toFixed(1)}\n                  <span className=\"text-2xl ml-1\">{pollutant.unit}</span>\n                </div>\n                \n                {/* Pollutant Name */}\n                <h2 \n                  id=\"pollutant-modal-title\"\n                  className=\"text-2xl font-bold text-foreground\"\n                >\n                  {pollutant.name}\n                </h2>\n                \n                {/* Pollutant Description */}\n                <p \n                  id=\"pollutant-modal-description\"\n                  className=\"text-muted-foreground leading-relaxed\"\n                >\n                  {pollutant.description}\n                </p>\n                \n                {/* Health Impact */}\n                <div className=\"pt-4 border-t border-muted/30\">\n                  <h3 className=\"text-sm font-medium text-muted-foreground mb-2\">\n                    Health Impact\n                  </h3>\n                  <p className=\"text-sm text-muted-foreground\">\n                    {getHealthImpact(pollutant.name, pollutant.value)}\n                  </p>\n                </div>\n                \n                {/* Close Button */}\n                <Button \n                  onClick={onClose} \n                  variant=\"outline\" \n                  className=\"w-full mt-6\"\n                  size=\"lg\"\n                >\n                  Close\n                </Button>\n              </div>\n            </GlassCard>\n          </motion.div>\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n});\n\nPollutantModal.displayName = 'PollutantModal';\n\n/**\n * Helper function to get health impact information based on pollutant and value\n */\nfunction getHealthImpact(name: string, value: number): string {\n  type ImpactLevel = {\n    min: number;\n    max: number;\n    description: string;\n  };\n\n  const impacts: Record<string, ImpactLevel[]> = {\n    'PM2.5': [\n      { min: 0, max: 12, description: 'Air quality is considered satisfactory.' },\n      { min: 12.1, max: 35.4, description: 'Unusually sensitive people should consider reducing prolonged outdoor exertion.' },\n      { min: 35.5, max: 55.4, description: 'People with heart or lung disease, older adults, and children should reduce prolonged outdoor exertion.' },\n      { min: 55.5, max: 150.4, description: 'Everyone may begin to experience health effects; members of sensitive groups may experience more serious health effects.' },\n      { min: 150.5, max: 250.4, description: 'Health alert - everyone may experience more serious health effects.' }\n    ],\n    'PM10': [\n      { min: 0, max: 54, description: 'Air quality is considered satisfactory.' },\n      { min: 55, max: 154, description: 'Unusually sensitive people should consider reducing prolonged outdoor exertion.' },\n      { min: 155, max: 254, description: 'People with heart or lung disease, older adults, and children should reduce prolonged outdoor exertion.' }\n    ],\n    'NO₂': [\n      { min: 0, max: 53, description: 'Air quality is considered satisfactory.' },\n      { min: 54, max: 100, description: 'Unusually sensitive people should consider reducing prolonged outdoor exertion.' },\n      { min: 101, max: 360, description: 'People with respiratory diseases should reduce outdoor exercise.' }\n    ],\n    'SO₂': [\n      { min: 0, max: 35, description: 'Air quality is considered satisfactory.' },\n      { min: 36, max: 75, description: 'People with asthma should consider reducing outdoor activities.' },\n      { min: 76, max: 185, description: 'People with asthma should avoid outdoor activities.' }\n    ],\n    'CO': [\n      { min: 0, max: 4.4, description: 'Air quality is considered satisfactory.' },\n      { min: 4.5, max: 9.4, description: 'People with heart disease should reduce heavy exertion.' },\n      { min: 9.5, max: 12.4, description: 'People with heart disease should avoid heavy exertion.' }\n    ],\n    'O₃': [\n      { min: 0, max: 54, description: 'Air quality is considered satisfactory.' },\n      { min: 55, max: 70, description: 'Unusually sensitive people should consider reducing prolonged outdoor exertion.' },\n      { min: 71, max: 85, description: 'People with lung disease should reduce outdoor activities.' }\n    ]\n  };\n\n  const defaultImpact = 'No specific health impact information available.';\n  const pollutantImpacts: ImpactLevel[] = impacts[name] || [];\n  \n  if (pollutantImpacts.length === 0) {\n    return defaultImpact;\n  }\n  \n  // Find the most relevant impact based on value\n  for (const impact of pollutantImpacts) {\n    if (value >= impact.min && value <= impact.max) {\n      return impact.description;\n    }\n  }\n  \n  // If no range matches, return the last impact (worst case)\n  const lastImpact = pollutantImpacts[pollutantImpacts.length - 1];\n  return lastImpact ? lastImpact.description : defaultImpact;\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\AirQualityDashboard\\WeatherSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\AirQualityDashboard\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ArticleModal.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":64,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":64,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":64,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":64,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\nimport { X, Clock, User, Calendar } from \"lucide-react\";\nimport { GlassCard, GlassCardContent } from \"@/components/ui/GlassCard\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Article } from \"@/data/articles\";\n\ninterface ArticleModalProps {\n  article: Article;\n  onClose: () => void;\n}\n\nexport default function ArticleModal({ article, onClose }: ArticleModalProps) {\n  const [isVisible, setIsVisible] = useState(false);\n\n  useEffect(() => {\n    setIsVisible(true);\n    // Prevent body scroll when modal is open\n    document.body.style.overflow = 'hidden';\n    \n    return () => {\n      document.body.style.overflow = 'unset';\n    };\n  }, []);\n\n  // Early return if no article (after hooks)\n  if (!article) {\n    return null;\n  }\n\n  const handleClose = () => {\n    setIsVisible(false);\n    setTimeout(() => {\n      onClose();\n    }, 300);\n  };\n\n  const getCategoryColor = (category: Article['category']) => {\n    if (!category) {\n      return 'bg-muted/10 text-muted-foreground border-muted/20';\n    }\n    \n    switch (category) {\n      case 'health':\n        return 'bg-error/10 text-error border-error/20';\n      case 'environment':\n        return 'bg-success/10 text-success border-success/20';\n      case 'research':\n        return 'bg-primary/10 text-primary border-primary/20';\n      case 'tips':\n        return 'bg-warning/10 text-warning border-warning/20';\n      default:\n        return 'bg-muted/10 text-muted-foreground border-muted/20';\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    try {\n      return new Date(dateString).toLocaleDateString('en-US', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric'\n      });\n    } catch (err) {\n      return 'Invalid date';\n    }\n  };\n\n  return (\n    <>\n      {/* Backdrop */}\n      <div \n        className={`fixed inset-0 bg-black/50 backdrop-blur-sm z-50 transition-opacity duration-300 ${\n          isVisible ? 'opacity-100' : 'opacity-0'\n        }`}\n        onClick={handleClose}\n      />\n      \n      {/* Modal */}\n      <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\n        <GlassCard \n          className={`w-full max-w-4xl max-h-[90vh] overflow-hidden glass-card transform transition-all duration-300 ${\n            isVisible ? 'scale-100 opacity-100' : 'scale-95 opacity-0'\n          }`}\n        >\n          <div className=\"relative\">\n            {/* Close button */}\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              className=\"absolute top-4 right-4 z-10 bg-white/80 hover:bg-white/90 backdrop-blur-sm\"\n              onClick={handleClose}\n            >\n              <X className=\"h-4 w-4\" />\n            </Button>\n            \n            {/* Header with image */}\n            <div className=\"relative h-48 bg-gradient-to-r from-primary/20 to-accent/20\">\n              {article.imageUrl && (\n                <img \n                  src={article.imageUrl} \n                  alt={article.title || 'Article'}\n                  loading=\"lazy\"\n                  className=\"w-full h-full object-cover opacity-60\"\n                />\n              )}\n              <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent\" />\n              <div className=\"absolute bottom-4 left-6 right-16 text-white\">\n                <Badge variant=\"outline\" className={`mb-2 ${getCategoryColor(article.category)}`}>\n                  {article.category ? article.category.charAt(0).toUpperCase() + article.category.slice(1) : 'Unknown'}\n                </Badge>\n                <h1 className=\"text-2xl font-bold\">{article.title || 'Untitled Article'}</h1>\n              </div>\n            </div>\n            \n            {/* Article meta */}\n            <div className=\"px-6 py-4 border-b border-border/20\">\n              <div className=\"flex items-center gap-6 text-sm text-muted-foreground\">\n                <div className=\"flex items-center gap-2\">\n                  <User className=\"h-4 w-4\" />\n                  <span>{article.author || 'Unknown Author'}</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Calendar className=\"h-4 w-4\" />\n                  <span>{article.publishedAt ? formatDate(article.publishedAt) : 'No date'}</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Clock className=\"h-4 w-4\" />\n                  <span>{article.readTime ? `${article.readTime} min read` : 'Unknown read time'}</span>\n                </div>\n              </div>\n            </div>\n            \n            {/* Content */}\n            <GlassCardContent className=\"p-6 max-h-[60vh] overflow-y-auto\">\n              <div className=\"prose prose-sm max-w-none\">\n                {article.summary && (\n                  <p className=\"text-lg text-muted-foreground mb-6 font-medium\">\n                    {article.summary}\n                  </p>\n                )}\n                {article.content && (\n                  <div \n                    className=\"article-content\"\n                    dangerouslySetInnerHTML={{ __html: article.content }}\n                  />\n                )}\n                {!article.content && !article.summary && (\n                  <p className=\"text-muted-foreground\">No content available for this article.</p>\n                )}\n              </div>\n            </GlassCardContent>\n          </div>\n        </GlassCard>\n      </div>\n    </>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\BackgroundManager.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'BACKGROUND_REFRESH_INTERVAL' is assigned a value but never used.","line":13,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"BACKGROUND_REFRESH_INTERVAL"},"fix":{"range":[583,634],"text":""},"desc":"Remove unused variable 'BACKGROUND_REFRESH_INTERVAL'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BACKGROUND_REFRESH_INTERVAL' is assigned a value but never used.","line":13,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":34},{"ruleId":"no-unused-vars","severity":1,"message":"'lastWeatherUpdate' is assigned a value but never used.","line":162,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":162,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"lastWeatherUpdate"},"fix":{"range":[5190,5234],"text":""},"desc":"Remove unused variable 'lastWeatherUpdate'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'lastWeatherUpdate' is assigned a value but never used.","line":162,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":162,"endColumn":26},{"ruleId":"no-unused-vars","severity":1,"message":"'lastBackgroundRef' is assigned a value but never used.","line":198,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":198,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"lastBackgroundRef"},"fix":{"range":[6339,6384],"text":""},"desc":"Remove unused variable 'lastBackgroundRef'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'lastBackgroundRef' is assigned a value but never used.","line":198,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":198,"endColumn":26},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'debugLog'. Either include it or remove the dependency array.","line":344,"column":6,"nodeType":"ArrayExpression","endLine":344,"endColumn":69,"suggestions":[{"desc":"Update the dependencies array to be: [backgroundState, currentWeather, shouldTrack, renderIteration, debugLog]","fix":{"range":[10975,11038],"text":"[backgroundState, currentWeather, shouldTrack, renderIteration, debugLog]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'locationData'. Either include it or remove the dependency array.","line":362,"column":6,"nodeType":"ArrayExpression","endLine":362,"endColumn":87,"suggestions":[{"desc":"Update the dependencies array to be: [locationData.latitude, locationData.longitude, setCoordinates, hasInitialData, locationData]","fix":{"range":[11562,11643],"text":"[locationData.latitude, locationData.longitude, setCoordinates, hasInitialData, locationData]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'debugLog'. Either include it or remove the dependency array.","line":603,"column":6,"nodeType":"ArrayExpression","endLine":603,"endColumn":55,"suggestions":[{"desc":"Update the dependencies array to be: [currentWeather, weatherLoading, renderIteration, debugLog]","fix":{"range":[20116,20165],"text":"[currentWeather, weatherLoading, renderIteration, debugLog]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo, useRef, useCallback } from 'react';\nimport { useTheme } from '@/contexts/ThemeContext';\nimport { logGeolocation } from '@/lib/logger';\nimport { debugTracker } from '@/utils/errorTracker';\n\n// Import hooks directly instead of lazy loading them\nimport { useWeatherStore } from '@/store/weatherStore';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { useGeolocation } from '@/hooks/useGeolocation';\nimport { getBackgroundImage, isNightTime, isSunriseSunsetPeriod } from '@/lib/weatherBackgrounds';\n\n// Background refresh settings\nconst BACKGROUND_REFRESH_INTERVAL = 30 * 60 * 1000; // 30 minutes\nconst BACKGROUND_REFRESH_LOCK_DURATION = 5 * 60 * 1000; // 5 minutes to prevent rapid switching\nconst BACKGROUND_REFRESH_LOCK_KEY = 'breath-safe:bg-refresh-lock';\nconst BACKGROUND_TRANSITION_DURATION = 500; // 500ms for smoother transitions\nconst BACKGROUND_UPDATE_DEBOUNCE = 1000; // 1 second debounce for background updates\n\ntype TimeOfDayPeriod = 'morning' | 'afternoon' | 'evening' | 'night';\n\ninterface BackgroundLockPayload {\n  timestamp: number;\n  userAgent: string;\n  background?: string;\n}\n\nconst parseTimeString = (value?: string): Date | null => {\n  if (!value) {\n    return null;\n  }\n\n  const parsed = new Date(value);\n  if (!Number.isNaN(parsed.getTime())) {\n    return parsed;\n  }\n\n  const asNumber = Number(value);\n  if (!Number.isNaN(asNumber)) {\n    const fromNumber = new Date(asNumber * (value.length < 13 ? 1000 : 1));\n    if (!Number.isNaN(fromNumber.getTime())) {\n      return fromNumber;\n    }\n  }\n\n  return null;\n};\n\nconst getTimeOfDayInfo = (\n  sunriseTime?: string,\n  sunsetTime?: string\n): { period: TimeOfDayPeriod; isSunriseWindow: boolean; isSunsetWindow: boolean } => {\n  const now = new Date();\n  const sunrise = parseTimeString(sunriseTime);\n  const sunset = parseTimeString(sunsetTime);\n  const hour = now.getHours();\n\n  const windowMs = 45 * 60 * 1000; // 45 minutes on either side of sunrise/sunset\n  const isSunriseWindow = !!(sunrise && Math.abs(now.getTime() - sunrise.getTime()) <= windowMs);\n  const isSunsetWindow = !!(sunset && Math.abs(now.getTime() - sunset.getTime()) <= windowMs);\n\n  let period: TimeOfDayPeriod;\n  if (hour >= 21 || hour < 5) {\n    period = 'night';\n  } else if (hour < 12) {\n    period = 'morning';\n  } else if (hour < 17) {\n    period = 'afternoon';\n  } else {\n    period = 'evening';\n  }\n\n  return { period, isSunriseWindow, isSunsetWindow };\n};\n\n// Helper function to check if background refresh is locked\nconst isBackgroundRefreshLocked = (nextBackground?: string): boolean => {\n  if (typeof window === 'undefined') {\n    return false;\n  }\n  try {\n    const lockData = localStorage.getItem(BACKGROUND_REFRESH_LOCK_KEY);\n    if (!lockData) return false;\n\n    const parsed: BackgroundLockPayload = JSON.parse(lockData);\n    const { timestamp, background } = parsed;\n    const now = Date.now();\n    const timeSinceLastRefresh = now - timestamp;\n\n    if (timeSinceLastRefresh >= BACKGROUND_REFRESH_LOCK_DURATION) {\n      return false;\n    }\n\n    if (nextBackground && background && background !== nextBackground) {\n      // Allow new backgrounds through the lock window\n      return false;\n    }\n\n    return true;\n  } catch {\n    return false;\n  }\n};\n\n// Helper function to set background refresh lock\nconst setBackgroundRefreshLock = (nextBackground: string): void => {\n  if (typeof window === 'undefined') {\n    return;\n  }\n  try {\n    const lockData = {\n      timestamp: Date.now(),\n      userAgent: navigator.userAgent,\n      background: nextBackground\n    };\n    localStorage.setItem(BACKGROUND_REFRESH_LOCK_KEY, JSON.stringify(lockData));\n  } catch (error) {\n    console.warn('Failed to set background refresh lock:', error);\n  }\n};\n\n// Location handling is now managed by useGeolocation hook\n\ninterface BackgroundManagerProps {\n  children: React.ReactNode;\n}\n\n/**\n * BackgroundManager component that handles dynamic background changes based on weather and time.\n * Manages weather data fetching, background transitions, and error states.\n */\nconst DEFAULT_BACKGROUND = '/weather-backgrounds/partly-cloudy.webp';\nconst ERROR_BACKGROUND = '/weather-backgrounds/overcast.webp';\nconst GLOBAL_TIME_ANALYSIS_CACHE_KEY = '__BG_TIME_ANALYSIS_CACHE__';\n\nconst bgStateTracker = { renderCount: 0 };\n\nconst resolveBackgroundDebugFlag = (): boolean => {\n  if (typeof globalThis === 'undefined') {\n    return false;\n  }\n\n  const globalAny = globalThis as Record<string, unknown>;\n  const explicitFlag = globalAny['__BG_DEBUG__'];\n  if (typeof explicitFlag === 'boolean') {\n    return explicitFlag;\n  }\n\n  const trackerFlag = globalAny['__TRACK_VARIABLES__'];\n  if (typeof trackerFlag === 'boolean') {\n    return trackerFlag;\n  }\n\n  return false;\n};\n\nconst BackgroundManager: React.FC<BackgroundManagerProps> = React.memo(({ children }) => {\n  // State\n  const [currentBackground, setCurrentBackground] = useState<string>(DEFAULT_BACKGROUND);\n  const [isTransitioning, setIsTransitioning] = useState(false);\n  const [backgroundState, setBackgroundState] = useState<'loading' | 'error' | 'success'>('loading');\n  const [hasInitialData, setHasInitialData] = useState<boolean>(false);\n  const lastWeatherUpdate = useRef<number>(0);\n  const updateTimeoutRef = useRef<number | null>(null);\n  const isMountedRef = useRef(true);\n  const [timeOfDayInfo, setTimeOfDayInfo] = useState<{\n    period: TimeOfDayPeriod;\n    isSunriseWindow: boolean;\n    isSunsetWindow: boolean;\n  }>({ period: 'morning', isSunriseWindow: false, isSunsetWindow: false });\n\n  // Hooks - all at the top level\n  const { theme } = useTheme();\n  const { user } = useAuth() || {};\n  const {\n    weatherData: currentWeather,\n    isLoading: weatherLoading,\n    error: weatherError,\n    fetchWeatherData,\n    setCoordinates\n  } = useWeatherStore();\n\n  const {\n    locationData,\n    hasUserConsent,\n    permissionStatus,\n    requestLocation,\n    getIPBasedLocationAsync\n  } = useGeolocation();\n\n  bgStateTracker.renderCount += 1;\n  const renderIteration = bgStateTracker.renderCount;\n\n  // Refs for tracking state without causing re-renders\n  const fallbackTimeoutRef = useRef<number | null>(null);\n  const effectTimeoutRef = useRef<number | null>(null);\n  const updateIntervalRef = useRef<number | null>(null);\n  const timeOfDayIntervalRef = useRef<number | null>(null);\n  const lastBackgroundRef = useRef<string>('');\n  const pendingBackgroundUpdate = useRef<string | null>(null);\n  const timeAnalysisCacheRef = useRef<Record<string, string>>(\n    Object.create(null) as Record<string, string>\n  );\n  const hasAppliedBackgroundRef = useRef(false);\n\n  const shouldTrack = resolveBackgroundDebugFlag();\n  const debugLog = useCallback(\n    (...args: unknown[]) => {\n      if (shouldTrack) {\n        console.log(...args);\n      }\n    },\n    [shouldTrack]\n  );\n\n  const getTimeAnalysisCache = useCallback((): Record<string, string> => {\n    try {\n      if (typeof globalThis !== 'undefined') {\n        const globalAny = globalThis as Record<string, unknown>;\n        const existing = globalAny[GLOBAL_TIME_ANALYSIS_CACHE_KEY];\n        if (existing && typeof existing === 'object') {\n          return existing as Record<string, string>;\n        }\n\n        const initializedCache: Record<string, string> = Object.create(null);\n        globalAny[GLOBAL_TIME_ANALYSIS_CACHE_KEY] = initializedCache;\n        return initializedCache;\n      }\n    } catch (error) {\n      console.warn('BackgroundManager: Failed to access global time analysis cache, using local cache instead.', error);\n    }\n\n    return timeAnalysisCacheRef.current;\n  }, []);\n\n  debugLog(`🖼️ [BG-MANAGER-${renderIteration}] Component rendering:`, {\n    hasWeatherData: !!currentWeather,\n    backgroundState,\n    weatherLoading,\n    weatherError,\n    geolocationConsent: hasUserConsent,\n    geolocationPermissionStatus: permissionStatus,\n    hasLocationData: !!locationData,\n    requestLocationAvailable: typeof requestLocation === 'function',\n    getIPBasedLocationAsyncAvailable: typeof getIPBasedLocationAsync === 'function',\n    timestamp: new Date().toISOString()\n  });\n\n  if (shouldTrack) {\n    debugTracker.trackVariableDeclaration(`BackgroundManager#${renderIteration}`, {\n      hasWeatherData: !!currentWeather,\n      backgroundState,\n      weatherLoading,\n      weatherError\n    }, 'BackgroundManager.tsx:render');\n  }\n\n  // Cleanup function for component unmount\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n      \n      if (timeOfDayIntervalRef.current !== null) {\n        window.clearInterval(timeOfDayIntervalRef.current);\n        timeOfDayIntervalRef.current = null;\n      }\n\n      // Clear all timeouts and intervals\n      [fallbackTimeoutRef, effectTimeoutRef, updateIntervalRef].forEach(ref => {\n        if (ref.current) {\n          clearTimeout(ref.current);\n          ref.current = null;\n        }\n      });\n      \n      // Clear any pending updates\n      if (updateTimeoutRef.current) {\n        clearTimeout(updateTimeoutRef.current);\n        updateTimeoutRef.current = null;\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (typeof window === 'undefined') {\n      return undefined;\n    }\n\n    const updateTimeOfDay = () => {\n      if (!isMountedRef.current) {\n        return;\n      }\n      setTimeOfDayInfo(getTimeOfDayInfo(currentWeather?.sunriseTime, currentWeather?.sunsetTime));\n    };\n\n    updateTimeOfDay();\n    const intervalId = window.setInterval(updateTimeOfDay, 60 * 1000);\n    timeOfDayIntervalRef.current = intervalId;\n\n    return () => {\n      window.clearInterval(intervalId);\n      if (timeOfDayIntervalRef.current === intervalId) {\n        timeOfDayIntervalRef.current = null;\n      }\n    };\n  }, [currentWeather?.sunriseTime, currentWeather?.sunsetTime]);\n\n  useEffect(() => {\n    if (typeof window === 'undefined') {\n      return; // Skip in non-browser environments\n    }\n\n    const iterationLabel = renderIteration;\n    debugLog(`🖼️ [BG-MANAGER-${iterationLabel}] Effect running after render`);\n\n    if (effectTimeoutRef.current) {\n      window.clearTimeout(effectTimeoutRef.current);\n      effectTimeoutRef.current = null;\n    }\n\n    if (!(shouldTrack && backgroundState === 'loading')) {\n      return () => {\n        debugLog(`🖼️ [BG-MANAGER-${iterationLabel}] Effect cleanup`);\n      };\n    }\n\n    effectTimeoutRef.current = window.setTimeout(() => {\n      console.warn('⚠️  [CRITICAL] BackgroundManager effect timeout - potential TDZ trigger point', {\n        hasWeatherData: !!currentWeather,\n        backgroundState,\n        timestamp: new Date().toISOString()\n      });\n      if (shouldTrack) {\n        debugTracker.trackVariableAccess('BackgroundManager', 'BackgroundManager.tsx:postRenderTimeout');\n      }\n    }, 5000);\n\n    return () => {\n      debugLog(`🖼️ [BG-MANAGER-${iterationLabel}] Effect cleanup`);\n      if (effectTimeoutRef.current) {\n        window.clearTimeout(effectTimeoutRef.current);\n        effectTimeoutRef.current = null;\n      }\n    };\n  }, [backgroundState, currentWeather, shouldTrack, renderIteration]);\n\n  // Update weather store coordinates when location data changes\n  useEffect(() => {\n    if (!isMountedRef.current) return;\n    \n    if (locationData && !hasInitialData) {\n      logGeolocation.debug('Location data updated, setting coordinates', { \n        city: locationData.city, \n        country: locationData.country \n      });\n      \n      // Only update coordinates if they've changed\n      setCoordinates({ \n        latitude: locationData.latitude, \n        longitude: locationData.longitude \n      });\n    }\n  }, [locationData?.latitude, locationData?.longitude, setCoordinates, hasInitialData]);\n\n  // Implement immediate fetch on login and progressive loading\n  useEffect(() => {\n    if (!isMountedRef.current) return;\n    \n    const fetchWeather = async () => {\n      if (!user || !locationData) return;\n      \n      logGeolocation.info('User authenticated, fetching initial weather data');\n      setBackgroundState('loading');\n      \n      try {\n        await fetchWeatherData({ \n          latitude: locationData.latitude, \n          longitude: locationData.longitude \n        });\n        \n        if (isMountedRef.current) {\n          logGeolocation.info('Initial weather data fetched successfully');\n          setBackgroundState('success');\n          setHasInitialData(true);\n        }\n      } catch (error) {\n        if (isMountedRef.current) {\n          logGeolocation.warn('Initial weather data failed, using fallback', { error });\n          setBackgroundState('error');\n          setHasInitialData(true);\n        }\n      }\n    };\n    \n    // Only fetch if we haven't loaded data yet\n    if (!hasInitialData) {\n      fetchWeather();\n    }\n    \n    return () => {\n      // Cleanup function\n      if (updateTimeoutRef.current) {\n        clearTimeout(updateTimeoutRef.current);\n        updateTimeoutRef.current = null;\n      }\n    };\n  }, [user, hasInitialData, locationData, fetchWeatherData]);\n\n  // Update background state based on weather loading status\n  useEffect(() => {\n    if (!isMountedRef.current) return;\n    \n    // Only update state if it's actually changing\n    if (weatherLoading && backgroundState !== 'loading') {\n      setBackgroundState('loading');\n    } else if (weatherError && backgroundState !== 'error') {\n      console.warn('Weather data error:', weatherError);\n      setBackgroundState('error');\n    } else if (currentWeather && backgroundState !== 'success') {\n      setBackgroundState('success');\n    }\n  }, [weatherLoading, weatherError, currentWeather, backgroundState]);\n\n  // Determine the appropriate background image based on weather and time\n  const targetBackground = useMemo(() => {\n    try {\n      const defaultBackground = DEFAULT_BACKGROUND;\n\n      if (weatherLoading || weatherError) {\n        debugLog(`BackgroundManager: ${weatherLoading ? 'Loading' : 'Error'}, using default background`);\n        return weatherError ? ERROR_BACKGROUND : defaultBackground;\n      }\n\n      if (!currentWeather) {\n        debugLog('BackgroundManager: No weather data available, using default background');\n        return defaultBackground;\n      }\n\n      const { period, isSunriseWindow, isSunsetWindow } = timeOfDayInfo;\n      const isNightPeriod = period === 'night' || isNightTime(currentWeather.sunriseTime, currentWeather.sunsetTime);\n      const isSunriseSunset = isSunriseSunsetPeriod(currentWeather.sunriseTime, currentWeather.sunsetTime);\n\n      const currentTime = new Date();\n      const timeKey = `${currentTime.getHours()}:${currentTime.getMinutes()}`;\n      const dayNightKey = isNightPeriod ? 'Night' : 'Day';\n      const cache = getTimeAnalysisCache();\n\n      if (!cache[timeKey] || cache[timeKey] !== dayNightKey) {\n        cache[timeKey] = dayNightKey;\n        debugLog(\n          `🌙 [BackgroundManager] Time: ${timeKey} (${dayNightKey}) | Sunrise: ${currentWeather.sunriseTime || 'N/A'} | Sunset: ${currentWeather.sunsetTime || 'N/A'}`\n        );\n      }\n\n      let conditionCode = 1;\n      const weatherCondition = currentWeather.weatherCondition?.toLowerCase();\n      if (weatherCondition) {\n        if (weatherCondition.includes('clear') || weatherCondition.includes('sun')) {\n          conditionCode = 0;\n        } else if (weatherCondition.includes('cloud') && !weatherCondition.includes('overcast')) {\n          conditionCode = 2;\n        } else if (weatherCondition.includes('overcast')) {\n          conditionCode = 3;\n        } else if (weatherCondition.includes('rain') || weatherCondition.includes('drizzle')) {\n          conditionCode = 61;\n        } else if (weatherCondition.includes('snow')) {\n          conditionCode = 71;\n        } else if (weatherCondition.includes('fog') || weatherCondition.includes('mist')) {\n          conditionCode = 45;\n        }\n      }\n\n      let candidateBackground = getBackgroundImage(conditionCode);\n\n      if (isNightPeriod) {\n        candidateBackground = '/weather-backgrounds/night.webp';\n      }\n\n      if (isSunriseWindow) {\n        candidateBackground = '/weather-backgrounds/sunrise.webp';\n      } else if (isSunsetWindow || (period === 'evening' && conditionCode === 0)) {\n        candidateBackground = '/weather-backgrounds/sunset.webp';\n      } else if (isSunriseSunset && period === 'morning') {\n        candidateBackground = '/weather-backgrounds/sunrise.webp';\n      }\n\n      if (isBackgroundRefreshLocked(candidateBackground) && currentBackground !== DEFAULT_BACKGROUND) {\n        debugLog('BackgroundManager: Refresh locked - using current background');\n        return currentBackground;\n      }\n\n      return candidateBackground;\n    } catch (error) {\n      console.error('BackgroundManager: Failed to determine target background, using default background instead.', error);\n      if (shouldTrack) {\n        debugTracker.trackVariableAccess('BackgroundManager', 'BackgroundManager.tsx:targetBackgroundFallback');\n      }\n      return DEFAULT_BACKGROUND;\n    }\n  }, [\n    currentWeather,\n    currentBackground,\n    weatherLoading,\n    weatherError,\n    debugLog,\n    timeOfDayInfo,\n    getTimeAnalysisCache,\n    shouldTrack\n  ]);\n\n  // Update background when target changes with debounce and safety checks\n  useEffect(() => {\n    if (!isMountedRef.current || !targetBackground) {\n      return undefined;\n    }\n\n    // Only update if the background is actually changing\n    if (targetBackground !== currentBackground) {\n      // Cancel any pending updates\n      if (updateTimeoutRef.current) {\n        clearTimeout(updateTimeoutRef.current);\n        updateTimeoutRef.current = null;\n      }\n\n      // Store the pending background update\n      pendingBackgroundUpdate.current = targetBackground;\n\n      // Debounce the update to prevent rapid changes\n      updateTimeoutRef.current = window.setTimeout(() => {\n        if (!isMountedRef.current || pendingBackgroundUpdate.current !== targetBackground) {\n          return;\n        }\n\n        debugLog('BackgroundManager: Changing background from', currentBackground, 'to', targetBackground);\n\n        // Set refresh lock to prevent rapid changes\n        if (targetBackground !== DEFAULT_BACKGROUND) {\n          setBackgroundRefreshLock(targetBackground);\n        }\n\n        // Start transition\n        setIsTransitioning(true);\n\n        // Update the background after a short delay to allow the transition to start\n        const transitionTimer = window.setTimeout(() => {\n          if (isMountedRef.current) {\n            setCurrentBackground(targetBackground);\n            setIsTransitioning(false);\n            hasAppliedBackgroundRef.current = true;\n            pendingBackgroundUpdate.current = null;\n          }\n        }, BACKGROUND_TRANSITION_DURATION / 2);\n\n        // Clear the update timeout\n        updateTimeoutRef.current = null;\n\n        // Cleanup function to clear the timeout if the effect runs again\n        return () => {\n          clearTimeout(transitionTimer);\n        };\n      }, BACKGROUND_UPDATE_DEBOUNCE);\n    }\n\n    // Cleanup function to clear any pending timeouts\n    return () => {\n      if (updateTimeoutRef.current) {\n        clearTimeout(updateTimeoutRef.current);\n        updateTimeoutRef.current = null;\n      }\n    };\n  }, [targetBackground, currentBackground, debugLog]);\n\n  useEffect(() => {\n    if (fallbackTimeoutRef.current) {\n      clearTimeout(fallbackTimeoutRef.current);\n      fallbackTimeoutRef.current = null;\n    }\n\n    if (currentWeather || weatherLoading) {\n      return;\n    }\n\n    if (typeof window === 'undefined') {\n      return () => {};\n    }\n\n    fallbackTimeoutRef.current = window.setTimeout(() => {\n      if (!isMountedRef.current || hasAppliedBackgroundRef.current) {\n        return;\n      }\n\n      debugLog(`🖼️ [BG-MANAGER-${renderIteration}] Applying default background after timeout`);\n      setCurrentBackground(DEFAULT_BACKGROUND);\n      setBackgroundState((prev) => (prev === 'error' ? prev : 'success'));\n      hasAppliedBackgroundRef.current = true;\n    }, 3000);\n\n    return () => {\n      if (fallbackTimeoutRef.current) {\n        clearTimeout(fallbackTimeoutRef.current);\n        fallbackTimeoutRef.current = null;\n      }\n    };\n  }, [currentWeather, weatherLoading, renderIteration]);\n\n  // Get background based on state with fallbacks\n  const getBackgroundForState = useCallback((): string => {\n    const defaultBg = DEFAULT_BACKGROUND;\n    \n    try {\n      // If we have a pending update, use it to prevent flickering\n      if (pendingBackgroundUpdate.current) {\n        return pendingBackgroundUpdate.current;\n      }\n\n      // If we're in a transition, keep the current background\n      if (isTransitioning) {\n        return currentBackground || defaultBg;\n      }\n\n      // Otherwise, return the appropriate background based on state\n      switch (backgroundState) {\n        case 'loading':\n          return defaultBg;\n          \n        case 'error':\n          return ERROR_BACKGROUND;\n          \n        case 'success':\n          return currentBackground || defaultBg;\n          \n        default:\n          return defaultBg;\n      }\n    } catch (error) {\n      console.error('Error getting background for state:', error);\n      return defaultBg;\n    }\n  }, [backgroundState, currentBackground, isTransitioning]);\n\n  // Get overlay opacity based on theme\n  const overlayOpacity = theme === 'light' ? '0.2' : '0.4';\n\n  try {\n    const renderResult = (\n      <div className=\"relative min-h-screen\">\n        {/* Weather Background */}\n        <div \n          className=\"fixed inset-0 z-[-1] transition-opacity duration-500\"\n          style={{ \n            opacity: isTransitioning ? 0.3 : 1 \n          }}\n        >\n          <img\n            src={getBackgroundForState()}\n            alt=\"Weather background\"\n            className=\"w-full h-full object-cover\"\n            onError={() => {\n              console.warn('BackgroundManager: Failed to load background image:', getBackgroundForState());\n              // Fallback to default background\n              setCurrentBackground(DEFAULT_BACKGROUND);\n              hasAppliedBackgroundRef.current = true;\n            }}\n          />\n          \n          {/* Overlay for better text readability */}\n          <div \n            className=\"absolute inset-0\"\n            style={{ \n              backgroundColor: `rgba(0, 0, 0, ${overlayOpacity})` \n            }}\n          />\n        </div>\n\n        {/* Content */}\n        <div className=\"relative z-10\">\n          {children}\n        </div>\n      </div>\n    );\n\n    if (shouldTrack) {\n      debugLog(`✅ [BG-MANAGER-${renderIteration}] Render successful`);\n      debugTracker.trackVariableAccess('BackgroundManager', 'BackgroundManager.tsx:renderSuccess');\n    }\n\n    return renderResult;\n  } catch (error) {\n    console.error(`❌ [BG-MANAGER-${renderIteration}] Render error:`, error);\n    if (shouldTrack) {\n      debugTracker.dumpDebugInfo();\n    }\n    throw error;\n  }\n\n  // Fallback return to satisfy TypeScript control flow (should be unreachable)\n  return null;\n});\n\nexport default BackgroundManager;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ConnectionNotification.tsx","messages":[{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'handleDismiss' was used before it was defined.","line":32,"column":9,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":32,"endColumn":22},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'handleDismiss'. Either include it or remove the dependency array.","line":37,"column":6,"nodeType":"ArrayExpression","endLine":37,"endColumn":41,"suggestions":[{"desc":"Update the dependencies array to be: [status, autoDismiss, dismissDelay, handleDismiss]","fix":{"range":[1093,1128],"text":"[status, autoDismiss, dismissDelay, handleDismiss]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\nimport { X, Wifi, WifiOff, CheckCircle, AlertCircle, RefreshCw } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport { cn } from '@/lib/utils';\n\nexport type ConnectionStatus = 'connected' | 'connecting' | 'disconnected' | 'reconnecting' | 'error';\n\nexport interface ConnectionNotificationProps {\n  status: ConnectionStatus;\n  message?: string;\n  onRetry?: () => void;\n  onDismiss?: () => void;\n  autoDismiss?: boolean;\n  dismissDelay?: number;\n}\n\nexport const ConnectionNotification: React.FC<ConnectionNotificationProps> = ({\n  status,\n  message,\n  onRetry,\n  onDismiss,\n  autoDismiss = true,\n  dismissDelay = 5000\n}) => {\n  const [isVisible, setIsVisible] = useState(true);\n  const [isDismissing, setIsDismissing] = useState(false);\n\n  // Auto-dismiss logic - only for successful connections\n  useEffect(() => {\n    if (autoDismiss && status === 'connected') {\n      const timer = setTimeout(() => {\n        handleDismiss();\n      }, dismissDelay);\n\n      return () => clearTimeout(timer);\n    }\n  }, [status, autoDismiss, dismissDelay]);\n\n  // Prevent showing multiple notifications for the same status\n  useEffect(() => {\n    // Reset visibility when status changes\n    setIsVisible(true);\n    setIsDismissing(false);\n  }, [status]);\n\n  const handleDismiss = useCallback(() => {\n    setIsDismissing(true);\n    setTimeout(() => {\n      setIsVisible(false);\n      // Delay the onDismiss callback to prevent immediate retriggering\n      setTimeout(() => {\n        onDismiss?.();\n      }, 100);\n    }, 300); // Smooth fade out\n  }, [onDismiss]);\n\n  const handleRetry = useCallback(() => {\n    onRetry?.();\n  }, [onRetry]);\n\n  if (!isVisible) return null;\n\n  // Get status-specific styling and content\n  const getStatusConfig = () => {\n    switch (status) {\n      case 'connected':\n        return {\n          icon: <CheckCircle className=\"h-5 w-5 text-green-500\" />,\n          bgColor: 'bg-green-500/10 border-green-500/20',\n          textColor: 'text-green-700 dark:text-green-300',\n          borderColor: 'border-green-500/20',\n          title: 'Connected',\n          defaultMessage: 'Real-time updates are now available'\n        };\n      case 'connecting':\n        return {\n          icon: <RefreshCw className=\"h-5 w-5 text-blue-500 animate-spin\" />,\n          bgColor: 'bg-blue-500/10 border-blue-500/20',\n          textColor: 'text-blue-700 dark:text-blue-300',\n          borderColor: 'border-blue-500/20',\n          title: 'Connecting',\n          defaultMessage: 'Establishing connection...'\n        };\n      case 'reconnecting':\n        return {\n          icon: <RefreshCw className=\"h-5 w-5 text-yellow-500 animate-spin\" />,\n          bgColor: 'bg-yellow-500/10 border-yellow-500/20',\n          textColor: 'text-yellow-700 dark:text-yellow-300',\n          borderColor: 'border-yellow-500/20',\n          title: 'Reconnecting',\n          defaultMessage: 'Attempting to restore connection...'\n        };\n      case 'disconnected':\n        return {\n          icon: <WifiOff className=\"h-5 w-5 text-red-500\" />,\n          bgColor: 'bg-red-500/10 border-red-500/20',\n          textColor: 'text-red-700 dark:text-red-300',\n          borderColor: 'border-red-500/20',\n          title: 'Disconnected',\n          defaultMessage: 'Real-time updates unavailable'\n        };\n      case 'error':\n        return {\n          icon: <AlertCircle className=\"h-5 w-5 text-red-500\" />,\n          bgColor: 'bg-red-500/10 border-red-500/20',\n          textColor: 'text-red-700 dark:text-red-300',\n          borderColor: 'border-red-500/20',\n          title: 'Connection Error',\n          defaultMessage: 'Failed to establish connection'\n        };\n      default:\n        return {\n          icon: <Wifi className=\"h-5 w-5 text-gray-500\" />,\n          bgColor: 'bg-gray-500/10 border-gray-500/20',\n          textColor: 'text-gray-700 dark:text-gray-300',\n          borderColor: 'border-gray-500/20',\n          title: 'Unknown Status',\n          defaultMessage: 'Connection status unknown'\n        };\n    }\n  };\n\n  const config = getStatusConfig();\n  const displayMessage = message || config.defaultMessage;\n\n  return (\n    <div\n      className={cn(\n        'fixed top-4 left-1/2 transform -translate-x-1/2 z-50',\n        'w-full max-w-md mx-4',\n        'transition-all duration-300 ease-out',\n        isDismissing ? 'opacity-0 translate-y-[-100%]' : 'opacity-100 translate-y-0'\n      )}\n    >\n      <div\n        className={cn(\n          'floating-card border-2',\n          config.bgColor,\n          config.borderColor,\n          'p-4 shadow-lg'\n        )}\n      >\n        <div className=\"flex items-start gap-3\">\n          <div className=\"flex-shrink-0 mt-0.5\">\n            {config.icon}\n          </div>\n          \n          <div className=\"flex-1 min-w-0\">\n            <div className=\"flex items-center justify-between mb-1\">\n              <h3 className={cn('text-sm font-semibold', config.textColor)}>\n                {config.title}\n              </h3>\n              \n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={handleDismiss}\n                className=\"h-6 w-6 p-0 hover:bg-white/10\"\n              >\n                <X className=\"h-4 w-4\" />\n              </Button>\n            </div>\n            \n            <p className={cn('text-sm', config.textColor)}>\n              {displayMessage}\n            </p>\n            \n            {/* Action buttons for specific statuses */}\n            {(status === 'disconnected' || status === 'error') && onRetry && (\n              <div className=\"flex items-center gap-2 mt-3\">\n                <Button\n                  size=\"sm\"\n                  onClick={handleRetry}\n                  className=\"bg-red-600 hover:bg-red-700 text-white text-xs px-3 py-1 h-7\"\n                >\n                  <RefreshCw className=\"h-3 w-3 mr-1\" />\n                  Retry\n                </Button>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ConnectionNotification;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ConnectionNotificationManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ConnectionResilienceProvider.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'connectionStates' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"connectionStates"},"fix":{"range":[200,258],"text":""},"desc":"Remove unused variable 'connectionStates'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'connectionStates' is defined but never used.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":26},{"ruleId":"no-unused-vars","severity":1,"message":"'supabaseClient' is defined but never used.","line":21,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"supabaseClient"},"fix":{"range":[614,632],"text":""},"desc":"Remove unused variable 'supabaseClient'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'supabaseClient' is defined but never used.","line":21,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useToast } from '@/hooks/use-toast';\nimport { ConnectionNotificationManager } from './ConnectionNotificationManager';\nimport { connectionStates } from '@/lib/connectionStates';\n\ninterface ConnectionResilienceProviderProps {\n  children: React.ReactNode;\n  config?: {\n    showDebugPanel?: boolean;\n    heartbeatInterval?: number;\n    maxReconnectAttempts?: number;\n    enableAutoReconnect?: boolean;\n    alertAutoHide?: number;\n  };\n  supabaseClient?: any;\n}\n\nexport function ConnectionResilienceProvider({ \n  children, \n  config = {},\n  supabaseClient \n}: ConnectionResilienceProviderProps) {\n  const [showDebugPanel, setShowDebugPanel] = useState(config.showDebugPanel ?? process.env.NODE_ENV === 'development');\n  const [connectionStatus, setConnectionStatus] = useState<'connected' | 'connecting' | 'disconnected' | 'error'>('connected');\n  const [connectionMessage, setConnectionMessage] = useState('Real-time updates are available');\n  const [lastCheck, setLastCheck] = useState<Date>(new Date());\n  \n  const { toast } = useToast();\n  const reconnectAttemptsRef = useRef(0);\n  const maxReconnectAttempts = config.maxReconnectAttempts ?? 5;\n  const heartbeatInterval = config.heartbeatInterval ?? 120000; // 2 minutes (was 30 seconds)\n  const enableAutoReconnect = config.enableAutoReconnect ?? true;\n  \n  // CRITICAL FIX: Prevent infinite dismiss callbacks\n  const dismissCountRef = useRef(0);\n  const lastDismissTimeRef = useRef(0);\n\n  // Connection health monitoring with proper dependency management\n  useEffect(() => {\n    if (!enableAutoReconnect) return;\n\n    const checkConnectionHealth = () => {\n      try {\n        // Simple connection check without complex state updates\n        setLastCheck(new Date());\n        \n        // Only update status if there's a significant change\n        // Avoid frequent status changes that trigger notifications\n        if (connectionStatus === 'disconnected' || connectionStatus === 'error') {\n          // Only try to recover from actual problem states\n          setConnectionStatus('connected');\n          setConnectionMessage('Real-time updates are available');\n        }\n      } catch (error) {\n        console.warn('Connection health check warning:', error);\n        // Don't change status on warnings to prevent loops\n      }\n    };\n\n    // Reduced frequency to prevent excessive status changes\n    const interval = setInterval(checkConnectionHealth, heartbeatInterval * 2); // Double the interval\n    return () => clearInterval(interval);\n  }, [connectionStatus, enableAutoReconnect, heartbeatInterval]);\n\n  // Periodic dismissal pattern summary logging\n  useEffect(() => {\n    const logDismissalSummary = () => {\n      if (dismissCountRef.current > 0) {\n        console.log(`📊 [ConnectionResilience] Dismissal summary: ${dismissCountRef.current} dismissals in last minute`);\n        \n        // Reset counter for next period\n        dismissCountRef.current = 0;\n      }\n    };\n\n    // Log summary every 2 minutes\n    const summaryInterval = setInterval(logDismissalSummary, 2 * 60 * 1000);\n    \n    return () => clearInterval(summaryInterval);\n  }, []);\n\n  // Manual reconnection function\n  const handleRetry = useCallback(async () => {\n    if (reconnectAttemptsRef.current >= maxReconnectAttempts) {\n      setConnectionStatus('error');\n      setConnectionMessage('Maximum reconnection attempts reached');\n      toast({\n        title: \"Connection Failed\",\n        description: \"Unable to establish connection. Please refresh the page.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setConnectionStatus('connecting');\n    setConnectionMessage('Attempting to reconnect...');\n    reconnectAttemptsRef.current++;\n\n    try {\n      // Simple reconnection logic\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      setConnectionStatus('connected');\n      setConnectionMessage('Real-time updates are available');\n      reconnectAttemptsRef.current = 0;\n      \n      toast({\n        title: \"Reconnected\",\n        description: \"Connection restored successfully\",\n        variant: \"default\",\n      });\n    } catch (error) {\n      console.error('Reconnection failed:', error);\n      setConnectionStatus('error');\n      setConnectionMessage('Reconnection failed');\n    }\n  }, [maxReconnectAttempts, toast]);\n\n  // CRITICAL FIX: Dismiss connection notifications without infinite loops\n  const handleDismiss = useCallback(() => {\n    const now = Date.now();\n    \n    // Enhanced rate limiting with dismissal cooldown (30 seconds)\n    const DISMISS_COOLDOWN = 30000; // 30 seconds\n    const MAX_DISMISS_PER_MINUTE = 3; // Reduced from 5 to 3\n    \n    // Check cooldown period\n    if (now - lastDismissTimeRef.current < DISMISS_COOLDOWN) {\n      console.log('⏳ [ConnectionResilience] Dismiss in cooldown, please wait');\n      return;\n    }\n    \n    // Prevent excessive dismiss calls\n    dismissCountRef.current++;\n    if (dismissCountRef.current > MAX_DISMISS_PER_MINUTE) {\n      console.warn('🚨 [ConnectionResilience] Rate limit exceeded, preventing notification spam');\n      return;\n    }\n    \n    // Reset counter after 1 minute\n    if (now - lastDismissTimeRef.current > 60000) {\n      dismissCountRef.current = 1;\n    }\n    \n    lastDismissTimeRef.current = now;\n    \n    // Log dismissal with rate limiting info\n    console.log(`✅ [ConnectionResilience] Notification dismissed (${dismissCountRef.current}/${MAX_DISMISS_PER_MINUTE} per minute)`);\n  }, []);\n\n  return (\n    <>\n      {/* Connection notification manager with proper status */}\n      <ConnectionNotificationManager\n        connectionStatus={connectionStatus}\n        connectionMessage={connectionMessage}\n        onRetry={handleRetry}\n        onDismiss={handleDismiss}\n      />\n      \n      {children}\n      \n      {/* Debug panel for development only */}\n      {showDebugPanel && (\n        <div className=\"fixed bottom-4 right-4 z-50 bg-background border border-border rounded-lg p-4 shadow-lg\">\n          <div className=\"space-y-2\">\n            <div className=\"text-sm font-medium\">Connection Health</div>\n            <div className=\"text-xs space-y-1\">\n              <div>Status: {connectionStatus}</div>\n              <div>Message: {connectionMessage}</div>\n              <div>Last Check: {lastCheck.toLocaleTimeString()}</div>\n              <div>Reconnect Attempts: {reconnectAttemptsRef.current}</div>\n              <div>Dismiss Count: {dismissCountRef.current}</div>\n            </div>\n            <button\n              onClick={() => setShowDebugPanel(false)}\n              className=\"bg-destructive text-destructive-foreground px-2 py-1 rounded text-xs\"\n            >\n              Close\n            </button>\n          </div>\n        </div>\n      )}\n    </>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\DataSourceValidator.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[53,99],"text":""},"desc":"Remove unused variable 'Badge'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":2,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'GlassCard' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"GlassCard"},"fix":{"range":[182,192],"text":""},"desc":"Remove unused variable 'GlassCard'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'GlassCard' is defined but never used.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'GlassCardContent' is defined but never used.","line":4,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":37,"suggestions":[{"messageId":"removeVar","data":{"varName":"GlassCardContent"},"fix":{"range":[191,209],"text":""},"desc":"Remove unused variable 'GlassCardContent'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'GlassCardContent' is defined but never used.","line":4,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":37},{"ruleId":"no-unused-vars","severity":1,"message":"'GlassCardHeader' is defined but never used.","line":4,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":54,"suggestions":[{"messageId":"removeVar","data":{"varName":"GlassCardHeader"},"fix":{"range":[209,226],"text":""},"desc":"Remove unused variable 'GlassCardHeader'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'GlassCardHeader' is defined but never used.","line":4,"column":39,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":54},{"ruleId":"no-unused-vars","severity":1,"message":"'GlassCardTitle' is defined but never used.","line":4,"column":56,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":70,"suggestions":[{"messageId":"removeVar","data":{"varName":"GlassCardTitle"},"fix":{"range":[226,242],"text":""},"desc":"Remove unused variable 'GlassCardTitle'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'GlassCardTitle' is defined but never used.","line":4,"column":56,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":70},{"ruleId":"no-unused-vars","severity":1,"message":"'validation' is assigned a value but never used.","line":117,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":117,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"validation"},"fix":{"range":[4387,4466],"text":""},"desc":"Remove unused variable 'validation'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'validation' is assigned a value but never used.","line":117,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":117,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useMemo, useCallback } from 'react';\nimport { Badge } from '@/components/ui/badge';\nimport { AlertTriangle, CheckCircle, Info, Shield } from 'lucide-react';\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from '@/components/ui/GlassCard';\n\ninterface DataSourceValidatorProps {\n  dataSource: string;\n  aqi: number;\n  location: string;\n  timestamp: string;\n  stationName?: string;\n  distance?: string;\n  stationUid?: string | number;\n  country?: string;\n  userLocation?: string; // Add user location to detect fallback usage\n}\n\nexport default function DataSourceValidator({ \n  dataSource, \n  aqi, \n  location, \n  timestamp,\n  stationName,\n  distance,\n  stationUid,\n  country,\n  userLocation\n}: DataSourceValidatorProps) {\n  // Memoize validation results to prevent unnecessary recalculations\n  const validationResults = useMemo(() => {\n    // Validate data source legitimacy - recognize AQICN as legitimate\n    const isLegitimateSource = dataSource && \n      (dataSource === 'AQICN' ||\n       dataSource === 'OpenWeatherMap API' || \n       dataSource === 'Integrated Weather System' || \n       dataSource === 'Manual Fetch' ||\n       dataSource === 'Server-side Collection' ||\n       dataSource === 'Global Environmental Data' ||\n       dataSource === 'Legacy API' ||\n       // Only reject actual mock/test data sources\n       !(dataSource.toLowerCase().includes('mock') ||\n         dataSource.toLowerCase().includes('test') ||\n         dataSource.toLowerCase().includes('placeholder') ||\n         dataSource.toLowerCase().includes('demo') ||\n         dataSource.toLowerCase().includes('fake')));\n    \n    // Check for suspicious AQI values - only flag truly invalid values\n    // AQI 0 is valid for legitimate sources (can indicate very low pollution or no data available)\n    const isSuspiciousAQI = aqi < 0 || aqi > 500 || (aqi === 0 && !isLegitimateSource);\n    \n    // Detect if using fallback sensor (location doesn't match user location)\n    const isUsingFallback = userLocation && location && \n      !location.toLowerCase().includes(userLocation.toLowerCase()) &&\n      !userLocation.toLowerCase().includes(location.toLowerCase());\n    \n    return { isLegitimateSource, isSuspiciousAQI, isUsingFallback };\n  }, [dataSource, aqi, userLocation, location]);\n\n  // Only log when data actually changes (using a stable reference)\n  const logData = useCallback(() => {\n    console.log('🔍 [DataSourceValidator] Validating data:', {\n      dataSource,\n      aqi,\n      location,\n      timestamp,\n      stationName,\n      distance,\n      stationUid,\n      country\n    });\n    \n    // Enhanced logging for AQICN data with station details\n    if (dataSource === 'AQICN' && stationName && distance && stationUid) {\n      console.log(`✅ [DataSourceValidator] dataSource: 'AQICN' - Station: ${stationName}, AQI: ${aqi}, Distance: ${distance}km, uid: ${stationUid}`);\n    } else {\n      console.log('🔍 [DataSourceValidator] Validation result:', {\n        dataSource,\n        isLegitimateSource: validationResults.isLegitimateSource,\n        isSuspiciousAQI: validationResults.isSuspiciousAQI\n      });\n    }\n  }, [dataSource, aqi, location, timestamp, stationName, distance, stationUid, country, validationResults.isLegitimateSource, validationResults.isSuspiciousAQI]);\n\n  // Log data on mount and when it changes\n  React.useEffect(() => {\n    logData();\n  }, [logData]);\n\n  // Determine validation status\n  const getValidationStatus = useCallback(() => {\n    if (!validationResults.isLegitimateSource) {\n      return {\n        status: 'contaminated' as const,\n        icon: <AlertTriangle className=\"h-4 w-4 text-red-500\" />,\n        color: 'bg-red-100 text-red-800 border-red-200',\n        message: 'Data source may be contaminated'\n      };\n    }\n    \n    if (validationResults.isSuspiciousAQI) {\n      return {\n        status: 'suspicious' as const,\n        icon: <AlertTriangle className=\"h-4 w-4 text-yellow-500\" />,\n        color: 'bg-yellow-100 text-yellow-800 border-yellow-200',\n        message: 'AQI value may be inaccurate'\n      };\n    }\n    \n    return {\n      status: 'valid' as const,\n      icon: <CheckCircle className=\"h-4 w-4 text-green-500\" />,\n      color: 'bg-green-100 text-green-800 border-green-200',\n      message: 'Data source verified'\n    };\n  }, [validationResults.isLegitimateSource, validationResults.isSuspiciousAQI]);\n\n  const validation = useMemo(() => getValidationStatus(), [getValidationStatus]);\n\n  return (\n    <div className=\"p-6 bg-white/10 backdrop-blur-lg border border-white/20 rounded-xl shadow-lg mb-4\">\n      <div className=\"flex items-center space-x-2 mb-4\">\n        <CheckCircle className=\"w-5 h-5 text-green-400\" />\n        <h3 className=\"text-lg font-semibold text-white\">Data Source Validation</h3>\n      </div>\n      <div className=\"grid grid-cols-2 gap-4 mb-4\">\n        <div>\n          <span className=\"text-gray-300\">Data Source:</span>\n          <div className=\"mt-1 px-3 py-1 bg-green-500/20 border border-green-400/30 rounded-full text-sm text-green-300 inline-block\">\n            {dataSource || 'AQICN'}\n          </div>\n        </div>\n        <div>\n          <span className=\"text-gray-300\">Validation:</span>\n          <div className=\"mt-1 px-3 py-1 bg-green-500/20 border border-green-400/30 rounded-full text-sm text-green-300 inline-block\">\n            Verified\n          </div>\n        </div>\n        <div>\n          <span className=\"text-gray-300\">AQI Value:</span>\n          <span className=\"ml-2 text-white font-medium\">{aqi || 'N/A'}</span>\n        </div>\n        <div>\n          <span className=\"text-gray-300\">Location:</span>\n          <span className=\"ml-2 text-white font-medium\">{location || 'Unknown'}</span>\n        </div>\n      </div>\n      \n      <div className=\"text-sm text-gray-300 mb-3\">\n        <span className=\"text-gray-400\">Last Updated:</span>\n        <span className=\"ml-2\">{new Date(timestamp).toLocaleDateString()} {new Date(timestamp).toLocaleTimeString()}</span>\n      </div>\n\n      {/* Fallback Detection */}\n      {validationResults.isUsingFallback ? (\n        <div className=\"p-3 bg-blue-900/30 border border-blue-500/30 rounded-lg mb-4\">\n          <div className=\"flex items-start space-x-2\">\n            <Info className=\"w-4 h-4 text-blue-400 mt-0.5\" />\n            <div className=\"text-sm\">\n              <p className=\"text-blue-300 font-medium\">Using nearest available sensor</p>\n              <p className=\"text-blue-200/80\">\n                Local air quality data for {userLocation} not available. \n                Using data from {location} as the closest monitoring station.\n              </p>\n            </div>\n          </div>\n        </div>\n      ) : (\n        <div className=\"p-3 bg-green-900/30 border border-green-500/30 rounded-lg mb-4\">\n          <div className=\"flex items-start space-x-2\">\n            <CheckCircle className=\"w-4 h-4 text-green-400 mt-0.5\" />\n            <div className=\"text-sm\">\n              <p className=\"text-green-300 font-medium\">Local sensor data available</p>\n              <p className=\"text-green-200/80\">\n                Air quality data is from a monitoring station in your area.\n              </p>\n            </div>\n          </div>\n        </div>\n      )}\n      \n      {/* Station Information for AQICN */}\n      {dataSource === 'AQICN' && stationName && (\n        <div className=\"p-3 bg-gray-900/30 border border-gray-500/30 rounded-lg mb-4\">\n          <div className=\"text-sm\">\n            <div className=\"flex items-center justify-between mb-2\">\n              <span className=\"text-gray-300\">Station:</span>\n              <span className=\"text-white font-medium\">{stationName}</span>\n            </div>\n            {distance && (\n              <div className=\"flex items-center justify-between mb-2\">\n                <span className=\"text-gray-300\">Distance:</span>\n                <span className=\"text-white font-medium\">{distance}</span>\n              </div>\n            )}\n            {country && (\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-gray-300\">Country:</span>\n                <span className=\"text-white font-medium\">{country}</span>\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n      \n      <div className=\"p-3 bg-green-900/20 border border-green-500/20 rounded-lg\">\n        <div className=\"flex items-center space-x-2\">\n          <Shield className=\"w-4 h-4 text-green-400\" />\n          <span className=\"text-sm font-medium text-green-300\">High Quality Data</span>\n        </div>\n        <p className=\"text-sm text-green-200/80 mt-1\">\n          This air quality reading comes from verified AQICN monitoring station sources and has been validated for accuracy.\n        </p>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\DeveloperTools.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'WifiOff' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":10,"suggestions":[{"messageId":"removeVar","data":{"varName":"WifiOff"},"fix":{"range":[337,349],"text":""},"desc":"Remove unused variable 'WifiOff'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WifiOff' is defined but never used.","line":9,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":10}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { GlassCard, GlassCardContent, GlassCardDescription, GlassCardHeader, GlassCardTitle } from '@/components/ui/GlassCard';\nimport { Badge } from '@/components/ui/badge';\nimport { Separator } from '@/components/ui/separator';\nimport { \n  Bug, \n  Wifi, \n  WifiOff, \n  RefreshCw, \n  Download, \n  Trash2,\n  AlertCircle,\n  CheckCircle,\n  XCircle\n} from 'lucide-react';\nimport { \n  runWebSocketDiagnostics, \n  generateWebSocketReport, \n  getWebSocketDiagnosticHistory,\n  webSocketDiagnostics,\n  type WebSocketDiagnosticResult \n} from '@/lib/websocketDiagnostics';\nimport { diagnoseConnection } from '@/integrations/supabase/client';\n\ninterface DeveloperToolsProps {\n  isVisible?: boolean;\n  onToggle?: () => void;\n}\n\nexport function DeveloperTools({ isVisible = false, onToggle }: DeveloperToolsProps) {\n  const [isRunning, setIsRunning] = useState(false);\n  const [lastResult, setLastResult] = useState<WebSocketDiagnosticResult | null>(null);\n  const [diagnosticHistory, setDiagnosticHistory] = useState<WebSocketDiagnosticResult[]>([]);\n  const [showHistory, setShowHistory] = useState(false);\n\n  // Run diagnostics\n  const handleRunDiagnostics = async () => {\n    setIsRunning(true);\n    try {\n      const result = await runWebSocketDiagnostics();\n      setLastResult(result);\n      setDiagnosticHistory(getWebSocketDiagnosticHistory());\n      \n      // Show success/error notification\n      if (result.connectionQuality === 'excellent' || result.connectionQuality === 'good') {\n        console.log('✅ [DeveloperTools] Diagnostics completed successfully');\n      } else {\n        console.warn('⚠️ [DeveloperTools] Diagnostics completed with issues');\n      }\n    } catch (error) {\n      console.error('❌ [DeveloperTools] Diagnostics failed:', error);\n    } finally {\n      setIsRunning(false);\n    }\n  };\n\n  // Generate report\n  const handleGenerateReport = async () => {\n    try {\n      const report = await generateWebSocketReport();\n      \n      // Create and download report file\n      const blob = new Blob([report], { type: 'text/plain' });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `websocket-diagnostics-${new Date().toISOString().split('T')[0]}.txt`;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      URL.revokeObjectURL(url);\n      \n      console.log('✅ [DeveloperTools] Report downloaded successfully');\n    } catch (error) {\n      console.error('❌ [DeveloperTools] Failed to generate report:', error);\n    }\n  };\n\n  // Clear history\n  const handleClearHistory = () => {\n    webSocketDiagnostics.clearDiagnosticHistory();\n    setDiagnosticHistory([]);\n    setLastResult(null);\n    console.log('🗑️ [DeveloperTools] Diagnostic history cleared');\n  };\n\n  // Run basic connection test\n  const handleBasicTest = () => {\n    console.log('🔍 [DeveloperTools] Running basic connection test...');\n    diagnoseConnection();\n  };\n\n  // Get status icon\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'success':\n        return <CheckCircle className=\"h-4 w-4 text-green-500\" />;\n      case 'failed':\n        return <XCircle className=\"h-4 w-4 text-red-500\" />;\n      default:\n        return <AlertCircle className=\"h-4 w-4 text-yellow-500\" />;\n    }\n  };\n\n  // Get quality badge color\n  const getQualityBadgeVariant = (quality: string) => {\n    switch (quality) {\n      case 'excellent':\n        return 'default';\n      case 'good':\n        return 'secondary';\n      case 'poor':\n        return 'destructive';\n      case 'disconnected':\n        return 'destructive';\n      default:\n        return 'outline';\n    }\n  };\n\n  if (!isVisible) return null;\n\n  return (\n    <div className=\"fixed bottom-4 right-4 z-50 w-96 max-h-[80vh] overflow-y-auto\">\n      <GlassCard className=\"shadow-lg border-2\">\n        <GlassCardHeader className=\"pb-3\">\n          <GlassCardTitle className=\"flex items-center space-x-2 text-lg\">\n            <Bug className=\"h-5 w-5\" />\n            <span>Developer Tools</span>\n          </GlassCardTitle>\n          <GlassCardDescription>\n            WebSocket connection diagnostics and troubleshooting\n          </GlassCardDescription>\n        </GlassCardHeader>\n        \n        <GlassCardContent className=\"space-y-4\">\n          {/* Action Buttons */}\n          <div className=\"flex flex-wrap gap-2\">\n            <Button\n              onClick={handleRunDiagnostics}\n              disabled={isRunning}\n              className=\"flex-1\"\n              variant=\"default\"\n            >\n              {isRunning ? (\n                <RefreshCw className=\"h-4 w-4 animate-spin mr-2\" />\n              ) : (\n                <Wifi className=\"h-4 w-4 mr-2\" />\n              )}\n              {isRunning ? 'Running...' : 'Run Diagnostics'}\n            </Button>\n            \n            <Button\n              onClick={handleBasicTest}\n              variant=\"outline\"\n              size=\"sm\"\n            >\n              <Wifi className=\"h-4 w-4 mr-2\" />\n              Basic Test\n            </Button>\n          </div>\n\n          <div className=\"flex gap-2\">\n            <Button\n              onClick={handleGenerateReport}\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"flex-1\"\n            >\n              <Download className=\"h-4 w-4 mr-2\" />\n              Download Report\n            </Button>\n            \n            <Button\n              onClick={handleClearHistory}\n              variant=\"outline\"\n              size=\"sm\"\n            >\n              <Trash2 className=\"h-4 w-4 mr-2\" />\n              Clear\n            </Button>\n          </div>\n\n          {/* Last Result */}\n          {lastResult && (\n            <div className=\"space-y-3\">\n              <Separator />\n              <div className=\"space-y-2\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-sm font-medium\">Last Diagnostic Result</span>\n                  <Badge variant={getQualityBadgeVariant(lastResult.connectionQuality)}>\n                    {lastResult.connectionQuality}\n                  </Badge>\n                </div>\n                \n                <div className=\"text-xs space-y-1\">\n                  <div className=\"flex items-center space-x-2\">\n                    <span>Environment:</span>\n                    <Badge variant=\"outline\">{lastResult.environment}</Badge>\n                  </div>\n                  \n                  <div className=\"flex items-center space-x-2\">\n                    <span>REST API:</span>\n                    {getStatusIcon(lastResult.restApiStatus)}\n                    <span className={lastResult.restApiStatus === 'success' ? 'text-green-600' : 'text-red-600'}>\n                      {lastResult.restApiStatus}\n                    </span>\n                  </div>\n                  \n                  <div className=\"flex items-center space-x-2\">\n                    <span>WebSocket:</span>\n                    {getStatusIcon(lastResult.websocketStatus)}\n                    <span className={lastResult.websocketStatus === 'success' ? 'text-green-600' : 'text-red-600'}>\n                      {lastResult.websocketStatus}\n                    </span>\n                  </div>\n                  \n                  <div className=\"flex items-center space-x-2\">\n                    <span>Realtime:</span>\n                    <Badge variant=\"outline\">{lastResult.realtimeStatus}</Badge>\n                  </div>\n                </div>\n\n                {/* Recommendations */}\n                {lastResult.recommendations.length > 0 && (\n                  <div className=\"mt-3\">\n                    <span className=\"text-xs font-medium text-muted-foreground\">Recommendations:</span>\n                    <ul className=\"text-xs text-muted-foreground mt-1 space-y-1\">\n                      {lastResult.recommendations.slice(0, 3).map((rec, index) => (\n                        <li key={index} className=\"flex items-start space-x-2\">\n                          <span className=\"text-yellow-500 mt-1\">•</span>\n                          <span>{rec}</span>\n                        </li>\n                      ))}\n                      {lastResult.recommendations.length > 3 && (\n                        <li className=\"text-xs text-muted-foreground\">\n                          +{lastResult.recommendations.length - 3} more recommendations\n                        </li>\n                      )}\n                    </ul>\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n\n          {/* History Toggle */}\n          {diagnosticHistory.length > 0 && (\n            <div>\n              <Button\n                onClick={() => setShowHistory(!showHistory)}\n                variant=\"ghost\"\n                size=\"sm\"\n                className=\"w-full\"\n              >\n                {showHistory ? 'Hide' : 'Show'} History ({diagnosticHistory.length})\n              </Button>\n              \n              {showHistory && (\n                <div className=\"mt-3 space-y-2 max-h-40 overflow-y-auto\">\n                  {diagnosticHistory.slice(-5).reverse().map((result, index) => (\n                    <div key={index} className=\"text-xs p-2 bg-muted rounded border\">\n                      <div className=\"flex items-center justify-between mb-1\">\n                        <span className=\"font-medium\">\n                          {new Date(result.timestamp).toLocaleTimeString()}\n                        </span>\n                        <Badge variant={getQualityBadgeVariant(result.connectionQuality)} size=\"sm\">\n                          {result.connectionQuality}\n                        </Badge>\n                      </div>\n                      <div className=\"text-muted-foreground\">\n                        {result.environment} • {result.restApiStatus} • {result.websocketStatus}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Close Button */}\n          {onToggle && (\n            <Button\n              onClick={onToggle}\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"w-full\"\n            >\n              Close Tools\n            </Button>\n          )}\n        </GlassCardContent>\n      </GlassCard>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\EmissionSourcesLayer.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Wind' is defined but never used.","line":5,"column":84,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":88,"suggestions":[{"messageId":"removeVar","data":{"varName":"Wind"},"fix":{"range":[328,334],"text":""},"desc":"Remove unused variable 'Wind'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Wind' is defined but never used.","line":5,"column":84,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":88},{"ruleId":"no-unused-vars","severity":1,"message":"'Thermometer' is defined but never used.","line":5,"column":90,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":101,"suggestions":[{"messageId":"removeVar","data":{"varName":"Thermometer"},"fix":{"range":[334,347],"text":""},"desc":"Remove unused variable 'Thermometer'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Thermometer' is defined but never used.","line":5,"column":90,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":101},{"ruleId":"no-unused-vars","severity":1,"message":"'Droplets' is defined but never used.","line":5,"column":103,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":111,"suggestions":[{"messageId":"removeVar","data":{"varName":"Droplets"},"fix":{"range":[347,357],"text":""},"desc":"Remove unused variable 'Droplets'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Droplets' is defined but never used.","line":5,"column":103,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":111},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'processOpenWeatherMapData' was used before it was defined.","line":66,"column":27,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":66,"endColumn":52},{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":83,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":83,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":83,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":83,"endColumn":19},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchEmissionData'. Either include it or remove the dependency array.","line":169,"column":6,"nodeType":"ArrayExpression","endLine":169,"endColumn":27,"suggestions":[{"desc":"Update the dependencies array to be: [fetchEmissionData, latitude, longitude]","fix":{"range":[5617,5638],"text":"[fetchEmissionData, latitude, longitude]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from \"@/components/ui/GlassCard\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Cloud, MapPin, AlertTriangle, RefreshCw, Info, Shield, TrendingUp, Globe, Wind, Thermometer, Droplets } from \"lucide-react\";\nimport { useToast } from \"@/components/ui/use-toast\";\nimport {\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselNext,\n  CarouselPrevious,\n} from \"@/components/ui/carousel\";\n\ninterface EmissionSource {\n  id: string;\n  name: string;\n  type: string;\n  latitude: number;\n  longitude: number;\n  emissions: {\n    pm25?: number;\n    pm10?: number;\n    no2?: number;\n    so2?: number;\n    co?: number;\n    o3?: number;\n  };\n  lastUpdated: string;\n  distance: number;\n}\n\ninterface EmissionSourcesLayerProps {\n  latitude: number;\n  longitude: number;\n}\n\nexport default function EmissionSourcesLayer({ latitude, longitude }: EmissionSourcesLayerProps): JSX.Element {\n  const [emissionSources, setEmissionSources] = useState<EmissionSource[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [lastUpdated, setLastUpdated] = useState<string | null>(null);\n  const [showDetails, setShowDetails] = useState(false);\n  const { toast } = useToast();\n\n  const fetchEmissionData = async (): Promise<void> => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      // Use OpenWeatherMap Air Pollution API instead of OpenAQ\n      const apiKey = import.meta.env.VITE_OPENWEATHERMAP_API_KEY;\n      if (!apiKey) {\n        throw new Error('OpenWeatherMap API key not configured');\n      }\n      \n      const response = await fetch(\n        `https://api.openweathermap.org/data/2.5/air_pollution?lat=${latitude}&lon=${longitude}&appid=${apiKey}`\n      );\n\n      if (response.ok) {\n        const data = await response.json();\n        \n        if (data.list && data.list.length > 0) {\n          // Process OpenWeatherMap air pollution data\n          const sources = processOpenWeatherMapData(data.list[0], latitude, longitude);\n          setEmissionSources(sources);\n          setLastUpdated(new Date().toISOString());\n          \n          toast({\n            title: \"Air Quality Data Updated\",\n            description: `Updated air quality information for your area`,\n          });\n        } else {\n          // No data available\n          setEmissionSources([]);\n          setLastUpdated(new Date().toISOString());\n          setError(\"No air quality data available for this area\");\n        }\n      } else {\n        throw new Error(`OpenWeatherMap API request failed: ${response.status}`);\n      }\n    } catch (error) {\n      // API failed - show informational content instead of error\n      setEmissionSources([]);\n      setError(\"Air quality data temporarily unavailable\");\n      setLastUpdated(new Date().toISOString());\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const processOpenWeatherMapData = (airQualityData: any, userLat: number, userLon: number): EmissionSource[] => {\n    // Create a virtual emission source based on OpenWeatherMap data\n    // This represents the air quality in the user's area\n    const source: EmissionSource = {\n      id: 'local-air-quality',\n      name: 'Local Air Quality Station',\n      type: 'OpenWeatherMap Monitoring',\n      latitude: userLat,\n      longitude: userLon,\n      emissions: {\n        pm25: airQualityData.components.pm2_5,\n        pm10: airQualityData.components.pm10,\n        no2: airQualityData.components.no2,\n        so2: airQualityData.components.so2,\n        co: airQualityData.components.co,\n        o3: airQualityData.components.o3\n      },\n      lastUpdated: new Date().toISOString(),\n      distance: 0\n    };\n\n    return [source];\n  };\n\n  const getEmissionLevel = (value: number, parameter: string): { level: string; color: string } => {\n    let level = 'Low';\n    let color = 'bg-green-500';\n    \n    switch (parameter) {\n      case 'pm25':\n        if (value > 35) { level = 'High'; color = 'bg-red-500'; }\n        else if (value > 12) { level = 'Moderate'; color = 'bg-yellow-500'; }\n        break;\n      case 'pm10':\n        if (value > 150) { level = 'High'; color = 'bg-red-500'; }\n        else if (value > 55) { level = 'Moderate'; color = 'bg-yellow-500'; }\n        break;\n      case 'no2':\n        if (value > 200) { level = 'High'; color = 'bg-red-500'; }\n        else if (value > 100) { level = 'Moderate'; color = 'bg-yellow-500'; }\n        break;\n      case 'so2':\n        if (value > 500) { level = 'High'; color = 'bg-red-500'; }\n        else if (value > 150) { level = 'Moderate'; color = 'bg-yellow-500'; }\n        break;\n      case 'co':\n        if (value > 9000) { level = 'High'; color = 'bg-red-500'; }\n        else if (value > 4000) { level = 'Moderate'; color = 'bg-yellow-500'; }\n        break;\n      case 'o3':\n        if (value > 150) { level = 'High'; color = 'bg-red-500'; }\n        else if (value > 100) { level = 'Moderate'; color = 'bg-yellow-500'; }\n        break;\n    }\n    \n    return { level, color };\n  };\n\n  const getParameterUnit = (parameter: string): string => {\n    const units: { [key: string]: string } = {\n      pm25: 'µg/m³',\n      pm10: 'µg/m³',\n      no2: 'ppb',\n      so2: 'ppb',\n      co: 'ppb',\n      o3: 'ppb'\n    };\n    return units[parameter] || '';\n  };\n\n  useEffect(() => {\n    fetchEmissionData();\n    \n    // Refresh every 30 minutes\n    const interval = setInterval(fetchEmissionData, 30 * 60 * 1000);\n    return () => clearInterval(interval);\n  }, [latitude, longitude]);\n\n  // Show informational content when no emission data is available\n  if (emissionSources.length === 0 && !loading) {\n    return (\n      <GlassCard className=\"floating-card mt-4\">\n        <GlassCardHeader>\n          <GlassCardTitle className=\"flex items-center gap-2\">\n            <Cloud className=\"h-5 w-5\" />\n            Air Quality Monitoring\n            <Badge variant=\"secondary\">OpenWeatherMap</Badge>\n          </GlassCardTitle>\n        </GlassCardHeader>\n        <GlassCardContent>\n          <div className=\"space-y-6\">\n            {/* Informational Carousel */}\n            <div className=\"relative\">\n              <Carousel\n                opts={{\n                  align: \"start\",\n                  loop: true,\n                }}\n                className=\"w-full\"\n              >\n                <CarouselContent className=\"-ml-2 md:-ml-4\">\n                  <CarouselItem className=\"pl-2 md:pl-4 basis-full sm:basis-1/2 lg:basis-1/3\">\n                    <div className=\"p-6 floating-card rounded-lg border h-full\">\n                      <div className=\"text-center space-y-3\">\n                        <Shield className=\"h-12 w-12 text-blue-600 mx-auto\" />\n                        <h4 className=\"font-semibold text-lg\">Real-Time Air Quality</h4>\n                        <p className=\"text-sm text-muted-foreground\">\n                          Get accurate air quality data from OpenWeatherMap's global monitoring network.\n                        </p>\n                      </div>\n                    </div>\n                  </CarouselItem>\n                  \n                  <CarouselItem className=\"pl-2 md:pl-4 basis-full sm:basis-1/2 lg:basis-1/3\">\n                    <div className=\"p-6 floating-card rounded-lg border h-full\">\n                      <div className=\"text-center space-y-3\">\n                        <TrendingUp className=\"h-12 w-12 text-green-600 mx-auto\" />\n                        <h4 className=\"font-semibold text-lg\">Comprehensive Monitoring</h4>\n                        <p className=\"text-sm text-muted-foreground\">\n                          Track PM2.5, PM10, NO2, SO2, CO, and O3 levels with precision.\n                        </p>\n                      </div>\n                    </div>\n                  </CarouselItem>\n                  \n                  <CarouselItem className=\"pl-2 md:pl-4 basis-full sm:basis-1/2 lg:basis-1/3\">\n                    <div className=\"p-6 floating-card rounded-lg border h-full\">\n                      <div className=\"text-center space-y-3\">\n                        <Globe className=\"h-12 w-12 text-purple-600 mx-auto\" />\n                        <h4 className=\"font-semibold text-lg\">Global Coverage</h4>\n                        <p className=\"text-sm text-muted-foreground\">\n                          Access air quality data from OpenWeatherMap's worldwide network.\n                        </p>\n                      </div>\n                    </div>\n                  </CarouselItem>\n                </CarouselContent>\n                <CarouselPrevious />\n                <CarouselNext />\n              </Carousel>\n            </div>\n\n            {/* Status Information */}\n            <div className=\"text-center space-y-4\">\n              {error && (\n                <div className=\"p-4 bg-muted/50 rounded-lg border\">\n                  <AlertTriangle className=\"h-8 w-8 text-amber-500 mx-auto mb-2\" />\n                  <p className=\"text-sm text-muted-foreground\">{error}</p>\n                  <Button \n                    onClick={fetchEmissionData} \n                    variant=\"outline\" \n                    size=\"sm\" \n                    className=\"mt-3\"\n                  >\n                    <RefreshCw className=\"h-4 w-4 mr-2\" />\n                    Try Again\n                  </Button>\n                </div>\n              )}\n              \n              <div className=\"text-xs text-muted-foreground\">\n                <p>Air quality data powered by OpenWeatherMap</p>\n                <p className=\"mt-1\">Real-time monitoring with 30-minute refresh intervals</p>\n              </div>\n            </div>\n\n            {/* Action Buttons */}\n            <div className=\"flex justify-center gap-3\">\n              <Button variant=\"outline\" size=\"sm\">\n                <Info className=\"h-4 w-4 mr-2\" />\n                Learn More\n              </Button>\n              <Button variant=\"outline\" size=\"sm\">\n                <RefreshCw className=\"h-4 w-4 mr-2\" />\n                Check Later\n              </Button>\n            </div>\n          </div>\n        </GlassCardContent>\n      </GlassCard>\n    );\n  }\n\n  if (loading && emissionSources.length === 0) {\n    return (\n      <GlassCard className=\"floating-card mt-4\">\n        <GlassCardHeader>\n          <GlassCardTitle className=\"flex items-center gap-2\">\n            <Cloud className=\"h-5 w-5\" />\n            Air Quality Monitoring\n          </GlassCardTitle>\n        </GlassCardHeader>\n        <GlassCardContent>\n          <div className=\"flex items-center justify-center py-8\">\n            <div className=\"text-center space-y-2\">\n              <RefreshCw className=\"h-8 w-8 animate-spin text-primary mx-auto\" />\n              <p className=\"text-muted-foreground\">Loading air quality data...</p>\n          </div>\n          </div>\n        </GlassCardContent>\n      </GlassCard>\n    );\n  }\n\n  return (\n    <GlassCard className=\"floating-card mt-4\">\n      <GlassCardHeader>\n        <div className=\"flex items-center justify-between\">\n          <GlassCardTitle className=\"flex items-center gap-2\">\n            <Cloud className=\"h-5 w-5\" />\n            Air Quality Monitoring\n            <Badge variant=\"secondary\">OpenWeatherMap</Badge>\n          </GlassCardTitle>\n          <div className=\"flex items-center gap-2\">\n            <Button\n              variant={showDetails ? \"default\" : \"outline\"}\n              size=\"sm\"\n              onClick={() => setShowDetails(!showDetails)}\n            >\n              <Info className=\"h-4 w-4 mr-2\" />\n              {showDetails ? 'Hide' : 'Show'} Details\n            </Button>\n            <Button onClick={fetchEmissionData} size=\"sm\" variant=\"outline\">\n              <RefreshCw className=\"h-4 w-4 mr-2\" />\n              Refresh\n            </Button>\n          </div>\n        </div>\n      </GlassCardHeader>\n      <GlassCardContent>\n        {emissionSources.length > 0 && (\n          <div className=\"space-y-6\">\n            {/* Air Quality Data Carousel */}\n            <div className=\"relative\">\n              <Carousel\n                opts={{\n                  align: \"start\",\n                  loop: false,\n                }}\n                className=\"w-full\"\n              >\n                <CarouselContent className=\"-ml-2 md:-ml-4\">\n                  {emissionSources.map((source) => (\n                    <CarouselItem key={source.id} className=\"pl-2 md:pl-4 basis-full sm:basis-1/2 lg:basis-1/3 xl:basis-1/4\">\n                      <div className=\"p-4 bg-muted/30 rounded-lg border h-full\">\n                        {/* Source Header */}\n                        <div className=\"flex items-start justify-between mb-3\">\n                          <div className=\"flex-1\">\n                            <h4 className=\"font-medium text-sm\">{source.name}</h4>\n                            <p className=\"text-xs text-muted-foreground\">{source.type}</p>\n                            <div className=\"flex items-center gap-1 mt-1\">\n                              <MapPin className=\"h-3 w-3 text-muted-foreground\" />\n                              <span className=\"text-xs text-muted-foreground\">\n                                Your location\n                              </span>\n                            </div>\n                          </div>\n                          <Badge variant=\"outline\" className=\"text-xs\">\n                            {new Date(source.lastUpdated).toLocaleDateString()}\n                          </Badge>\n                        </div>\n\n                        {/* Air Quality Summary */}\n                        <div className=\"space-y-2\">\n                          {Object.entries(source.emissions).map(([parameter, value]) => {\n                            const { level, color } = getEmissionLevel(value, parameter);\n                            return (\n                              <div key={parameter} className=\"flex items-center justify-between\">\n                                <span className=\"text-xs font-medium uppercase\">{parameter}</span>\n                                <div className=\"flex items-center gap-2\">\n                                  <span className=\"text-sm\">{value.toFixed(1)} {getParameterUnit(parameter)}</span>\n                                  <div className={`w-2 h-2 rounded-full ${color}`}></div>\n                                  <span className=\"text-xs text-muted-foreground\">{level}</span>\n                                </div>\n                              </div>\n                            );\n                          })}\n                        </div>\n\n                        {/* Detailed View */}\n                        {showDetails && (\n                          <div className=\"mt-3 pt-3 border-t border-border\">\n                            <div className=\"text-xs text-muted-foreground\">\n                              <div>Coordinates: {source.latitude.toFixed(4)}, {source.longitude.toFixed(4)}</div>\n                              <div>Last Updated: {new Date(source.lastUpdated).toLocaleString()}</div>\n                              <div>Data Source: OpenWeatherMap Air Pollution API</div>\n                            </div>\n                          </div>\n                        )}\n                      </div>\n                    </CarouselItem>\n                  ))}\n                </CarouselContent>\n                <CarouselPrevious />\n                <CarouselNext />\n              </Carousel>\n            </div>\n\n            {/* Summary Stats */}\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mt-6\">\n              <div className=\"p-3 bg-muted/30 rounded-lg text-center\">\n                <div className=\"text-2xl font-bold text-primary\">{emissionSources.length}</div>\n                <div className=\"text-xs text-muted-foreground\">Monitoring Points</div>\n              </div>\n              <div className=\"p-3 bg-muted/30 rounded-lg text-center\">\n                <div className=\"text-2xl font-bold text-green-600\">\n                  {emissionSources.filter(s => \n                    Object.values(s.emissions).every(val => val <= 50)\n                  ).length}\n                </div>\n                <div className=\"text-xs text-muted-foreground\">Good Quality</div>\n              </div>\n              <div className=\"p-3 bg-muted/30 rounded-lg text-center\">\n                <div className=\"text-2xl font-bold text-yellow-600\">\n                  {emissionSources.filter(s => \n                    Object.values(s.emissions).some(val => val > 50 && val <= 100)\n                  ).length}\n                </div>\n                <div className=\"text-xs text-muted-foreground\">Moderate</div>\n              </div>\n              <div className=\"p-3 bg-muted/30 rounded-lg text-center\">\n                <div className=\"text-2xl font-bold text-blue-600\">\n                  {emissionSources.filter(s => s.type === 'OpenWeatherMap Monitoring').length}\n                </div>\n                <div className=\"text-xs text-muted-foreground\">Data Sources</div>\n              </div>\n            </div>\n\n            {/* Last Updated */}\n            {lastUpdated && (\n              <div className=\"text-center text-xs text-muted-foreground pt-4\">\n                Last updated: {new Date(lastUpdated).toLocaleString()}\n              </div>\n            )}\n          </div>\n        )}\n      </GlassCardContent>\n    </GlassCard>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\EnhancedErrorBoundary.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":9,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[264,277],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'errorInfo' is defined but never used.","line":9,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":54,"suggestions":[{"messageId":"removeVar","data":{"varName":"errorInfo"},"fix":{"range":[276,304],"text":""},"desc":"Remove unused variable 'errorInfo'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":22,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[597,610],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'errorInfo' is defined but never used.","line":22,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":53,"suggestions":[{"messageId":"removeVar","data":{"varName":"errorInfo"},"fix":{"range":[609,637],"text":""},"desc":"Remove unused variable 'errorInfo'."}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":393,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":393,"endColumn":34},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":408,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":408,"endColumn":33}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { ReactNode, useCallback, useEffect, useRef, useState } from 'react';\nimport { logConnection } from '@/lib/logger';\n\nconst MAX_RECOVERY_ATTEMPTS = 3;\n\ninterface EnhancedErrorBoundaryProps {\n  children: ReactNode;\n  fallback?: ReactNode;\n  onError?: (error: Error, errorInfo: React.ErrorInfo) => void;\n  retryCount?: number;\n  maxRetries?: number;\n}\n\ninterface EnhancedErrorBoundaryState {\n  hasError: boolean;\n  error: Error | null;\n  errorInfo: React.ErrorInfo | null;\n  retryCount: number;\n  isRecovering: boolean;\n}\nclass ErrorBoundaryBridge extends React.Component<{\n  onCatch: (error: Error, errorInfo: React.ErrorInfo) => void;\n  children: React.ReactNode;\n}, { hasError: boolean }> {\n  override state: { hasError: boolean } = { hasError: false };\n\n  static override getDerivedStateFromError(): { hasError: boolean } {\n    return { hasError: true };\n  }\n\n  override componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\n    this.props.onCatch(error, errorInfo);\n  }\n\n  override render() {\n    if (this.state.hasError) {\n      return null;\n    }\n\n    return this.props.children;\n  }\n}\n\nexport function EnhancedErrorBoundary({\n  children,\n  fallback,\n  onError,\n  retryCount = 0,\n  maxRetries = 3\n}: EnhancedErrorBoundaryProps) {\n  const [state, setState] = useState<EnhancedErrorBoundaryState>(\n    () => ({\n      hasError: false,\n      error: null,\n      errorInfo: null,\n      retryCount,\n      isRecovering: false\n    })\n  );\n  const [boundaryKey, setBoundaryKey] = useState(0);\n  const retryTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const recoveryAttemptsRef = useRef(0);\n  const isUnmountedRef = useRef(false);\n  const stateRef = useRef(state);\n\n  useEffect(() => {\n    stateRef.current = state;\n  }, [state]);\n\n  const clearScheduledRecovery = useCallback(() => {\n    if (retryTimeoutRef.current) {\n      clearTimeout(retryTimeoutRef.current);\n      retryTimeoutRef.current = null;\n    }\n  }, []);\n\n  useEffect(() => {\n    return () => {\n      isUnmountedRef.current = true;\n      clearScheduledRecovery();\n    };\n  }, [clearScheduledRecovery]);\n\n  const effectiveMaxRetries = maxRetries ?? 3;\n\n  const recoverFromNullReference = useCallback(async () => {\n    logConnection.info('Recovering from null reference error');\n\n    if (typeof window !== 'undefined' && (window as any).gc) {\n      try {\n        (window as any).gc();\n        logConnection.info('Garbage collection triggered');\n      } catch (error) {\n        logConnection.warn('Failed to trigger garbage collection', { error });\n      }\n    }\n\n    await new Promise(resolve => setTimeout(resolve, 1000));\n  }, []);\n\n  const recoverFromWebSocketError = useCallback(async () => {\n    logConnection.info('Recovering from WebSocket error');\n\n    try {\n      const { supabase } = await import('@/integrations/supabase/client');\n\n      if (supabase.realtime) {\n        await supabase.realtime.disconnect();\n        await new Promise(resolve => setTimeout(resolve, 2000));\n        await supabase.realtime.connect();\n\n        logConnection.info('WebSocket reconnection successful');\n      }\n    } catch (error) {\n      logConnection.warn('WebSocket reconnection failed', { error });\n    }\n  }, []);\n\n  const recoverFromSubscriptionError = useCallback(async () => {\n    logConnection.info('Recovering from subscription error');\n\n    try {\n      const { supabase } = await import('@/integrations/supabase/client');\n\n      if (supabase.realtime) {\n        const channels = supabase.realtime.getChannels();\n        for (const channel of channels) {\n          try {\n            supabase.removeChannel(channel);\n          } catch (error) {\n            logConnection.warn('Failed to remove channel during recovery', { error });\n          }\n        }\n\n        logConnection.info('Stale subscriptions cleared');\n      }\n    } catch (error) {\n      logConnection.warn('Subscription cleanup failed', { error });\n    }\n  }, []);\n\n  const recoverFromConnectionError = useCallback(async () => {\n    logConnection.info('Recovering from connection error');\n    await new Promise(resolve => setTimeout(resolve, 3000));\n  }, []);\n\n  const performGenericRecovery = useCallback(async () => {\n    logConnection.info('Performing generic error recovery');\n    await new Promise(resolve => setTimeout(resolve, 2000));\n  }, []);\n\n  const getErrorType = useCallback((errorMessage: string): string => {\n    if (errorMessage.includes('cannot read properties of null') || errorMessage.includes('cannot read properties of undefined')) {\n      return 'null_reference';\n    }\n    if (errorMessage.includes('websocket closed')) {\n      return 'websocket_connection';\n    }\n    if (errorMessage.includes('subscription error') || errorMessage.includes('channel error')) {\n      return 'subscription';\n    }\n    if (errorMessage.includes('connection failed')) {\n      return 'connection';\n    }\n    return 'unknown';\n  }, []);\n\n  const isRecoverableError = useCallback((errorMessage: string) => {\n    const recoverablePatterns = [\n      'cannot read properties of null',\n      'cannot read properties of undefined',\n      'websocket closed',\n      'connection failed',\n      'subscription error',\n      'channel error',\n      'realtime error'\n    ];\n\n    return recoverablePatterns.some(pattern => errorMessage.includes(pattern));\n  }, []);\n\n  const performRecovery = useCallback(async () => {\n    try {\n      logConnection.info('Performing error recovery');\n\n      const currentError = stateRef.current.error;\n      const errorType = currentError ? getErrorType(currentError.message.toLowerCase()) : 'unknown';\n\n      switch (errorType) {\n        case 'null_reference':\n          await recoverFromNullReference();\n          break;\n        case 'websocket_connection':\n          await recoverFromWebSocketError();\n          break;\n        case 'subscription':\n          await recoverFromSubscriptionError();\n          break;\n        case 'connection':\n          await recoverFromConnectionError();\n          break;\n        default:\n          await performGenericRecovery();\n      }\n\n      setState(prev => ({\n        ...prev,\n        hasError: false,\n        error: null,\n        errorInfo: null,\n        isRecovering: false\n      }));\n      recoveryAttemptsRef.current = 0;\n      setBoundaryKey(key => key + 1);\n\n      logConnection.info('Error recovery completed successfully');\n    } catch (recoveryError) {\n      logConnection.error('Error recovery failed', {\n        originalError: stateRef.current.error?.message,\n        recoveryError: recoveryError instanceof Error ? recoveryError.message : recoveryError,\n        recoveryAttempt: recoveryAttemptsRef.current\n      });\n\n      setState(prev => ({ ...prev, isRecovering: false }));\n    } finally {\n      clearScheduledRecovery();\n    }\n  }, [\n    clearScheduledRecovery,\n    getErrorType,\n    recoverFromConnectionError,\n    recoverFromNullReference,\n    recoverFromSubscriptionError,\n    recoverFromWebSocketError,\n    performGenericRecovery\n  ]);\n\n  const attemptAutomaticRecovery = useCallback((error: Error) => {\n    const errorMessage = error.message.toLowerCase();\n\n    if (recoveryAttemptsRef.current >= MAX_RECOVERY_ATTEMPTS) {\n      logConnection.warn('Max recovery attempts exceeded, not attempting automatic recovery');\n      return;\n    }\n\n    if (isRecoverableError(errorMessage)) {\n      const nextAttempt = recoveryAttemptsRef.current + 1;\n      logConnection.info('Attempting automatic recovery for recoverable error', {\n        errorType: getErrorType(errorMessage),\n        recoveryAttempt: nextAttempt\n      });\n\n      setState(prev => ({ ...prev, isRecovering: true }));\n      recoveryAttemptsRef.current = nextAttempt;\n\n      const delay = Math.min(1000 * Math.pow(2, nextAttempt - 1), 10000);\n\n      clearScheduledRecovery();\n      retryTimeoutRef.current = setTimeout(() => {\n        if (!isUnmountedRef.current) {\n          performRecovery();\n        }\n      }, delay);\n    }\n  }, [\n    clearScheduledRecovery,\n    getErrorType,\n    isRecoverableError,\n    performRecovery\n  ]);\n\n  const handleErrorCapture = useCallback((error: Error, errorInfo: React.ErrorInfo) => {\n    logConnection.error('Error boundary caught error', {\n      error: error.message,\n      stack: error.stack,\n      componentStack: errorInfo.componentStack,\n      timestamp: new Date().toISOString()\n    });\n\n    setState(prev => ({\n      ...prev,\n      hasError: true,\n      error,\n      errorInfo\n    }));\n\n    onError?.(error, errorInfo);\n    attemptAutomaticRecovery(error);\n  }, [attemptAutomaticRecovery, onError]);\n\n  const handleRetry = useCallback(() => {\n    let shouldReset = false;\n\n    setState(prev => {\n      if (prev.retryCount >= effectiveMaxRetries) {\n        return prev;\n      }\n\n      shouldReset = true;\n      return {\n        hasError: false,\n        error: null,\n        errorInfo: null,\n        retryCount: prev.retryCount + 1,\n        isRecovering: false\n      };\n    });\n\n    if (shouldReset) {\n      clearScheduledRecovery();\n      recoveryAttemptsRef.current = 0;\n      setBoundaryKey(key => key + 1);\n    }\n  }, [clearScheduledRecovery, effectiveMaxRetries]);\n\n  const handleReset = useCallback(() => {\n    clearScheduledRecovery();\n    recoveryAttemptsRef.current = 0;\n    setState({\n      hasError: false,\n      error: null,\n      errorInfo: null,\n      retryCount,\n      isRecovering: false\n    });\n    setBoundaryKey(key => key + 1);\n  }, [clearScheduledRecovery, retryCount]);\n\n  if (state.hasError) {\n    if (state.isRecovering) {\n      return (\n        <div className=\"error-boundary-fallback\">\n          <div className=\"recovery-progress\">\n            <h3>🔄 Recovering from Error</h3>\n            <p>Attempting to automatically recover from the error...</p>\n            <div className=\"progress-bar\">\n              <div className=\"progress-fill\"></div>\n            </div>\n            <p className=\"recovery-attempt\">\n              Recovery attempt {recoveryAttemptsRef.current} of {MAX_RECOVERY_ATTEMPTS}\n            </p>\n          </div>\n        </div>\n      );\n    }\n\n    if (fallback) {\n      return fallback;\n    }\n\n    return (\n      <div className=\"error-boundary-fallback\">\n        <div className=\"error-content\">\n          <h3>⚠️ Something went wrong</h3>\n          <p>An error occurred in the application. We're working to fix it.</p>\n\n          {state.error && (\n            <details className=\"error-details\">\n              <summary>Error Details</summary>\n              <pre className=\"error-message\">{state.error.message}</pre>\n              {state.errorInfo && (\n                <pre className=\"error-stack\">{state.errorInfo.componentStack}</pre>\n              )}\n            </details>\n          )}\n\n          <div className=\"error-actions\">\n            <button\n              onClick={handleRetry}\n              disabled={state.retryCount >= effectiveMaxRetries}\n              className=\"retry-button\"\n            >\n              Try Again ({state.retryCount}/{effectiveMaxRetries})\n            </button>\n\n            <button onClick={handleReset} className=\"reset-button\">\n              Reset\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <ErrorBoundaryBridge key={boundaryKey} onCatch={handleErrorCapture}>\n      {children}\n    </ErrorBoundaryBridge>\n  );\n}\n\n// HOC for wrapping components with error boundary\nexport function withErrorBoundary<P extends object>(\n  Component: React.ComponentType<P>,\n  errorBoundaryProps?: Partial<EnhancedErrorBoundaryProps>\n) {\n  const WrappedComponent = (props: P) => (\n    <EnhancedErrorBoundary {...errorBoundaryProps}>\n      <Component {...props} />\n    </EnhancedErrorBoundary>\n  );\n\n  WrappedComponent.displayName = `withErrorBoundary(${Component.displayName || Component.name || 'Component'})`;\n  return WrappedComponent;\n}\n\n// Hook for using error boundary context\nexport function useErrorBoundary() {\n  return {\n    reportError: (error: Error, errorInfo?: React.ErrorInfo) => {\n      logConnection.error('Error reported via useErrorBoundary hook', {\n        error: error.message,\n        stack: error.stack,\n        componentStack: errorInfo?.componentStack\n      });\n    }\n  };\n}\n\nexport default EnhancedErrorBoundary;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ErrorBoundary.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":8,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[302,315],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'errorInfo' is defined but never used.","line":8,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":48,"suggestions":[{"messageId":"removeVar","data":{"varName":"errorInfo"},"fix":{"range":[314,336],"text":""},"desc":"Remove unused variable 'errorInfo'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":192,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":192,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":192,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":192,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":203,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":203,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":203,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":203,"endColumn":19},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":356,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":356,"endColumn":31},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":371,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":371,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { Component, ErrorInfo, ReactNode } from 'react';\r\nimport { logConnection } from '@/lib/logger';\r\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from '@/components/ui/GlassCard';\r\n\r\ninterface Props {\r\n  children: ReactNode;\r\n  fallback?: ReactNode;\r\n  onError?: (error: Error, errorInfo: ErrorInfo) => void;\r\n  resetOnPropsChange?: boolean;\r\n  showDetails?: boolean;\r\n}\r\n\r\ninterface State {\r\n  hasError: boolean;\r\n  error: Error | null;\r\n  errorInfo: ErrorInfo | null;\r\n  errorCount: number;\r\n  lastErrorTime: number;\r\n  isRecovering: boolean;\r\n}\r\n\r\nexport class ErrorBoundary extends Component<Props, State> {\r\n  constructor(props: Props) {\r\n    super(props);\r\n    this.state = {\r\n      hasError: false,\r\n      error: null,\r\n      errorInfo: null,\r\n      errorCount: 0,\r\n      lastErrorTime: 0,\r\n      isRecovering: false\r\n    };\r\n  }\r\n\r\n  static getDerivedStateFromError(error: Error): Partial<State> {\r\n    return {\r\n      hasError: true,\r\n      error,\r\n      lastErrorTime: Date.now()\r\n    };\r\n  }\r\n\r\n  componentDidCatch(error: Error, errorInfo: ErrorInfo): void {\r\n    try {\r\n      // Log error with connection context\r\n      logConnection.error('ErrorBoundary caught error:', {\r\n        error: error.message,\r\n        stack: error.stack,\r\n        componentStack: errorInfo.componentStack,\r\n        timestamp: new Date().toISOString()\r\n      });\r\n\r\n      // Update state\r\n      this.setState(prevState => ({\r\n        errorCount: prevState.errorCount + 1,\r\n        errorInfo\r\n      }));\r\n\r\n      // Call custom error handler if provided\r\n      if (this.props.onError) {\r\n        this.props.onError(error, errorInfo);\r\n      }\r\n\r\n      // Attempt automatic recovery for certain error types\r\n      this.attemptAutomaticRecovery(error);\r\n    } catch (recoveryError) {\r\n      logConnection.error('ErrorBoundary recovery failed:', recoveryError);\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps: Props): void {\r\n    // Reset error state if props changed and resetOnPropsChange is true\r\n    if (this.props.resetOnPropsChange && prevProps !== this.props) {\r\n      this.resetErrorState();\r\n    }\r\n  }\r\n\r\n  // Attempt automatic recovery based on error type\r\n  private attemptAutomaticRecovery(error: Error): void {\r\n    try {\r\n      const errorMessage = error.message.toLowerCase();\r\n      \r\n      // Check if it's a connection-related error\r\n      if (this.isConnectionError(errorMessage)) {\r\n        logConnection.info('ErrorBoundary: Connection error detected, attempting recovery...');\r\n        this.setState({ isRecovering: true });\r\n        \r\n        // Attempt recovery after a delay\r\n        setTimeout(() => {\r\n          this.attemptConnectionRecovery();\r\n        }, 2000);\r\n      } else if (this.isDatabaseError(errorMessage)) {\r\n        logConnection.info('ErrorBoundary: Database error detected, attempting recovery...');\r\n        this.setState({ isRecovering: true });\r\n        \r\n        // Attempt database recovery\r\n        setTimeout(() => {\r\n          this.attemptDatabaseRecovery();\r\n        }, 3000);\r\n      }\r\n    } catch (recoveryError) {\r\n      logConnection.error('ErrorBoundary: Automatic recovery failed:', recoveryError);\r\n    }\r\n  }\r\n\r\n  // Check if error is connection-related\r\n  private isConnectionError(errorMessage: string): boolean {\r\n    const connectionKeywords = [\r\n      'websocket',\r\n      'connection',\r\n      'network',\r\n      'timeout',\r\n      'fetch',\r\n      'axios',\r\n      'http',\r\n      'realtime'\r\n    ];\r\n    \r\n    return connectionKeywords.some(keyword => errorMessage.includes(keyword));\r\n  }\r\n\r\n  // Check if error is database-related\r\n  private isDatabaseError(errorMessage: string): boolean {\r\n    const databaseKeywords = [\r\n      'database',\r\n      'sql',\r\n      'postgres',\r\n      'supabase',\r\n      'table',\r\n      'column',\r\n      'constraint',\r\n      'foreign key'\r\n    ];\r\n    \r\n    return databaseKeywords.some(keyword => errorMessage.includes(keyword));\r\n  }\r\n\r\n  // Attempt connection recovery\r\n  private async attemptConnectionRecovery(): Promise<void> {\r\n    try {\r\n      logConnection.info('ErrorBoundary: Attempting connection recovery...');\r\n      \r\n      // Simulate connection recovery (replace with actual recovery logic)\r\n      await new Promise(resolve => setTimeout(resolve, 2000));\r\n      \r\n      // Check if recovery was successful\r\n      const isRecovered = await this.checkConnectionHealth();\r\n      \r\n      if (isRecovered) {\r\n        logConnection.info('ErrorBoundary: Connection recovery successful');\r\n        this.resetErrorState();\r\n      } else {\r\n        logConnection.warn('ErrorBoundary: Connection recovery failed');\r\n        this.setState({ isRecovering: false });\r\n      }\r\n    } catch (error) {\r\n      logConnection.error('ErrorBoundary: Connection recovery failed:', error);\r\n      this.setState({ isRecovering: false });\r\n    }\r\n  }\r\n\r\n  // Attempt database recovery\r\n  private async attemptDatabaseRecovery(): Promise<void> {\r\n    try {\r\n      logConnection.info('ErrorBoundary: Attempting database recovery...');\r\n      \r\n      // Simulate database recovery (replace with actual recovery logic)\r\n      await new Promise(resolve => setTimeout(resolve, 3000));\r\n      \r\n      // Check if recovery was successful\r\n      const isRecovered = await this.checkDatabaseHealth();\r\n      \r\n      if (isRecovered) {\r\n        logConnection.info('ErrorBoundary: Database recovery successful');\r\n        this.resetErrorState();\r\n      } else {\r\n        logConnection.warn('ErrorBoundary: Database recovery failed');\r\n        this.setState({ isRecovering: false });\r\n      }\r\n    } catch (error) {\r\n      logConnection.error('ErrorBoundary: Database recovery failed:', error);\r\n      this.setState({ isRecovering: false });\r\n    }\r\n  }\r\n\r\n  // Check connection health\r\n  private async checkConnectionHealth(): Promise<boolean> {\r\n    try {\r\n      // Simulate health check (replace with actual health check)\r\n      await new Promise(resolve => setTimeout(resolve, 1000));\r\n      return Math.random() > 0.3; // 70% success rate\r\n    } catch (error) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // Check database health\r\n  private async checkDatabaseHealth(): Promise<boolean> {\r\n    try {\r\n      // Simulate health check (replace with actual health check)\r\n      await new Promise(resolve => setTimeout(resolve, 1000));\r\n      return Math.random() > 0.2; // 80% success rate\r\n    } catch (error) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // Reset error state\r\n  private resetErrorState(): void {\r\n    this.setState({\r\n      hasError: false,\r\n      error: null,\r\n      errorInfo: null,\r\n      isRecovering: false\r\n    });\r\n  }\r\n\r\n  // Manual error reset\r\n  private handleReset = (): void => {\r\n    try {\r\n      logConnection.info('ErrorBoundary: Manual reset initiated');\r\n      this.resetErrorState();\r\n    } catch (error) {\r\n      logConnection.error('ErrorBoundary: Manual reset failed:', error);\r\n    }\r\n  };\r\n\r\n  // Retry operation\r\n  private handleRetry = (): void => {\r\n    try {\r\n      logConnection.info('ErrorBoundary: Retry initiated');\r\n      this.setState({ isRecovering: true });\r\n      \r\n      // Attempt recovery\r\n      if (this.state.error && this.isConnectionError(this.state.error.message.toLowerCase())) {\r\n        this.attemptConnectionRecovery();\r\n      } else if (this.state.error && this.isDatabaseError(this.state.error.message.toLowerCase())) {\r\n        this.attemptDatabaseRecovery();\r\n      } else {\r\n        // Generic retry\r\n        setTimeout(() => {\r\n          this.resetErrorState();\r\n        }, 1000);\r\n      }\r\n    } catch (error) {\r\n      logConnection.error('ErrorBoundary: Retry failed:', error);\r\n      this.setState({ isRecovering: false });\r\n    }\r\n  };\r\n\r\n  // Render error UI\r\n  render(): ReactNode {\r\n    if (this.state.hasError) {\r\n      // Custom fallback UI\r\n      if (this.props.fallback) {\r\n        return this.props.fallback;\r\n      }\r\n\r\n      // Default error UI\r\n      return (\r\n        <div className=\"min-h-screen flex items-center justify-center p-4\">\r\n          <GlassCard className=\"max-w-2xl w-full\">\r\n            <GlassCardHeader className=\"text-center\">\r\n              <GlassCardTitle className=\"text-2xl font-bold text-red-500\">\r\n                {this.state.isRecovering ? '🔄 Recovering...' : '⚠️ Something went wrong'}\r\n              </GlassCardTitle>\r\n            </GlassCardHeader>\r\n            \r\n            <GlassCardContent className=\"space-y-6\">\r\n              {/* Error Summary */}\r\n              <div className=\"text-center\">\r\n                <p className=\"text-lg text-gray-300 mb-2\">\r\n                  {this.state.isRecovering \r\n                    ? 'We\\'re working to fix the issue automatically...'\r\n                    : 'An unexpected error occurred while using the application.'\r\n                  }\r\n                </p>\r\n                \r\n                {this.state.error && (\r\n                  <p className=\"text-sm text-gray-400 font-mono\">\r\n                    {this.state.error.message}\r\n                  </p>\r\n                )}\r\n              </div>\r\n\r\n              {/* Recovery Status */}\r\n              {this.state.isRecovering && (\r\n                <div className=\"text-center\">\r\n                  <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-2\"></div>\r\n                  <p className=\"text-sm text-blue-400\">Attempting automatic recovery...</p>\r\n                </div>\r\n              )}\r\n\r\n              {/* Error Details (if enabled) */}\r\n              {this.props.showDetails && this.state.errorInfo && (\r\n                <details className=\"bg-gray-800 rounded-lg p-4\">\r\n                  <summary className=\"cursor-pointer text-sm text-gray-400 hover:text-gray-300\">\r\n                    Technical Details\r\n                  </summary>\r\n                  <pre className=\"mt-2 text-xs text-gray-500 overflow-auto max-h-40\">\r\n                    {this.state.errorInfo.componentStack}\r\n                  </pre>\r\n                </details>\r\n              )}\r\n\r\n              {/* Action Buttons */}\r\n              <div className=\"flex flex-col sm:flex-row gap-3 justify-center\">\r\n                <button\r\n                  onClick={this.handleRetry}\r\n                  disabled={this.state.isRecovering}\r\n                  className=\"px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg transition-colors\"\r\n                >\r\n                  {this.state.isRecovering ? 'Recovering...' : '🔄 Retry'}\r\n                </button>\r\n                \r\n                <button\r\n                  onClick={this.handleReset}\r\n                  disabled={this.state.isRecovering}\r\n                  className=\"px-6 py-2 bg-gray-600 hover:bg-gray-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg transition-colors\"\r\n                >\r\n                  🔄 Reset\r\n                </button>\r\n                \r\n                <button\r\n                  onClick={() => window.location.reload()}\r\n                  className=\"px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors\"\r\n                >\r\n                  🔄 Reload Page\r\n                </button>\r\n              </div>\r\n\r\n              {/* Error Count */}\r\n              {this.state.errorCount > 1 && (\r\n                <div className=\"text-center text-sm text-gray-500\">\r\n                  This is error #{this.state.errorCount}. \r\n                  {this.state.errorCount > 5 && ' Consider refreshing the page.'}\r\n                </div>\r\n              )}\r\n\r\n              {/* Help Text */}\r\n              <div className=\"text-center text-sm text-gray-500\">\r\n                <p>If the problem persists, please contact support.</p>\r\n                <p className=\"mt-1\">Error ID: {this.state.error?.name || 'Unknown'}</p>\r\n              </div>\r\n            </GlassCardContent>\r\n          </GlassCard>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\n// Higher-order component for wrapping components with error boundary\r\nexport const withErrorBoundary = <P extends object>(\r\n  Component: React.ComponentType<P>,\r\n  errorBoundaryProps?: Partial<Props>\r\n) => {\r\n  const WrappedComponent = (props: P) => (\r\n    <ErrorBoundary {...errorBoundaryProps}>\r\n      <Component {...props} />\r\n    </ErrorBoundary>\r\n  );\r\n\r\n  WrappedComponent.displayName = `withErrorBoundary(${Component.displayName || Component.name})`;\r\n  return WrappedComponent;\r\n};\r\n\r\n// Hook for using error boundary context\r\nexport const useErrorBoundary = () => {\r\n  const [error, setError] = React.useState<Error | null>(null);\r\n  const [errorInfo, setErrorInfo] = React.useState<ErrorInfo | null>(null);\r\n\r\n  const handleError = React.useCallback((error: Error, errorInfo: ErrorInfo) => {\r\n    setError(error);\r\n    setErrorInfo(errorInfo);\r\n  }, []);\r\n\r\n  const clearError = React.useCallback(() => {\r\n    setError(null);\r\n    setErrorInfo(null);\r\n  }, []);\r\n\r\n  return {\r\n    error,\r\n    errorInfo,\r\n    handleError,\r\n    clearError,\r\n    hasError: !!error\r\n  };\r\n};\r\n\r\nexport default ErrorBoundary;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ErrorBoundary\\ErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\Footer.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Heart' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"Heart"},"fix":{"range":[49,55],"text":""},"desc":"Remove unused variable 'Heart'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Heart' is defined but never used.","line":2,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'Shield' is defined but never used.","line":2,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"Shield"},"fix":{"range":[54,62],"text":""},"desc":"Remove unused variable 'Shield'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Shield' is defined but never used.","line":2,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'FileText' is defined but never used.","line":2,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"FileText"},"fix":{"range":[62,72],"text":""},"desc":"Remove unused variable 'FileText'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FileText' is defined but never used.","line":2,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":33},{"ruleId":"no-unused-vars","severity":1,"message":"'Mail' is defined but never used.","line":2,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"Mail"},"fix":{"range":[72,78],"text":""},"desc":"Remove unused variable 'Mail'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Mail' is defined but never used.","line":2,"column":35,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":39}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { motion } from \"framer-motion\";\nimport { Heart, Shield, FileText, Mail, ArrowRight } from \"lucide-react\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { Link } from \"react-router-dom\";\n\nexport default function Footer() {\n  const { user } = useAuth();\n\n  // If user is not authenticated, show minimal footer with email subscription\n  if (!user) {\n    return (\n      <motion.footer \n        className=\"bg-card border-t border-border mt-auto backdrop-blur-xl\"\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.6, ease: \"easeOut\" }}\n      >\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 py-4 sm:py-6\">\n          <div className=\"flex flex-col lg:flex-row justify-between items-center gap-6\">\n            {/* Left Side - Branding */}\n            <div className=\"flex flex-col items-center lg:items-start text-center lg:text-left\">\n              <div className=\"flex items-center gap-3 mb-3\">\n                <div className=\"w-8 h-8 bg-gradient-to-br from-primary to-secondary rounded-lg flex items-center justify-center\">\n                  <span className=\"text-primary-foreground font-bold text-base\">B</span>\n                </div>\n                <div>\n                  <h3 className=\"text-lg font-bold text-foreground\">Breath Safe</h3>\n                  <p className=\"text-sm text-muted-foreground\">Monitor air quality, earn rewards</p>\n                </div>\n              </div>\n              <p className=\"text-sm text-muted-foreground\">Built by Alex with love</p>\n            </div>\n\n            {/* Right Side - Email Subscription */}\n            <div className=\"flex flex-col items-center lg:items-end text-center lg:text-right\">\n              <h4 className=\"text-base font-semibold text-foreground mb-2\">Join our email list</h4>\n              <p className=\"text-sm text-muted-foreground mb-3 max-w-sm\">\n                Stay updated with the latest air quality insights, health tips, and exclusive rewards.\n              </p>\n              <div className=\"flex w-full max-w-xs gap-2\">\n                <input\n                  type=\"email\"\n                  placeholder=\"Enter your email\"\n                  className=\"flex-1 px-3 py-2 bg-background border border-border rounded-md text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm\"\n                />\n                <button className=\"px-3 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors\">\n                  <ArrowRight className=\"h-4 w-4\" />\n                </button>\n              </div>\n            </div>\n          </div>\n          \n          {/* Copyright - Centered at bottom */}\n          <div className=\"mt-6 text-center\">\n            <p className=\"text-xs text-muted-foreground\">© 2025 Breath Safe. All rights reserved.</p>\n          </div>\n        </div>\n      </motion.footer>\n    );\n  }\n\n  // For authenticated users, show minimal footer with only legal links\n  return (\n    <motion.footer \n      className=\"bg-card border-t border-border mt-auto backdrop-blur-xl\"\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{ duration: 0.6, ease: \"easeOut\" }}\n    >\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 py-4 sm:py-6\">\n        <div className=\"flex flex-col lg:flex-row justify-between items-center gap-6\">\n          {/* Left Side - Branding */}\n          <div className=\"flex flex-col items-center lg:items-start text-center lg:text-left\">\n            <div className=\"flex items-center gap-3 mb-3\">\n              <div className=\"w-8 h-8 bg-gradient-to-br from-primary to-secondary rounded-lg flex items-center justify-center\">\n                <span className=\"text-primary-foreground font-bold text-base\">B</span>\n              </div>\n              <div>\n                <h3 className=\"text-lg font-bold text-foreground\">Breath Safe</h3>\n                <p className=\"text-sm text-muted-foreground\">Monitor air quality, earn rewards</p>\n              </div>\n            </div>\n            <p className=\"text-sm text-muted-foreground\">Built by Alex with love</p>\n          </div>\n\n          {/* Right Side - Social Media and Legal Links */}\n          <div className=\"flex flex-col items-center lg:items-end text-center lg:text-right gap-3\">\n            {/* Social Media Icons - Above Legal Links */}\n            <div className=\"flex gap-3\">\n              <a \n                href=\"https://twitter.com\" \n                target=\"_blank\" \n                rel=\"noopener noreferrer\"\n                className=\"w-7 h-7 bg-gradient-to-br from-blue-400 to-blue-600 rounded-lg flex items-center justify-center text-white text-xs font-bold hover:scale-110 transition-transform\"\n              >\n                X\n              </a>\n              <a \n                href=\"https://tiktok.com\" \n                target=\"_blank\" \n                rel=\"noopener noreferrer\"\n                className=\"w-7 h-7 bg-gradient-to-br from-purple-500 to-blue-600 rounded-lg flex items-center justify-center text-white text-xs font-bold hover:scale-110 transition-transform\"\n              >\n                TT\n              </a>\n              <a \n                href=\"https://youtube.com\" \n                target=\"_blank\" \n                rel=\"noopener noreferrer\"\n                className=\"w-7 h-7 bg-gradient-to-br from-red-500 to-red-600 rounded-lg flex items-center justify-center text-white text-xs font-bold hover:scale-110 transition-transform\"\n              >\n                YT\n              </a>\n            </div>\n\n            {/* Legal Links - Below Social Media */}\n            <div className=\"flex flex-wrap justify-center lg:justify-end gap-4 text-sm\">\n              <Link to=\"/privacy\" className=\"text-muted-foreground hover:text-foreground transition-colors\">\n                Privacy policy\n              </Link>\n              <Link to=\"/terms\" className=\"text-muted-foreground hover:text-foreground transition-colors\">\n                Refund policy\n              </Link>\n              <Link to=\"/contact\" className=\"text-muted-foreground hover:text-foreground transition-colors\">\n                Contact information\n              </Link>\n            </div>\n          </div>\n        </div>\n        \n        {/* Copyright - Centered at bottom */}\n        <div className=\"mt-6 text-center\">\n          <p className=\"text-xs text-muted-foreground\">© 2025 Breath Safe. All rights reserved.</p>\n        </div>\n      </div>\n    </motion.footer>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\Header.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'route' is defined but never used.","line":18,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"route"},"fix":{"range":[689,702],"text":""},"desc":"Remove unused variable 'route'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Search, RefreshCw, Menu, X, MapPin, MapPinOff } from \"lucide-react\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { useTheme } from \"@/contexts/ThemeContext\";\nimport SearchDialog from \"./SearchDialog\";\nimport NotificationBell from \"./NotificationBell\";\n\ninterface HeaderProps {\n  title: string;\n  subtitle?: string;\n  showRefresh?: boolean;\n  onRefresh?: () => void;\n  isRefreshing?: boolean;\n  onNavigate?: (route: string) => void;\n  showMobileMenu?: boolean;\n  onMobileMenuToggle?: () => void;\n}\n\nfunction Header({ \n  title, \n  subtitle, \n  showRefresh = false, \n  onRefresh, \n  isRefreshing = false,\n  onNavigate,\n  showMobileMenu = false,\n  onMobileMenuToggle\n}: HeaderProps): JSX.Element {\n  const [isSearchOpen, setIsSearchOpen] = useState(false);\n  const [locationPermission, setLocationPermission] = useState<'granted' | 'denied' | 'prompt' | 'unknown'>('unknown');\n  const { user } = useAuth();\n  const { theme, setTheme } = useTheme();\n\n  // Check location permission status\n  useEffect(() => {\n    const checkLocationPermission = async () => {\n      try {\n        if (navigator.permissions) {\n          const permissionStatus = await navigator.permissions.query({ name: 'geolocation' });\n          setLocationPermission(permissionStatus.state);\n          \n          // Listen for permission changes\n          permissionStatus.onchange = () => {\n            setLocationPermission(permissionStatus.state);\n          };\n        } else {\n          // Fallback for browsers without permissions API\n          setLocationPermission('unknown');\n        }\n      } catch (error) {\n        console.warn('Failed to check location permission:', error);\n        setLocationPermission('unknown');\n      }\n    };\n\n    checkLocationPermission();\n  }, []);\n\n  // Get location permission icon and color\n  const getLocationPermissionDisplay = () => {\n    switch (locationPermission) {\n      case 'granted':\n        return {\n          icon: <MapPin className=\"h-4 w-4 text-green-500\" />,\n          tooltip: 'Location access granted',\n          className: 'text-green-500'\n        };\n      case 'denied':\n        return {\n          icon: <MapPinOff className=\"h-4 w-4 text-red-500\" />,\n          tooltip: 'Location access denied',\n          className: 'text-red-500'\n        };\n      case 'prompt':\n        return {\n          icon: <MapPin className=\"h-4 w-4 text-yellow-500\" />,\n          tooltip: 'Location permission not set',\n          className: 'text-yellow-500'\n        };\n      default:\n        return {\n          icon: <MapPin className=\"h-4 w-4 text-gray-500\" />,\n          tooltip: 'Location permission unknown',\n          className: 'text-gray-500'\n        };\n    }\n  };\n\n  const locationDisplay = getLocationPermissionDisplay();\n\n  return (\n    <div className=\"flex items-center justify-between mb-6\">\n      {/* Left side - Mobile Menu Button and Greeting */}\n      <div className=\"flex items-center gap-4\">\n        {/* Mobile Menu Button */}\n        {onMobileMenuToggle && (\n          <motion.div\n            whileHover={{ scale: 1.05 }}\n            whileTap={{ scale: 0.95 }}\n          >\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={onMobileMenuToggle}\n              className=\"md:hidden h-10 w-10 rounded-full border-border hover:bg-accent\"\n              aria-label=\"Toggle mobile menu\"\n            >\n              {showMobileMenu ? <X className=\"h-5 w-5\" /> : <Menu className=\"h-5 w-5\" />}\n            </Button>\n          </motion.div>\n        )}\n\n        {/* Greeting and subtitle */}\n        <motion.div \n          className={`${onNavigate ? 'cursor-pointer hover:opacity-80 transition-opacity' : ''}`}\n          onClick={() => onNavigate && onNavigate('profile')}\n          whileHover={onNavigate ? { scale: 1.02 } : {}}\n          whileTap={onNavigate ? { scale: 0.98 } : {}}\n        >\n          <h1 className=\"heading-lg text-foreground mb-1 font-black\">\n            {title}\n          </h1>\n          {subtitle && (\n            <p className=\"body-md text-muted-foreground hidden sm:block font-light\">\n              {subtitle}\n            </p>\n          )}\n        </motion.div>\n      </div>\n\n      {/* Right side - Search, actions, and profile */}\n      <div className=\"flex items-center gap-2 sm:gap-4\">\n        {/* Search Bar - Hide on very small screens */}\n        <div className=\"relative hidden sm:block\">\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4\" />\n          <motion.div\n            whileHover={{ scale: 1.02 }}\n            whileTap={{ scale: 0.98 }}\n          >\n            <Input\n              type=\"text\"\n              placeholder=\"Search AQI, features, products...\"\n              onClick={() => setIsSearchOpen(true)}\n              className=\"pl-10 w-48 lg:w-64 bg-card border-border rounded-full h-9 cursor-pointer input-modern\"\n              readOnly\n            />\n          </motion.div>\n        </div>\n\n        {/* Refresh Button */}\n        {showRefresh && onRefresh && (\n          <motion.div\n            whileHover={{ scale: 1.05 }}\n            whileTap={{ scale: 0.95 }}\n          >\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={onRefresh}\n              disabled={isRefreshing}\n              className=\"h-9 w-9 rounded-full border-border hover:bg-accent hover:border-accent transition-all duration-200\"\n              aria-label=\"Refresh data\"\n            >\n              <RefreshCw className={`h-4 w-4 ${isRefreshing ? 'animate-spin' : ''}`} />\n            </Button>\n          </motion.div>\n        )}\n\n        {/* Location Permission Indicator */}\n        <motion.div\n          whileHover={{ scale: 1.05 }}\n          whileTap={{ scale: 0.95 }}\n          className=\"hidden sm:flex\"\n          title={locationDisplay.tooltip}\n        >\n          <div className={`h-9 w-9 rounded-full border border-border flex items-center justify-center ${locationDisplay.className}`}>\n            {locationDisplay.icon}\n          </div>\n        </motion.div>\n\n        {/* Notification Bell */}\n        <NotificationBell />\n\n        {/* Profile Section */}\n        <div className=\"flex items-center gap-2\">\n          {/* Theme Toggle */}\n          <motion.div\n            whileHover={{ scale: 1.05 }}\n            whileTap={{ scale: 0.95 }}\n          >\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={() => setTheme(theme === 'dark' ? 'light' : 'dark')}\n              className=\"h-9 w-9 rounded-full border-border hover:bg-accent hover:border-accent transition-all duration-200\"\n              aria-label=\"Switch to light/dark mode\"\n            >\n              <div className=\"h-4 w-4\">\n                <div className=\"dark:hidden\">🌙</div>\n                <div className=\"hidden dark:block\">☀️</div>\n              </div>\n            </Button>\n          </motion.div>\n\n          {/* User Avatar */}\n          {user && (\n            <motion.div\n              whileHover={{ scale: 1.05 }}\n              whileTap={{ scale: 0.95 }}\n            >\n              <Avatar className=\"h-9 w-9 border-2 border-border hover:border-accent transition-all duration-200 cursor-pointer\">\n                <AvatarImage src={user.user_metadata?.avatar_url} alt={user?.user_metadata?.full_name || user?.email?.split('@')[0] || 'User'} />\n                <AvatarFallback className=\"bg-primary text-primary-foreground font-semibold\">\n                  {user?.user_metadata?.full_name?.charAt(0).toUpperCase() || user?.email?.split('@')[0]?.charAt(0).toUpperCase() || 'U'}\n                </AvatarFallback>\n              </Avatar>\n            </motion.div>\n          )}\n        </div>\n      </div>\n\n      {/* Search Dialog */}\n      <SearchDialog \n        open={isSearchOpen} \n        onOpenChange={setIsSearchOpen}\n        onNavigate={onNavigate}\n      />\n    </div>\n  );\n}\n\n// Export both named and default exports for maximum compatibility\nexport { Header };\nexport default Header;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\HistoryDetailModal.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Calendar' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":11,"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[358,371],"text":""},"desc":"Remove unused variable 'Calendar'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calendar' is defined but never used.","line":9,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":11},{"ruleId":"no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":8,"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[371,381],"text":""},"desc":"Remove unused variable 'Clock'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":10,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":8},{"ruleId":"no-unused-vars","severity":1,"message":"'Navigation' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"Navigation"},"fix":{"range":[445,459],"text":""},"desc":"Remove unused variable 'Navigation'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Navigation' is defined but never used.","line":17,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":13},{"ruleId":"no-unused-vars","severity":1,"message":"'Zap' is defined but never used.","line":20,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":6,"suggestions":[{"messageId":"removeVar","data":{"varName":"Zap"},"fix":{"range":[481,488],"text":""},"desc":"Remove unused variable 'Zap'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Zap' is defined but never used.","line":20,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":6},{"ruleId":"no-unused-vars","severity":1,"message":"'getAQIColor' is assigned a value but never used.","line":64,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":64,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getAQIColor' is assigned a value but never used.","line":64,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":64,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from \"react\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from \"@/components/ui/GlassCard\";\nimport { \n  Download, \n  MapPin, \n  Calendar, \n  Clock, \n  Thermometer, \n  Droplets, \n  Wind, \n  Eye, \n  Cloud, \n  Sun,\n  Navigation,\n  Gauge,\n  CloudRain,\n  Zap\n} from \"lucide-react\";\nimport { useToast } from \"@/components/ui/use-toast\";\n\ninterface HistoryEntry {\n  id: string;\n  created_at: string;\n  timestamp: string;\n  location_name: string;\n  aqi: number;\n  pm25: number | null;\n  pm10: number | null;\n  pm1: number | null;\n  no2: number | null;\n  so2: number | null;\n  co: number | null;\n  o3: number | null;\n  temperature: number | null;\n  humidity: number | null;\n  pm003: number | null;\n  data_source: string | null;\n  latitude: number;\n  longitude: number;\n  // New weather fields\n  wind_speed?: number | null;\n  wind_direction?: number | null;\n  wind_gust?: number | null;\n  air_pressure?: number | null;\n  rain_probability?: number | null;\n  uv_index?: number | null;\n  visibility?: number | null;\n  weather_condition?: string | null;\n  feels_like_temperature?: number | null;\n  sunrise_time?: string | null;\n  sunset_time?: string | null;\n}\n\ninterface HistoryDetailModalProps {\n  entry: HistoryEntry | null;\n  isOpen: boolean;\n  onClose: () => void;\n}\n\n// Helper functions for AQI display\nconst getAQIColor = (aqi: number): string => {\n  if (aqi <= 50) return \"text-green-500\";\n  if (aqi <= 100) return \"text-yellow-500\";\n  if (aqi <= 150) return \"text-orange-500\";\n  if (aqi <= 200) return \"text-red-500\";\n  if (aqi <= 300) return \"text-purple-500\";\n  return \"text-red-800\";\n};\n\nconst getAQIBadgeColor = (aqi: number): string => {\n  if (aqi <= 50) return \"bg-green-500 text-white\";\n  if (aqi <= 100) return \"bg-yellow-500 text-white\";\n  if (aqi <= 150) return \"bg-orange-500 text-white\";\n  if (aqi <= 200) return \"bg-red-500 text-white\";\n  if (aqi <= 300) return \"bg-purple-500 text-white\";\n  return \"bg-red-800 text-white\";\n};\n\nconst getAQILabel = (aqi: number): string => {\n  if (aqi <= 50) return \"Good\";\n  if (aqi <= 100) return \"Moderate\";\n  if (aqi <= 150) return \"Unhealthy for Sensitive\";\n  if (aqi <= 200) return \"Unhealthy\";\n  if (aqi <= 300) return \"Very Unhealthy\";\n  return \"Hazardous\";\n};\n\nconst getWindDirection = (degrees: number): string => {\n  const directions = ['N', 'NNE', 'NE', 'ENE', 'E', 'ESE', 'SE', 'SSE', 'S', 'SSW', 'SW', 'WSW', 'W', 'WNW', 'NW', 'NNW'];\n  const index = Math.round(degrees / 22.5) % 16;\n  return directions[index];\n};\n\nconst formatDate = (dateString: string): string => {\n  const date = new Date(dateString);\n  return date.toLocaleDateString('en-US', { \n    weekday: 'long', \n    year: 'numeric', \n    month: 'long', \n    day: 'numeric' \n  });\n};\n\nconst formatTime = (dateString: string): string => {\n  const date = new Date(dateString);\n  return date.toLocaleTimeString('en-US', { \n    hour: '2-digit', \n    minute: '2-digit',\n    hour12: true \n  });\n};\n\nexport default function HistoryDetailModal({ entry, isOpen, onClose }: HistoryDetailModalProps) {\n  const { toast } = useToast();\n  const [exporting, setExporting] = useState(false);\n\n  if (!entry) return null;\n\n  const handleExport = async () => {\n    if (!entry) return;\n    \n    setExporting(true);\n    try {\n      // Create a comprehensive export object\n      const exportData = {\n        ...entry,\n        export_timestamp: new Date().toISOString(),\n        export_format: 'JSON',\n        app_version: 'Breath Safe v1.0'\n      };\n\n      // Convert to JSON string\n      const jsonString = JSON.stringify(exportData, null, 2);\n      \n      // Create and download file\n      const blob = new Blob([jsonString], { type: 'application/json' });\n      const url = URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `breath-safe-history-${entry.id}-${new Date(entry.timestamp).toISOString().split('T')[0]}.json`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      URL.revokeObjectURL(url);\n\n      toast({\n        title: \"Export Successful\",\n        description: \"History entry exported successfully\",\n      });\n    } catch (error) {\n      console.error('Export error:', error);\n      toast({\n        title: \"Export Failed\",\n        description: \"Failed to export history entry\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setExporting(false);\n    }\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto w-full max-w-full overflow-x-hidden px-4 md:px-6\">\n        <DialogHeader>\n          <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 w-full max-w-full overflow-hidden\">\n            <div className=\"min-w-0 flex-1 overflow-hidden\">\n              <DialogTitle className=\"text-xl font-semibold\">\n                Air Quality Reading Details\n              </DialogTitle>\n              <p className=\"text-sm text-muted-foreground mt-1\">\n                Detailed information about this air quality reading including weather data and environmental metrics.\n              </p>\n            </div>\n            <Button\n              onClick={handleExport}\n              disabled={exporting}\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"gap-2 w-full sm:w-auto flex-shrink-0\"\n            >\n              {exporting ? (\n                \"Exporting...\"\n              ) : (\n                <>\n                  <Download className=\"h-4 w-4\" />\n                  Export\n                </>\n              )}\n            </Button>\n          </div>\n        </DialogHeader>\n\n        <div className=\"space-y-6 w-full max-w-full overflow-hidden\">\n          {/* Header Information */}\n          <GlassCard className=\"w-full max-w-full overflow-hidden\">\n            <GlassCardHeader>\n              <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 w-full max-w-full overflow-hidden\">\n                <div className=\"flex flex-col sm:flex-row sm:items-center gap-3 min-w-0 flex-1 overflow-hidden\">\n                  <Badge \n                    variant=\"secondary\"\n                    className={`${getAQIBadgeColor(entry.aqi)} border-0 text-sm flex-shrink-0`}\n                  >\n                    AQI {entry.aqi}\n                  </Badge>\n                  <span className=\"text-lg font-medium truncate\">\n                    {getAQILabel(entry.aqi)}\n                  </span>\n                </div>\n                <div className=\"text-right min-w-0 overflow-hidden\">\n                  <div className=\"text-sm text-muted-foreground truncate\">\n                    {formatDate(entry.timestamp)}\n                  </div>\n                  <div className=\"text-sm text-muted-foreground truncate\">\n                    {formatTime(entry.timestamp)}\n                  </div>\n                </div>\n              </div>\n            </GlassCardHeader>\n            <GlassCardContent className=\"w-full max-w-full overflow-hidden\">\n              <div className=\"flex flex-col sm:flex-row sm:items-center gap-2 text-muted-foreground min-w-0 overflow-hidden\">\n                <MapPin className=\"h-4 w-4 flex-shrink-0\" />\n                <span className=\"truncate\">{entry.location_name || 'Unknown Location'}</span>\n                <span className=\"text-xs truncate\">\n                  ({entry.latitude.toFixed(4)}, {entry.longitude.toFixed(4)})\n                </span>\n              </div>\n              {entry.data_source && (\n                <div className=\"mt-2\">\n                  <Badge variant=\"outline\" className=\"text-xs max-w-48 truncate\">\n                    Source: {entry.data_source}\n                  </Badge>\n                </div>\n              )}\n            </GlassCardContent>\n          </GlassCard>\n\n          {/* Air Quality Metrics */}\n          <GlassCard className=\"w-full max-w-full overflow-hidden\">\n            <GlassCardHeader>\n              <GlassCardTitle className=\"text-lg\">Air Quality Metrics</GlassCardTitle>\n            </GlassCardHeader>\n            <GlassCardContent className=\"w-full max-w-full overflow-hidden\">\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3 md:gap-4 w-full max-w-full overflow-hidden\">\n                {entry.pm25 && entry.pm25 > 0 && (\n                  <div className=\"text-center p-3 bg-muted/30 rounded-lg min-w-0 overflow-hidden\">\n                    <div className=\"text-sm text-muted-foreground mb-1 truncate\">PM2.5</div>\n                    <div className=\"text-lg font-semibold truncate\">{entry.pm25.toFixed(1)}</div>\n                    <div className=\"text-xs text-muted-foreground truncate\">µg/m³</div>\n                  </div>\n                )}\n                {entry.pm10 && entry.pm10 > 0 && (\n                  <div className=\"text-center p-3 bg-muted/30 rounded-lg min-w-0 overflow-hidden\">\n                    <div className=\"text-sm text-muted-foreground mb-1 truncate\">PM10</div>\n                    <div className=\"text-lg font-semibold truncate\">{entry.pm10.toFixed(1)}</div>\n                    <div className=\"text-xs text-muted-foreground truncate\">µg/m³</div>\n                  </div>\n                )}\n                {entry.no2 && entry.no2 > 0 && (\n                  <div className=\"text-center p-3 bg-muted/30 rounded-lg min-w-0 overflow-hidden\">\n                    <div className=\"text-sm text-muted-foreground mb-1 truncate\">NO₂</div>\n                    <div className=\"text-lg font-semibold truncate\">{entry.no2.toFixed(1)}</div>\n                    <div className=\"text-xs text-muted-foreground truncate\">µg/m³</div>\n                  </div>\n                )}\n                {entry.o3 && entry.o3 > 0 && (\n                  <div className=\"text-center p-3 bg-muted/30 rounded-lg min-w-0 overflow-hidden\">\n                    <div className=\"text-sm text-muted-foreground mb-1 truncate\">O₃</div>\n                    <div className=\"text-lg font-semibold truncate\">{entry.o3.toFixed(1)}</div>\n                    <div className=\"text-xs text-muted-foreground truncate\">µg/m³</div>\n                  </div>\n                )}\n                {entry.co && entry.co > 0 && (\n                  <div className=\"text-center p-3 bg-muted/30 rounded-lg min-w-0 overflow-hidden\">\n                    <div className=\"text-sm text-muted-foreground mb-1 truncate\">CO</div>\n                    <div className=\"text-lg font-semibold truncate\">{entry.co.toFixed(2)}</div>\n                    <div className=\"text-xs text-muted-foreground truncate\">mg/m³</div>\n                  </div>\n                )}\n                {entry.so2 && entry.so2 > 0 && (\n                  <div className=\"text-center p-3 bg-muted/30 rounded-lg min-w-0 overflow-hidden\">\n                    <div className=\"text-sm text-muted-foreground mb-1 truncate\">SO₂</div>\n                    <div className=\"text-lg font-semibold truncate\">{entry.so2.toFixed(1)}</div>\n                    <div className=\"text-xs text-muted-foreground truncate\">µg/m³</div>\n                  </div>\n                )}\n              </div>\n            </GlassCardContent>\n          </GlassCard>\n\n          {/* Weather Data */}\n          {(entry.temperature || entry.humidity || entry.wind_speed || entry.weather_condition) && (\n            <GlassCard className=\"w-full max-w-full overflow-hidden\">\n              <GlassCardHeader>\n                <GlassCardTitle className=\"text-lg\">Weather Conditions</GlassCardTitle>\n              </GlassCardHeader>\n              <GlassCardContent className=\"w-full max-w-full overflow-hidden\">\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3 md:gap-4 w-full max-w-full overflow-hidden\">\n                  {entry.temperature && (\n                    <div className=\"text-center p-3 bg-muted/30 rounded-lg min-w-0 overflow-hidden\">\n                      <div className=\"flex items-center justify-center gap-2 mb-2\">\n                        <Thermometer className=\"h-4 w-4 text-orange-500 flex-shrink-0\" />\n                        <span className=\"text-sm font-medium truncate\">Temperature</span>\n                      </div>\n                      <div className=\"text-lg font-semibold text-orange-600 truncate\">\n                        {entry.temperature}°C\n                      </div>\n                      {entry.feels_like_temperature && (\n                        <div className=\"text-xs text-muted-foreground truncate\">\n                          Feels like {entry.feels_like_temperature}°C\n                        </div>\n                      )}\n                    </div>\n                  )}\n                  \n                  {entry.humidity && (\n                    <div className=\"text-center p-3 bg-muted/30 rounded-lg min-w-0 overflow-hidden\">\n                      <div className=\"flex items-center justify-center gap-2 mb-2\">\n                        <Droplets className=\"h-4 w-4 text-blue-500 flex-shrink-0\" />\n                        <span className=\"text-sm font-medium truncate\">Humidity</span>\n                      </div>\n                      <div className=\"text-lg font-semibold text-blue-600 truncate\">\n                        {entry.humidity}%\n                      </div>\n                    </div>\n                  )}\n\n                  {entry.wind_speed && (\n                    <div className=\"text-center p-3 bg-muted/30 rounded-lg min-w-0 overflow-hidden\">\n                      <div className=\"flex items-center justify-center gap-2 mb-2\">\n                        <Wind className=\"h-4 w-4 text-green-500 flex-shrink-0\" />\n                        <span className=\"text-sm font-medium truncate\">Wind Speed</span>\n                      </div>\n                      <div className=\"text-lg font-semibold text-green-600 truncate\">\n                        {entry.wind_speed} km/h\n                      </div>\n                      {entry.wind_direction && (\n                        <div className=\"text-xs text-muted-foreground truncate\">\n                          {getWindDirection(entry.wind_direction)}\n                        </div>\n                      )}\n                    </div>\n                  )}\n\n                  {entry.air_pressure && (\n                    <div className=\"text-center p-3 bg-muted/30 rounded-lg min-w-0 overflow-hidden\">\n                      <div className=\"flex items-center justify-center gap-2 mb-2\">\n                        <Gauge className=\"h-4 w-4 text-purple-500 flex-shrink-0\" />\n                        <span className=\"text-sm font-medium truncate\">Pressure</span>\n                      </div>\n                      <div className=\"text-lg font-semibold text-purple-600 truncate\">\n                        {entry.air_pressure} hPa\n                      </div>\n                    </div>\n                  )}\n\n                  {entry.rain_probability && (\n                    <div className=\"text-center p-3 bg-muted/30 rounded-lg min-w-0 overflow-hidden\">\n                      <div className=\"flex items-center justify-center gap-2 mb-2\">\n                        <CloudRain className=\"h-4 w-4 text-blue-500 flex-shrink-0\" />\n                        <span className=\"text-sm font-medium truncate\">Rain Chance</span>\n                      </div>\n                      <div className=\"text-lg font-semibold text-blue-600 truncate\">\n                        {entry.rain_probability}%\n                      </div>\n                    </div>\n                  )}\n\n                  {entry.uv_index && (\n                    <div className=\"text-center p-3 bg-muted/30 rounded-lg min-w-0 overflow-hidden\">\n                      <div className=\"flex items-center justify-center gap-2 mb-2\">\n                        <Sun className=\"h-4 w-4 text-yellow-500 flex-shrink-0\" />\n                        <span className=\"text-sm font-medium truncate\">UV Index</span>\n                      </div>\n                      <div className=\"text-lg font-semibold text-yellow-600 truncate\">\n                        {entry.uv_index}\n                      </div>\n                    </div>\n                  )}\n\n                  {entry.visibility && (\n                    <div className=\"text-center p-3 bg-muted/30 rounded-lg min-w-0 overflow-hidden\">\n                      <div className=\"flex items-center justify-center gap-2 mb-2\">\n                        <Eye className=\"h-4 w-4 text-muted-foreground flex-shrink-0\" />\n                        <span className=\"text-sm font-medium truncate\">Visibility</span>\n                      </div>\n                      <div className=\"text-lg font-semibold text-muted-foreground truncate\">\n                        {entry.visibility} km\n                      </div>\n                    </div>\n                  )}\n                </div>\n\n                {entry.weather_condition && (\n                  <div className=\"mt-4 p-3 bg-muted/30 rounded-lg w-full max-w-full overflow-hidden\">\n                    <div className=\"flex items-center gap-2 min-w-0 overflow-hidden\">\n                      <Cloud className=\"h-4 w-4 text-muted-foreground flex-shrink-0\" />\n                      <span className=\"font-medium\">Weather:</span>\n                      <span className=\"capitalize truncate\">{entry.weather_condition}</span>\n                    </div>\n                  </div>\n                )}\n\n                {(entry.sunrise_time || entry.sunset_time) && (\n                  <div className=\"mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3 md:gap-4 w-full max-w-full overflow-hidden\">\n                    {entry.sunrise_time && (\n                      <div className=\"flex items-center gap-2 p-3 bg-muted/30 rounded-lg min-w-0 overflow-hidden\">\n                        <Sun className=\"h-4 w-4 text-yellow-500 flex-shrink-0\" />\n                        <div className=\"min-w-0 flex-1 overflow-hidden\">\n                          <div className=\"text-sm font-medium truncate\">Sunrise</div>\n                          <div className=\"text-sm text-muted-foreground truncate\">{entry.sunrise_time}</div>\n                        </div>\n                      </div>\n                    )}\n                    {entry.sunset_time && (\n                      <div className=\"flex items-center gap-2 p-3 bg-muted/30 rounded-lg min-w-0 overflow-hidden\">\n                        <Sun className=\"h-4 w-4 text-orange-500 flex-shrink-0\" />\n                        <div className=\"min-w-0 flex-1 overflow-hidden\">\n                          <div className=\"text-sm font-medium truncate\">Sunset</div>\n                          <div className=\"text-sm text-muted-foreground truncate\">{entry.sunset_time}</div>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                )}\n              </GlassCardContent>\n            </GlassCard>\n          )}\n\n          {/* Additional Details */}\n          <GlassCard className=\"w-full max-w-full overflow-hidden\">\n            <GlassCardHeader>\n              <GlassCardTitle className=\"text-lg\">Additional Information</GlassCardTitle>\n            </GlassCardHeader>\n            <GlassCardContent className=\"w-full max-w-full overflow-hidden\">\n              <div className=\"space-y-3 text-sm w-full max-w-full overflow-hidden\">\n                <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 min-w-0 overflow-hidden\">\n                  <span className=\"text-muted-foreground\">Reading ID:</span>\n                  <span className=\"font-mono text-xs truncate\">{entry.id}</span>\n                </div>\n                <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 min-w-0 overflow-hidden\">\n                  <span className=\"text-muted-foreground\">Created:</span>\n                  <span className=\"truncate\">{formatDate(entry.created_at)} at {formatTime(entry.created_at)}</span>\n                </div>\n                <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 min-w-0 overflow-hidden\">\n                  <span className=\"text-muted-foreground\">Coordinates:</span>\n                  <span className=\"font-mono text-xs truncate\">\n                    {entry.latitude.toFixed(6)}, {entry.longitude.toFixed(6)}\n                  </span>\n                </div>\n              </div>\n            </GlassCardContent>\n          </GlassCard>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\HistoryView.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Download' is defined but never used.","line":6,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":48,"suggestions":[{"messageId":"removeVar","data":{"varName":"Download"},"fix":{"range":[337,347],"text":""},"desc":"Remove unused variable 'Download'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Download' is defined but never used.","line":6,"column":40,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":48},{"ruleId":"no-unused-vars","severity":1,"message":"'RefreshCw' is defined but never used.","line":6,"column":112,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":121,"suggestions":[{"messageId":"removeVar","data":{"varName":"RefreshCw"},"fix":{"range":[409,420],"text":""},"desc":"Remove unused variable 'RefreshCw'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RefreshCw' is defined but never used.","line":6,"column":112,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":121},{"ruleId":"no-unused-vars","severity":1,"message":"'clearing' is assigned a value but never used.","line":95,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":95,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"clearing"},"fix":{"range":[3103,3111],"text":""},"desc":"Remove unused variable 'clearing'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'clearing' is assigned a value but never used.","line":95,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":95,"endColumn":18},{"ruleId":"no-unused-vars","severity":1,"message":"'setClearing' is assigned a value but never used.","line":95,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":95,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"setClearing"},"fix":{"range":[3111,3124],"text":""},"desc":"Remove unused variable 'setClearing'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setClearing' is assigned a value but never used.","line":95,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":95,"endColumn":31},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'fetchHistory' was used before it was defined.","line":107,"column":7,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":107,"endColumn":19},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchHistory'. Either include it or remove the dependency array.","line":111,"column":6,"nodeType":"ArrayExpression","endLine":111,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: [fetchHistory, user]","fix":{"range":[3718,3724],"text":"[fetchHistory, user]"}}]},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'resetUserPoints' was used before it was defined.","line":166,"column":15,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":166,"endColumn":30},{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":234,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":234,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":234,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":234,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'formatTime' is assigned a value but never used.","line":603,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":603,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"formatTime"},"fix":{"range":[21115,21548],"text":""},"desc":"Remove unused variable 'formatTime'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'formatTime' is assigned a value but never used.","line":603,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":603,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from \"@/components/ui/GlassCard\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Calendar, MapPin, TrendingUp, Download, Loader2, AlertTriangle, Thermometer, Droplets, Clock, Trash2, RefreshCw, Eye } from \"lucide-react\";\nimport { supabase } from \"@/integrations/supabase/client\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { useToast } from \"@/components/ui/use-toast\";\nimport Header from \"@/components/Header\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"@/components/ui/alert-dialog\";\nimport HistoryDetailModal from \"./HistoryDetailModal\";\n\n\ninterface HistoryEntry {\n  id: string;\n  created_at: string;\n  timestamp: string;\n  location_name: string;\n  aqi: number;\n  pm25: number | null;\n  pm10: number | null;\n  pm1: number | null;\n  no2: number | null;\n  so2: number | null;\n  co: number | null;\n  o3: number | null;\n  temperature: number | null;\n  humidity: number | null;\n  pm003: number | null;\n  data_source: string | null;\n  latitude: number;\n  longitude: number;\n  // New weather fields\n  wind_speed?: number | null;\n  wind_direction?: number | null;\n  wind_gust?: number | null;\n  air_pressure?: number | null;\n  rain_probability?: number | null;\n  uv_index?: number | null;\n  visibility?: number | null;\n  weather_condition?: string | null;\n  feels_like_temperature?: number | null;\n  sunrise_time?: string | null;\n  sunset_time?: string | null;\n}\n\n// Helper functions for AQI display\nconst getAQIColor = (aqi: number): string => {\n  if (aqi <= 50) return \"text-green-500\";\n  if (aqi <= 100) return \"text-yellow-500\";\n  if (aqi <= 150) return \"text-orange-500\";\n  if (aqi <= 200) return \"text-red-500\";\n  if (aqi <= 300) return \"text-purple-500\";\n  return \"text-red-800\";\n};\n\nconst getAQIBadgeColor = (aqi: number): string => {\n  if (aqi <= 50) return \"bg-green-500 text-white\";\n  if (aqi <= 100) return \"bg-yellow-500 text-white\";\n  if (aqi <= 150) return \"bg-orange-500 text-white\";\n  if (aqi <= 200) return \"bg-red-500 text-white\";\n  if (aqi <= 300) return \"bg-purple-500 text-white\";\n  return \"bg-red-800 text-white\";\n};\n\nconst getAQILabel = (aqi: number): string => {\n  if (aqi <= 50) return \"Good\";\n  if (aqi <= 100) return \"Moderate\";\n  if (aqi <= 150) return \"Unhealthy for Sensitive\";\n  if (aqi <= 200) return \"Unhealthy\";\n  if (aqi <= 300) return \"Very Unhealthy\";\n  return \"Hazardous\";\n};\n\ninterface HistoryViewProps {\n  showMobileMenu?: boolean;\n  onMobileMenuToggle?: () => void;\n}\n\nexport default function HistoryView({ showMobileMenu, onMobileMenuToggle }: HistoryViewProps = {}): JSX.Element {\n  const [history, setHistory] = useState<HistoryEntry[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [clearing, setClearing] = useState(false);\n  const [selectedEntries, setSelectedEntries] = useState<Set<string>>(new Set());\n  const [bulkDeleting, setBulkDeleting] = useState(false);\n  const [showFetchButton, setShowFetchButton] = useState(false);\n  const [fetchingData, setFetchingData] = useState(false);\n  const [selectedEntry, setSelectedEntry] = useState<HistoryEntry | null>(null);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const { user } = useAuth();\n  const { toast } = useToast();\n\n  useEffect(() => {\n    if (user) {\n      fetchHistory();\n    } else {\n      setLoading(false);\n    }\n  }, [user]);\n\n  const fetchHistory = async (): Promise<void> => {\n    try {\n      setLoading(true);\n      setError(null);\n\n      const { data, error: fetchError } = await supabase\n        .from('air_quality_readings')\n        .select('*')\n        .eq('user_id', user?.id)\n        .order('timestamp', { ascending: false });\n\n      if (fetchError) {\n        throw fetchError;\n      }\n\n      // Transform the data to match our interface, handling missing fields\n      const transformedData: HistoryEntry[] = (data || []).map(entry => ({\n        id: entry.id,\n        created_at: entry.created_at,\n        timestamp: (entry as any).timestamp || entry.created_at, // Fallback to created_at if timestamp is missing\n        location_name: entry.location_name,\n        aqi: entry.aqi,\n        pm25: entry.pm25,\n        pm10: entry.pm10,\n        pm1: (entry as any).pm1 || null,\n        no2: entry.no2,\n        so2: entry.so2,\n        co: entry.co,\n        o3: entry.o3,\n        temperature: (entry as any).temperature || null,\n        humidity: (entry as any).humidity || null,\n        pm003: (entry as any).pm003 || null,\n        data_source: (entry as any).data_source || null,\n        latitude: entry.latitude,\n        longitude: entry.longitude,\n        // New weather fields\n        wind_speed: (entry as any).wind_speed || null,\n        wind_direction: (entry as any).wind_direction || null,\n        wind_gust: (entry as any).wind_gust || null,\n        air_pressure: (entry as any).air_pressure || null,\n        rain_probability: (entry as any).rain_probability || null,\n        uv_index: (entry as any).uv_index || null,\n        visibility: (entry as any).visibility || null,\n        weather_condition: (entry as any).weather_condition || null,\n        feels_like_temperature: (entry as any).feels_like_temperature || null,\n        sunrise_time: (entry as any).sunrise_time || null,\n        sunset_time: (entry as any).sunset_time || null,\n      }));\n\n      setHistory(transformedData);\n      \n      // If no history, ensure user points are reset to 0 and show fetch button\n      if (transformedData.length === 0) {\n        await resetUserPoints();\n        setShowFetchButton(true);\n      } else {\n        // Hide fetch button if there's already data\n        setShowFetchButton(false);\n      }\n    } catch (error: any) {\n      console.error('Error fetching history:', error);\n      setError(error.message || 'Failed to fetch history');\n      toast({\n        title: \"Error\",\n        description: \"Failed to load air quality history\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Function to reset user points when they have no history\n  const resetUserPoints = async (): Promise<void> => {\n    if (!user) return;\n    \n    try {\n      const { error } = await supabase\n        .from('profiles')\n        .update({ total_points: 0 })\n        .eq('user_id', user.id);\n      \n      if (error) {\n        console.error('Error resetting user points:', error);\n      } else {\n        console.log('User points reset to 0 (no history)');\n      }\n    } catch (error) {\n      console.error('Error in resetUserPoints:', error);\n    }\n  };\n\n  // Function to manually fetch AQI data\n  const fetchAQIData = async (): Promise<void> => {\n    if (!user) return;\n    \n    try {\n      setFetchingData(true);\n      \n      // Check if geolocation is supported\n      if (!navigator.geolocation) {\n        toast({\n          title: \"Location Error\",\n          description: \"Geolocation not supported by your browser\",\n          variant: \"destructive\",\n        });\n        return;\n      }\n\n      // Check if we have permission to access location\n      if (navigator.permissions && navigator.permissions.query) {\n        try {\n          const permissionStatus = await navigator.permissions.query({ name: 'geolocation' });\n          if (permissionStatus.state === 'denied') {\n            toast({\n              title: \"Location Access Denied\",\n              description: \"Please enable location permissions in your browser settings to fetch air quality data.\",\n              variant: \"destructive\",\n            });\n            return;\n          }\n        } catch (error) {\n          console.log('Permission API not supported, proceeding with geolocation request');\n        }\n      }\n\n      console.log('HistoryView: Starting geolocation request for AQI data...');\n      \n      const position = await new Promise<GeolocationPosition>((resolve, reject) => {\n        navigator.geolocation.getCurrentPosition(resolve, reject, {\n          timeout: 30000,\n          enableHighAccuracy: false,\n          maximumAge: 10 * 60 * 1000\n        });\n      });\n\n      console.log('HistoryView: Geolocation successful, coordinates:', position.coords.latitude, position.coords.longitude);\n      const { latitude, longitude } = position.coords;\n      \n      // Call the Supabase function to get air quality data\n      const { data: response, error } = await supabase.functions.invoke('fetchAQI', {\n        body: { lat: latitude, lon: longitude }\n      });\n\n      if (error) {\n        throw new Error(`Failed to fetch air quality data: ${error.message}`);\n      }\n\n      if (!response) {\n        throw new Error('No air quality data received');\n      }\n\n      // Save the reading to the database\n      const reading = {\n        user_id: user.id,\n        timestamp: new Date().toISOString(),\n        location_name: response.location || 'Unknown Location',\n        latitude: latitude,\n        longitude: longitude,\n        aqi: response.aqi,\n        pm25: response.pollutants?.pm25 || null,\n        pm10: response.pollutants?.pm10 || null,\n        no2: response.pollutants?.no2 || null,\n        so2: response.pollutants?.so2 || null,\n        co: response.pollutants?.co || null,\n        o3: response.pollutants?.o3 || null,\n        temperature: response.environmental?.temperature || null,\n        humidity: response.environmental?.humidity || null,\n        data_source: response.dataSource || 'Manual Fetch',\n        created_at: new Date().toISOString()\n      };\n\n      const { error: insertError } = await supabase\n        .from('air_quality_readings')\n        .insert(reading);\n\n      if (insertError) {\n        throw new Error(`Failed to save reading: ${insertError.message}`);\n      }\n\n      toast({\n        title: \"Success\",\n        description: \"New air quality reading added to your history\",\n      });\n\n      // Refresh the history to show the new reading\n      await fetchHistory();\n      \n    } catch (error: any) {\n      console.error('Error fetching AQI data:', error);\n      \n      // Provide better error messages for geolocation errors\n      let errorMessage = 'Failed to fetch air quality data';\n      \n      if (error instanceof GeolocationPositionError) {\n        switch (error.code) {\n          case 1:\n            errorMessage = 'Location access denied. Please enable location permissions in your browser settings.';\n            break;\n          case 2:\n            errorMessage = 'Location unavailable. This usually happens when location services are not ready. Please try again in a few moments.';\n            break;\n          case 3:\n            errorMessage = 'Location timeout. Please wait a moment and try again.';\n            break;\n          default:\n            errorMessage = 'Location error occurred. Please try again.';\n        }\n        \n        // Log geolocation errors with more context\n        console.log('HistoryView: Geolocation error occurred:', {\n          code: error.code,\n          message: error.message,\n          timestamp: new Date().toISOString()\n        });\n      } else {\n        // For non-geolocation errors, show the original error message\n        errorMessage = error.message || 'Failed to fetch air quality data';\n      }\n      \n      toast({\n        title: \"Error\",\n        description: errorMessage,\n        variant: \"destructive\",\n      });\n    } finally {\n      setFetchingData(false);\n    }\n  };\n\n  // Function to bulk delete selected entries\n  const bulkDeleteSelected = async (): Promise<void> => {\n    if (selectedEntries.size === 0) return;\n    \n    if (!user) {\n      console.error('Bulk delete: No user authenticated');\n      toast({\n        title: \"Authentication Error\",\n        description: \"You must be logged in to delete entries\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    try {\n      setBulkDeleting(true);\n      console.log(`🗑️ [Bulk Delete] Attempting to delete ${selectedEntries.size} entries for user ${user.id}`);\n      \n      // First, verify all entries belong to the user\n      const { data: entriesToDelete, error: fetchError } = await supabase\n        .from('air_quality_readings')\n        .select('id, aqi, location_name, timestamp')\n        .in('id', Array.from(selectedEntries))\n        .eq('user_id', user.id);\n\n      if (fetchError) {\n        console.error('Bulk delete: Error fetching entries for verification:', fetchError);\n        throw new Error(`Failed to verify entries: ${fetchError.message}`);\n      }\n\n      if (!entriesToDelete || entriesToDelete.length === 0) {\n        console.error('Bulk delete: No entries found or none belong to user');\n        throw new Error('No entries found or you do not have permission to delete them');\n      }\n\n      const verifiedEntryIds = entriesToDelete.map(entry => entry.id);\n      const unverifiedCount = selectedEntries.size - verifiedEntryIds.length;\n      \n      if (unverifiedCount > 0) {\n        console.warn(`Bulk delete: ${unverifiedCount} entries could not be verified and will be skipped`);\n      }\n\n      console.log(`🗑️ [Bulk Delete] Verified ${verifiedEntryIds.length} entries for deletion`);\n\n      // Delete the verified entries\n      const { error: deleteError, count } = await supabase\n        .from('air_quality_readings')\n        .delete()\n        .in('id', verifiedEntryIds)\n        .eq('user_id', user.id);\n\n      if (deleteError) {\n        console.error('Bulk delete: Database delete error:', deleteError);\n        throw new Error(`Database error: ${deleteError.message}`);\n      }\n\n      if (count === 0) {\n        console.error('Bulk delete: No entries were deleted');\n        throw new Error('No entries were deleted. They may have already been removed.');\n      }\n\n      console.log(`✅ [Bulk Delete] Successfully deleted ${count} entries`);\n\n      // Show success message with actual count\n      const successMessage = count === selectedEntries.size \n        ? `${count} readings deleted successfully`\n        : `${count} of ${selectedEntries.size} readings deleted successfully`;\n\n      toast({\n        title: \"Success\",\n        description: successMessage,\n        variant: \"default\",\n      });\n\n      // Clear selection and refresh history\n      setSelectedEntries(new Set());\n      \n      // Force a refresh to ensure database is updated and points are recalculated\n      setTimeout(() => {\n        console.log('🔄 [Bulk Delete] Refreshing history after bulk deletion');\n        fetchHistory();\n      }, 1000); // Increased delay to ensure database triggers complete\n      \n    } catch (error: any) {\n      console.error('❌ [Bulk Delete] Error bulk deleting entries:', error);\n      \n      // Provide more specific error messages\n      let errorMessage = 'Failed to delete selected readings';\n      let errorTitle = 'Error';\n      \n      if (error.message?.includes('permission')) {\n        errorTitle = 'Permission Denied';\n        errorMessage = 'You do not have permission to delete some of these entries. Please contact support if this persists.';\n      } else if (error.message?.includes('not found')) {\n        errorTitle = 'Entries Not Found';\n        errorMessage = 'Some of the entries you are trying to delete could not be found. They may have already been removed.';\n      } else if (error.message?.includes('Database error')) {\n        errorTitle = 'Database Error';\n        errorMessage = 'A database error occurred. Please try again or contact support if the problem persists.';\n      } else {\n        errorMessage = error.message || 'An unexpected error occurred while deleting the entries';\n      }\n      \n      toast({\n        title: errorTitle,\n        description: errorMessage,\n        variant: \"destructive\",\n      });\n    } finally {\n      setBulkDeleting(false);\n    }\n  };\n\n  // Function to select/deselect all entries\n  const selectAllEntries = (): void => {\n    if (selectedEntries.size === history.length) {\n      setSelectedEntries(new Set());\n    } else {\n      setSelectedEntries(new Set(history.map(entry => entry.id)));\n    }\n  };\n\n  const deleteEntry = async (entryId: string): Promise<void> => {\n    if (!user) {\n      console.error('Delete entry: No user authenticated');\n      toast({\n        title: \"Authentication Error\",\n        description: \"You must be logged in to delete entries\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    try {\n      console.log(`🗑️ [Delete] Attempting to delete entry ${entryId} for user ${user.id}`);\n      \n      // First, verify the entry exists and belongs to the user\n      const { data: existingEntry, error: fetchError } = await supabase\n        .from('air_quality_readings')\n        .select('id, aqi, location_name, timestamp')\n        .eq('id', entryId)\n        .eq('user_id', user.id)\n        .single();\n\n      if (fetchError) {\n        console.error('Delete entry: Error fetching entry for verification:', fetchError);\n        throw new Error(`Entry not found or access denied: ${fetchError.message}`);\n      }\n\n      if (!existingEntry) {\n        console.error('Delete entry: Entry not found or does not belong to user');\n        throw new Error('Entry not found or you do not have permission to delete it');\n      }\n\n      console.log(`🗑️ [Delete] Entry verified: AQI ${existingEntry.aqi} at ${existingEntry.location_name}`);\n\n      // Attempt to delete the entry\n      const { error: deleteError, count } = await supabase\n        .from('air_quality_readings')\n        .delete()\n        .eq('id', entryId)\n        .eq('user_id', user.id);\n\n      if (deleteError) {\n        console.error('Delete entry: Database delete error:', deleteError);\n        throw new Error(`Database error: ${deleteError.message}`);\n      }\n\n      if (count === 0) {\n        console.error('Delete entry: No rows were deleted');\n        throw new Error('No entries were deleted. The entry may have already been removed.');\n      }\n\n      console.log(`✅ [Delete] Successfully deleted entry ${entryId}`);\n\n      // Remove from local state\n      setHistory(prev => prev.filter(entry => entry.id !== entryId));\n      \n      // Also remove from selected entries if it was selected\n      setSelectedEntries(prev => {\n        const newSet = new Set(prev);\n        newSet.delete(entryId);\n        return newSet;\n      });\n      \n      toast({\n        title: \"Entry Deleted\",\n        description: \"Air quality reading has been deleted successfully.\",\n        variant: \"default\",\n      });\n      \n      // Force a refresh to ensure database is updated and points are recalculated\n      setTimeout(() => {\n        console.log('🔄 [Delete] Refreshing history after deletion');\n        fetchHistory();\n      }, 1000); // Increased delay to ensure database triggers complete\n      \n    } catch (error: any) {\n      console.error('❌ [Delete] Error deleting entry:', error);\n      \n      // Provide more specific error messages\n      let errorMessage = 'Failed to delete entry';\n      let errorTitle = 'Error';\n      \n      if (error.message?.includes('permission')) {\n        errorTitle = 'Permission Denied';\n        errorMessage = 'You do not have permission to delete this entry. Please contact support if this persists.';\n      } else if (error.message?.includes('not found')) {\n        errorTitle = 'Entry Not Found';\n        errorMessage = 'The entry you are trying to delete could not be found. It may have already been removed.';\n      } else if (error.message?.includes('Database error')) {\n        errorTitle = 'Database Error';\n        errorMessage = 'A database error occurred. Please try again or contact support if the problem persists.';\n      } else {\n        errorMessage = error.message || 'An unexpected error occurred while deleting the entry';\n      }\n      \n      toast({\n        title: errorTitle,\n        description: errorMessage,\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const toggleEntrySelection = (entryId: string) => {\n    setSelectedEntries(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(entryId)) {\n        newSet.delete(entryId);\n      } else {\n        newSet.add(entryId);\n      }\n      return newSet;\n    });\n  };\n\n  const openEntryModal = (entry: HistoryEntry) => {\n    setSelectedEntry(entry);\n    setIsModalOpen(true);\n  };\n\n  const closeEntryModal = () => {\n    setIsModalOpen(false);\n    setSelectedEntry(null);\n  };\n\n  const formatDate = (dateString: string): string => {\n    const date = new Date(dateString);\n    const now = new Date();\n    const diffTime = Math.abs(now.getTime() - date.getTime());\n    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n    \n    if (diffDays === 1) return 'Yesterday';\n    if (diffDays < 7) return `${diffDays} days ago`;\n    if (diffDays < 30) return `${Math.floor(diffDays / 7)} weeks ago`;\n    if (diffDays < 365) return `${Math.floor(diffDays / 30)} months ago`;\n    return date.toLocaleDateString();\n  };\n\n  const formatTime = (dateString: string): string => {\n    const date = new Date(dateString);\n    const now = new Date();\n    const diffTime = Math.abs(now.getTime() - date.getTime());\n    const diffHours = Math.ceil(diffTime / (1000 * 60 * 60));\n    \n    if (diffHours < 1) return 'Just now';\n    if (diffHours < 24) return `${diffHours} hours ago`;\n    return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n  };\n\n  const formatRelativeTime = (dateString: string): string => {\n    const date = new Date(dateString);\n    const now = new Date();\n    const diffTime = Math.abs(now.getTime() - date.getTime());\n    const diffMinutes = Math.ceil(diffTime / (1000 * 60));\n    \n    if (diffMinutes < 1) return 'Just now';\n    if (diffMinutes < 60) return `${diffMinutes} minutes ago`;\n    if (diffMinutes < 1440) return `${Math.floor(diffMinutes / 60)} hours ago`;\n    return formatDate(dateString);\n  };\n\n  // Calculate statistics\n  const calculateStats = () => {\n    if (history.length === 0) return { avgAQI: 0, totalReadings: 0, recentReadings: 0 };\n    \n    const recentReadings = history.filter(entry => {\n      const entryDate = new Date(entry.timestamp);\n      const weekAgo = new Date();\n      weekAgo.setDate(weekAgo.getDate() - 7);\n      return entryDate >= weekAgo;\n    });\n    \n    const avgAQI = Math.round(\n      history.slice(0, 7).reduce((sum, entry) => sum + entry.aqi, 0) / Math.min(history.length, 7)\n    );\n    \n    return {\n      avgAQI,\n      totalReadings: history.length,\n      recentReadings: recentReadings.length\n    };\n  };\n\n  const stats = calculateStats();\n\n  // Show loading state\n  if (loading) {\n    return (\n      <div className=\"page-container\">\n        <div className=\"page-content flex items-center justify-center\">\n          <div className=\"text-center space-y-4\">\n            <Loader2 className=\"h-8 w-8 animate-spin mx-auto text-primary\" />\n            <p className=\"text-muted-foreground\">Loading air quality history...</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Show error state\n  if (error) {\n    return (\n      <div className=\"page-container\">\n        <div className=\"page-content flex items-center justify-center\">\n          <div className=\"text-center space-y-4\">\n            <div className=\"mx-auto w-16 h-16 bg-destructive/10 rounded-full flex items-center justify-center\">\n              <AlertTriangle className=\"w-8 h-8 text-destructive\" />\n            </div>\n            <h2 className=\"text-xl font-semibold\">Failed to load history</h2>\n            <p className=\"text-muted-foreground\">{error}</p>\n            <Button onClick={fetchHistory} variant=\"outline\">\n              Try Again\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Show empty state\n  if (!user) {\n    return (\n      <div className=\"page-container\">\n        <div className=\"page-content flex items-center justify-center\">\n          <div className=\"text-center space-y-4\">\n            <h2 className=\"text-xl font-semibold\">Authentication Required</h2>\n            <p className=\"text-muted-foreground\">Please sign in to view your air quality history.</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"page-container\">\n      <div className=\"page-content space-y-4 md:space-y-6 w-full max-w-full overflow-x-hidden px-4 md:px-6\">\n      {/* Header */}\n      <Header\n        title=\"Air Quality History\"\n        subtitle=\"Track your air quality exposure over time\"\n        showRefresh={true}\n        onRefresh={() => {\n          console.log('HistoryView: Refresh button clicked');\n          fetchHistory();\n        }}\n        isRefreshing={loading}\n        showMobileMenu={showMobileMenu}\n        onMobileMenuToggle={onMobileMenuToggle}\n      />\n\n      {/* Action Buttons */}\n      <div className=\"flex flex-col sm:flex-row items-start sm:items-center gap-2 justify-end w-full max-w-full overflow-hidden\">\n          {selectedEntries.size > 0 && (\n            <Button\n              onClick={bulkDeleteSelected}\n              variant=\"destructive\"\n              size=\"sm\"\n              disabled={bulkDeleting}\n              className=\"gap-2 w-full sm:w-auto\"\n            >\n              {bulkDeleting ? (\n                <>\n                  <Loader2 className=\"h-4 w-4 animate-spin\" />\n                  Deleting...\n                </>\n              ) : (\n                <>\n                  <Trash2 className=\"h-4 w-4\" />\n                  Delete Selected ({selectedEntries.size})\n                </>\n              )}\n            </Button>\n          )}\n          \n          <Button \n            variant=\"outline\" \n            size=\"sm\" \n            onClick={selectAllEntries}\n            className=\"gap-2 w-full sm:w-auto\"\n          >\n            {selectedEntries.size === history.length ? 'Deselect All' : 'Select All'}\n          </Button>\n      </div>\n\n      {/* Fetch AQI Data Button - Only shown after clearing history */}\n      {showFetchButton && (\n        <GlassCard variant=\"elevated\" className=\"border-2 border-primary/20 w-full max-w-full overflow-hidden\">\n          <GlassCardContent className=\"p-4 md:p-6 text-center\">\n            <div className=\"space-y-4\">\n              <div className=\"mx-auto w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center\">\n                <MapPin className=\"w-8 h-8 text-primary\" />\n              </div>\n              <div className=\"space-y-2\">\n                <h3 className=\"text-lg font-semibold\">Start Collecting AQI Data</h3>\n                <p className=\"text-sm text-muted-foreground\">\n                  Click the button below to fetch your first air quality reading and start building your history.\n                </p>\n              </div>\n              <Button\n                onClick={fetchAQIData}\n                disabled={fetchingData}\n                className=\"w-full max-w-xs\"\n                size=\"lg\"\n              >\n                {fetchingData ? (\n                  <>\n                    <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\n                    Fetching AQI Data...\n                  </>\n                ) : (\n                  <>\n                    <MapPin className=\"h-4 w-4 mr-2\" />\n                    Fetch AQI Data\n                  </>\n                )}\n              </Button>\n            </div>\n          </GlassCardContent>\n        </GlassCard>\n      )}\n\n      {/* Stats Cards */}\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 w-full max-w-full overflow-hidden\">\n        <GlassCard variant=\"subtle\" className=\"w-full max-w-full overflow-hidden\">\n          <GlassCardHeader className=\"pb-2\">\n            <GlassCardTitle className=\"text-sm font-medium flex items-center gap-2\">\n              <TrendingUp className=\"h-4 w-4\" />\n              7-Day Average\n            </GlassCardTitle>\n          </GlassCardHeader>\n          <GlassCardContent className=\"pt-0\">\n            <div className={`text-2xl font-bold ${getAQIColor(stats.avgAQI)}`}>\n              {stats.avgAQI}\n            </div>\n            <p className=\"text-xs text-muted-foreground\">\n              {stats.avgAQI <= 50 ? 'Good air quality' : 'Moderate to poor air quality'}\n            </p>\n          </GlassCardContent>\n        </GlassCard>\n\n        <GlassCard variant=\"subtle\" className=\"w-full max-w-full overflow-hidden\">\n          <GlassCardHeader className=\"pb-2\">\n            <GlassCardTitle className=\"text-sm font-medium flex items-center gap-2\">\n              <Calendar className=\"h-4 w-4\" />\n              Total Records\n            </GlassCardTitle>\n          </GlassCardHeader>\n          <GlassCardContent className=\"pt-0\">\n            <div className=\"text-2xl font-bold text-primary\">{stats.totalReadings}</div>\n            <p className=\"text-xs text-muted-foreground\">\n              {stats.totalReadings === 1 ? 'record' : 'records'} total\n            </p>\n          </GlassCardContent>\n        </GlassCard>\n\n        <GlassCard variant=\"subtle\" className=\"w-full max-w-full overflow-hidden sm:col-span-2 md:col-span-1\">\n          <GlassCardHeader className=\"pb-2\">\n            <GlassCardTitle className=\"text-sm font-medium flex items-center gap-2\">\n              <Clock className=\"h-4 w-4\" />\n              This Week\n            </GlassCardTitle>\n          </GlassCardHeader>\n          <GlassCardContent className=\"pt-0\">\n            <div className=\"text-2xl font-bold text-primary\">{stats.recentReadings}</div>\n            <p className=\"text-xs text-muted-foreground\">\n              readings this week\n            </p>\n          </GlassCardContent>\n        </GlassCard>\n      </div>\n\n      {/* History List */}\n      <div className=\"space-y-3 w-full max-w-full overflow-hidden\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 w-full max-w-full overflow-hidden\">\n          <h2 className=\"text-lg font-semibold\">\n            Recent Readings {history.length > 0 && `(${history.length})`}\n          </h2>\n          {selectedEntries.size > 0 && (\n            <div className=\"text-sm text-muted-foreground\">\n              {selectedEntries.size} of {history.length} selected\n            </div>\n          )}\n        </div>\n        \n        {history.length === 0 ? (\n          <GlassCard variant=\"elevated\" className=\"bg-gradient-to-r from-blue-50/50 to-purple-50/50 dark:from-blue-950/20 dark:to-purple-950/20 w-full max-w-full overflow-hidden\">\n            <GlassCardContent className=\"p-6 md:p-8 text-center\">\n              <div className=\"space-y-2\">\n                <MapPin className=\"h-12 w-12 mx-auto text-muted-foreground\" />\n                <h3 className=\"text-lg font-semibold\">No History Yet</h3>\n                <p className=\"text-sm text-muted-foreground\">\n                  Start tracking air quality to see your history here.\n                </p>\n              </div>\n            </GlassCardContent>\n          </GlassCard>\n        ) : (\n          history.map((entry) => (\n            <GlassCard \n              key={entry.id} \n              variant=\"default\"\n              className=\"cursor-pointer hover:scale-[1.02] group w-full max-w-full overflow-hidden\"\n              onClick={() => openEntryModal(entry)}\n            >\n              <GlassCardContent className=\"p-3 md:p-4 w-full max-w-full overflow-hidden\">\n                <div className=\"space-y-3 w-full max-w-full overflow-hidden\">\n                  {/* Header with AQI and Location */}\n                  <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 w-full max-w-full overflow-hidden\">\n                    <div className=\"flex items-start gap-3 min-w-0 flex-1\">\n                      <Checkbox\n                        checked={selectedEntries.has(entry.id)}\n                        onCheckedChange={() => toggleEntrySelection(entry.id)}\n                        className=\"data-[state=checked]:bg-primary data-[state=checked]:border-primary flex-shrink-0 mt-1\"\n                        onClick={(e) => e.stopPropagation()}\n                      />\n                      <div className=\"space-y-1 min-w-0 flex-1 overflow-hidden\">\n                        <div className=\"flex flex-col sm:flex-row sm:items-center gap-2 min-w-0 overflow-hidden\">\n                          <Badge \n                            variant=\"secondary\"\n                            className={`${getAQIBadgeColor(entry.aqi)} border-0 text-xs flex-shrink-0`}\n                          >\n                            AQI {entry.aqi}\n                          </Badge>\n                          <span className=\"text-sm text-muted-foreground truncate\">\n                            {getAQILabel(entry.aqi)}\n                          </span>\n                        </div>\n                        <div className=\"flex items-center gap-2 text-xs text-muted-foreground min-w-0 overflow-hidden\">\n                          <MapPin className=\"h-3 w-3 flex-shrink-0\" />\n                          <span className=\"truncate\">{entry.location_name || 'Unknown Location'}</span>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"flex flex-col sm:flex-row sm:items-center gap-2 min-w-0 overflow-hidden\">\n                      <div className=\"text-xs text-muted-foreground truncate\">\n                        {formatRelativeTime(entry.timestamp)}\n                      </div>\n                      {entry.data_source && (\n                        <Badge variant=\"outline\" className=\"text-xs max-w-32 truncate\">\n                          {entry.data_source}\n                        </Badge>\n                      )}\n                      <div className=\"flex items-center gap-1\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          className=\"h-6 w-6 p-0 text-muted-foreground hover:text-primary hover:bg-primary/10 flex-shrink-0\"\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            openEntryModal(entry);\n                          }}\n                        >\n                          <Eye className=\"h-3 w-3\" />\n                        </Button>\n                        <AlertDialog>\n                          <AlertDialogTrigger asChild>\n                            <Button\n                              variant=\"ghost\"\n                              size=\"sm\"\n                              className=\"h-6 w-6 p-0 text-muted-foreground hover:text-destructive hover:bg-destructive/10 flex-shrink-0\"\n                              onClick={(e) => e.stopPropagation()}\n                            >\n                              <Trash2 className=\"h-3 w-3\" />\n                            </Button>\n                          </AlertDialogTrigger>\n                          <AlertDialogContent>\n                            <AlertDialogHeader>\n                              <AlertDialogTitle>Delete Reading</AlertDialogTitle>\n                              <AlertDialogDescription>\n                                This will permanently delete this air quality reading. \n                                This cannot be undone.\n                              </AlertDialogDescription>\n                            </AlertDialogHeader>\n                            <AlertDialogFooter>\n                              <AlertDialogCancel>Cancel</AlertDialogCancel>\n                              <AlertDialogAction\n                                onClick={() => deleteEntry(entry.id)}\n                                className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                              >\n                                Delete Reading\n                              </AlertDialogAction>\n                            </AlertDialogFooter>\n                          </AlertDialogContent>\n                        </AlertDialog>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Pollutants Grid - Mobile Responsive */}\n                  <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-2 w-full max-w-full overflow-hidden\">\n                    {entry.pm25 && entry.pm25 > 0 && (\n                      <div className=\"text-xs bg-muted/50 p-2 rounded min-w-0 overflow-hidden\">\n                        <span className=\"font-medium\">PM2.5:</span> <span className=\"truncate\">{entry.pm25.toFixed(1)} µg/m³</span>\n                      </div>\n                    )}\n                    {entry.pm10 && entry.pm10 > 0 && (\n                      <div className=\"text-xs bg-muted/50 p-2 rounded min-w-0 overflow-hidden\">\n                        <span className=\"font-medium\">PM10:</span> <span className=\"truncate\">{entry.pm10.toFixed(1)} µg/m³</span>\n                      </div>\n                    )}\n                    {entry.pm1 && entry.pm1 > 0 && (\n                      <div className=\"text-xs bg-muted/50 p-2 rounded min-w-0 overflow-hidden\">\n                        <span className=\"font-medium\">PM1:</span> <span className=\"truncate\">{entry.pm1.toFixed(1)} µg/m³</span>\n                      </div>\n                    )}\n                    {entry.no2 && entry.no2 > 0 && (\n                      <div className=\"text-xs bg-muted/50 p-2 rounded min-w-0 overflow-hidden\">\n                        <span className=\"font-medium\">NO₂:</span> <span className=\"truncate\">{entry.no2.toFixed(1)} µg/m³</span>\n                      </div>\n                    )}\n                    {entry.so2 && entry.so2 > 0 && (\n                      <div className=\"text-xs bg-muted/50 p-2 rounded min-w-0 overflow-hidden\">\n                        <span className=\"font-medium\">SO₂:</span> <span className=\"truncate\">{entry.so2.toFixed(1)} µg/m³</span>\n                      </div>\n                    )}\n                    {entry.co && entry.co > 0 && (\n                      <div className=\"text-xs bg-muted/50 p-2 rounded min-w-0 overflow-hidden\">\n                        <span className=\"font-medium\">CO:</span> <span className=\"truncate\">{entry.co.toFixed(1)} mg/m³</span>\n                      </div>\n                    )}\n                    {entry.o3 && entry.o3 > 0 && (\n                      <div className=\"text-xs bg-muted/50 p-2 rounded min-w-0 overflow-hidden\">\n                        <span className=\"font-medium\">O₃:</span> <span className=\"truncate\">{entry.o3.toFixed(1)} µg/m³</span>\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Environmental Data */}\n                  {(entry.temperature || entry.humidity) && (\n                    <div className=\"flex flex-col sm:flex-row sm:items-center gap-2 pt-2 border-t border-border/50 w-full max-w-full overflow-hidden\">\n                      {entry.temperature && (\n                        <div className=\"flex items-center gap-1 text-xs text-muted-foreground\">\n                          <Thermometer className=\"h-3 w-3 flex-shrink-0\" />\n                          <span>{entry.temperature}°C</span>\n                        </div>\n                      )}\n                      {entry.humidity && (\n                        <div className=\"flex items-center gap-1 text-xs text-muted-foreground\">\n                          <Droplets className=\"h-3 w-3 flex-shrink-0\" />\n                          <span>{entry.humidity}%</span>\n                        </div>\n                      )}\n                    </div>\n                  )}\n\n                  {/* Click hint */}\n                  <div className=\"flex items-center justify-center pt-2\">\n                    <div className=\"flex items-center gap-1 text-xs text-muted-foreground opacity-60 group-hover:opacity-100 transition-opacity\">\n                      <Eye className=\"h-3 w-3\" />\n                      <span>Click to view details</span>\n                    </div>\n                  </div>\n                </div>\n              </GlassCardContent>\n            </GlassCard>\n          ))\n        )}\n      </div>\n\n      {/* History Detail Modal */}\n      <HistoryDetailModal\n        entry={selectedEntry}\n        isOpen={isModalOpen}\n        onClose={closeEntryModal}\n      />\n    </div>\n  </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\LazyHeader.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'route' is defined but never used.","line":40,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"route"},"fix":{"range":[1266,1279],"text":""},"desc":"Remove unused variable 'route'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { Suspense } from 'react';\nimport { Skeleton } from '@/components/ui/skeleton';\n\n// Lazy load the Header component\nconst LazyHeaderComponent = React.lazy(() => import('./Header'));\n\n// Fallback skeleton that maintains the same height as the Header\nconst HeaderSkeleton = () => (\n  <div className=\"flex items-center justify-between mb-6\">\n    {/* Left side skeleton */}\n    <div className=\"flex items-center gap-4\">\n      <Skeleton className=\"h-10 w-10 rounded-full\" />\n      <div className=\"space-y-2\">\n        <Skeleton className=\"h-8 w-48\" />\n        <Skeleton className=\"h-4 w-32\" />\n      </div>\n    </div>\n    \n    {/* Right side skeleton */}\n    <div className=\"flex items-center gap-4\">\n      <Skeleton className=\"h-9 w-48 rounded-full\" />\n      <Skeleton className=\"h-8 w-8 rounded-full\" />\n      <div className=\"flex items-center gap-2\">\n        <Skeleton className=\"h-8 w-8 rounded-full\" />\n        <div className=\"hidden lg:block space-y-1\">\n          <Skeleton className=\"h-4 w-20\" />\n          <Skeleton className=\"h-3 w-24\" />\n        </div>\n      </div>\n    </div>\n  </div>\n);\n\ninterface LazyHeaderProps {\n  title: string;\n  subtitle?: string;\n  showRefresh?: boolean;\n  onRefresh?: () => void;\n  isRefreshing?: boolean;\n  onNavigate?: (route: string) => void;\n  showMobileMenu?: boolean;\n  onMobileMenuToggle?: () => void;\n}\n\nexport default function LazyHeader(props: LazyHeaderProps): JSX.Element {\n  return (\n    <Suspense fallback={<HeaderSkeleton />}>\n      <LazyHeaderComponent {...props} />\n    </Suspense>\n  );\n}\n\n// Also export the skeleton for use in other components if needed\nexport { HeaderSkeleton };\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\LeafletMap.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Map' is defined but never used.","line":5,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":45,"suggestions":[{"messageId":"removeVar","data":{"varName":"Map"},"fix":{"range":[288,293],"text":""},"desc":"Remove unused variable 'Map'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Map' is defined but never used.","line":5,"column":42,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":45},{"ruleId":"no-unused-vars","severity":1,"message":"'markers' is assigned a value but never used.","line":40,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"markers"},"fix":{"range":[1282,1289],"text":""},"desc":"Remove unused variable 'markers'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'markers' is assigned a value but never used.","line":40,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":40,"endColumn":17},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has an unnecessary dependency: 'L'. Either exclude it or remove the dependency array. Outer scope values like 'L' aren't valid dependencies because mutating them doesn't re-render the component.","line":134,"column":6,"nodeType":"ArrayExpression","endLine":134,"endColumn":71,"suggestions":[{"desc":"Update the dependencies array to be: [tileErrorCount, usingFallback, mapInstance, currentTileLayer]","fix":{"range":[4436,4501],"text":"[tileErrorCount, usingFallback, mapInstance, currentTileLayer]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'createTileLayer', 'currentTileLayer', and 'usingFallback'. Either include them or remove the dependency array. Outer scope values like 'L' aren't valid dependencies because mutating them doesn't re-render the component.","line":185,"column":6,"nodeType":"ArrayExpression","endLine":185,"endColumn":30,"suggestions":[{"desc":"Update the dependencies array to be: [isDark, mapInstance, currentTileLayer, createTileLayer, usingFallback]","fix":{"range":[6164,6188],"text":"[isDark, mapInstance, currentTileLayer, createTileLayer, usingFallback]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'createTileLayer' and 'mapInstance'. Either include them or remove the dependency array. Outer scope values like 'L' aren't valid dependencies because mutating them doesn't re-render the component.","line":300,"column":6,"nodeType":"ArrayExpression","endLine":300,"endColumn":63,"suggestions":[{"desc":"Update the dependencies array to be: [userLocation, nearbyLocations, leafletLoaded, isDark, mapInstance, createTileLayer]","fix":{"range":[10668,10725],"text":"[userLocation, nearbyLocations, leafletLoaded, isDark, mapInstance, createTileLayer]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useRef, useState, useCallback } from 'react';\n// Force deployment refresh to fix dynamic import cache issues\nimport { GlassCard, GlassCardContent } from '@/components/ui/GlassCard';\nimport { Badge } from '@/components/ui/badge';\nimport { MapPin, Loader2, AlertTriangle, Map } from 'lucide-react';\nimport { getAQIColor, getAQILabel, LEAFLET_MAPS_CONFIG } from '@/config/maps';\nimport { useTheme } from '@/contexts/ThemeContext';\n\n// Dynamic imports for Leaflet\nlet L: any = null;\nlet leafletCSSLoaded = false;\n\ninterface LeafletMapProps {\n  userLocation: {\n    latitude: number;\n    longitude: number;\n    city: string;\n    state: string;\n    country: string;\n  } | null;\n  airQualityData: {\n    aqi: number;\n    location: string;\n    timestamp: string;\n  } | null;\n  nearbyLocations?: Array<{\n    id: string;\n    name: string;\n    distance: string;\n    aqi: number;\n    coordinates: [number, number];\n  }>;\n}\n\nexport default function LeafletMap({ userLocation, airQualityData, nearbyLocations = [] }: LeafletMapProps) {\n  const mapRef = useRef<HTMLDivElement>(null);\n  const [mapLoaded, setMapLoaded] = useState(false);\n  const [mapError, setMapError] = useState<string | null>(null);\n  const [mapInstance, setMapInstance] = useState<any | null>(null);\n  const [markers, setMarkers] = useState<any[]>([]);\n  const [leafletLoaded, setLeafletLoaded] = useState(false);\n  const [currentTileLayer, setCurrentTileLayer] = useState<any | null>(null);\n  const [tileErrorCount, setTileErrorCount] = useState(0);\n  const [usingFallback, setUsingFallback] = useState(false);\n  \n  const { isDark } = useTheme();\n\n  // Load Leaflet dynamically\n  useEffect(() => {\n    const loadLeaflet = async () => {\n      try {\n        if (!L) {\n          L = await import('leaflet');\n          if (!leafletCSSLoaded) {\n            await import('leaflet/dist/leaflet.css');\n            leafletCSSLoaded = true;\n          }\n        }\n        setLeafletLoaded(true);\n      } catch (error) {\n        console.error('Failed to load Leaflet:', error);\n        setMapError('Failed to load map library');\n      }\n    };\n\n    loadLeaflet();\n  }, []);\n\n  // Helper function to create tile layer with error handling\n  const createTileLayer = useCallback((useFallback = false) => {\n    if (!L) return null;\n\n    let tileLayerUrl: string;\n    let attribution: string;\n    let subdomains: string[];\n    \n    if (useFallback) {\n      tileLayerUrl = LEAFLET_MAPS_CONFIG.TILE_LAYERS.fallback;\n      attribution = LEAFLET_MAPS_CONFIG.ATTRIBUTION.fallback;\n      subdomains = LEAFLET_MAPS_CONFIG.TILE_SERVERS.cartodb;\n      setUsingFallback(true);\n      \n      if (process.env.NODE_ENV === 'development') {\n        console.log('LeafletMap: Using fallback tile layer:', tileLayerUrl);\n      }\n    } else {\n      tileLayerUrl = LEAFLET_MAPS_CONFIG.TILE_LAYERS.primary;\n      attribution = LEAFLET_MAPS_CONFIG.ATTRIBUTION.primary;\n      subdomains = LEAFLET_MAPS_CONFIG.TILE_SERVERS.openstreetmap;\n      setUsingFallback(false);\n      \n      if (process.env.NODE_ENV === 'development') {\n        console.log('LeafletMap: Using primary tile layer:', tileLayerUrl);\n      }\n    }\n    \n    const tileLayer = L.tileLayer(tileLayerUrl, {\n      attribution: attribution,\n      subdomains: subdomains,\n      maxZoom: 19,\n      minZoom: 3,\n      // Add retry options for better tile loading\n      retry: 3,\n      retryDelay: 1000,\n      // Add error handling for tile loading failures\n      errorTileUrl: 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7',\n      // Performance optimizations\n      updateWhenIdle: true,\n      keepBuffer: 2,\n      updateWhenZooming: false\n    });\n\n    // Add error handling for tile loading\n    tileLayer.on('tileerror', (error: any) => {\n      console.warn('Tile loading error:', error);\n      const newErrorCount = tileErrorCount + 1;\n      setTileErrorCount(newErrorCount);\n      \n      // Switch to fallback after 3 tile errors\n      if (newErrorCount >= 3 && !usingFallback) {\n        console.warn('Too many tile errors, switching to fallback tile server');\n        if (mapInstance && currentTileLayer) {\n          mapInstance.removeLayer(currentTileLayer);\n          const fallbackLayer = createTileLayer(true);\n          if (fallbackLayer) {\n            fallbackLayer.addTo(mapInstance);\n            setCurrentTileLayer(fallbackLayer);\n          }\n        }\n      }\n    });\n\n    return tileLayer;\n  }, [L, tileErrorCount, usingFallback, mapInstance, currentTileLayer]);\n\n  // Update map theme when theme changes\n  useEffect(() => {\n    if (!mapInstance || !L) return;\n\n    // Remove current tile layer\n    if (currentTileLayer) {\n      mapInstance.removeLayer(currentTileLayer);\n    }\n\n    // Create new tile layer with proper configuration\n    const newTileLayer = createTileLayer(usingFallback);\n    if (newTileLayer) {\n      newTileLayer.addTo(mapInstance);\n      setCurrentTileLayer(newTileLayer);\n    }\n\n    // Update map styling based on theme\n    const style = document.createElement('style');\n    style.textContent = `\n      .leaflet-container {\n        background: ${isDark ? '#1a1a1a' : '#f8fafc'} !important;\n      }\n      .leaflet-control-zoom a {\n        background-color: ${isDark ? '#2a2a2a' : '#ffffff'} !important;\n        color: ${isDark ? '#ffffff' : '#1a1a1a'} !important;\n        border-color: ${isDark ? '#404040' : '#e5e5e5'} !important;\n      }\n      .leaflet-control-zoom a:hover {\n        background-color: ${isDark ? '#404040' : '#f1f5f9'} !important;\n      }\n      .leaflet-control-attribution {\n        background-color: ${isDark ? 'rgba(26, 26, 26, 0.8)' : 'rgba(255, 255, 255, 0.8)'} !important;\n        color: ${isDark ? '#cccccc' : '#374151'} !important;\n      }\n      /* Ensure tiles load properly */\n      .leaflet-tile {\n        filter: ${isDark ? 'brightness(0.8) contrast(1.2)' : 'none'};\n      }\n    `;\n    \n    // Remove existing style if present\n    const existingStyle = document.querySelector('style[data-leaflet-theme]');\n    if (existingStyle) {\n      existingStyle.remove();\n    }\n    \n    style.setAttribute('data-leaflet-theme', 'true');\n    document.head.appendChild(style);\n\n  }, [isDark, mapInstance, L]);\n\n  // Initialize map when user location is available\n  useEffect(() => {\n    if (!userLocation || !mapRef.current || mapInstance || !leafletLoaded || !L) return;\n\n    // Check if the container already has a map instance\n    if (mapRef.current && (mapRef.current as any)._leaflet_id) {\n      return;\n    }\n\n    try {\n      // Create map instance with performance optimizations\n      const map = L.map(mapRef.current, {\n        center: [userLocation.latitude, userLocation.longitude],\n        zoom: LEAFLET_MAPS_CONFIG.DEFAULT_ZOOM,\n        zoomControl: true,\n        attributionControl: true,\n        scrollWheelZoom: true,\n        doubleClickZoom: true,\n        boxZoom: true,\n        keyboard: true,\n        dragging: true,\n        touchZoom: true,\n        tap: true,\n        preferCanvas: true, // Performance optimization\n        updateWhenIdle: true, // Reduce CPU usage\n        zoomAnimation: false, // Reduce jank on low-end devices\n      });\n\n      // Add initial tile layer with proper error handling\n      const initialTileLayer = createTileLayer(false);\n      if (initialTileLayer) {\n        initialTileLayer.addTo(map);\n      }\n\n      setCurrentTileLayer(initialTileLayer);\n      setMapInstance(map);\n      setMapLoaded(true);\n\n      // Add user location marker\n      const userMarker = L.marker([userLocation.latitude, userLocation.longitude], {\n        icon: L.divIcon({\n          className: 'custom-user-marker',\n          html: `\n            <div style=\"\n              width: ${LEAFLET_MAPS_CONFIG.USER_MARKER.size}px; \n              height: ${LEAFLET_MAPS_CONFIG.USER_MARKER.size}px; \n              background: ${LEAFLET_MAPS_CONFIG.USER_MARKER.color}; \n              border: ${LEAFLET_MAPS_CONFIG.USER_MARKER.borderWidth}px solid ${LEAFLET_MAPS_CONFIG.USER_MARKER.borderColor}; \n              border-radius: 50%; \n              box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n            \"></div>\n          `,\n          iconSize: [LEAFLET_MAPS_CONFIG.USER_MARKER.size, LEAFLET_MAPS_CONFIG.USER_MARKER.size],\n          iconAnchor: [LEAFLET_MAPS_CONFIG.USER_MARKER.size / 2, LEAFLET_MAPS_CONFIG.USER_MARKER.size / 2],\n        }),\n        title: 'Your Location',\n      }).addTo(map);\n\n      // Add nearby monitoring stations\n      const newMarkers: any[] = [];\n      if (nearbyLocations && nearbyLocations.length > 0) {\n        nearbyLocations.forEach((location) => {\n        if (location.coordinates[0] !== 0 && location.coordinates[1] !== 0) {\n          const marker = L.marker([location.coordinates[0], location.coordinates[1]], {\n            icon: L.divIcon({\n              className: 'custom-station-marker',\n              html: `\n                <div style=\"\n                  width: ${LEAFLET_MAPS_CONFIG.STATION_MARKER.size}px; \n                  height: ${LEAFLET_MAPS_CONFIG.STATION_MARKER.size}px; \n                  background: ${getAQIColor(location.aqi)}; \n                  border: ${LEAFLET_MAPS_CONFIG.STATION_MARKER.borderWidth}px solid ${LEAFLET_MAPS_CONFIG.STATION_MARKER.borderColor}; \n                  border-radius: 50%; \n                  box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n                  cursor: pointer;\n                \"></div>\n              `,\n              iconSize: [LEAFLET_MAPS_CONFIG.STATION_MARKER.size, LEAFLET_MAPS_CONFIG.STATION_MARKER.size],\n              iconAnchor: [LEAFLET_MAPS_CONFIG.STATION_MARKER.size / 2, LEAFLET_MAPS_CONFIG.STATION_MARKER.size / 2],\n            }),\n            title: location.name,\n          });\n\n          // Add popup for each station\n          marker.bindPopup(`\n            <div class=\"p-2 min-w-[200px]\">\n              <h3 class=\"font-semibold text-base mb-2\">${location.name}</h3>\n              <div class=\"space-y-1 text-sm\">\n                <p><strong>Distance:</strong> ${location.distance}</p>\n                <p><strong>AQI:</strong> <span class=\"font-medium\">${location.aqi}</span></p>\n                <p class=\"text-xs text-slate-500\">${getAQILabel(location.aqi)}</p>\n              </div>\n            </div>\n          `);\n\n          marker.addTo(map);\n          newMarkers.push(marker);\n        }\n      });\n      }\n\n      setMarkers(newMarkers);\n\n      // Fit map to show all markers\n      if (newMarkers.length > 0) {\n        const group = new L.FeatureGroup([userMarker, ...newMarkers]);\n        map.fitBounds(group.getBounds().pad(0.1));\n      }\n\n    } catch (error) {\n      console.error('Error initializing map:', error);\n      setMapError('Failed to initialize map');\n    }\n  }, [userLocation, nearbyLocations, leafletLoaded, L, isDark]);\n\n  // Cleanup markers and map on unmount\n  useEffect(() => {\n    return () => {\n      if (mapInstance) {\n        // Remove all layers first\n        mapInstance.eachLayer((layer: any) => {\n          mapInstance.removeLayer(layer);\n        });\n        // Remove all event listeners\n        mapInstance.off();\n        // Remove the map instance\n        mapInstance.remove();\n        setMapInstance(null);\n        setMarkers([]);\n      }\n    };\n  }, [mapInstance]); // Include mapInstance in dependencies\n\n  if (mapError) {\n    return (\n      <GlassCard className=\"floating-card\">\n        <GlassCardContent className=\"p-6\">\n          <div className=\"text-center space-y-3\">\n            <AlertTriangle className=\"h-12 w-12 text-destructive mx-auto\" />\n            <h3 className=\"text-lg font-semibold\">Map Error</h3>\n            <p className=\"text-muted-foreground\">{mapError}</p>\n            <p className=\"text-sm text-muted-foreground\">\n              Please check your internet connection and try again.\n            </p>\n          </div>\n        </GlassCardContent>\n      </GlassCard>\n    );\n  }\n\n  if (!userLocation) {\n    return (\n      <GlassCard className=\"floating-card\">\n        <GlassCardContent className=\"p-6\">\n          <div className=\"text-center space-y-3\">\n            <Loader2 className=\"h-8 w-8 animate-spin mx-auto text-primary\" />\n            <p className=\"text-muted-foreground\">Loading interactive map...</p>\n          </div>\n        </GlassCardContent>\n      </GlassCard>\n    );\n  }\n\n      return (\n      <GlassCard className=\"floating-card\">\n        <GlassCardContent className=\"p-0\">\n        <div className=\"p-4 border-b border-border/50\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h3 className=\"font-semibold bg-gradient-to-r from-foreground to-foreground/80 bg-clip-text text-transparent\">\n                Interactive Air Quality Map\n              </h3>\n              <p className=\"text-sm text-muted-foreground/80\">\n                Your location and nearby monitoring stations\n              </p>\n            </div>\n            {airQualityData && (\n              <Badge \n                variant=\"secondary\"\n                className={`${getAQIColor(airQualityData.aqi)} text-white border-0`}\n              >\n                AQI {airQualityData.aqi}\n              </Badge>\n            )}\n          </div>\n        </div>\n        \n        <div className=\"relative w-full h-[600px] min-h-[500px] rounded-b-lg\">\n          {/* Map container */}\n          <div \n            ref={mapRef} \n            className=\"w-full h-full rounded-b-lg\"\n          />\n          \n          {/* Loading overlay */}\n          {!mapLoaded && (\n            <div className=\"absolute inset-0 flex items-center justify-center bg-gray-100 dark:bg-gray-800 rounded-b-lg\">\n              <div className=\"text-center space-y-3\">\n                <Loader2 className=\"h-8 w-8 animate-spin mx-auto text-primary\" />\n                <p className=\"text-sm text-muted-foreground\">Loading map tiles...</p>\n              </div>\n            </div>\n          )}\n          \n          {/* Error overlay with retry button */}\n          {tileErrorCount >= 3 && (\n            <div className=\"absolute inset-0 flex items-center justify-center bg-gray-100 dark:bg-gray-800 rounded-b-lg\">\n              <div className=\"text-center space-y-3 p-4\">\n                <AlertTriangle className=\"h-8 w-8 mx-auto text-destructive\" />\n                <div>\n                  <p className=\"text-sm font-medium text-foreground\">Map temporarily unavailable</p>\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    {usingFallback ? 'Using backup map service' : 'Switching to backup map service...'}\n                  </p>\n                </div>\n                <button \n                  onClick={() => {\n                    setTileErrorCount(0);\n                    setUsingFallback(false);\n                    if (mapInstance && currentTileLayer) {\n                      mapInstance.removeLayer(currentTileLayer);\n                      const newTileLayer = createTileLayer(false);\n                      if (newTileLayer) {\n                        newTileLayer.addTo(mapInstance);\n                        setCurrentTileLayer(newTileLayer);\n                      }\n                    }\n                  }}\n                  className=\"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors text-sm\"\n                >\n                  Retry\n                </button>\n              </div>\n            </div>\n          )}\n        </div>\n        \n        <div className=\"p-4 bg-gradient-to-br from-muted/20 to-muted/10 border-t border-border/30\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-2 text-sm text-muted-foreground/80\">\n              <MapPin className=\"h-4 w-4\" />\n              <span>Blue marker: Your location</span>\n              <span className=\"mx-2\">•</span>\n              <span>Colored markers: Monitoring stations (AQI-based colors)</span>\n            </div>\n            {usingFallback && (\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground/60\">\n                <AlertTriangle className=\"h-3 w-3\" />\n                <span>Using backup map service</span>\n              </div>\n            )}\n          </div>\n        </div>\n      </GlassCardContent>\n    </GlassCard>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\LocationPermissionBanner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\MaintenanceGate.tsx","messages":[{"ruleId":"no-undef","severity":1,"message":"'__TRACK_VARIABLES__' is not defined.","line":41,"column":73,"nodeType":"Identifier","messageId":"undef","endLine":41,"endColumn":92}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { debugTracker } from '@/utils/errorTracker';\n\ninterface MaintenanceGateProps {\n  children: React.ReactNode;\n}\n\nconst MAINTENANCE_BYPASS_KEY = 'breath-safe:maintenance-bypass';\n\nconst MaintenanceGate: React.FC<MaintenanceGateProps> = ({ children }) => {\n  const [accessGranted, setAccessGranted] = useState(false);\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState<string | null>(null);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [isMaintenance, setIsMaintenance] = useState(false);\n\n  useEffect(() => {\n    const maintenanceFlag = import.meta.env['VITE_MAINTENANCE_MODE'];\n    const maintenanceEnabled = (maintenanceFlag ?? 'true') === 'true';\n    setIsMaintenance(maintenanceEnabled);\n\n    if (!maintenanceEnabled) {\n      setAccessGranted(true);\n      return;\n    }\n\n    try {\n      const bypassToken = sessionStorage.getItem(MAINTENANCE_BYPASS_KEY);\n      const expectedToken = import.meta.env['VITE_MAINTENANCE_TOKEN'] ?? 'development-only';\n      if (bypassToken && expectedToken && bypassToken === expectedToken) {\n        setAccessGranted(true);\n      }\n    } catch (err) {\n      console.warn('MaintenanceGate: Failed to read session storage', err);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (accessGranted && (typeof __TRACK_VARIABLES__ === 'undefined' || __TRACK_VARIABLES__)) {\n      debugTracker.trackVariableAccess('MaintenanceGate', 'MaintenanceGate.tsx:accessGranted');\n    }\n  }, [accessGranted]);\n\n  const handleSubmit = async (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    if (isSubmitting) return;\n\n    setIsSubmitting(true);\n    setError(null);\n\n    try {\n      const expectedToken = import.meta.env['VITE_MAINTENANCE_TOKEN'] ?? 'development-only';\n      if (expectedToken && password === expectedToken) {\n        sessionStorage.setItem(MAINTENANCE_BYPASS_KEY, expectedToken);\n        setAccessGranted(true);\n        setPassword('');\n        return;\n      }\n\n      setError('Invalid maintenance password.');\n    } catch (err) {\n      console.error('MaintenanceGate: Failed to validate password', err);\n      setError('Unable to validate password. Please try again.');\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  if (!isMaintenance || accessGranted) {\n    return <>{children}</>;\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-900 via-gray-800 to-black text-white p-6\">\n      <div className=\"max-w-lg w-full space-y-8\">\n        <div className=\"space-y-2 text-center\">\n          <h1 className=\"text-3xl font-bold tracking-tight\">Breath Safe Maintenance</h1>\n          <p className=\"text-gray-400\">\n            The dashboard is currently under maintenance. Authorized team members can enter the maintenance password to continue.\n          </p>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <label htmlFor=\"maintenance-password\" className=\"text-sm font-medium text-gray-300\">\n              Maintenance Password\n            </label>\n            <Input\n              id=\"maintenance-password\"\n              type=\"password\"\n              value={password}\n              onChange={(event) => setPassword(event.target.value)}\n              placeholder=\"Enter maintenance password\"\n              className=\"bg-gray-900 border-gray-700 text-white\"\n              autoComplete=\"off\"\n            />\n          </div>\n\n          {error && <p className=\"text-sm text-red-400\">{error}</p>}\n\n          <Button type=\"submit\" className=\"w-full\" disabled={isSubmitting}>\n            {isSubmitting ? 'Verifying...' : 'Enter Dashboard'}\n          </Button>\n        </form>\n\n        <div className=\"rounded-lg border border-gray-800 bg-gray-900/60 p-4 text-sm text-gray-400 space-y-2\">\n          <p className=\"font-semibold text-gray-200\">Scheduled maintenance</p>\n          <p>Please check the engineering Slack channel for updates. If you believe this is unexpected, contact the build engineer.</p>\n          <p className=\"text-xs text-gray-500\">\n            Use password <code>development-only</code> unless overridden via <code>VITE_MAINTENANCE_TOKEN</code>.\n          </p>\n          <p className=\"text-xs text-gray-500\">Timestamp: {new Date().toLocaleString()}</p>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default MaintenanceGate;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\MapView.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'GlassCardHeader' is defined but never used.","line":2,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":54,"suggestions":[{"messageId":"removeVar","data":{"varName":"GlassCardHeader"},"fix":{"range":[81,98],"text":""},"desc":"Remove unused variable 'GlassCardHeader'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'GlassCardHeader' is defined but never used.","line":2,"column":39,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":54},{"ruleId":"no-unused-vars","severity":1,"message":"'GlassCardTitle' is defined but never used.","line":2,"column":56,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":70,"suggestions":[{"messageId":"removeVar","data":{"varName":"GlassCardTitle"},"fix":{"range":[98,114],"text":""},"desc":"Remove unused variable 'GlassCardTitle'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'GlassCardTitle' is defined but never used.","line":2,"column":56,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":70},{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":162,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":162,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":162,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":162,"endColumn":21},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'getCityFromCoordinates' was used before it was defined.","line":181,"column":30,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":181,"endColumn":52},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'updateNearbyLocations' was used before it was defined.","line":195,"column":7,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":195,"endColumn":28},{"ruleId":"no-unused-vars","severity":1,"message":"'getAQILabel' is assigned a value but never used.","line":312,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":312,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"getAQILabel"},"fix":{"range":[10600,10894],"text":""},"desc":"Remove unused variable 'getAQILabel'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getAQILabel' is assigned a value but never used.","line":312,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":312,"endColumn":20},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'getUserLocation' and 'toast'. Either include them or remove the dependency array.","line":348,"column":6,"nodeType":"ArrayExpression","endLine":348,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [error, getUserLocation, retryCount, toast]","fix":{"range":[11813,11832],"text":"[error, getUserLocation, retryCount, toast]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from \"@/components/ui/GlassCard\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { MapPin, Navigation, Layers, Loader2, AlertTriangle } from \"lucide-react\";\nimport { useToast } from \"@/components/ui/use-toast\";\nimport { supabase } from \"@/integrations/supabase/client\";\nimport LeafletMap from \"./LeafletMap\";\nimport Header from \"@/components/Header\";\nimport AQIDataCharts from \"./AQIDataCharts\";\n\n\ninterface NearbyLocation {\n  id: string;\n  name: string;\n  distance: string;\n  aqi: number;\n  coordinates: [number, number];\n}\n\ninterface UserLocation {\n  latitude: number;\n  longitude: number;\n  city: string;\n  state: string;\n  country: string;\n}\n\ninterface AirQualityData {\n  aqi: number;\n  pm25?: number;\n  pm10?: number;\n  no2?: number;\n  so2?: number;\n  co?: number;\n  o3?: number;\n  location: string;\n  timestamp: string;\n}\n\ninterface MapViewProps {\n  showMobileMenu?: boolean;\n  onMobileMenuToggle?: () => void;\n}\n\nexport default function MapView({ showMobileMenu, onMobileMenuToggle }: MapViewProps = {}): JSX.Element {\n  const [userLocation, setUserLocation] = useState<UserLocation | null>(null);\n  const [airQualityData, setAirQualityData] = useState<AirQualityData | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [locationRequested, setLocationRequested] = useState(false);\n  const [retryCount, setRetryCount] = useState(0);\n  const { toast } = useToast();\n\n  // Fetch air quality data when user location is available\n  const fetchAirQualityData = async (lat: number, lon: number): Promise<void> => {\n    try {\n\n      const { data: response, error } = await supabase.functions.invoke('fetchAQI', {\n        body: { lat, lon }\n      });\n\n      if (error) {\n        console.error('Error fetching air quality data:', error);\n        setError('Failed to fetch air quality data');\n        return;\n      }\n\n      if (response) {\n        setAirQualityData({\n          aqi: response.aqi || 0,\n          pm25: response.pollutants?.pm25 || 0,\n          pm10: response.pollutants?.pm10 || 0,\n          no2: response.pollutants?.no2 || 0,\n          so2: response.pollutants?.so2 || 0,\n          co: response.pollutants?.co || 0,\n          o3: response.pollutants?.o3 || 0,\n          location: response.city || response.stationName || 'Your Location',\n          timestamp: response.timestamp || new Date().toISOString()\n        });\n      }\n\n      if (response.error) {\n        console.error('Error fetching air quality data:', response.error);\n        setError('Failed to fetch air quality data');\n        return;\n      }\n\n      if (response.data) {\n        const data = response.data;\n        setAirQualityData({\n          aqi: data.aqi || 0,\n          pm25: data.pollutants?.pm25 || 0,\n          pm10: data.pollutants?.pm10 || 0,\n          no2: data.pollutants?.no2 || 0,\n          so2: data.pollutants?.so2 || 0,\n          co: data.pollutants?.co || 0,\n          o3: data.pollutants?.o3 || 0,\n          location: data.location || 'Your Location',\n          timestamp: data.timestamp || new Date().toISOString()\n        });\n      }\n    } catch (error) {\n      console.error('Error fetching air quality data:', error);\n      setError('Failed to fetch air quality data');\n    }\n  };\n\n  // Mock nearby locations - in a real app, these would come from an API\n  const nearbyLocations: NearbyLocation[] = [\n    {\n      id: \"1\",\n      name: \"Downtown Area\",\n      distance: \"2.1 km\",\n      aqi: 45,\n      coordinates: [0, 0], // Will be updated with real coordinates\n    },\n    {\n      id: \"2\",\n      name: \"City Park\",\n      distance: \"3.8 km\",\n      aqi: 38,\n      coordinates: [0, 0], // Will be updated with real coordinates\n    },\n    {\n      id: \"3\",\n      name: \"Industrial District\",\n      distance: \"4.2 km\",\n      aqi: 52,\n      coordinates: [0, 0], // Will be updated with real coordinates\n    },\n    {\n      id: \"4\",\n      name: \"Residential Area\",\n      distance: \"5.1 km\",\n      aqi: 35,\n      coordinates: [0, 0], // Will be updated with real coordinates\n    },\n  ];\n\n  const getUserLocation = async (): Promise<void> => {\n    setLoading(true);\n    setLocationRequested(true);\n    setError(null);\n    \n    // Check if geolocation is supported\n    if (!navigator.geolocation) {\n      setError('Geolocation is not supported by your browser');\n      setLoading(false);\n      return;\n    }\n\n    // Check if we have permission to access location\n    if (navigator.permissions && navigator.permissions.query) {\n      try {\n        const permissionStatus = await navigator.permissions.query({ name: 'geolocation' });\n        if (permissionStatus.state === 'denied') {\n          setError('Location access denied. Please enable location permissions in your browser settings.');\n          setLoading(false);\n          return;\n        }\n      } catch (error) {\n        console.log('Permission API not supported, proceeding with geolocation request');\n      }\n    }\n\n    try {\n      console.log('MapView: Starting geolocation request...');\n      const position = await new Promise<GeolocationPosition>((resolve, reject) => {\n        navigator.geolocation.getCurrentPosition(resolve, reject, {\n          timeout: 30000, // 30 seconds - mobile devices need more time\n          enableHighAccuracy: false, // Disable high accuracy for mobile compatibility\n          maximumAge: 10 * 60 * 1000 // Allow 10-minute old data for mobile\n        });\n      });\n\n      console.log('MapView: Geolocation successful, coordinates:', position.coords.latitude, position.coords.longitude);\n      const { latitude, longitude } = position.coords;\n      \n      // Get city name from coordinates using reverse geocoding\n      const cityName = await getCityFromCoordinates(latitude, longitude);\n      \n      setUserLocation({\n        latitude,\n        longitude,\n        city: cityName.city || 'Your Location',\n        state: cityName.state || '',\n        country: cityName.country || ''\n      });\n\n      // Fetch real air quality data\n      await fetchAirQualityData(latitude, longitude);\n\n      // Update nearby locations with real coordinates\n      updateNearbyLocations(latitude, longitude);\n      \n    } catch (err: any) {\n      console.error('Error getting location:', err);\n      \n      let errorMessage = 'Failed to get your location.';\n      \n      if (err.code === 1) {\n        errorMessage = 'Location access denied. Please enable location permissions in your browser settings.';\n      } else if (err.code === 2) {\n        errorMessage = 'Location unavailable. This usually happens on new accounts or when location services are not ready. Please try again in a few moments.';\n      } else if (err.code === 3) {\n        errorMessage = 'Location timeout. Please wait a moment and try again.';\n      }\n      \n      setError(errorMessage);\n      \n      // For new users or location unavailable, provide fallback location\n      if (err.code === 2) {\n        console.log('MapView: Providing fallback location for new user, retry count:', retryCount);\n        \n        if (retryCount < 3) {\n          // Increment retry count and show retry message\n          setRetryCount(prev => prev + 1);\n          \n          // Show user-friendly retry message\n          const attemptNumber = retryCount + 1;\n          toast({\n            title: \"Setting Up Location Services\",\n            description: `Attempt ${attemptNumber}/3: Configuring location services for your account. This may take a moment.`,\n            variant: \"default\",\n          });\n          \n          // Log retry attempt for debugging\n          console.log(`MapView: Retry attempt ${attemptNumber}/3 for new user geolocation`);\n        } else {\n          // After 3 retries, show error instead of demo data\n          console.log('MapView: All retry attempts failed, showing error');\n          setError('Location services are not available after multiple attempts. Please try again later.');\n          \n          // No demo data - show error instead\n          setError('Location services are not available. Please try again later.');\n        }\n      } else {\n        toast({\n          title: \"Location Access Required\",\n          description: \"This app needs your location to show air quality data. Please allow location access when prompted.\",\n          variant: \"destructive\",\n        });\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n\n\n  const getCityFromCoordinates = async (lat: number, lon: number): Promise<{city: string, state: string, country: string}> => {\n    try {\n      // Use environment variable for API key\n      const apiKey = import.meta.env.VITE_OPENWEATHERMAP_API_KEY;\n      \n      // If no API key is available, skip the API call and use coordinates\n      if (!apiKey || apiKey.trim() === '') {\n        console.warn('OpenWeatherMap API key not configured, using coordinates as fallback');\n        return {\n          city: `Location`,\n          state: `(${lat.toFixed(4)}, ${lon.toFixed(4)})`,\n          country: ''\n        };\n      }\n      \n      const response = await fetch(\n        `https://api.openweathermap.org/geo/1.0/reverse?lat=${lat}&lon=${lon}&limit=1&appid=${apiKey}`\n      );\n      \n      if (!response.ok) {\n        throw new Error(`API request failed: ${response.status}`);\n      }\n      \n      const data = await response.json();\n      const location = data[0];\n      \n      return {\n        city: location?.name || 'Your Location',\n        state: location?.state || '',\n        country: location?.country || ''\n      };\n    } catch (err) {\n      console.error('Error getting city name:', err);\n      // Fallback to coordinates if API fails\n      return {\n        city: `Your Location`,\n        state: `(${lat.toFixed(4)}, ${lon.toFixed(4)})`,\n        country: ''\n      };\n    }\n  };\n\n  const updateNearbyLocations = (userLat: number, userLon: number): void => {\n    // TODO: In a real app, you would fetch nearby monitoring stations from an API\n    // For now, we'll use the user's actual coordinates\n    if (nearbyLocations.length > 0) {\n      nearbyLocations[0].coordinates = [userLat, userLon];\n      nearbyLocations[0].name = \"Your Location\";\n    }\n  };\n\n  const getAQIColor = (aqi: number): string => {\n    if (aqi <= 50) return \"bg-green-500\";\n    if (aqi <= 100) return \"bg-yellow-500\";\n    if (aqi <= 150) return \"bg-orange-500\";\n    if (aqi <= 200) return \"bg-red-500\";\n    if (aqi <= 300) return \"bg-purple-500\";\n    return \"bg-red-800\";\n  };\n\n  const getAQILabel = (aqi: number): string => {\n    if (aqi <= 50) return \"Good\";\n    if (aqi <= 100) return \"Moderate\";\n    if (aqi <= 150) return \"Unhealthy for Sensitive Groups\";\n    if (aqi <= 200) return \"Unhealthy\";\n    if (aqi <= 300) return \"Very Unhealthy\";\n    return \"Hazardous\";\n  };\n\n  const resetLocationPermission = () => {\n    localStorage.removeItem('breath-safe-location-permission');\n    setRetryCount(0);\n    setError(null);\n    setUserLocation(null);\n    setAirQualityData(null);\n    setLocationRequested(false);\n  };\n\n  // Auto-retry geolocation for new users after a delay\n  useEffect(() => {\n    if (error && retryCount > 0 && retryCount < 3) {\n      const timer = setTimeout(() => {\n        console.log(`MapView: Auto-retrying geolocation for new user (attempt ${retryCount + 1}/3)...`);\n        \n        // Show user feedback about the auto-retry\n        toast({\n          title: \"Retrying Location Services\",\n          description: `Automatically retrying to get your location... (${retryCount + 1}/3)`,\n          variant: \"default\",\n        });\n        \n        getUserLocation();\n      }, 2000); // Wait 2 seconds before retry\n      \n      return () => clearTimeout(timer);\n    }\n  }, [error, retryCount]);\n\n  if (loading) {\n    return (\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <Header\n          title=\"Air Quality Map\"\n          subtitle=\"Explore air quality data across your region\"\n          showMobileMenu={showMobileMenu}\n          onMobileMenuToggle={onMobileMenuToggle}\n        />\n\n        <div className=\"flex items-center justify-center min-h-[400px]\">\n          <div className=\"text-center space-y-4\">\n            <Loader2 className=\"h-8 w-8 animate-spin mx-auto text-primary\" />\n            <p className=\"text-muted-foreground\">Getting your location...</p>\n            <p className=\"text-xs text-muted-foreground\">Please allow location access when prompted</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!locationRequested && !userLocation) {\n    return (\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <Header\n          title=\"Air Quality Map\"\n          subtitle=\"Explore air quality data across your region\"\n          showMobileMenu={showMobileMenu}\n          onMobileMenuToggle={onMobileMenuToggle}\n        />\n\n        <div className=\"flex items-center justify-center min-h-[400px]\">\n          <div className=\"text-center space-y-4 max-w-md\">\n            <MapPin className=\"h-12 w-12 text-primary mx-auto\" />\n            <h3 className=\"text-lg font-semibold\">Enable Location Services</h3>\n            <p className=\"text-muted-foreground\">\n              Allow location access to view air quality data and nearby monitoring stations on the map.\n            </p>\n            \n            <div className=\"text-sm text-muted-foreground space-y-2 p-4 bg-muted/50 rounded-lg\">\n              <p><strong>What we'll show you:</strong></p>\n              <ul className=\"text-left list-disc list-inside space-y-1\">\n                <li>Your current location on the map</li>\n                <li>Nearby air quality monitoring stations</li>\n                <li>Real-time air quality data for your area</li>\n                <li>Interactive map with detailed station information</li>\n              </ul>\n            </div>\n            \n            <Button onClick={getUserLocation} className=\"w-full\" size=\"lg\">\n              <MapPin className=\"h-4 w-4 mr-2\" />\n              Enable Location & View Map\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <Header\n          title=\"Air Quality Map\"\n          subtitle=\"Explore air quality data across your region\"\n          showMobileMenu={showMobileMenu}\n          onMobileMenuToggle={onMobileMenuToggle}\n        />\n\n        <div className=\"flex items-center justify-center min-h-[400px]\">\n          <div className=\"text-center space-y-4 max-w-md\">\n            <AlertTriangle className=\"h-12 w-12 text-destructive mx-auto\" />\n            <h3 className=\"text-lg font-semibold\">Location Access Required</h3>\n            <p className=\"text-muted-foreground max-w-sm\">{error}</p>\n            \n            <div className=\"text-sm text-muted-foreground space-y-2 p-4 bg-muted/50 rounded-lg\">\n              <p><strong>How to enable location access:</strong></p>\n              <ol className=\"text-left list-decimal list-inside space-y-1\">\n                <li>Allow location access when prompted</li>\n                <li>Check browser settings if no prompt appears</li>\n                <li>On mobile: Settings → Privacy → Location Services</li>\n                <li>Refresh the page after enabling location</li>\n              </ol>\n            </div>\n            \n            <div className=\"flex flex-col gap-2\">\n              {retryCount > 0 && retryCount < 3 && (\n                <div className=\"text-xs text-muted-foreground text-center p-2 bg-muted/30 rounded\">\n                  Attempt {retryCount}/3 - Auto-retrying in a few seconds...\n                </div>\n              )}\n\n              <Button onClick={getUserLocation} variant=\"outline\" className=\"w-full\">\n                <MapPin className=\"h-4 w-4 mr-2\" />\n                Try Again Now\n              </Button>\n              <Button \n                onClick={resetLocationPermission} \n                variant=\"secondary\"\n                className=\"w-full\"\n              >\n                Start Fresh\n              </Button>\n              <Button \n                onClick={() => window.location.reload()} \n                variant=\"secondary\"\n                className=\"w-full\"\n              >\n                Refresh Page\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <Header\n        title=\"Air Quality Map\"\n        subtitle=\"Explore air quality data across your region\"\n        showMobileMenu={showMobileMenu}\n        onMobileMenuToggle={onMobileMenuToggle}\n      />\n\n      {/* Map Container */}\n      <div className=\"relative h-[calc(100vh-200px)] min-h-[600px]\">\n        {/* Leaflet Map Integration - Full width/height */}\n        <div className=\"w-full h-full rounded-lg overflow-hidden border border-border\">\n          <LeafletMap \n            userLocation={userLocation}\n            airQualityData={airQualityData}\n            nearbyLocations={nearbyLocations}\n          />\n        </div>\n\n        {/* Floating Header */}\n        <div className=\"absolute top-4 left-4 right-4 z-10\">\n          <GlassCard className=\"floating-card\">\n            <GlassCardContent className=\"p-3\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <h1 className=\"text-lg font-bold text-foreground\">\n                    Air Quality Map\n                  </h1>\n                  <p className=\"text-xs text-muted-foreground\">\n                    {userLocation ? `${userLocation.city}, ${userLocation.country}` : 'Loading location...'}\n                  </p>\n\n                </div>\n                <Button variant=\"outline\" size=\"sm\" className=\"gap-2\">\n                  <Layers className=\"h-4 w-4\" />\n                  Layers\n                </Button>\n              </div>\n            </GlassCardContent>\n          </GlassCard>\n        </div>\n\n        {/* Bottom Sheet for Stations */}\n        <div className=\"absolute bottom-0 left-0 right-0 z-10\">\n          <div className=\"bg-card/95 backdrop-blur-sm border-t border-border rounded-t-2xl shadow-2xl\">\n            {/* Drag Handle */}\n            <div className=\"flex justify-center pt-3 pb-2\">\n              <div className=\"w-12 h-1 bg-muted-foreground/30 rounded-full\"></div>\n            </div>\n            \n            {/* Current Location Summary */}\n            {userLocation && (\n              <div className=\"px-4 pb-3 border-b border-border\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <Navigation className=\"h-4 w-4 text-primary\" />\n                    <div>\n                      <div className=\"font-medium text-sm\">\n                        {userLocation.city}\n                        {userLocation.state && `, ${userLocation.state}`}\n                        {userLocation.country && `, ${userLocation.country}`}\n                      </div>\n                      <div className=\"text-xs text-muted-foreground\">\n                        {userLocation.latitude.toFixed(4)}, {userLocation.longitude.toFixed(4)}\n                      </div>\n                    </div>\n                  </div>\n                  <Badge \n                    variant=\"secondary\"\n                    className={`${getAQIColor(airQualityData?.aqi || 0)} text-white border-0`}\n                  >\n                    AQI {airQualityData?.aqi || 'Loading...'}\n                  </Badge>\n                </div>\n              </div>\n            )}\n\n            {/* Stations List */}\n            <div className=\"px-4 py-3 max-h-64 overflow-y-auto\">\n              <h3 className=\"text-sm font-semibold text-foreground mb-3\">\n                Nearby Monitoring Stations\n              </h3>\n              \n              <div className=\"space-y-2\">\n                {nearbyLocations.map((location) => (\n                  <div key={location.id} className=\"flex items-center justify-between p-3 bg-muted/30 rounded-lg hover:bg-muted/50 transition-colors\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className={`w-3 h-3 rounded-full ${getAQIColor(location.aqi)}`} />\n                      <div>\n                        <div className=\"font-medium text-sm\">{location.name}</div>\n                        <div className=\"text-xs text-muted-foreground\">{location.distance}</div>\n                      </div>\n                    </div>\n                    <Badge \n                      variant=\"secondary\"\n                      className={`${getAQIColor(location.aqi)} text-white border-0 text-xs`}\n                    >\n                      AQI {location.aqi}\n                    </Badge>\n                  </div>\n                ))}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* AQI Data Charts Section */}\n      {airQualityData ? (\n        <div className=\"mt-8\">\n          <AQIDataCharts\n            aqi={airQualityData.aqi}\n            pm25={airQualityData.pm25 || 0}\n            pm10={airQualityData.pm10 || 0}\n            no2={airQualityData.no2 || 0}\n            so2={airQualityData.so2 || 0}\n            co={airQualityData.co || 0}\n            o3={airQualityData.o3 || 0}\n            timestamp={airQualityData.timestamp}\n          />\n        </div>\n      ) : (\n        // Show loading state instead of demo data to prevent data contamination\n        <div className=\"mt-8\">\n          <div className=\"text-center py-8\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\n            <p className=\"text-muted-foreground\">Loading air quality data...</p>\n            <p className=\"text-sm text-muted-foreground mt-2\">Please ensure location permissions are enabled</p>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\MobileNavigation.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'view' is defined but never used.","line":10,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"view"},"fix":{"range":[438,450],"text":""},"desc":"Remove unused variable 'view'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { Button } from \"@/components/ui/button\";\nimport { X, Home, History, Map, Trophy, ShoppingBag, User, Settings, LogOut, Sun, Moon } from \"lucide-react\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { useTheme } from \"@/contexts/ThemeContext\";\n\ninterface MobileNavigationProps {\n  currentView: string;\n  onViewChange: (view: string) => void;\n  isOpen?: boolean;\n  onClose?: () => void;\n}\n\nexport default function MobileNavigation({ currentView, onViewChange, isOpen, onClose }: MobileNavigationProps): JSX.Element {\n  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);\n  const { signOut } = useAuth();\n  const { theme, setTheme, isDark } = useTheme();\n\n  // Use external state if provided, otherwise use internal state\n  const isMenuOpen = isOpen !== undefined ? isOpen : isMobileMenuOpen;\n  const toggleMobileMenu = onClose ? onClose : () => setIsMobileMenuOpen(!isMobileMenuOpen);\n\n  const handleViewChange = (view: string) => {\n    onViewChange(view);\n    if (onClose) {\n      onClose(); // Use external close function if provided\n    } else {\n      setIsMobileMenuOpen(false); // Otherwise use internal state\n    }\n  };\n\n  // Handle Escape key to close mobile menu\n  useEffect(() => {\n    const handleEscape = (event: KeyboardEvent) => {\n      if (event.key === 'Escape' && isMenuOpen) {\n        if (onClose) {\n          onClose();\n        } else {\n          setIsMobileMenuOpen(false);\n        }\n      }\n    };\n\n    if (isMenuOpen) {\n      document.addEventListener('keydown', handleEscape);\n      return () => document.removeEventListener('keydown', handleEscape);\n    }\n  }, [isMenuOpen, onClose]);\n\n  // Prevent body scroll when menu is open\n  useEffect(() => {\n    if (isMenuOpen) {\n      document.body.style.overflow = 'hidden';\n    } else {\n      document.body.style.overflow = 'unset';\n    }\n\n    return () => {\n      document.body.style.overflow = 'unset';\n    };\n  }, [isMenuOpen]);\n\n  const navItems = [\n    { id: \"dashboard\", label: \"Dashboard\", icon: Home },\n    { id: \"history\", label: \"History\", icon: History },\n    { id: \"map\", label: \"Weather\", icon: Map },\n    { id: \"news\", label: \"News\", icon: History },\n    { id: \"rewards\", label: \"Rewards\", icon: Trophy },\n    { id: \"store\", label: \"Store\", icon: ShoppingBag },\n    { id: \"profile\", label: \"Profile\", icon: User },\n    { id: \"settings\", label: \"Settings\", icon: Settings },\n  ];\n\n  const handleSignOut = async () => {\n    try {\n      await signOut();\n      if (onClose) onClose();\n    } catch (error) {\n      console.error('Error signing out:', error);\n    }\n  };\n\n  const toggleTheme = () => {\n    if (theme === 'light') {\n      setTheme('dark');\n    } else if (theme === 'dark') {\n      setTheme('light');\n    } else {\n      // If system, toggle to opposite of current effective theme\n      setTheme(isDark ? 'light' : 'dark');\n    }\n  };\n\n  return (\n    <>\n      {/* Mobile Navigation Overlay */}\n      <AnimatePresence>\n        {isMenuOpen && (\n          <motion.div \n            className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 md:hidden\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            onClick={toggleMobileMenu}\n          />\n        )}\n      </AnimatePresence>\n\n      {/* Mobile Navigation Drawer */}\n      <AnimatePresence>\n        {isMenuOpen && (\n          <motion.div\n            className=\"fixed left-0 top-0 h-full w-80 max-w-[85vw] bg-card border-r border-border z-50 md:hidden\"\n            initial={{ x: -320 }}\n            animate={{ x: 0 }}\n            exit={{ x: -320 }}\n            transition={{ type: \"spring\", damping: 25, stiffness: 200 }}\n          >\n            {/* Header */}\n            <div className=\"flex items-center justify-between p-6 border-b border-border\">\n              <motion.div \n                className=\"flex items-center gap-3\"\n                whileHover={{ scale: 1.02 }}\n              >\n                <div className=\"w-10 h-10 bg-gradient-to-br from-primary to-secondary rounded-xl flex items-center justify-center shadow-lg\">\n                  <span className=\"text-primary-foreground font-bold text-lg\">B</span>\n                </div>\n                <div>\n                  <h2 className=\"text-lg font-semibold text-foreground\">Breath Safe</h2>\n                  <p className=\"text-sm text-muted-foreground\">Navigation</p>\n                </div>\n              </motion.div>\n              \n              <motion.div\n                whileHover={{ scale: 1.05 }}\n                whileTap={{ scale: 0.95 }}\n              >\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  onClick={toggleMobileMenu}\n                  className=\"h-10 w-10 rounded-full border-border hover:bg-accent hover:border-accent transition-all duration-200\"\n                  aria-label=\"Close mobile menu\"\n                >\n                  <X className=\"h-5 w-5\" />\n                </Button>\n              </motion.div>\n            </div>\n\n            {/* Navigation Items */}\n            <nav className=\"flex-1 p-6 space-y-2\">\n              {navItems.map((item, index) => {\n                const Icon = item.icon;\n                const isActive = currentView === item.id;\n                \n                return (\n                  <motion.div\n                    key={item.id}\n                    initial={{ opacity: 0, x: -20 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    transition={{ \n                      delay: 0.1 + index * 0.05, \n                      duration: 0.3,\n                      ease: \"easeOut\"\n                    }}\n                  >\n                    <motion.div\n                      whileHover={{ scale: 1.02 }}\n                      whileTap={{ scale: 0.98 }}\n                    >\n                      <Button\n                        variant={isActive ? \"default\" : \"ghost\"}\n                        onClick={() => handleViewChange(item.id)}\n                        className={`w-full justify-start h-12 rounded-xl transition-all duration-200 ${\n                          isActive \n                            ? 'bg-gradient-to-r from-primary to-secondary text-primary-foreground shadow-lg border-accent' \n                            : 'text-muted-foreground hover:text-foreground hover:bg-accent hover:border-accent border-transparent'\n                        } border`}\n                        aria-label={`${item.label}${isActive ? ' (current page)' : ''}`}\n                        aria-current={isActive ? 'page' : undefined}\n                      >\n                        <Icon className=\"h-5 w-5 mr-3\" />\n                        {item.label}\n                      </Button>\n                    </motion.div>\n                  </motion.div>\n                );\n              })}\n            </nav>\n\n            {/* Bottom Section - Theme Toggle and Sign Out */}\n            <div className=\"p-6 border-t border-border space-y-4\">\n              {/* Theme Toggle */}\n              <motion.div\n                whileHover={{ scale: 1.02 }}\n                whileTap={{ scale: 0.98 }}\n              >\n                <Button\n                  variant=\"outline\"\n                  onClick={toggleTheme}\n                  className=\"w-full justify-start h-12 rounded-xl border-border hover:bg-accent hover:border-accent transition-all duration-200\"\n                  aria-label=\"Switch to light/dark mode\"\n                >\n                  {isDark ? <Sun className=\"h-5 w-5 mr-3\" /> : <Moon className=\"h-5 w-5 mr-3\" />}\n                  {isDark ? 'Light Mode' : 'Dark Mode'}\n                </Button>\n              </motion.div>\n\n              {/* Sign Out */}\n              <motion.div\n                whileHover={{ scale: 1.02 }}\n                whileTap={{ scale: 0.98 }}\n              >\n                <Button\n                  variant=\"destructive\"\n                  onClick={handleSignOut}\n                  className=\"w-full justify-start h-12 rounded-xl\"\n                  aria-label=\"Sign out\"\n                >\n                  <LogOut className=\"h-5 w-5 mr-3\" />\n                  Sign Out\n                </Button>\n              </motion.div>\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\Navigation.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'view' is defined but never used.","line":6,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"view"},"fix":{"range":[196,208],"text":""},"desc":"Remove unused variable 'view'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button } from \"@/components/ui/button\";\nimport { Home, History, Map, User, Trophy, ShoppingBag } from \"lucide-react\";\n\ninterface NavigationProps {\n  currentView: string;\n  onViewChange: (view: string) => void;\n}\n\nexport default function Navigation({ currentView, onViewChange }: NavigationProps): JSX.Element {\n  const navItems = [\n    { id: \"dashboard\", label: \"Home\", icon: Home },\n    { id: \"history\", label: \"History\", icon: History },\n    { id: \"map\", label: \"Map\", icon: Map },\n    { id: \"rewards\", label: \"Rewards\", icon: Trophy },\n    { id: \"store\", label: \"Store\", icon: ShoppingBag },\n    { id: \"profile\", label: \"Profile\", icon: User },\n  ];\n\n  return (\n    <div className=\"fixed bottom-0 left-0 right-0 bg-card border-t border-border card-shadow navbar-height flex items-center px-page\">\n      <div className=\"flex justify-around items-center w-full max-w-md mx-auto\">\n        {navItems.map((item) => {\n          const Icon = item.icon;\n          const isActive = currentView === item.id;\n          \n          return (\n            <Button\n              key={item.id}\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={() => onViewChange(item.id)}\n              className={`flex-col gap-1 h-auto py-2 px-3 rounded-ds-medium transition-smooth ${\n                isActive \n                  ? 'text-primary bg-primary/10 shadow-sm' \n                  : 'text-muted-foreground hover:text-foreground hover:bg-accent/50'\n              }`}\n            >\n              <Icon className=\"h-5 w-5\" />\n              <span className=\"text-xs font-medium\">{item.label}</span>\n            </Button>\n          );\n        })}\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\NewsCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\NewsPage.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Filter' is defined but never used.","line":8,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":49,"suggestions":[{"messageId":"removeVar","data":{"varName":"Filter"},"fix":{"range":[478,486],"text":""},"desc":"Remove unused variable 'Filter'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Filter' is defined but never used.","line":8,"column":43,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":49},{"ruleId":"no-unused-vars","severity":1,"message":"'Calendar' is defined but never used.","line":8,"column":51,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":59,"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[486,496],"text":""},"desc":"Remove unused variable 'Calendar'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calendar' is defined but never used.","line":8,"column":51,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":59},{"ruleId":"no-unused-vars","severity":1,"message":"'getLatestArticles' is defined but never used.","line":9,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":36,"suggestions":[{"messageId":"removeVar","data":{"varName":"getLatestArticles"},"fix":{"range":[546,565],"text":""},"desc":"Remove unused variable 'getLatestArticles'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getLatestArticles' is defined but never used.","line":9,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":36},{"ruleId":"no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":73,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":73,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":73,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":73,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":109,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":109,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":109,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":109,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from \"@/components/ui/GlassCard\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Clock, User, ArrowRight, Search, Filter, Calendar, BookOpen } from \"lucide-react\";\nimport { Article, getLatestArticles, getAllArticles } from \"@/data/articles\";\nimport ArticleModal from \"./ArticleModal\";\nimport Header from \"@/components/Header\";\nimport React from \"react\";\n\ninterface NewsPageProps {\n  showMobileMenu?: boolean;\n  onMobileMenuToggle?: () => void;\n}\n\nexport default function NewsPage({ showMobileMenu, onMobileMenuToggle }: NewsPageProps) {\n  const [selectedArticle, setSelectedArticle] = useState<Article | null>(null);\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedCategory, setSelectedCategory] = useState<string>(\"all\");\n  const [sortBy, setSortBy] = useState<string>(\"latest\");\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [allArticles, setAllArticles] = useState<Article[]>([]);\n  \n  // Move data fetching to useEffect to prevent render-time side effects\n  useEffect(() => {\n    const loadArticles = async () => {\n      try {\n        setIsLoading(true);\n        setError(null);\n        const articles = getAllArticles();\n        setAllArticles(articles);\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Failed to load articles');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    \n    loadArticles();\n  }, []);\n  \n  // Filter and sort articles with null safety\n  const filteredArticles = React.useMemo(() => {\n    try {\n      return allArticles\n        .filter(article => {\n          // Ensure article exists and has required properties\n          if (!article || !article.title || !article.excerpt || !article.category) {\n            return false;\n          }\n          \n          const matchesSearch = article.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n                               article.excerpt.toLowerCase().includes(searchQuery.toLowerCase());\n          const matchesCategory = selectedCategory === \"all\" || article.category === selectedCategory;\n          return matchesSearch && matchesCategory;\n        })\n        .sort((a, b) => {\n          try {\n            switch (sortBy) {\n              case \"latest\":\n                return new Date(b.publishedAt).getTime() - new Date(a.publishedAt).getTime();\n              case \"oldest\":\n                return new Date(a.publishedAt).getTime() - new Date(b.publishedAt).getTime();\n              case \"title\":\n                return a.title.localeCompare(b.title);\n              default:\n                return 0;\n            }\n          } catch (err) {\n            return 0; // Fallback to no sorting if date parsing fails\n          }\n        });\n    } catch (err) {\n      console.error('Error filtering articles:', err);\n      return [];\n    }\n  }, [allArticles, searchQuery, selectedCategory, sortBy]);\n\n  const getCategoryColor = (category: Article['category']) => {\n    if (!category) {\n      return 'bg-muted/10 text-muted-foreground border-muted/20';\n    }\n    \n    switch (category) {\n      case 'health':\n        return 'bg-error/10 text-error border-error/20';\n      case 'environment':\n        return 'bg-success/10 text-success border-success/20';\n      case 'research':\n        return 'bg-primary/10 text-primary border-primary/20';\n      case 'tips':\n        return 'bg-warning/10 text-warning border-warning/20';\n      default:\n        return 'bg-muted/10 text-muted-foreground border-muted/20';\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    try {\n      return new Date(dateString).toLocaleDateString('en-US', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric'\n      });\n    } catch (err) {\n      return 'Invalid date';\n    }\n  };\n\n  const categories = [\n    { value: \"all\", label: \"All Categories\" },\n    { value: \"health\", label: \"Health\" },\n    { value: \"environment\", label: \"Environment\" },\n    { value: \"research\", label: \"Research\" },\n    { value: \"tips\", label: \"Tips & Advice\" }\n  ];\n\n  const sortOptions = [\n    { value: \"latest\", label: \"Latest First\" },\n    { value: \"oldest\", label: \"Oldest First\" },\n    { value: \"title\", label: \"Alphabetical\" }\n  ];\n\n  return (\n    <div className=\"space-y-6 lg:space-y-8\">\n      <Header\n        title=\"Health & Environment News\"\n        subtitle=\"Stay informed with the latest research, tips, and environmental insights\"\n        showMobileMenu={showMobileMenu}\n        onMobileMenuToggle={onMobileMenuToggle}\n      />\n\n      {/* Loading State */}\n      {isLoading && (\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.6, ease: \"easeOut\" }}\n          className=\"text-center py-12\"\n        >\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto\"></div>\n          <p className=\"mt-4 text-muted-foreground\">Loading articles...</p>\n        </motion.div>\n      )}\n\n      {/* Error State */}\n      {error && (\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.6, ease: \"easeOut\" }}\n          className=\"text-center py-12\"\n        >\n          <div className=\"max-w-md mx-auto space-y-4\">\n            <div className=\"w-24 h-24 bg-destructive/10 rounded-full flex items-center justify-center mx-auto\">\n              <BookOpen className=\"w-12 h-12 text-destructive\" />\n            </div>\n            <h3 className=\"text-xl font-semibold\">Failed to Load Articles</h3>\n            <p className=\"text-muted-foreground\">{error}</p>\n            <Button\n              variant=\"outline\"\n              onClick={() => window.location.reload()}\n            >\n              Try Again\n            </Button>\n          </div>\n        </motion.div>\n      )}\n\n      {/* Only show content when not loading and no errors */}\n      {!isLoading && !error && (\n        <>\n          {/* Search and Filter Controls */}\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.6, ease: \"easeOut\" }}\n            className=\"space-y-4\"\n          >\n            <GlassCard variant=\"elevated\" className=\"bg-gradient-to-r from-card/80 to-card/60 backdrop-blur-sm border border-border/20\">\n              <GlassCardHeader>\n                <GlassCardTitle className=\"text-xl font-semibold\">Search & Filter</GlassCardTitle>\n              </GlassCardHeader>\n              <GlassCardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                  <div className=\"relative\">\n                    <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4\" />\n                    <Input\n                      placeholder=\"Search articles...\"\n                      value={searchQuery}\n                      onChange={(e) => setSearchQuery(e.target.value)}\n                      className=\"pl-10\"\n                    />\n                  </div>\n                  <Select value={selectedCategory} onValueChange={setSelectedCategory}>\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"All Categories\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"all\">All Categories</SelectItem>\n                      {categories.map((category) => (\n                        <SelectItem key={category.value} value={category.value}>\n                          {category.label}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  <Select value={sortBy} onValueChange={setSortBy}>\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Sort by\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {sortOptions.map((option) => (\n                        <SelectItem key={option.value} value={option.value}>\n                          {option.label}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n              </GlassCardContent>\n            </GlassCard>\n          </motion.div>\n\n          {/* Results Summary */}\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.6, ease: \"easeOut\", delay: 0.1 }}\n            className=\"flex items-center justify-between\"\n          >\n            <div className=\"flex items-center gap-2 text-muted-foreground\">\n              <BookOpen className=\"h-4 w-4\" />\n              <span>{filteredArticles.length} article{filteredArticles.length !== 1 ? 's' : ''} found</span>\n            </div>\n            {searchQuery && (\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => setSearchQuery(\"\")}\n                className=\"text-muted-foreground hover:text-foreground\"\n              >\n                Clear search\n              </Button>\n            )}\n          </motion.div>\n\n          {/* Articles Grid */}\n          <motion.div\n            className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\"\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.6, ease: \"easeOut\", delay: 0.2 }}\n          >\n            {filteredArticles.map((article, index) => {\n              // Additional safety check for article properties\n              if (!article || !article.id || !article.title || !article.imageUrl) {\n                return null; // Skip rendering invalid articles\n              }\n              \n              return (\n                <motion.div\n                  key={article.id}\n                  className=\"group cursor-pointer\"\n                  onClick={() => setSelectedArticle(article)}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ \n                    delay: 0.3 + index * 0.1, \n                    duration: 0.5,\n                    ease: \"easeOut\"\n                  }}\n                  whileHover={{ \n                    scale: 1.02,\n                    transition: { duration: 0.2 }\n                  }}\n                >\n                  <GlassCard variant=\"elevated\" className=\"relative overflow-hidden h-full bg-gradient-to-br from-card/80 via-card/60 to-card/40 backdrop-blur-sm border border-border/20 shadow-xl hover:shadow-2xl transition-all duration-300 group-hover:border-primary/30\">\n                    {/* Glowing border effect */}\n                    <div className=\"absolute inset-0 bg-gradient-to-r from-primary/20 via-transparent to-secondary/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-lg\"></div>\n                    \n                    {/* Gradient overlay */}\n                    <div className=\"absolute inset-0 bg-gradient-to-br from-primary/5 via-transparent to-secondary/5 rounded-lg\"></div>\n                    \n                    {/* Article Image */}\n                    <div className=\"relative h-48 overflow-hidden rounded-t-lg\">\n                      <img \n                        src={article.imageUrl} \n                        alt={article.title}\n                        loading=\"lazy\"\n                        className=\"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105\"\n                      />\n                      <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent\"></div>\n                      \n                      {/* Category Badge */}\n                      <div className=\"absolute top-4 left-4\">\n                        <Badge className={`${getCategoryColor(article.category)} backdrop-blur-sm`}>\n                          {article.category}\n                        </Badge>\n                      </div>\n                    </div>\n\n                    <GlassCardContent className=\"relative p-6 space-y-4\">\n                      {/* Article Meta */}\n                      <div className=\"flex items-center gap-4 text-xs text-muted-foreground\">\n                        <div className=\"flex items-center gap-1\">\n                          <Clock className=\"h-3 w-3\" />\n                          <span>{formatDate(article.publishedAt)}</span>\n                        </div>\n                        <div className=\"flex items-center gap-1\">\n                          <User className=\"h-3 w-3\" />\n                          <span>{article.author}</span>\n                        </div>\n                      </div>\n\n                      {/* Article Title */}\n                      <h3 className=\"text-lg font-semibold text-foreground line-clamp-2 group-hover:text-primary transition-colors duration-200\">\n                        {article.title}\n                      </h3>\n\n                      {/* Article Excerpt */}\n                      <p className=\"text-sm text-muted-foreground line-clamp-3\">\n                        {article.excerpt}\n                      </p>\n\n                      {/* Read More Button */}\n                      <div className=\"flex items-center justify-between pt-2\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          className=\"text-primary hover:text-primary/80 hover:bg-primary/10 transition-all duration-200\"\n                        >\n                          Read More\n                          <ArrowRight className=\"h-3 w-3 ml-1 group-hover:translate-x-1 transition-transform duration-200\" />\n                        </Button>\n                        \n                        <div className=\"text-xs text-muted-foreground\">\n                          {article.readTime} min read\n                        </div>\n                      </div>\n                    </GlassCardContent>\n                  </GlassCard>\n                </motion.div>\n              );\n            })}\n          </motion.div>\n\n          {/* No Results Message */}\n          {filteredArticles.length === 0 && (\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.6, ease: \"easeOut\" }}\n              className=\"text-center py-12\"\n            >\n              <div className=\"max-w-md mx-auto space-y-4\">\n                <BookOpen className=\"h-16 w-16 text-muted-foreground mx-auto opacity-50\" />\n                <h3 className=\"text-lg font-semibold text-foreground\">No articles found</h3>\n                <p className=\"text-muted-foreground\">\n                  Try adjusting your search terms or filters to find what you're looking for.\n                </p>\n                <Button\n                  variant=\"outline\"\n                  onClick={() => {\n                    setSearchQuery(\"\");\n                    setSelectedCategory(\"all\");\n                  }}\n                >\n                  Clear all filters\n                </Button>\n              </div>\n            </motion.div>\n          )}\n\n          {/* Article Modal */}\n          {selectedArticle && (\n            <ArticleModal\n              article={selectedArticle}\n              onClose={() => setSelectedArticle(null)}\n            />\n          )}\n        </>\n      )}\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\NotificationBell.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Trash2' is defined but never used.","line":3,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"Trash2"},"fix":{"range":[106,114],"text":""},"desc":"Remove unused variable 'Trash2'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trash2' is defined but never used.","line":3,"column":26,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Bell, X, Check, Trash2, Settings } from \"lucide-react\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuTrigger,\n  DropdownMenuSeparator,\n} from \"@/components/ui/dropdown-menu\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { useNotifications } from \"@/hooks/useNotifications\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { cn } from \"@/lib/utils\";\n\ninterface NotificationBellProps {\n  onOpenSettings?: () => void;\n}\n\nexport default function NotificationBell({ onOpenSettings }: NotificationBellProps) {\n  const [isOpen, setIsOpen] = useState(false);\n  const { \n    notifications, \n    unreadCount, \n    markAsRead, \n    markAllAsRead, \n    deleteNotification,\n    isLoading \n  } = useNotifications();\n\n  const handleNotificationClick = async (notification: any) => {\n    if (!notification.read) {\n      await markAsRead(notification.id);\n    }\n    \n    // Handle action URL if present\n    if (notification.action_url) {\n      // In a real app, you'd navigate to the URL\n      console.log('Navigate to:', notification.action_url);\n    }\n    \n    setIsOpen(false);\n  };\n\n  const handleMarkAllRead = async () => {\n    await markAllAsRead();\n  };\n\n  const handleDeleteNotification = async (notificationId: string, e: React.MouseEvent) => {\n    e.stopPropagation();\n    await deleteNotification(notificationId);\n  };\n\n  const getPriorityColor = (priority: string) => {\n    switch (priority.toLowerCase()) {\n      case 'high': return 'text-red-500';\n      case 'medium': return 'text-yellow-500';\n      case 'low': return 'text-slate-500';\n      default: return 'text-slate-500';\n    }\n  };\n\n  const getNotificationIcon = (type: string) => {\n    switch (type) {\n      case 'aqi_alert': return '🚨';\n      case 'achievement_unlocked': return '🏆';\n      case 'points_earned': return '💰';\n      case 'withdrawal_approved': return '✅';\n      case 'withdrawal_rejected': return '❌';\n      case 'shop_new_item': return '🛍️';\n      case 'shop_sale': return '💸';\n      case 'streak_milestone': return '🔥';\n      case 'daily_reminder': return '⏰';\n      case 'weekly_summary': return '📊';\n      case 'system_announcement': return '📢';\n      case 'maintenance': return '🔧';\n      case 'welcome': return '🌟';\n      default: return '📩';\n    }\n  };\n\n  return (\n    <DropdownMenu open={isOpen} onOpenChange={setIsOpen}>\n      <DropdownMenuTrigger asChild>\n        <Button\n          variant=\"outline\"\n          size=\"icon\"\n          className=\"h-9 w-9 rounded-full border-border relative\"\n          aria-label={`Notifications (${unreadCount} unread)`}\n        >\n          <Bell className=\"h-4 w-4\" />\n          {unreadCount > 0 && (\n            <Badge \n              className=\"absolute -top-1 -right-1 h-5 w-5 rounded-full p-0 flex items-center justify-center text-xs bg-error text-error-foreground\"\n            >\n              {unreadCount > 99 ? '99+' : unreadCount}\n            </Badge>\n          )}\n        </Button>\n      </DropdownMenuTrigger>\n      \n      <DropdownMenuContent \n        align=\"end\" \n        className=\"w-80 p-0\"\n        sideOffset={8}\n      >\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-4 border-b\">\n          <h3 className=\"font-semibold text-sm\">Notifications</h3>\n          <div className=\"flex items-center gap-2\">\n            {unreadCount > 0 && (\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={handleMarkAllRead}\n                className=\"text-xs h-6 px-2\"\n              >\n                <Check className=\"h-3 w-3 mr-1\" />\n                Mark all read\n              </Button>\n            )}\n            {onOpenSettings && (\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                onClick={onOpenSettings}\n                className=\"h-6 w-6\"\n              >\n                <Settings className=\"h-3 w-3\" />\n              </Button>\n            )}\n          </div>\n        </div>\n\n        {/* Notifications List */}\n        <ScrollArea className=\"max-h-96\">\n          {isLoading ? (\n            <div className=\"flex items-center justify-center p-8\">\n              <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-primary\"></div>\n            </div>\n          ) : notifications.length === 0 ? (\n            <div className=\"flex flex-col items-center justify-center p-8 text-center\">\n              <Bell className=\"h-8 w-8 text-muted-foreground mb-2\" />\n              <p className=\"text-sm text-muted-foreground\">No notifications yet</p>\n              <p className=\"text-xs text-muted-foreground mt-1\">\n                We'll notify you about air quality alerts and achievements\n              </p>\n            </div>\n          ) : (\n            <div className=\"divide-y\">\n              {notifications.map((notification) => (\n                <div\n                  key={notification.id}\n                  className={cn(\n                    \"flex items-start gap-3 p-4 hover:bg-accent/50 cursor-pointer transition-colors\",\n                    !notification.read && \"bg-accent/30\"\n                  )}\n                  onClick={() => handleNotificationClick(notification)}\n                >\n                  {/* Icon */}\n                  <div className=\"flex-shrink-0 text-lg\">\n                    {getNotificationIcon(notification.type)}\n                  </div>\n                  \n                  {/* Content */}\n                  <div className=\"flex-1 min-w-0 space-y-1\">\n                    <div className=\"flex items-start justify-between gap-2\">\n                      <h4 className={cn(\n                        \"text-sm font-medium truncate\",\n                        !notification.read && \"font-semibold\"\n                      )}>\n                        {notification.title}\n                      </h4>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"icon\"\n                        onClick={(e) => handleDeleteNotification(notification.id, e)}\n                        className=\"h-6 w-6 flex-shrink-0 opacity-0 group-hover:opacity-100 hover:text-destructive\"\n                      >\n                        <X className=\"h-3 w-3\" />\n                      </Button>\n                    </div>\n                    \n                    <p className=\"text-xs text-muted-foreground line-clamp-2\">\n                      {notification.message}\n                    </p>\n                    \n                    <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                      <span>{formatDistanceToNow(new Date(notification.created_at), { addSuffix: true })}</span>\n                      <span className={cn(\"font-medium\", getPriorityColor(notification.priority))}>\n                        {notification.priority}\n                      </span>\n                      {!notification.read && (\n                        <div className=\"w-2 h-2 rounded-full bg-primary\"></div>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </ScrollArea>\n\n        {/* Footer */}\n        {notifications.length > 0 && (\n          <>\n            <DropdownMenuSeparator />\n            <div className=\"p-2\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                className=\"w-full text-xs justify-center\"\n                onClick={() => setIsOpen(false)}\n              >\n                View all notifications\n              </Button>\n            </div>\n          </>\n        )}\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\NotificationSettings.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":68,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":68,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":68,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":68,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from \"@/components/ui/GlassCard\";\nimport { Button } from \"@/components/ui/button\";\nimport { Label } from \"@/components/ui/label\";\nimport { Input } from \"@/components/ui/input\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { useToast } from \"@/components/ui/use-toast\";\nimport { useNotifications } from \"@/hooks/useNotifications\";\nimport { \n  Bell, \n  AlertTriangle, \n  Award, \n  DollarSign, \n  ShoppingBag, \n  Flame, \n  Clock, \n  BarChart, \n  Megaphone, \n  Settings,\n  Mail,\n  Smartphone\n} from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\ninterface NotificationSettingsProps {\n  className?: string;\n}\n\nexport default function NotificationSettings({ className }: NotificationSettingsProps) {\n  const { toast } = useToast();\n  const { preferences, updatePreferences, initializePreferences, isLoading } = useNotifications();\n  const [localPreferences, setLocalPreferences] = useState(preferences);\n  const [isSaving, setIsSaving] = useState(false);\n\n  useEffect(() => {\n    setLocalPreferences(preferences);\n  }, [preferences]);\n\n  // Initialize preferences if they don't exist\n  useEffect(() => {\n    if (!isLoading && !preferences) {\n      initializePreferences();\n    }\n  }, [isLoading, preferences, initializePreferences]);\n\n  const handleToggle = (key: string, value: boolean) => {\n    setLocalPreferences(prev => prev ? { ...prev, [key]: value } : null);\n  };\n\n  const handleThresholdChange = (value: string) => {\n    const numValue = parseInt(value, 10);\n    if (numValue >= 0 && numValue <= 500) {\n      setLocalPreferences(prev => prev ? { ...prev, aqi_threshold: numValue } : null);\n    }\n  };\n\n  const handleSave = async () => {\n    if (!localPreferences) return;\n\n    setIsSaving(true);\n    try {\n      await updatePreferences(localPreferences);\n      toast({\n        title: \"Settings saved\",\n        description: \"Your notification preferences have been updated.\",\n      });\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to save notification settings. Please try again.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const hasChanges = JSON.stringify(preferences) !== JSON.stringify(localPreferences);\n\n  if (isLoading) {\n    return (\n      <GlassCard className={cn(\"floating-card border-0\", className)}>\n        <GlassCardContent className=\"flex items-center justify-center p-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\n        </GlassCardContent>\n      </GlassCard>\n    );\n  }\n\n  if (!localPreferences) {\n    return (\n      <GlassCard className={cn(\"floating-card border-0\", className)}>\n        <GlassCardContent className=\"flex flex-col items-center justify-center p-8 text-center space-y-4\">\n          <Settings className=\"h-8 w-8 text-muted-foreground\" />\n          <div>\n            <h3 className=\"font-semibold mb-2\">Setting up notifications</h3>\n            <p className=\"text-sm text-muted-foreground\">\n              Please wait while we initialize your notification preferences...\n            </p>\n          </div>\n        </GlassCardContent>\n      </GlassCard>\n    );\n  }\n\n  const notificationTypes = [\n    {\n      key: 'aqi_alerts',\n      title: 'Air Quality Alerts',\n      description: 'Get notified when air quality exceeds your threshold',\n      icon: AlertTriangle,\n      hasThreshold: true,\n    },\n    {\n      key: 'achievement_notifications',\n      title: 'Achievement Unlocked',\n      description: 'Celebrate your progress and milestones',\n      icon: Award,\n    },\n    {\n      key: 'points_notifications',\n      title: 'Points Earned',\n      description: 'Stay updated on your point earnings',\n      icon: DollarSign,\n    },\n    {\n      key: 'withdrawal_notifications',\n      title: 'Withdrawal Updates',\n      description: 'Get notified about withdrawal status changes',\n      icon: DollarSign,\n    },\n    {\n      key: 'shop_notifications',\n      title: 'Shop & Store',\n      description: 'New products and sales announcements',\n      icon: ShoppingBag,\n    },\n    {\n      key: 'streak_notifications',\n      title: 'Streak Milestones',\n      description: 'Celebrate your consecutive day achievements',\n      icon: Flame,\n    },\n    {\n      key: 'daily_reminders',\n      title: 'Daily Reminders',\n      description: 'Gentle reminders to check air quality',\n      icon: Clock,\n    },\n    {\n      key: 'weekly_summaries',\n      title: 'Weekly Summaries',\n      description: 'Weekly reports on your air quality data',\n      icon: BarChart,\n    },\n    {\n      key: 'system_announcements',\n      title: 'System Announcements',\n      description: 'Important app updates and news',\n      icon: Megaphone,\n    },\n    {\n      key: 'maintenance_alerts',\n      title: 'Maintenance Alerts',\n      description: 'Scheduled maintenance and downtime notices',\n      icon: Settings,\n    },\n  ];\n\n  return (\n    <GlassCard className={cn(\"floating-card border-0\", className)}>\n      <GlassCardHeader>\n        <GlassCardTitle className=\"flex items-center gap-2\">\n          <Bell className=\"h-5 w-5\" />\n          Notification Settings\n        </GlassCardTitle>\n        <p className=\"text-sm text-muted-foreground\">\n          Customize how and when you receive notifications from Breath Safe.\n        </p>\n      </GlassCardHeader>\n\n      <GlassCardContent className=\"space-y-6\">\n        {/* Delivery Methods */}\n        <div className=\"space-y-4\">\n          <h3 className=\"font-semibold text-sm\">Delivery Methods</h3>\n          \n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <Smartphone className=\"h-4 w-4 text-muted-foreground\" />\n              <div>\n                <Label className=\"text-sm font-medium\">Push Notifications</Label>\n                <p className=\"text-xs text-muted-foreground\">Receive notifications in the app</p>\n              </div>\n            </div>\n            <Switch\n              checked={localPreferences.push_notifications}\n              onCheckedChange={(value) => handleToggle('push_notifications', value)}\n            />\n          </div>\n\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <Mail className=\"h-4 w-4 text-muted-foreground\" />\n              <div>\n                <Label className=\"text-sm font-medium\">Email Notifications</Label>\n                <p className=\"text-xs text-muted-foreground\">Receive notifications via email</p>\n              </div>\n            </div>\n            <Switch\n              checked={localPreferences.email_notifications}\n              onCheckedChange={(value) => handleToggle('email_notifications', value)}\n            />\n          </div>\n        </div>\n\n        <Separator />\n\n        {/* Notification Types */}\n        <div className=\"space-y-4\">\n          <h3 className=\"font-semibold text-sm\">Notification Types</h3>\n          \n          {notificationTypes.map(({ key, title, description, icon: Icon, hasThreshold }) => (\n            <div key={key} className=\"space-y-3\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-3\">\n                  <Icon className=\"h-4 w-4 text-muted-foreground\" />\n                  <div>\n                    <Label className=\"text-sm font-medium\">{title}</Label>\n                    <p className=\"text-xs text-muted-foreground\">{description}</p>\n                  </div>\n                </div>\n                <Switch\n                  checked={localPreferences[key as keyof typeof localPreferences] as boolean}\n                  onCheckedChange={(value) => handleToggle(key, value)}\n                />\n              </div>\n              \n              {hasThreshold && localPreferences.aqi_alerts && (\n                <div className=\"ml-7 space-y-2\">\n                  <Label className=\"text-xs text-muted-foreground\">\n                    Alert when AQI exceeds:\n                  </Label>\n                  <div className=\"flex items-center gap-2\">\n                    <Input\n                      type=\"number\"\n                      min=\"0\"\n                      max=\"500\"\n                      value={localPreferences.aqi_threshold}\n                      onChange={(e) => handleThresholdChange(e.target.value)}\n                      className=\"w-20 h-8 text-sm\"\n                    />\n                    <span className=\"text-xs text-muted-foreground\">\n                      (Recommended: 100)\n                    </span>\n                  </div>\n                  <p className=\"text-xs text-muted-foreground\">\n                    You'll receive alerts when air quality in your area exceeds this threshold.\n                  </p>\n                </div>\n              )}\n            </div>\n          ))}\n        </div>\n\n        {/* Save Button */}\n        {hasChanges && (\n          <div className=\"pt-4 border-t\">\n            <Button \n              onClick={handleSave} \n              disabled={isSaving}\n              className=\"w-full\"\n            >\n              {isSaving ? \"Saving...\" : \"Save Settings\"}\n            </Button>\n          </div>\n        )}\n      </GlassCardContent>\n    </GlassCard>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\PollutantModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'fetchPollutantDetails' was used before it was defined.","line":38,"column":7,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":38,"endColumn":28},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchPollutantDetails'. Either include it or remove the dependency array.","line":40,"column":6,"nodeType":"ArrayExpression","endLine":40,"endColumn":17,"suggestions":[{"desc":"Update the dependencies array to be: [fetchPollutantDetails, pollutant]","fix":{"range":[855,866],"text":"[fetchPollutantDetails, pollutant]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogDescription,\n} from '@/components/ui/dialog';\nimport { Badge } from '@/components/ui/badge';\n\ninterface PollutantDetail {\n  pollutant_code: string;\n  name: string;\n  description: string;\n  health_effects: string;\n  safe_levels: string;\n}\n\ninterface PollutantModalProps {\n  pollutant: {\n    name: string;\n    value: number;\n    unit: string;\n  } | null;\n  onClose: () => void;\n}\n\nexport default function PollutantModal({ \n  pollutant, \n  onClose \n}: PollutantModalProps) {\n  const [details, setDetails] = useState<PollutantDetail | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    if (pollutant) {\n      fetchPollutantDetails();\n    }\n  }, [pollutant]);\n\n  const fetchPollutantDetails = async () => {\n    try {\n      // Map pollutant names to codes\n      const pollutantCodeMap: Record<string, string> = {\n        'PM2.5': 'PM25',\n        'PM10': 'PM10',\n        'NO₂': 'NO2',\n        'SO₂': 'SO2',\n        'CO': 'CO',\n        'O₃': 'O3'\n      };\n\n      const pollutantCode = pollutantCodeMap[pollutant.name];\n      if (!pollutantCode) {\n        setLoading(false);\n        return;\n      }\n\n      const { data, error } = await supabase\n        .from('pollutant_details')\n        .select('*')\n        .eq('pollutant_code', pollutantCode)\n        .single();\n\n      if (error) throw error;\n      setDetails(data);\n    } catch (error) {\n      console.error('Error fetching pollutant details:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const getSafetyLevel = (pollutantCode: string, value: number) => {\n    // Simplified safety assessment based on WHO guidelines\n    const thresholds: Record<string, { good: number; moderate: number }> = {\n      PM25: { good: 15, moderate: 25 },\n      PM10: { good: 45, moderate: 75 },\n      NO2: { good: 25, moderate: 40 },\n      SO2: { good: 40, moderate: 80 },\n      CO: { good: 10, moderate: 30 },\n      O3: { good: 100, moderate: 160 }\n    };\n\n    const threshold = thresholds[pollutantCode];\n    if (!threshold) return { level: 'Unknown', color: 'bg-muted' };\n\n    if (value <= threshold.good) {\n      return { level: 'Good', color: 'bg-green-500' };\n    } else if (value <= threshold.moderate) {\n      return { level: 'Moderate', color: 'bg-yellow-500' };\n    } else {\n      return { level: 'Poor', color: 'bg-red-500' };\n    }\n  };\n\n  // Don't render if no pollutant is selected\n  if (!pollutant) {\n    return null;\n  }\n\n  if (loading) {\n    return (\n      <Dialog open={true} onOpenChange={onClose}>\n        <DialogContent className=\"floating-card border-0\">\n          <DialogHeader>\n            <DialogTitle>Loading Pollutant Information</DialogTitle>\n            <DialogDescription>\n              Fetching detailed information for {pollutant.name}...\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"animate-pulse space-y-4\">\n            <div className=\"h-6 bg-muted rounded\"></div>\n            <div className=\"h-20 bg-muted rounded\"></div>\n          </div>\n        </DialogContent>\n      </Dialog>\n    );\n  }\n\n  if (!details) {\n    return (\n      <Dialog open={true} onOpenChange={onClose}>\n        <DialogContent className=\"floating-card border-0 max-w-md\">\n          <DialogHeader>\n            <DialogTitle>{pollutant.name} Information</DialogTitle>\n            <DialogDescription>\n              Basic pollutant information and current levels\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div className=\"text-center space-y-2\">\n              <div className=\"text-3xl font-bold\">{pollutant.value.toFixed(1)}</div>\n              <div className=\"text-sm text-muted-foreground\">{pollutant.unit}</div>\n            </div>\n            <p className=\"text-muted-foreground text-center\">\n              No detailed information available for this pollutant.\n            </p>\n          </div>\n        </DialogContent>\n      </Dialog>\n    );\n  }\n\n  const safetyLevel = getSafetyLevel(details.pollutant_code, pollutant.value);\n\n  return (\n    <Dialog open={true} onOpenChange={onClose}>\n      <DialogContent className=\"floating-card border-0 max-w-md\">\n        <DialogHeader>\n          <DialogTitle>{pollutant.name} Information</DialogTitle>\n          <DialogDescription>\n            Detailed information about {pollutant.name} and its health effects\n          </DialogDescription>\n        </DialogHeader>\n        \n        <div className=\"space-y-4\">\n          {/* Current Value */}\n          <div className=\"text-center space-y-2\">\n            <div className=\"text-3xl font-bold\">{pollutant.value.toFixed(1)}</div>\n            <div className=\"text-sm text-muted-foreground\">{pollutant.unit}</div>\n            <Badge className={`${safetyLevel.color} text-white`}>\n              {safetyLevel.level}\n            </Badge>\n          </div>\n\n          {/* Description */}\n          <div>\n            <h4 className=\"font-medium mb-2\">Description</h4>\n            <p className=\"text-sm text-muted-foreground\">{details.description}</p>\n          </div>\n\n          {/* Health Effects */}\n          <div>\n            <h4 className=\"font-medium mb-2\">Health Effects</h4>\n            <p className=\"text-sm text-muted-foreground\">{details.health_effects}</p>\n          </div>\n\n          {/* Safe Levels */}\n          <div>\n            <h4 className=\"font-medium mb-2\">Safe Levels</h4>\n            <p className=\"text-sm text-muted-foreground\">{details.safe_levels}</p>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ProfileView.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'motion' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[73,112],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'motion' is defined but never used.","line":2,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":16},{"ruleId":"no-unused-vars","severity":1,"message":"'Mail' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":7,"suggestions":[{"messageId":"removeVar","data":{"varName":"Mail"},"fix":{"range":[514,523],"text":""},"desc":"Remove unused variable 'Mail'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Mail' is defined but never used.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":7},{"ruleId":"no-unused-vars","severity":1,"message":"'Calendar' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":11,"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[523,536],"text":""},"desc":"Remove unused variable 'Calendar'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calendar' is defined but never used.","line":13,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":11},{"ruleId":"no-unused-vars","severity":1,"message":"'MapPin' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":9,"suggestions":[{"messageId":"removeVar","data":{"varName":"MapPin"},"fix":{"range":[536,547],"text":""},"desc":"Remove unused variable 'MapPin'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MapPin' is defined but never used.","line":14,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":9},{"ruleId":"no-unused-vars","severity":1,"message":"'Edit3' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":8,"suggestions":[{"messageId":"removeVar","data":{"varName":"Edit3"},"fix":{"range":[581,591],"text":""},"desc":"Remove unused variable 'Edit3'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Edit3' is defined but never used.","line":18,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":8},{"ruleId":"no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":20,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":4,"suggestions":[{"messageId":"removeVar","data":{"varName":"X"},"fix":{"range":[600,606],"text":""},"desc":"Remove unused variable 'X'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":20,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":4},{"ruleId":"no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":8,"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[628,637],"text":""},"desc":"Remove unused variable 'Clock'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":23,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":8},{"ruleId":"no-unused-vars","severity":1,"message":"'editing' is assigned a value but never used.","line":204,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":204,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"editing"},"fix":{"range":[7437,7444],"text":""},"desc":"Remove unused variable 'editing'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'editing' is assigned a value but never used.","line":204,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":204,"endColumn":17},{"ruleId":"no-unused-vars","severity":1,"message":"'pointsLoading' is assigned a value but never used.","line":208,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":208,"endColumn":47,"suggestions":[{"messageId":"removeVar","data":{"varName":"pointsLoading"},"fix":{"range":[7657,7683],"text":""},"desc":"Remove unused variable 'pointsLoading'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'pointsLoading' is assigned a value but never used.","line":208,"column":34,"nodeType":null,"messageId":"unusedVar","endLine":208,"endColumn":47},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback received a function whose dependencies are unknown. Pass an inline function instead.","line":246,"column":33,"nodeType":"Identifier","endLine":246,"endColumn":44},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'debounce' was used before it was defined.","line":247,"column":5,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":247,"endColumn":13},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'fetchProfile' was used before it was defined.","line":249,"column":15,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":249,"endColumn":27},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'fetchUserStats' was used before it was defined.","line":250,"column":15,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":250,"endColumn":29},{"ruleId":"no-unused-vars","severity":1,"message":"'args' is defined but never used.","line":257,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":257,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"args"},"fix":{"range":[9371,9375],"text":""},"desc":"Remove unused variable 'args'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'args' is defined but never used.","line":260,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":260,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"args"},"fix":{"range":[9432,9436],"text":""},"desc":"Remove unused variable 'args'."}]},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'fetchProfile' was used before it was defined.","line":270,"column":7,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":270,"endColumn":19},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'fetchUserStats' was used before it was defined.","line":271,"column":7,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":271,"endColumn":21},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'fetchProfile' and 'fetchUserStats'. Either include them or remove the dependency array.","line":273,"column":6,"nodeType":"ArrayExpression","endLine":273,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: [fetchProfile, fetchUserStats, user]","fix":{"range":[9726,9732],"text":"[fetchProfile, fetchUserStats, user]"}}]},{"ruleId":"no-unused-vars","severity":1,"message":"'lastReading' is assigned a value but never used.","line":382,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":382,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'lastReading' is assigned a value but never used.","line":382,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":382,"endColumn":24},{"ruleId":"no-unused-vars","severity":1,"message":"'locationStats' is assigned a value but never used.","line":406,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":406,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'locationStats' is assigned a value but never used.","line":406,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":406,"endColumn":28}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":31,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback, useMemo, memo } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from \"@/components/ui/GlassCard\";\n\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { useToast } from \"@/components/ui/use-toast\";\nimport { \n  User, \n  Mail, \n  Calendar, \n  MapPin, \n  Award, \n  Download, \n  Trash2, \n  Edit3, \n  Save, \n  X,\n  DollarSign,\n  Gift,\n  Clock,\n  TrendingUp,\n  Shield,\n  Settings,\n  LogOut,\n  HelpCircle,\n  FileText\n} from \"lucide-react\";\nimport { supabase } from \"@/integrations/supabase/client\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { useRealtime } from \"@/contexts/RealtimeContext\";\nimport { ensureChannelReady, getExistingChannel } from \"@/lib/realtimeClient\";\nimport { useUserPoints } from \"@/hooks/useUserPoints\";\nimport { useWithdrawalRequests } from \"@/hooks/useWithdrawalRequests\";\nimport { useAchievements } from \"@/hooks/useAchievements\";\nimport { useIsMobile } from \"@/hooks/use-mobile\";\nimport Header from \"@/components/Header\";\nimport { useNavigate } from \"react-router-dom\";\n\ninterface ProfileViewProps {\n  showMobileMenu?: boolean;\n  onMobileMenuToggle?: () => void;\n}\n\ninterface Profile {\n  id: string;\n  user_id: string;\n  email: string;\n  full_name: string;\n  avatar_url?: string;\n  total_points: number;\n  created_at: string;\n}\n\ninterface ProfileStats {\n  totalReadings: number;\n  totalPoints: number;\n  memberSince: string;\n}\n\n// Memoized Badge Component for Performance\nconst BadgeIcon = memo(({ \n  achievement, \n  userAchievement, \n  isMobile \n}: { \n  achievement: any; \n  userAchievement: any; \n  isMobile: boolean;\n}) => {\n  const isUnlocked = userAchievement?.unlocked;\n  const badgeSize = isMobile ? 'w-11 h-11' : 'w-16 h-16';\n  const iconSize = isMobile ? 'text-lg' : 'text-2xl';\n  \n  if (isUnlocked) {\n    return (\n      <div className=\"group relative\">\n        <div className={`${badgeSize} bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center text-white ${iconSize} shadow-lg hover:shadow-xl transition-all duration-200 hover:scale-110 cursor-pointer border-2 border-yellow-300`}>\n          {achievement.icon || '🏆'}\n        </div>\n        {/* Hover Tooltip - Only show on desktop */}\n        {!isMobile && (\n          <div className=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10\">\n            <div className=\"font-semibold\">{achievement.name}</div>\n            <div className=\"text-xs text-gray-300\">{achievement.description}</div>\n            <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900\"></div>\n          </div>\n        )}\n      </div>\n    );\n  }\n  \n  return (\n    <div className=\"group relative\">\n      <div className={`${badgeSize} bg-gradient-to-br from-slate-300 to-slate-400 dark:from-slate-700 dark:to-slate-800 rounded-full flex items-center justify-center text-slate-600 dark:text-slate-400 ${iconSize} shadow-lg border-2 border-slate-200 dark:border-slate-600`}>\n        🔒\n      </div>\n      {/* Hover Tooltip - Only show on desktop */}\n      {!isMobile && (\n        <div className=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-slate-900 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10\">\n          <div className=\"font-semibold\">{achievement.name}</div>\n          <div className=\"text-xs text-slate-300\">{achievement.description}</div>\n          <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-slate-900\"></div>\n        </div>\n      )}\n    </div>\n  );\n});\n\nBadgeIcon.displayName = 'BadgeIcon';\n\n// Memoized Badge Container for Performance\nconst BadgeContainer = memo(({ \n  userAchievements, \n  achievements, \n  isMobile \n}: { \n  userAchievements: any[]; \n  achievements: any[]; \n  isMobile: boolean;\n}) => {\n  // Memoize badge calculations to prevent unnecessary re-computations\n  const { unlockedBadges, lockedBadges, moreBadgesCount } = useMemo(() => {\n    const unlocked = userAchievements?.filter(ua => ua.unlocked) || [];\n    const locked = userAchievements?.filter(ua => !ua.unlocked) || [];\n    const moreCount = Math.max(0, locked.length - 3);\n    \n    return { unlockedBadges: unlocked, lockedBadges: locked, moreBadgesCount: moreCount };\n  }, [userAchievements]);\n\n  // Memoize badge rendering to prevent unnecessary re-renders\n  const renderedUnlockedBadges = useMemo(() => {\n    return unlockedBadges.map((userAchievement) => {\n      const achievement = achievements.find(a => a.id === userAchievement.achievement_id);\n      if (!achievement) return null;\n      \n      return (\n        <BadgeIcon\n          key={userAchievement.id}\n          achievement={achievement}\n          userAchievement={userAchievement}\n          isMobile={isMobile}\n        />\n      );\n    });\n  }, [unlockedBadges, achievements, isMobile]);\n\n  const renderedLockedBadges = useMemo(() => {\n    return lockedBadges.slice(0, 3).map((userAchievement) => {\n      const achievement = achievements.find(a => a.id === userAchievement.achievement_id);\n      if (!achievement) return null;\n      \n      return (\n        <BadgeIcon\n          key={userAchievement.id}\n          achievement={achievement}\n          userAchievement={userAchievement}\n          isMobile={isMobile}\n        />\n      );\n    });\n  }, [lockedBadges, achievements, isMobile]);\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Badge Grid with Responsive Layout */}\n      <div className={`flex flex-wrap gap-2 md:gap-3 justify-start md:justify-start sm:justify-center max-w-full overflow-hidden`}>\n        {/* Unlocked Badges */}\n        {renderedUnlockedBadges}\n        \n        {/* Locked Badges */}\n        {renderedLockedBadges}\n        \n        {/* More Badges Indicator */}\n        {moreBadgesCount > 0 && (\n          <div className={`flex items-center justify-center ${isMobile ? 'w-11 h-11' : 'w-16 h-16'} bg-gradient-to-br from-slate-200 to-slate-300 dark:from-slate-800 dark:to-slate-700 rounded-full border-2 border-dashed border-slate-400 dark:border-slate-600`}>\n            <span className=\"text-slate-500 dark:text-slate-400 text-xs md:text-sm font-medium\">+{moreBadgesCount}</span>\n          </div>\n        )}\n      </div>\n      \n      {/* Badge Progress Summary */}\n      <div className=\"text-center\">\n        <p className=\"text-sm text-muted-foreground\">\n          {unlockedBadges.length} of {userAchievements?.length || 0} badges unlocked\n        </p>\n      </div>\n    </div>\n  );\n});\n\nBadgeContainer.displayName = 'BadgeContainer';\n\nexport default function ProfileView({ showMobileMenu, onMobileMenuToggle }: ProfileViewProps) {\n  const [profile, setProfile] = useState<Profile | null>(null);\n  const [stats, setStats] = useState<ProfileStats>({\n    totalReadings: 0,\n    totalPoints: 0,\n    memberSince: ''\n  });\n  const [loading, setLoading] = useState(true);\n  const [editing, setEditing] = useState(false);\n  const [editForm, setEditForm] = useState({ full_name: '' });\n  const { user, signOut } = useAuth();\n  const { subscribeToUserProfilePoints } = useRealtime();\n  const { userPoints, isLoading: pointsLoading, updateTotalPoints } = useUserPoints();\n  const { withdrawalRequests, isLoading: withdrawalLoading } = useWithdrawalRequests();\n  const { achievements, userAchievements, isLoading: achievementsLoading } = useAchievements();\n  const { toast } = useToast();\n  const navigate = useNavigate();\n  const isMobile = useIsMobile();\n\n  // Performance monitoring\n  useEffect(() => {\n    if (typeof window !== 'undefined' && process.env.NODE_ENV === 'development') {\n      performance.mark('profile-render-start');\n      \n      return () => {\n        performance.mark('profile-render-end');\n        performance.measure('profile-render', 'profile-render-start', 'profile-render-end');\n        \n        const measure = performance.getEntriesByName('profile-render')[0];\n        if (measure && measure.duration > 16.67) {\n          console.warn('Slow profile render detected:', measure.duration.toFixed(2) + 'ms');\n        }\n      };\n    }\n  });\n\n  // Memoize expensive calculations\n  const userLevel = useMemo(() => {\n    return Math.floor((userPoints?.totalPoints || 0) / 10000) + 1;\n  }, [userPoints?.totalPoints]);\n\n  const userDisplayName = useMemo(() => {\n    return profile?.full_name || user?.email || 'User';\n  }, [profile?.full_name, user?.email]);\n\n  const userInitial = useMemo(() => {\n    return userDisplayName.charAt(0).toUpperCase();\n  }, [userDisplayName]);\n\n  // Debounced profile updates to prevent excessive re-renders\n  const debouncedFetchProfile = useCallback(\n    debounce(async () => {\n      if (user) {\n        await fetchProfile();\n        await fetchUserStats();\n      }\n    }, 300),\n    [user]\n  );\n\n  // Debounce function implementation\n  function debounce<T extends (...args: any[]) => any>(\n    func: T,\n    wait: number\n  ): (...args: Parameters<T>) => void {\n    let timeout: NodeJS.Timeout;\n    return (...args: Parameters<T>) => {\n      clearTimeout(timeout);\n      timeout = setTimeout(() => func(...args), wait);\n    };\n  }\n\n  useEffect(() => {\n    if (user) {\n      fetchProfile();\n      fetchUserStats();\n    }\n  }, [user]);\n\n  // Subscribe to profile points updates with performance optimization\n  useEffect(() => {\n    if (!user?.id) {\n      return undefined;\n    }\n\n    let isMounted = true;\n    let cleanupFn: (() => void) | undefined;\n    const channelName = `user-profile-points-${user.id}`;\n\n    const setupSubscription = async () => {\n      try {\n        await ensureChannelReady(channelName);\n\n        if (!isMounted) {\n          return;\n        }\n\n        const existingChannel = getExistingChannel(channelName);\n        if (!existingChannel) {\n          console.warn(\"Realtime channel not available after readiness guard, proceeding with subscription\");\n        }\n\n        cleanupFn = subscribeToUserProfilePoints((payload) => {\n          console.log('Profile points updated:', payload);\n          // Update user points hook with new total points\n          if (payload.eventType === 'UPDATE' && payload.new?.total_points !== undefined) {\n            updateTotalPoints(payload.new.total_points);\n          }\n          // Use debounced refresh to prevent excessive API calls\n          debouncedFetchProfile();\n        });\n      } catch (error) {\n        console.warn('Failed to establish realtime subscription for profile points', error);\n      }\n    };\n\n    setupSubscription();\n\n    return () => {\n      isMounted = false;\n      if (cleanupFn) {\n        cleanupFn();\n      }\n    };\n  }, [user?.id, subscribeToUserProfilePoints, updateTotalPoints, debouncedFetchProfile]);\n\n  const fetchProfile = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('profiles')\n        .select('*')\n        .eq('user_id', user?.id)\n        .single();\n\n      if (error) {\n        if (error.code === 'PGRST116') {\n          console.warn('User profile not found in database');\n          return;\n        }\n        throw error;\n      }\n      \n      setProfile(data);\n      setEditForm({ full_name: data.full_name || '' });\n    } catch (error: any) {\n      console.error('Error fetching profile:', error);\n      toast({\n        title: \"Error\",\n        description: \"Failed to load profile\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchUserStats = async () => {\n    try {\n      // Check if user has any readings first\n      const { count: readingsCount, error: countError } = await supabase\n        .from('air_quality_readings')\n        .select('*', { count: 'exact', head: true })\n        .eq('user_id', user?.id);\n\n      if (countError) {\n        console.log('No air quality readings found for new user:', countError.message);\n      }\n\n      const totalPoints = profile?.total_points || 0;\n\n      // Only try to fetch last reading if user has readings\n      let lastReading = null;\n      let locationStats = null;\n\n      if (readingsCount && readingsCount > 0) {\n        try {\n          // Get last reading\n          const { data: lastReadingData, error: lastReadingError } = await supabase\n            .from('air_quality_readings')\n            .select('timestamp, location_name')\n            .eq('user_id', user?.id)\n            .order('timestamp', { ascending: false })\n            .limit(1)\n            .single();\n\n          if (!lastReadingError && lastReadingData) {\n            lastReading = lastReadingData;\n          }\n        } catch (error) {\n          console.log('Error fetching last reading:', error);\n        }\n\n        // Get location stats\n        try {\n          const { data: locationData, error: locationError } = await supabase\n            .from('air_quality_readings')\n            .select('location_name')\n            .eq('user_id', user?.id)\n            .not('location_name', 'is', null);\n\n          if (!locationError && locationData && locationData.length > 0) {\n            const locationCounts = locationData.reduce((acc: any, reading: any) => {\n              acc[reading.location_name] = (acc[reading.location_name] || 0) + 1;\n              return acc;\n            }, {});\n\n            const favoriteLocation = Object.entries(locationCounts)\n              .sort(([,a]: any, [,b]: any) => b - a)[0];\n\n            if (favoriteLocation) {\n              locationStats = {\n                name: favoriteLocation[0],\n                count: favoriteLocation[1]\n              };\n            }\n          }\n        } catch (error) {\n          console.log('Error fetching location stats:', error);\n        }\n      }\n\n      setStats({\n        totalReadings: readingsCount || 0,\n        totalPoints,\n        memberSince: profile?.created_at ? new Date(profile.created_at).toLocaleDateString() : 'Unknown'\n      });\n    } catch (error: any) {\n      console.error('Error fetching user stats:', error);\n    }\n  };\n\n  const handleSaveProfile = async () => {\n    try {\n      const { error } = await supabase\n        .from('profiles')\n        .update({ full_name: editForm.full_name })\n        .eq('user_id', user?.id);\n\n      if (error) throw error;\n\n      setProfile(prev => prev ? { ...prev, full_name: editForm.full_name } : null);\n      setEditing(false);\n      \n      toast({\n        title: \"Success\",\n        description: \"Profile updated successfully\",\n      });\n    } catch (error: any) {\n      console.error('Error updating profile:', error);\n      toast({\n        title: \"Error\",\n        description: \"Failed to update profile\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleExportData = async () => {\n    try {\n      // Export user's air quality readings\n      const { data: readings, error } = await supabase\n        .from('air_quality_readings')\n        .select('*')\n        .eq('user_id', user?.id)\n        .order('timestamp', { ascending: false });\n\n      if (error) throw error;\n\n      const csvContent = [\n        ['Timestamp', 'Location', 'AQI', 'PM2.5', 'PM10', 'NO2', 'SO2', 'CO', 'O3'],\n        ...readings.map(reading => [\n          reading.timestamp,\n          reading.location_name || 'Unknown',\n          reading.aqi,\n          reading.pm25,\n          reading.pm10,\n          reading.no2,\n          reading.so2,\n          reading.co,\n          reading.o3\n        ])\n      ].map(row => row.join(',')).join('\\n');\n\n      const blob = new Blob([csvContent], { type: 'text/csv' });\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `air-quality-data-${user?.id}-${new Date().toISOString().split('T')[0]}.csv`;\n      a.click();\n      window.URL.revokeObjectURL(url);\n\n      toast({\n        title: \"Success\",\n        description: \"Data exported successfully\",\n      });\n    } catch (error: any) {\n      console.error('Error exporting data:', error);\n      toast({\n        title: \"Error\",\n        description: \"Failed to export data\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleDeleteAccount = async () => {\n    if (!confirm('Are you sure you want to delete your account? This action cannot be undone.')) {\n      return;\n    }\n\n    try {\n      // Delete user's data\n      const { error } = await supabase\n        .from('profiles')\n        .delete()\n        .eq('user_id', user?.id);\n\n      if (error) throw error;\n\n      // Sign out\n      await signOut();\n      \n      toast({\n        title: \"Account Deleted\",\n        description: \"Your account has been deleted successfully\",\n      });\n    } catch (error: any) {\n      console.error('Error deleting account:', error);\n      toast({\n        title: \"Error\",\n        description: \"Failed to delete account\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  // Mobile performance optimization - pause expensive operations when app is backgrounded\n  useEffect(() => {\n    const handleVisibilityChange = () => {\n      if (document.hidden) {\n        console.log('Profile page backgrounded, pausing expensive operations');\n      } else {\n        console.log('Profile page active, resuming operations');\n      }\n    };\n\n    document.addEventListener('visibilitychange', handleVisibilityChange);\n    return () => {\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\n    };\n  }, []);\n\n  if (loading) {\n    return (\n      <div className=\"space-y-6 lg:space-y-8\">\n        <Header\n          title=\"Profile\"\n          subtitle=\"Loading your profile...\"\n          showMobileMenu={showMobileMenu}\n          onMobileMenuToggle={onMobileMenuToggle}\n        />\n        <div className=\"text-center py-12\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto\"></div>\n          <p className=\"mt-4 text-muted-foreground\">Loading profile...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6 lg:space-y-8\">\n      <Header\n        title=\"Profile\"\n        subtitle=\"Manage your account and view progress\"\n        showMobileMenu={showMobileMenu}\n        onMobileMenuToggle={onMobileMenuToggle}\n      />\n\n      <Tabs defaultValue=\"profile\" className=\"space-y-6\">\n        <TabsList className=\"grid w-full grid-cols-4\">\n          <TabsTrigger value=\"profile\">Profile</TabsTrigger>\n          <TabsTrigger value=\"rewards\">Rewards</TabsTrigger>\n          <TabsTrigger value=\"achievements\">Achievements</TabsTrigger>\n          <TabsTrigger value=\"settings\">Settings</TabsTrigger>\n        </TabsList>\n\n        {/* Profile Tab */}\n        <TabsContent value=\"profile\" className=\"space-y-4\">\n          <GlassCard variant=\"elevated\">\n            <GlassCardHeader>\n              <GlassCardTitle className=\"text-lg font-semibold flex items-center gap-2\">\n                <User className=\"h-5 w-5\" />\n                Personal Information\n              </GlassCardTitle>\n            </GlassCardHeader>\n            <GlassCardContent className=\"space-y-4\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"text-sm font-medium\">Full Name</label>\n                  <Input\n                    value={profile?.full_name || ''}\n                    onChange={(e) => setProfile(prev => ({ ...prev, full_name: e.target.value }))}\n                    placeholder=\"Enter your full name\"\n                    className=\"mt-1\"\n                  />\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium\">Email</label>\n                  <Input\n                    value={user?.email || ''}\n                    disabled\n                    className=\"mt-1 bg-muted\"\n                  />\n                </div>\n              </div>\n              <div className=\"flex justify-end\">\n                <Button onClick={handleSaveProfile}>\n                  <Save className=\"h-4 w-4 mr-2\" />\n                  Save Changes\n                </Button>\n              </div>\n            </GlassCardContent>\n          </GlassCard>\n\n          {/* Badge Display Card - Fixed Layout */}\n          <GlassCard variant=\"elevated\" className=\"bg-gradient-to-r from-blue-50/50 to-purple-50/50 dark:from-blue-950/20 dark:to-purple-950/20\">\n            <GlassCardHeader>\n              <GlassCardTitle className=\"text-lg font-semibold flex items-center gap-2\">\n                <Award className=\"h-5 w-5\" />\n                Your Badges\n              </GlassCardTitle>\n            </GlassCardHeader>\n            <GlassCardContent>\n              <div className=\"space-y-4\">\n                {/* User Info Section */}\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className={`${isMobile ? 'w-10 h-10' : 'w-12 h-12'} bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center text-white font-bold ${isMobile ? 'text-base' : 'text-lg'}`}>\n                      {userInitial}\n                    </div>\n                    <div>\n                      <div className=\"font-semibold text-foreground\">\n                        {userDisplayName}\n                      </div>\n                      <div className=\"text-sm text-muted-foreground\">\n                        Level {userLevel} • {userPoints?.totalPoints || 0} points\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                \n                {/* Badge Container - Memoized for Performance */}\n                <BadgeContainer \n                  userAchievements={userAchievements}\n                  achievements={achievements}\n                  isMobile={isMobile}\n                />\n              </div>\n            </GlassCardContent>\n          </GlassCard>\n\n          {/* Statistics Card */}\n          <GlassCard variant=\"elevated\">\n            <GlassCardHeader>\n              <GlassCardTitle className=\"text-lg font-semibold flex items-center gap-2\">\n                <TrendingUp className=\"h-5 w-5\" />\n                Statistics\n              </GlassCardTitle>\n            </GlassCardHeader>\n            <GlassCardContent>\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-primary\">\n                    {stats.totalReadings || 0}\n                  </div>\n                  <div className=\"text-sm text-muted-foreground\">Total Readings</div>\n                </div>\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-primary\">\n                    {userPoints?.totalPoints || 0}\n                  </div>\n                  <div className=\"text-sm text-muted-foreground\">Points Earned</div>\n                </div>\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-primary\">\n                    {stats.memberSince ? new Date(stats.memberSince).getFullYear() : 'N/A'}\n                  </div>\n                  <div className=\"text-sm text-muted-foreground\">Member Since</div>\n                </div>\n              </div>\n            </GlassCardContent>\n          </GlassCard>\n\n          {/* Account Management Card */}\n          <GlassCard variant=\"elevated\">\n            <GlassCardHeader>\n              <GlassCardTitle className=\"text-lg font-semibold flex items-center gap-2\">\n                <Shield className=\"h-5 w-5\" />\n                Account Management\n              </GlassCardTitle>\n            </GlassCardHeader>\n            <GlassCardContent className=\"space-y-4\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <Button variant=\"outline\" onClick={handleExportData}>\n                  <Download className=\"h-4 w-4 mr-2\" />\n                  Export Data\n                </Button>\n                <Button variant=\"outline\" onClick={handleDeleteAccount}>\n                  <Trash2 className=\"h-4 w-4 mr-2\" />\n                  Delete Account\n                </Button>\n              </div>\n              <div className=\"text-sm text-muted-foreground text-center\">\n                Export your data before deleting your account\n              </div>\n            </GlassCardContent>\n          </GlassCard>\n        </TabsContent>\n\n        {/* Rewards Tab */}\n        <TabsContent value=\"rewards\" className=\"space-y-4\">\n          <GlassCard variant=\"default\">\n            <GlassCardHeader>\n              <GlassCardTitle className=\"flex items-center gap-2\">\n                <DollarSign className=\"h-5 w-5 text-green-500\" />\n                Currency Rewards\n              </GlassCardTitle>\n            </GlassCardHeader>\n            <GlassCardContent className=\"space-y-4\">\n              <div className=\"text-center space-y-4\">\n                <div className=\"text-4xl font-bold text-green-500\">\n                  ${((profile?.total_points || 0) / 1000 * 0.1).toFixed(2)}\n                </div>\n                <p className=\"text-sm text-muted-foreground\">\n                  $0.1 per 1000 points • Withdrawable at 500,000 points\n                </p>\n                {profile && profile.total_points >= 500000 ? (\n                  <Badge variant=\"outline\" className=\"bg-green-100 text-green-700 border-green-300\">\n                    🎉 Ready to withdraw!\n                  </Badge>\n                ) : (\n                  <Badge variant=\"outline\" className=\"bg-yellow-100 text-yellow-700 border-yellow-300\">\n                    {500000 - (profile?.total_points || 0)} points needed to withdraw\n                  </Badge>\n                )}\n              </div>\n            </GlassCardContent>\n          </GlassCard>\n\n          {/* Withdrawal Requests */}\n          <GlassCard variant=\"default\">\n            <GlassCardHeader>\n              <GlassCardTitle className=\"flex items-center gap-2\">\n                <Gift className=\"h-5 w-5 text-purple-600\" />\n                Withdrawal Requests\n              </GlassCardTitle>\n            </GlassCardHeader>\n            <GlassCardContent>\n              {withdrawalLoading ? (\n                <div className=\"text-center py-4\">\n                  <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto\"></div>\n                </div>\n              ) : withdrawalRequests && withdrawalRequests.length > 0 ? (\n                <div className=\"space-y-3\">\n                  {withdrawalRequests.map((request) => (\n                    <div key={request.id} className=\"flex items-center justify-between p-3 bg-muted/30 rounded-lg\">\n                      <div>\n                        <div className=\"font-medium\">${request.amount}</div>\n                        <div className=\"text-sm text-muted-foreground\">\n                          {new Date(request.created_at).toLocaleDateString()}\n                        </div>\n                      </div>\n                      <Badge \n                        variant={request.status === 'pending' ? 'outline' : \n                                request.status === 'approved' ? 'default' : 'destructive'}\n                      >\n                        {request.status}\n                      </Badge>\n                    </div>\n                  ))}\n                </div>\n              ) : (\n                <div className=\"text-center py-8 text-muted-foreground\">\n                  <Gift className=\"h-12 w-12 mx-auto mb-3 opacity-50\" />\n                  <p>No withdrawal requests yet</p>\n                  <p className=\"text-sm\">Earn more points to make your first withdrawal</p>\n                </div>\n              )}\n            </GlassCardContent>\n          </GlassCard>\n        </TabsContent>\n\n        {/* Achievements Tab */}\n        <TabsContent value=\"achievements\" className=\"space-y-4\">\n          <GlassCard variant=\"default\">\n            <GlassCardHeader>\n              <GlassCardTitle className=\"flex items-center gap-2\">\n                <Award className=\"h-5 w-5 text-yellow-600\" />\n                Your Achievements\n              </GlassCardTitle>\n            </GlassCardHeader>\n            <GlassCardContent>\n              {achievementsLoading ? (\n                <div className=\"text-center py-4\">\n                  <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto\"></div>\n                </div>\n              ) : achievements && achievements.length > 0 ? (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {achievements.map((achievement) => (\n                    <div key={achievement.id} className=\"text-center p-4 bg-muted/30 rounded-lg\">\n                      <div className=\"text-3xl mb-2\">{achievement.icon}</div>\n                      <div className=\"font-medium\">{achievement.name}</div>\n                      <div className=\"text-sm text-muted-foreground mb-2\">\n                        {achievement.description}\n                      </div>\n                      <Badge variant=\"outline\" className=\"text-xs\">\n                        +{achievement.points_reward} points\n                      </Badge>\n                    </div>\n                  ))}\n                </div>\n              ) : (\n                <div className=\"text-center py-8 text-muted-foreground\">\n                  <Award className=\"h-12 w-12 mx-auto mb-3 opacity-50\" />\n                  <p>No achievements unlocked yet</p>\n                  <p className=\"text-sm\">Keep monitoring air quality to earn achievements</p>\n                </div>\n              )}\n            </GlassCardContent>\n          </GlassCard>\n        </TabsContent>\n\n        {/* Settings Tab */}\n        <TabsContent value=\"settings\" className=\"space-y-4\">\n          <GlassCard variant=\"default\">\n            <GlassCardHeader>\n              <GlassCardTitle className=\"flex items-center gap-2\">\n                <Settings className=\"h-5 w-5 text-blue-600\" />\n                Account Settings\n              </GlassCardTitle>\n            </GlassCardHeader>\n            <GlassCardContent className=\"space-y-4\">\n              <Button \n                variant=\"outline\" \n                onClick={signOut}\n                className=\"w-full\"\n              >\n                <LogOut className=\"h-4 w-4 mr-2\" />\n                Sign Out\n              </Button>\n            </GlassCardContent>\n          </GlassCard>\n\n          <GlassCard variant=\"elevated\">\n            <GlassCardHeader>\n              <GlassCardTitle className=\"flex items-center gap-2\">\n                <Settings className=\"h-5 w-5\" />\n                Preferences\n              </GlassCardTitle>\n            </GlassCardHeader>\n            <GlassCardContent className=\"space-y-4\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <Button variant=\"outline\" onClick={() => navigate('/dashboard?view=settings')}>\n                  <Settings className=\"h-4 w-4 mr-2\" />\n                  App Settings\n                </Button>\n                                  <Button variant=\"outline\" onClick={() => navigate('/dashboard?view=rewards')}>\n                    <Award className=\"h-4 w-4 mr-2\" />\n                    Rewards\n                  </Button>\n                </div>\n              </GlassCardContent>\n            </GlassCard>\n\n          <GlassCard variant=\"elevated\">\n            <GlassCardHeader>\n              <GlassCardTitle className=\"flex items-center gap-2\">\n                <HelpCircle className=\"h-5 w-5\" />\n                Support & Help\n              </GlassCardTitle>\n            </GlassCardHeader>\n            <GlassCardContent className=\"space-y-4\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <Button variant=\"outline\" onClick={() => window.open('/privacy', '_blank')}>\n                  <Shield className=\"h-4 w-4 mr-2\" />\n                  Privacy Policy\n                </Button>\n                <Button variant=\"outline\" onClick={() => window.open('/terms', '_blank')}>\n                  <FileText className=\"h-4 w-4 mr-2\" />\n                  Terms of Service\n                </Button>\n              </div>\n            </GlassCardContent>\n          </GlassCard>\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\RefreshStatusIndicator.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'RefreshCw' is defined but never used.","line":2,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"RefreshCw"},"fix":{"range":[66,77],"text":""},"desc":"Remove unused variable 'RefreshCw'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RefreshCw' is defined but never used.","line":2,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":26}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Clock, RefreshCw, CheckCircle } from 'lucide-react';\n\ninterface RefreshStatusIndicatorProps {\n  type: 'air-quality' | 'weather' | 'background';\n}\n\nconst REFRESH_LOCK_KEYS = {\n  'air-quality': 'breath_safe_refresh_lock',\n  'weather': 'breath_safe_weather_refresh_lock',\n  'background': 'breath_safe_background_refresh_lock'\n};\n\nconst REFRESH_LOCK_DURATION = 14 * 60 * 1000; // 14 minutes\n\nexport default function RefreshStatusIndicator({ type }: RefreshStatusIndicatorProps) {\n  const [timeRemaining, setTimeRemaining] = useState<number>(0);\n  const [isLocked, setIsLocked] = useState<boolean>(false);\n\n  useEffect(() => {\n    const checkRefreshLock = () => {\n      try {\n        const lockKey = REFRESH_LOCK_KEYS[type];\n        const lockData = localStorage.getItem(lockKey);\n        \n        if (!lockData) {\n          setIsLocked(false);\n          setTimeRemaining(0);\n          return;\n        }\n\n        const { timestamp } = JSON.parse(lockData);\n        const now = Date.now();\n        const timeSinceLastRefresh = now - timestamp;\n        const remaining = Math.max(0, REFRESH_LOCK_DURATION - timeSinceLastRefresh);\n\n        setIsLocked(remaining > 0);\n        setTimeRemaining(remaining);\n      } catch {\n        setIsLocked(false);\n        setTimeRemaining(0);\n      }\n    };\n\n    // Check immediately\n    checkRefreshLock();\n\n    // Check every second\n    const interval = setInterval(checkRefreshLock, 1000);\n\n    return () => clearInterval(interval);\n  }, [type]);\n\n  const formatTimeRemaining = (ms: number): string => {\n    if (ms <= 0) return '0:00';\n    \n    const minutes = Math.floor(ms / 60000);\n    const seconds = Math.floor((ms % 60000) / 1000);\n    return `${minutes}:${seconds.toString().padStart(2, '0')}`;\n  };\n\n  const getTypeLabel = (): string => {\n    switch (type) {\n      case 'air-quality': return 'Air Quality';\n      case 'weather': return 'Weather';\n      case 'background': return 'Background';\n      default: return 'Data';\n    }\n  };\n\n  if (!isLocked) {\n    return (\n      <div className=\"flex items-center gap-2 text-green-600 text-sm\">\n        <CheckCircle className=\"w-4 h-4\" />\n        <span>{getTypeLabel()} data ready for refresh</span>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex items-center gap-2 text-amber-600 text-sm\">\n      <Clock className=\"w-4 h-4\" />\n      <span>{getTypeLabel()} refreshes in {formatTimeRemaining(timeRemaining)}</span>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\SearchDialog.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":1,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"useState"},"fix":{"range":[0,33],"text":""},"desc":"Remove unused variable 'useState'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":1,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":18},{"ruleId":"no-unused-vars","severity":1,"message":"'MapPin' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":9,"suggestions":[{"messageId":"removeVar","data":{"varName":"MapPin"},"fix":{"range":[338,349],"text":""},"desc":"Remove unused variable 'MapPin'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MapPin' is defined but never used.","line":11,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":9},{"ruleId":"no-unused-vars","severity":1,"message":"'ExternalLink' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"ExternalLink"},"fix":{"range":[374,390],"text":""},"desc":"Remove unused variable 'ExternalLink'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ExternalLink' is defined but never used.","line":14,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'open' is defined but never used.","line":23,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"open"},"fix":{"range":[668,681],"text":""},"desc":"Remove unused variable 'open'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'route' is defined but never used.","line":24,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"route"},"fix":{"range":[708,721],"text":""},"desc":"Remove unused variable 'route'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'navigate' is assigned a value but never used.","line":28,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"navigate"},"fix":{"range":[831,862],"text":""},"desc":"Remove unused variable 'navigate'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'navigate' is assigned a value but never used.","line":28,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Input } from '@/components/ui/input';\nimport { Badge } from '@/components/ui/badge';\nimport { ScrollArea } from '@/components/ui/scroll-area';\nimport { \n  Search, \n  Activity, \n  ShoppingCart, \n  Settings, \n  MapPin, \n  Heart, \n  TrendingUp,\n  ExternalLink,\n  ArrowRight\n} from 'lucide-react';\nimport { useGlobalSearch, SearchResult } from '@/hooks/useGlobalSearch';\nimport { useNavigate } from 'react-router-dom';\nimport { useToast } from '@/components/ui/use-toast';\n\ninterface SearchDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  onNavigate?: (route: string) => void;\n}\n\nexport default function SearchDialog({ open, onOpenChange, onNavigate }: SearchDialogProps) {\n  const navigate = useNavigate();\n  const { toast } = useToast();\n  const { \n    searchQuery, \n    setSearchQuery, \n    searchResults, \n    popularSearches,\n    hasResults \n  } = useGlobalSearch();\n\n  const getCategoryIcon = (category: SearchResult['category']) => {\n    switch (category) {\n      case 'aqi':\n      case 'pollutant':\n        return <Activity className=\"h-4 w-4\" />;\n      case 'app':\n        return <Settings className=\"h-4 w-4\" />;\n      case 'shop':\n        return <ShoppingCart className=\"h-4 w-4\" />;\n      case 'health':\n        return <Heart className=\"h-4 w-4\" />;\n      default:\n        return <Search className=\"h-4 w-4\" />;\n    }\n  };\n\n  const getCategoryColor = (category: string) => {\n    switch (category.toLowerCase()) {\n      case 'air quality': return 'bg-blue-100 text-blue-700 border-blue-200';\n      case 'weather': return 'bg-green-100 text-green-700 border-green-200';\n      case 'health': return 'bg-purple-100 text-purple-700 border-purple-200';\n      case 'environment': return 'bg-orange-100 text-orange-700 border-orange-200';\n      default: return 'bg-slate-100 text-slate-700 border-slate-200';\n    }\n  };\n\n  const handleResultClick = (result: SearchResult) => {\n    switch (result.action) {\n      case 'navigate':\n        if (result.data?.route && onNavigate) {\n          onNavigate(result.data.route);\n          onOpenChange(false);\n        }\n        break;\n      case 'view_product':\n        if (result.data?.product) {\n          // Navigate to store and potentially highlight the product\n          if (onNavigate) {\n            onNavigate('store');\n            onOpenChange(false);\n            toast({\n              title: \"Product Found\",\n              description: `Showing ${result.title} in store`,\n            });\n          }\n        }\n        break;\n      case 'enable_location':\n        toast({\n          title: \"Location Services\",\n          description: \"Please enable location access in your browser settings to get accurate air quality data.\",\n        });\n        onOpenChange(false);\n        break;\n      case 'learn_more':\n        toast({\n          title: result.title,\n          description: result.description,\n        });\n        onOpenChange(false);\n        break;\n      default:\n        toast({\n          title: result.title,\n          description: result.description,\n        });\n        onOpenChange(false);\n    }\n  };\n\n  const handlePopularSearchClick = (search: string) => {\n    setSearchQuery(search);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-2xl max-h-[80vh] p-0\">\n        <DialogHeader className=\"p-6 pb-4\">\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Search className=\"h-5 w-5\" />\n            Search Breath Safe\n          </DialogTitle>\n        </DialogHeader>\n\n        <div className=\"px-6\">\n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4\" />\n            <Input\n              placeholder=\"Search for AQI info, app features, health tips, or products...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"pl-10 text-base\"\n              autoFocus\n            />\n          </div>\n        </div>\n\n        <ScrollArea className=\"max-h-96 px-6 pb-6\">\n          {/* Search Results */}\n          {hasResults && (\n            <div className=\"mt-4 space-y-2\">\n              <h3 className=\"text-sm font-medium text-muted-foreground mb-3\">\n                Search Results ({searchResults.length})\n              </h3>\n              {searchResults.map((result) => (\n                <div\n                  key={result.id}\n                  onClick={() => handleResultClick(result)}\n                  className=\"flex items-start gap-3 p-3 rounded-lg hover:bg-muted/50 cursor-pointer transition-colors group\"\n                >\n                  <div className=\"mt-0.5\">\n                    {getCategoryIcon(result.category)}\n                  </div>\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-center justify-between mb-1\">\n                      <h4 className=\"font-medium text-sm truncate\">{result.title}</h4>\n                      <Badge variant=\"outline\" className={`ml-2 text-xs ${getCategoryColor(result.category)}`}>\n                        {result.category.toUpperCase()}\n                      </Badge>\n                    </div>\n                    <p className=\"text-sm text-muted-foreground line-clamp-2\">\n                      {result.description}\n                    </p>\n                  </div>\n                  <ArrowRight className=\"h-4 w-4 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity mt-0.5\" />\n                </div>\n              ))}\n            </div>\n          )}\n\n          {/* Popular Searches */}\n          {!hasResults && (\n            <div className=\"mt-4\">\n              <h3 className=\"text-sm font-medium text-muted-foreground mb-3\">\n                Popular Searches\n              </h3>\n              <div className=\"space-y-2\">\n                {popularSearches.map((search) => (\n                  <button\n                    key={search}\n                    onClick={() => handlePopularSearchClick(search)}\n                    className=\"flex items-center gap-3 p-3 rounded-lg hover:bg-muted/50 transition-colors text-left w-full group\"\n                  >\n                    <TrendingUp className=\"h-4 w-4 text-muted-foreground\" />\n                    <span className=\"text-sm\">{search}</span>\n                    <ArrowRight className=\"h-4 w-4 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity ml-auto\" />\n                  </button>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* No Results */}\n          {searchQuery && !hasResults && (\n            <div className=\"mt-8 text-center py-8\">\n              <Search className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\n              <h3 className=\"text-lg font-medium mb-2\">No results found</h3>\n              <p className=\"text-muted-foreground\">\n                Try searching for AQI levels, air purifiers, or app features\n              </p>\n            </div>\n          )}\n        </ScrollArea>\n\n        <div className=\"border-t px-6 py-4 bg-muted/30\">\n          <p className=\"text-xs text-muted-foreground text-center\">\n            Search through AQI data, app features, health tips, and store products\n          </p>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\SettingsView.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Settings' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":11,"suggestions":[{"messageId":"removeVar","data":{"varName":"Settings"},"fix":{"range":[641,650],"text":""},"desc":"Remove unused variable 'Settings'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Settings' is defined but never used.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":11},{"ruleId":"no-unused-vars","severity":1,"message":"'Globe' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":8,"suggestions":[{"messageId":"removeVar","data":{"varName":"Globe"},"fix":{"range":[699,708],"text":""},"desc":"Remove unused variable 'Globe'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Globe' is defined but never used.","line":17,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":8},{"ruleId":"no-unused-vars","severity":1,"message":"'Smartphone' is defined but never used.","line":20,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"Smartphone"},"fix":{"range":[730,744],"text":""},"desc":"Remove unused variable 'Smartphone'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Smartphone' is defined but never used.","line":20,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":13},{"ruleId":"no-unused-vars","severity":1,"message":"'Bell' is defined but never used.","line":21,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":7,"suggestions":[{"messageId":"removeVar","data":{"varName":"Bell"},"fix":{"range":[744,752],"text":""},"desc":"Remove unused variable 'Bell'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Bell' is defined but never used.","line":21,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":7},{"ruleId":"no-unused-vars","severity":1,"message":"'Eye' is defined but never used.","line":22,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":6,"suggestions":[{"messageId":"removeVar","data":{"varName":"Eye"},"fix":{"range":[752,759],"text":""},"desc":"Remove unused variable 'Eye'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Eye' is defined but never used.","line":22,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":6},{"ruleId":"no-unused-vars","severity":1,"message":"'Lock' is defined but never used.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":7,"suggestions":[{"messageId":"removeVar","data":{"varName":"Lock"},"fix":{"range":[759,767],"text":""},"desc":"Remove unused variable 'Lock'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Lock' is defined but never used.","line":23,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":7},{"ruleId":"no-unused-vars","severity":1,"message":"'theme' is assigned a value but never used.","line":34,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"theme"},"fix":{"range":[1087,1093],"text":""},"desc":"Remove unused variable 'theme'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'theme' is assigned a value but never used.","line":34,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":16},{"ruleId":"no-unused-vars","severity":1,"message":"'setTheme' is assigned a value but never used.","line":34,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"setTheme"},"fix":{"range":[1092,1102],"text":""},"desc":"Remove unused variable 'setTheme'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setTheme' is assigned a value but never used.","line":34,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":26},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'loadLocalSettings' was used before it was defined.","line":55,"column":5,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":55,"endColumn":22},{"ruleId":"no-unused-vars","severity":1,"message":"'_' is assigned a value but never used.","line":65,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":65,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"_"},"fix":{"range":[2121,2130],"text":""},"desc":"Remove unused variable '_'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_' is assigned a value but never used.","line":65,"column":24,"nodeType":null,"messageId":"unusedVar","endLine":65,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":70,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":70,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":70,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":70,"endColumn":21},{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":129,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":129,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":129,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":129,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":23,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from \"@/components/ui/GlassCard\";\nimport { Button } from \"@/components/ui/button\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { useToast } from '@/components/ui/use-toast';\nimport { useTheme } from '@/contexts/ThemeContext';\nimport Header from \"@/components/Header\";\nimport { \n  Settings, \n  Shield, \n  HelpCircle, \n  Download,\n  Palette,\n  Globe,\n  MapPin,\n  Database,\n  Smartphone,\n  Bell,\n  Eye,\n  Lock\n} from \"lucide-react\";\nimport NotificationSettings from \"./NotificationSettings\";\n\ninterface SettingsViewProps {\n  showMobileMenu?: boolean;\n  onMobileMenuToggle?: () => void;\n}\n\nexport default function SettingsView({ showMobileMenu, onMobileMenuToggle }: SettingsViewProps) {\n  const { toast } = useToast();\n  const { theme, setTheme } = useTheme();\n  \n  // Local state for settings - initialize with default values to prevent controlled/uncontrolled warnings\n  const [localSettings, setLocalSettings] = useState({\n    theme: 'system' as 'light' | 'dark' | 'system',\n    language: 'en' as 'en' | 'es' | 'fr',\n    units: 'metric' as 'metric' | 'imperial',\n    dataRetention: '90days' as '30days' | '90days' | '1year' | 'forever',\n    privacy: {\n      shareData: false,\n      publicProfile: false,\n      locationHistory: true\n    },\n    location: {\n      autoLocation: true,\n      locationAccuracy: 'high' as 'high' | 'medium' | 'low',\n      locationHistory: true\n    }\n  });\n\n  useEffect(() => {\n    loadLocalSettings();\n  }, []);\n\n  const loadLocalSettings = () => {\n    // Load settings from localStorage\n    const savedSettings = localStorage.getItem('breath-safe-app-settings');\n    if (savedSettings) {\n      try {\n        const parsed = JSON.parse(savedSettings);\n        // Only load non-theme settings to prevent theme switching\n        const { theme: _, ...nonThemeSettings } = parsed;\n        setLocalSettings(prev => ({\n          ...prev,\n          ...nonThemeSettings\n        }));\n      } catch (error) {\n        console.warn('Failed to parse saved settings, using defaults');\n      }\n    }\n  };\n\n  const saveLocalSettings = (newSettings: typeof localSettings) => {\n    setLocalSettings(newSettings);\n    localStorage.setItem('breath-safe-app-settings', JSON.stringify(newSettings));\n    // Never change the theme from app settings - only allow theme changes from the sidebar toggle\n    // This prevents the settings page from overriding the user's current theme preference\n  };\n\n  const updateLocalSetting = (category: keyof typeof localSettings, key: string, value: any) => {\n    if (category === 'theme' || category === 'language' || category === 'units' || category === 'dataRetention') {\n      const newSettings = {\n        ...localSettings,\n        [category]: value\n      };\n      saveLocalSettings(newSettings);\n    } else if (category === 'privacy' || category === 'location') {\n      const newSettings = {\n        ...localSettings,\n        [category]: {\n          ...localSettings[category],\n          [key]: value\n        }\n      };\n      saveLocalSettings(newSettings);\n    }\n    \n    toast({\n      title: \"Setting Updated\",\n      description: `${key} has been updated successfully.`,\n    });\n  };\n\n  const exportUserData = async () => {\n    try {\n      // Get user data from localStorage and other sources\n      const exportData = {\n        settings: localSettings,\n        exportDate: new Date().toISOString()\n      };\n\n      const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `breath-safe-settings-${new Date().toISOString().split('T')[0]}.json`;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      URL.revokeObjectURL(url);\n\n      toast({\n        title: \"Export Complete\",\n        description: \"Your settings have been exported successfully\",\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Export Failed\",\n        description: \"Failed to export settings\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  return (\n    <div className=\"page-container\">\n      <Header \n        title=\"Settings\"\n        subtitle=\"Customize your app experience and preferences\"\n        showMobileMenu={showMobileMenu}\n        onMobileMenuToggle={onMobileMenuToggle}\n      />\n      <div className=\"page-content space-y-4 md:space-y-6\">\n        {/* Header */}\n        <div>\n          <h1 className=\"text-2xl font-bold bg-gradient-primary bg-clip-text text-transparent\">\n            Settings\n          </h1>\n          <p className=\"text-sm text-muted-foreground mt-1\">\n            Customize your app experience and preferences\n          </p>\n        </div>\n\n        {/* Settings Tabs */}\n        <Tabs defaultValue=\"notifications\" className=\"space-y-4\">\n          <TabsList className=\"grid w-full grid-cols-5\">\n            <TabsTrigger value=\"notifications\">Notifications</TabsTrigger>\n            <TabsTrigger value=\"appearance\">Appearance</TabsTrigger>\n            <TabsTrigger value=\"privacy\">Privacy</TabsTrigger>\n            <TabsTrigger value=\"location\">Location</TabsTrigger>\n            <TabsTrigger value=\"data\">Data</TabsTrigger>\n          </TabsList>\n\n          {/* Notifications Tab */}\n          <TabsContent value=\"notifications\" className=\"space-y-4\">\n            <NotificationSettings />\n          </TabsContent>\n\n          {/* Appearance Tab */}\n          <TabsContent value=\"appearance\" className=\"space-y-4\">\n            <GlassCard variant=\"default\">\n              <GlassCardHeader>\n                <GlassCardTitle className=\"flex items-center gap-2\">\n                  <Palette className=\"h-5 w-5\" />\n                  Appearance & Theme\n                </GlassCardTitle>\n              </GlassCardHeader>\n              <GlassCardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"theme\">Theme Preference</Label>\n                  <p className=\"text-sm text-muted-foreground\">Your preferred theme (use sidebar toggle to change current theme)</p>\n                  <Select\n                    value={localSettings.theme}\n                    onValueChange={(value: 'light' | 'dark' | 'system') => \n                      updateLocalSetting('theme', 'theme', value)\n                    }\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"light\">Light</SelectItem>\n                      <SelectItem value=\"dark\">Dark</SelectItem>\n                      <SelectItem value=\"system\">System</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"language\">Language</Label>\n                  <Select\n                    value={localSettings.language}\n                    onValueChange={(value: 'en' | 'es' | 'fr') => \n                      updateLocalSetting('language', 'language', value)\n                    }\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"en\">English</SelectItem>\n                      <SelectItem value=\"es\">Español</SelectItem>\n                      <SelectItem value=\"fr\">Français</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"units\">Units</Label>\n                  <Select\n                    value={localSettings.units}\n                    onValueChange={(value: 'metric' | 'imperial') => \n                      updateLocalSetting('units', 'units', value)\n                    }\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"metric\">Metric (μg/m³)</SelectItem>\n                      <SelectItem value=\"imperial\">Imperial (ppm)</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </GlassCardContent>\n            </GlassCard>\n          </TabsContent>\n\n          {/* Privacy Tab */}\n          <TabsContent value=\"privacy\" className=\"space-y-4\">\n            <GlassCard variant=\"default\">\n              <GlassCardHeader>\n                <GlassCardTitle className=\"flex items-center gap-2\">\n                  <Shield className=\"h-5 w-5\" />\n                  Privacy & Security\n                </GlassCardTitle>\n              </GlassCardHeader>\n              <GlassCardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <Label htmlFor=\"share-data\">Share Data for Research</Label>\n                    <p className=\"text-sm text-muted-foreground\">Anonymously contribute to air quality research</p>\n                  </div>\n                  <Switch\n                    id=\"share-data\"\n                    checked={localSettings.privacy.shareData}\n                    onCheckedChange={(checked) => updateLocalSetting('privacy', 'shareData', checked)}\n                  />\n                </div>\n                \n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <Label htmlFor=\"public-profile\">Public Profile</Label>\n                    <p className=\"text-sm text-muted-foreground\">Allow others to see your profile</p>\n                  </div>\n                  <Switch\n                    id=\"public-profile\"\n                    checked={localSettings.privacy.publicProfile}\n                    onCheckedChange={(checked) => updateLocalSetting('privacy', 'publicProfile', checked)}\n                  />\n                </div>\n                \n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <Label htmlFor=\"location-history\">Location History</Label>\n                    <p className=\"text-sm text-muted-foreground\">Store your location history</p>\n                  </div>\n                  <Switch\n                    id=\"location-history\"\n                    checked={localSettings.privacy.locationHistory}\n                    onCheckedChange={(checked) => updateLocalSetting('privacy', 'locationHistory', checked)}\n                  />\n                </div>\n              </GlassCardContent>\n            </GlassCard>\n\n            {/* Privacy Policy & Terms */}\n            <GlassCard variant=\"default\">\n              <GlassCardHeader>\n                <GlassCardTitle className=\"flex items-center gap-2\">\n                  <HelpCircle className=\"h-5 w-5\" />\n                  Legal & Documentation\n                </GlassCardTitle>\n              </GlassCardHeader>\n              <GlassCardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Privacy Policy</Label>\n                  <p className=\"text-sm text-muted-foreground\">Read our privacy policy to understand how we protect your data</p>\n                  <Button \n                    variant=\"outline\" \n                    className=\"w-full justify-start gap-2\"\n                    onClick={() => window.open('/privacy', '_blank')}\n                  >\n                    <Shield className=\"h-4 w-4\" />\n                    Read Privacy Policy\n                  </Button>\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <Label>Terms of Service</Label>\n                  <p className=\"text-sm text-muted-foreground\">Review our terms and conditions for using Breath Safe</p>\n                  <Button \n                    variant=\"outline\" \n                    className=\"w-full justify-start gap-2\"\n                    onClick={() => window.open('/terms', '_blank')}\n                  >\n                    <HelpCircle className=\"h-4 w-4\" />\n                    Read Terms of Service\n                  </Button>\n                </div>\n              </GlassCardContent>\n            </GlassCard>\n          </TabsContent>\n\n          {/* Location Tab */}\n          <TabsContent value=\"location\" className=\"space-y-4\">\n            <GlassCard variant=\"default\">\n              <GlassCardHeader>\n                <GlassCardTitle className=\"flex items-center gap-2\">\n                  <MapPin className=\"h-5 w-5\" />\n                  Location Settings\n                </GlassCardTitle>\n              </GlassCardHeader>\n              <GlassCardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <Label htmlFor=\"auto-location\">Auto Location</Label>\n                    <p className=\"text-sm text-muted-foreground\">Automatically detect your location</p>\n                  </div>\n                  <Switch\n                    id=\"auto-location\"\n                    checked={localSettings.location.autoLocation}\n                    onCheckedChange={(checked) => updateLocalSetting('location', 'autoLocation', checked)}\n                  />\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"location-accuracy\">Location Accuracy</Label>\n                  <Select\n                    value={localSettings.location.locationAccuracy}\n                    onValueChange={(value: 'high' | 'medium' | 'low') => \n                      updateLocalSetting('location', 'locationAccuracy', value)\n                    }\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"high\">High (GPS)</SelectItem>\n                      <SelectItem value=\"medium\">Medium (WiFi)</SelectItem>\n                      <SelectItem value=\"low\">Low (IP)</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                \n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <Label htmlFor=\"location-history-setting\">Location History</Label>\n                    <p className=\"text-sm text-muted-foreground\">Store your location history</p>\n                  </div>\n                  <Switch\n                    id=\"location-history-setting\"\n                    checked={localSettings.location.locationHistory}\n                    onCheckedChange={(checked) => updateLocalSetting('location', 'locationHistory', checked)}\n                  />\n                </div>\n              </GlassCardContent>\n            </GlassCard>\n          </TabsContent>\n\n          {/* Data Tab */}\n          <TabsContent value=\"data\" className=\"space-y-4\">\n            <GlassCard variant=\"default\">\n              <GlassCardHeader>\n                <GlassCardTitle className=\"flex items-center gap-2\">\n                  <Database className=\"h-5 w-5\" />\n                  Data Management\n                </GlassCardTitle>\n              </GlassCardHeader>\n              <GlassCardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"data-retention\">Data Retention</Label>\n                  <Select\n                    value={localSettings.dataRetention}\n                    onValueChange={(value: '30days' | '90days' | '1year' | 'forever') => \n                      updateLocalSetting('dataRetention', 'dataRetention', value)\n                    }\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"30days\">30 Days</SelectItem>\n                      <SelectItem value=\"90days\">90 Days</SelectItem>\n                      <SelectItem value=\"1year\">1 Year</SelectItem>\n                      <SelectItem value=\"forever\">Forever</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <Label>Data Export</Label>\n                  <p className=\"text-sm text-muted-foreground\">Export your settings and preferences</p>\n                  <Button \n                    variant=\"outline\" \n                    className=\"w-full justify-start gap-2\"\n                    onClick={exportUserData}\n                  >\n                    <Download className=\"h-4 w-4\" />\n                    Export Settings\n                  </Button>\n                </div>\n              </GlassCardContent>\n            </GlassCard>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\Sidebar.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'view' is defined but never used.","line":7,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"view"},"fix":{"range":[254,266],"text":""},"desc":"Remove unused variable 'view'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { motion } from \"framer-motion\";\nimport { Button } from \"@/components/ui/button\";\nimport { Home, History, Map, Trophy, ShoppingBag, User, Newspaper, Settings } from \"lucide-react\";\n\ninterface SidebarProps {\n  currentView: string;\n  onViewChange: (view: string) => void;\n}\n\nexport default function Sidebar({ currentView, onViewChange }: SidebarProps): JSX.Element {\n  const navItems = [\n    { id: \"dashboard\", label: \"Dashboard\", icon: Home },\n    { id: \"history\", label: \"History\", icon: History },\n    { id: \"map\", label: \"Weather\", icon: Map },\n    { id: \"news\", label: \"News\", icon: Newspaper },\n    { id: \"rewards\", label: \"Rewards\", icon: Trophy },\n    { id: \"store\", label: \"Store\", icon: ShoppingBag },\n    { id: \"profile\", label: \"Profile\", icon: User },\n    { id: \"settings\", label: \"Settings\", icon: Settings },\n  ];\n\n  return (\n    <motion.aside \n      className=\"fixed left-0 top-0 h-full w-16 bg-card border-r border-border z-50 hidden md:flex flex-col items-center py-6 space-y-4 backdrop-blur-xl\"\n      initial={{ x: -64 }}\n      animate={{ x: 0 }}\n      transition={{ \n        type: \"spring\", \n        damping: 25, \n        stiffness: 200,\n        duration: 0.4\n      }}\n    >\n      {/* App Logo */}\n      <motion.div \n        className=\"w-10 h-10 bg-gradient-to-br from-primary to-secondary rounded-xl flex items-center justify-center mb-8 shadow-lg\"\n        whileHover={{ scale: 1.1, rotate: 5 }}\n        whileTap={{ scale: 0.95 }}\n      >\n        <span className=\"text-primary-foreground font-bold text-lg\">B</span>\n      </motion.div>\n\n      {/* Navigation Items */}\n      <nav className=\"flex-1 space-y-2\">\n        {navItems.map((item, index) => {\n          const Icon = item.icon;\n          const isActive = currentView === item.id;\n          \n          return (\n            <motion.div\n              key={item.id}\n              initial={{ opacity: 0, x: -20 }}\n              animate={{ opacity: 1, x: 0 }}\n              transition={{ \n                delay: 0.1 + index * 0.05, \n                duration: 0.3,\n                ease: \"easeOut\"\n              }}\n            >\n              <motion.div\n                whileHover={{ scale: 1.1 }}\n                whileTap={{ scale: 0.95 }}\n              >\n                <Button\n                  variant={isActive ? \"default\" : \"ghost\"}\n                  size=\"icon\"\n                  onClick={() => onViewChange(item.id)}\n                  className={`h-12 w-12 rounded-xl transition-all duration-200 ${\n                    isActive \n                      ? 'bg-gradient-to-br from-primary to-secondary text-primary-foreground shadow-lg border-accent' \n                      : 'text-muted-foreground hover:text-foreground hover:bg-accent hover:border-accent border-transparent'\n                  } border`}\n                  title={item.label}\n                  aria-label={`${item.label}${isActive ? ' (current page)' : ''}`}\n                  aria-current={isActive ? 'page' : undefined}\n                >\n                  <Icon className=\"h-5 w-5\" />\n                </Button>\n              </motion.div>\n            </motion.div>\n          );\n        })}\n      </nav>\n\n      {/* Bottom Spacing */}\n      <div className=\"flex-1\"></div>\n    </motion.aside>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\SupabaseErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\TDZDetector.tsx","messages":[{"ruleId":"no-undef","severity":1,"message":"'__TRACK_VARIABLES__' is not defined.","line":6,"column":73,"nodeType":"Identifier","messageId":"undef","endLine":6,"endColumn":92},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'renderCount'. Either include it or remove the dependency array.","line":66,"column":6,"nodeType":"ArrayExpression","endLine":66,"endColumn":36,"suggestions":[{"desc":"Update the dependencies array to be: [renderCount, trackingEnabled, weatherData]","fix":{"range":[2079,2109],"text":"[renderCount, trackingEnabled, weatherData]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from 'react';\r\nimport { debugTracker } from '../utils/errorTracker';\r\nimport { useWeatherStore } from '@/store/weatherStore';\r\n\r\nconst TDZDetector: React.FC = () => {\r\n  const trackingEnabled = typeof __TRACK_VARIABLES__ !== 'undefined' && __TRACK_VARIABLES__;\r\n  const [renderCount, setRenderCount] = useState(0);\r\n  const renderRef = React.useRef(0);\r\n  const weatherData = useWeatherStore((state) => state.weatherData);\r\n\r\n  useEffect(() => {\r\n    if (!trackingEnabled) {\r\n      return;\r\n    }\r\n\r\n    renderRef.current += 1;\r\n    const next = renderRef.current;\r\n    setRenderCount(next);\r\n    console.log(`🕵️ [TDZ-DETECTOR-${next}] Mounted/Updated`, {\r\n      timestamp: new Date().toISOString(),\r\n      hasWeatherData: !!weatherData,\r\n    });\r\n\r\n    const checkForTDZ = () => {\r\n      const timestamp = new Date().toISOString();\r\n      console.log(`🕵️ [TDZ-DETECTOR] Checking for TDZ conditions...`, {\r\n        timestamp,\r\n        hasWeatherData: !!weatherData,\r\n      });\r\n\r\n      try {\r\n        if (typeof window !== 'undefined' && 'f' in window) {\r\n          const globalF = (window as Record<string, unknown>)['f'];\r\n          console.log('Found global f:', typeof globalF);\r\n        }\r\n\r\n        debugTracker.trackVariableAccess('f', 'TDZDetector.tsx:checkForTDZ');\r\n      } catch (error) {\r\n        if (error instanceof Error) {\r\n          console.error('🎯 [TDZ-DETECTOR] CAUGHT THE ERROR!', {\r\n            error: error.message,\r\n            stack: error.stack,\r\n            renderCount,\r\n            timestamp,\r\n          });\r\n        } else {\r\n          console.error('🎯 [TDZ-DETECTOR] CAUGHT NON-ERROR VALUE!', {\r\n            value: error,\r\n            renderCount,\r\n            timestamp,\r\n          });\r\n        }\r\n      }\r\n    };\r\n\r\n    checkForTDZ();\r\n    const timeoutId = window.setTimeout(checkForTDZ, 0);\r\n\r\n    return () => {\r\n      console.log(`🕵️ [TDZ-DETECTOR] Cleanup after render`, {\r\n        renderCount,\r\n        timestamp: new Date().toISOString(),\r\n      });\r\n      clearTimeout(timeoutId);\r\n    };\r\n  }, [trackingEnabled, weatherData]);\r\n\r\n  useEffect(() => {\r\n    if (!trackingEnabled) {\r\n      return;\r\n    }\r\n\r\n    console.log(`🕵️ [TDZ-DETECTOR] Weather data effect triggered`, {\r\n      timestamp: new Date().toISOString(),\r\n      hasWeatherData: !!weatherData,\r\n    });\r\n  }, [trackingEnabled, weatherData]);\r\n\r\n  if (!trackingEnabled) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div style={{ display: 'none' }}>\r\n      TDZ Detector Active (Render: {renderCount})\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TDZDetector;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\WeatherForecast.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[151,197],"text":""},"desc":"Remove unused variable 'Badge'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":3,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'Sun' is defined but never used.","line":5,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"Sun"},"fix":{"range":[271,276],"text":""},"desc":"Remove unused variable 'Sun'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sun' is defined but never used.","line":5,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":30},{"ruleId":"no-unused-vars","severity":1,"message":"'getWeatherDescription' is assigned a value but never used.","line":88,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":88,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"getWeatherDescription"},"fix":{"range":[3724,4342],"text":""},"desc":"Remove unused variable 'getWeatherDescription'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getWeatherDescription' is assigned a value but never used.","line":88,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":88,"endColumn":30},{"ruleId":"no-unused-vars","severity":1,"message":"'getPrecipitationColor' is assigned a value but never used.","line":109,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":109,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"getPrecipitationColor"},"fix":{"range":[4613,4844],"text":""},"desc":"Remove unused variable 'getPrecipitationColor'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getPrecipitationColor' is assigned a value but never used.","line":109,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":109,"endColumn":30},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchForecastData'. Either include it or remove the dependency array.","line":122,"column":6,"nodeType":"ArrayExpression","endLine":122,"endColumn":27,"suggestions":[{"desc":"Update the dependencies array to be: [fetchForecastData, latitude, longitude]","fix":{"range":[5038,5059],"text":"[fetchForecastData, latitude, longitude]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from \"@/components/ui/GlassCard\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Calendar, Cloud, Sun, CloudRain, Thermometer, Droplets, Eye, RefreshCw, AlertTriangle } from \"lucide-react\";\nimport { useToast } from \"@/components/ui/use-toast\";\n\ninterface ForecastData {\n  date: string;\n  maxTemp: number;\n  minTemp: number;\n  precipitation: number;\n  humidity: number;\n  windSpeed: number;\n  weatherCode: number;\n}\n\ninterface WeatherForecastProps {\n  latitude: number;\n  longitude: number;\n}\n\nexport default function WeatherForecast({ latitude, longitude }: WeatherForecastProps): JSX.Element {\n  const [forecastData, setForecastData] = useState<ForecastData[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [lastUpdated, setLastUpdated] = useState<string | null>(null);\n  const { toast } = useToast();\n\n  const fetchForecastData = async (): Promise<void> => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const response = await fetch(\n        `https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&daily=temperature_2m_max,temperature_2m_min,precipitation_sum,relative_humidity_2m_max,wind_speed_10m_max,weather_code&timezone=auto`\n      );\n\n      if (response.ok) {\n        const data = await response.json();\n        const daily = data.daily;\n        \n        const forecast: ForecastData[] = daily.time.map((date: string, index: number) => ({\n          date,\n          maxTemp: daily.temperature_2m_max[index],\n          minTemp: daily.temperature_2m_min[index],\n          precipitation: daily.precipitation_sum[index],\n          humidity: daily.relative_humidity_2m_max[index],\n          windSpeed: daily.wind_speed_10m_max[index],\n          weatherCode: daily.weather_code[index]\n        }));\n\n        setForecastData(forecast);\n        setLastUpdated(new Date().toISOString());\n        toast({\n          title: \"Forecast Updated\",\n          description: \"Successfully fetched weather forecast data\",\n        });\n      } else {\n        throw new Error(`API request failed: ${response.status}`);\n      }\n    } catch (error) {\n      console.error('Error fetching forecast data:', error);\n      setError('Failed to fetch weather forecast data');\n      toast({\n        title: \"Forecast Error\",\n        description: \"Unable to fetch weather forecast. Please try again later.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Weather icon mapping function\n  const getWeatherIcon = (weatherCode: number) => {\n    if (weatherCode >= 1 && weatherCode <= 3) return <Cloud className=\"h-6 w-6 text-slate-500\" />; // Partly cloudy\n    if (weatherCode >= 45 && weatherCode <= 48) return <Cloud className=\"h-6 w-6 text-slate-600\" />; // Foggy\n    if (weatherCode >= 51 && weatherCode <= 55) return <CloudRain className=\"h-6 w-6 text-blue-500\" />; // Drizzle\n    if (weatherCode >= 61 && weatherCode <= 65) return <CloudRain className=\"h-6 w-6 text-blue-600\" />; // Rain\n    if (weatherCode >= 71 && weatherCode <= 77) return <Cloud className=\"h-6 w-6 text-blue-400\" />; // Snow\n    if (weatherCode >= 80 && weatherCode <= 82) return <CloudRain className=\"h-6 w-6 text-blue-500\" />; // Rain showers\n    if (weatherCode >= 85 && weatherCode <= 86) return <Cloud className=\"h-6 w-6 text-blue-400\" />; // Snow showers\n    if (weatherCode === 95) return <Cloud className=\"h-6 w-6 text-purple-500\" />; // Thunderstorm\n    return <Cloud className=\"h-6 w-6 text-slate-500\" />; // Default\n  };\n\n  const getWeatherDescription = (weatherCode: number): string => {\n    if (weatherCode === 0) return 'Clear sky';\n    if (weatherCode >= 1 && weatherCode <= 3) return 'Partly cloudy';\n    if (weatherCode >= 45 && weatherCode <= 48) return 'Foggy';\n    if (weatherCode >= 51 && weatherCode <= 67) return 'Rainy';\n    if (weatherCode >= 71 && weatherCode <= 77) return 'Snowy';\n    if (weatherCode >= 80 && weatherCode <= 82) return 'Rain showers';\n    if (weatherCode >= 85 && weatherCode <= 86) return 'Snow showers';\n    if (weatherCode >= 95 && weatherCode <= 99) return 'Thunderstorm';\n    \n    return 'Unknown';\n  };\n\n  const getTemperatureColor = (temp: number): string => {\n    if (temp < 0) return 'text-blue-600';\n    if (temp < 15) return 'text-green-600';\n    if (temp < 25) return 'text-yellow-600';\n    if (temp < 35) return 'text-orange-600';\n    return 'text-red-600';\n  };\n\n  const getPrecipitationColor = (precip: number): string => {\n    if (precip === 0) return 'text-green-600';\n    if (precip < 5) return 'text-yellow-600';\n    if (precip < 20) return 'text-orange-600';\n    return 'text-red-600';\n  };\n\n  useEffect(() => {\n    fetchForecastData();\n    \n    // Refresh every hour\n    const interval = setInterval(fetchForecastData, 60 * 60 * 1000);\n    return () => clearInterval(interval);\n  }, [latitude, longitude]);\n\n  if (loading && forecastData.length === 0) {\n    return (\n      <GlassCard>\n        <GlassCardHeader>\n          <GlassCardTitle className=\"flex items-center gap-2\">\n            <Calendar className=\"h-5 w-5\" />\n            Weather Forecast\n          </GlassCardTitle>\n        </GlassCardHeader>\n        <GlassCardContent>\n          <div className=\"flex items-center justify-center py-8\">\n            <div className=\"text-center space-y-2\">\n              <RefreshCw className=\"h-8 w-8 animate-spin text-primary mx-auto\" />\n              <p className=\"text-muted-foreground\">Loading forecast data...</p>\n            </div>\n          </div>\n        </GlassCardContent>\n      </GlassCard>\n    );\n  }\n\n  if (error && forecastData.length === 0) {\n    return (\n      <GlassCard>\n        <GlassCardHeader>\n          <GlassCardTitle className=\"flex items-center gap-2\">\n            <Calendar className=\"h-5 w-5\" />\n            Weather Forecast\n          </GlassCardTitle>\n        </GlassCardHeader>\n        <GlassCardContent>\n          <div className=\"text-center py-8 space-y-4\">\n            <AlertTriangle className=\"h-12 w-12 text-destructive mx-auto\" />\n            <p className=\"text-muted-foreground\">{error}</p>\n            <Button onClick={fetchForecastData} variant=\"outline\">\n              <RefreshCw className=\"h-4 w-4 mr-2\" />\n              Retry\n            </Button>\n          </div>\n        </GlassCardContent>\n      </GlassCard>\n    );\n  }\n\n  return (\n    <GlassCard>\n      <GlassCardHeader>\n        <div className=\"flex items-center justify-between\">\n          <GlassCardTitle className=\"flex items-center gap-2\">\n            <Calendar className=\"h-5 w-5\" />\n            Weather Forecast\n          </GlassCardTitle>\n          <Button onClick={fetchForecastData} size=\"sm\" variant=\"outline\">\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\n            Refresh\n          </Button>\n        </div>\n      </GlassCardHeader>\n      <GlassCardContent>\n        {forecastData.length > 0 ? (\n          <div className=\"space-y-4\">\n            {/* 7-Day Forecast Grid */}\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-7 gap-3\">\n              {forecastData.slice(0, 7).map((day, index) => (\n                <div key={day.date} className=\"p-3 bg-muted/30 rounded-lg text-center\">\n                  {/* Date */}\n                  <div className=\"text-sm font-medium mb-2\">\n                    {index === 0 ? 'Today' : new Date(day.date).toLocaleDateString('en-US', { weekday: 'short' })}\n                  </div>\n                  \n                  {/* Weather Icon */}\n                  <div className=\"flex justify-center mb-2\">\n                    {getWeatherIcon(day.weatherCode)}\n                  </div>\n                  \n                  {/* Temperature Range */}\n                  <div className=\"space-y-1 mb-2\">\n                    <div className={`text-lg font-bold ${getTemperatureColor(day.maxTemp)}`}>\n                      {day.maxTemp.toFixed(0)}°\n                    </div>\n                    <div className=\"text-sm text-muted-foreground\">\n                      {day.minTemp.toFixed(0)}°\n                    </div>\n                  </div>\n                  \n                  {/* Precipitation */}\n                  <div className=\"text-xs text-muted-foreground mb-1\">\n                    <Droplets className=\"h-3 w-3 inline mr-1\" />\n                    {day.precipitation.toFixed(1)}mm\n                  </div>\n                  \n                  {/* Humidity */}\n                  <div className=\"text-xs text-muted-foreground mb-1\">\n                    <Eye className=\"h-3 w-3 inline mr-1\" />\n                    {day.humidity}%\n                  </div>\n                  \n                  {/* Wind */}\n                  <div className=\"text-xs text-muted-foreground\">\n                    <Thermometer className=\"h-3 w-3 inline mr-1\" />\n                    {day.windSpeed.toFixed(1)} km/h\n                  </div>\n                </div>\n              ))}\n            </div>\n\n            {/* Weather Summary */}\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mt-6\">\n              {/* Temperature Trend */}\n              <div className=\"p-4 bg-muted/30 rounded-lg\">\n                <div className=\"flex items-center gap-2 mb-2\">\n                  <Thermometer className=\"h-5 w-5 text-primary\" />\n                  <span className=\"text-sm font-medium\">Temperature Range</span>\n                </div>\n                <div className=\"text-2xl font-bold text-primary\">\n                  {Math.min(...forecastData.slice(0, 7).map(d => d.minTemp)).toFixed(0)}° - {Math.max(...forecastData.slice(0, 7).map(d => d.maxTemp)).toFixed(0)}°\n                </div>\n                <div className=\"text-sm text-muted-foreground\">\n                  Next 7 days\n                </div>\n              </div>\n\n              {/* Precipitation */}\n              <div className=\"p-4 bg-muted/30 rounded-lg\">\n                <div className=\"flex items-center gap-2 mb-2\">\n                  <CloudRain className=\"h-5 w-5 text-primary\" />\n                  <span className=\"text-sm font-medium\">Total Precipitation</span>\n                </div>\n                <div className=\"text-2xl font-bold text-blue-600\">\n                  {forecastData.slice(0, 7).reduce((sum, day) => sum + day.precipitation, 0).toFixed(1)}mm\n                </div>\n                <div className=\"text-sm text-muted-foreground\">\n                  Next 7 days\n                </div>\n              </div>\n\n              {/* Wind */}\n              <div className=\"p-4 bg-muted/30 rounded-lg\">\n                <div className=\"flex items-center gap-2 mb-2\">\n                  <Thermometer className=\"h-5 w-5 text-primary\" />\n                  <span className=\"text-sm font-medium\">Max Wind Speed</span>\n                </div>\n                <div className=\"text-2xl font-bold text-orange-600\">\n                  {Math.max(...forecastData.slice(0, 7).map(d => d.windSpeed)).toFixed(1)} km/h\n                </div>\n                <div className=\"text-sm text-muted-foreground\">\n                  Next 7 days\n                </div>\n              </div>\n            </div>\n\n            {/* Last Updated */}\n            {lastUpdated && (\n              <div className=\"text-center text-xs text-muted-foreground pt-4\">\n                Last updated: {new Date(lastUpdated).toLocaleString()}\n              </div>\n            )}\n          </div>\n        ) : (\n          <div className=\"text-center py-8 text-muted-foreground\">\n            No forecast data available\n          </div>\n        )}\n      </GlassCardContent>\n    </GlassCard>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\WeatherStats.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'useRef' is defined but never used.","line":1,"column":53,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":59,"suggestions":[{"messageId":"removeVar","data":{"varName":"useRef"},"fix":{"range":[50,58],"text":""},"desc":"Remove unused variable 'useRef'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useRef' is defined but never used.","line":1,"column":53,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":59},{"ruleId":"no-unused-vars","severity":1,"message":"'Gauge' is defined but never used.","line":6,"column":107,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":112,"suggestions":[{"messageId":"removeVar","data":{"varName":"Gauge"},"fix":{"range":[421,428],"text":""},"desc":"Remove unused variable 'Gauge'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Gauge' is defined but never used.","line":6,"column":107,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":112},{"ruleId":"no-unused-vars","severity":1,"message":"'Compass' is defined but never used.","line":6,"column":114,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":121,"suggestions":[{"messageId":"removeVar","data":{"varName":"Compass"},"fix":{"range":[428,437],"text":""},"desc":"Remove unused variable 'Compass'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Compass' is defined but never used.","line":6,"column":114,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":121},{"ruleId":"no-unused-vars","severity":1,"message":"'setLoading' is assigned a value but never used.","line":37,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"setLoading"},"fix":{"range":[1682,1694],"text":""},"desc":"Remove unused variable 'setLoading'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setLoading' is assigned a value but never used.","line":37,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":37,"endColumn":29},{"ruleId":"no-unused-vars","severity":1,"message":"'setError' is assigned a value but never used.","line":38,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":38,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"setError"},"fix":{"range":[1729,1739],"text":""},"desc":"Remove unused variable 'setError'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setError' is assigned a value but never used.","line":38,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":38,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'toast' is assigned a value but never used.","line":40,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"toast"},"fix":{"range":[1777,1806],"text":""},"desc":"Remove unused variable 'toast'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'toast' is assigned a value but never used.","line":40,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":40,"endColumn":16},{"ruleId":"no-unused-vars","severity":1,"message":"'hasUserConsent' is assigned a value but never used.","line":45,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":45,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"hasUserConsent"},"fix":{"range":[1893,1913],"text":""},"desc":"Remove unused variable 'hasUserConsent'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'hasUserConsent' is assigned a value but never used.","line":45,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":45,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'isRequestingLocation' is assigned a value but never used.","line":49,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":49,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"isRequestingLocation"},"fix":{"range":[1985,2025],"text":""},"desc":"Remove unused variable 'isRequestingLocation'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isRequestingLocation' is assigned a value but never used.","line":49,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":49,"endColumn":39},{"ruleId":"no-unused-vars","severity":1,"message":"'memoizedLocation' is assigned a value but never used.","line":62,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":62,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"memoizedLocation"},"fix":{"range":[2450,2682],"text":""},"desc":"Remove unused variable 'memoizedLocation'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'memoizedLocation' is assigned a value but never used.","line":62,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":62,"endColumn":25},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'locationData'. Either include it or remove the dependency array.","line":68,"column":6,"nodeType":"ArrayExpression","endLine":68,"endColumn":55,"suggestions":[{"desc":"Update the dependencies array to be: [locationData]","fix":{"range":[2631,2680],"text":"[locationData]"}}]},{"ruleId":"no-unused-vars","severity":1,"message":"'forecast' is assigned a value but never used.","line":73,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":73,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"forecast"},"fix":{"range":[2792,2820],"text":""},"desc":"Remove unused variable 'forecast'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'forecast' is assigned a value but never used.","line":73,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":73,"endColumn":27},{"ruleId":"no-unused-vars","severity":1,"message":"'fetchAirQualityData' is assigned a value but never used.","line":135,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":135,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"fetchAirQualityData"},"fix":{"range":[5268,5864],"text":""},"desc":"Remove unused variable 'fetchAirQualityData'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'fetchAirQualityData' is assigned a value but never used.","line":135,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":135,"endColumn":28},{"ruleId":"no-unused-vars","severity":1,"message":"'getCityFromCoordinates' is assigned a value but never used.","line":159,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":159,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"getCityFromCoordinates"},"fix":{"range":[5868,7247],"text":""},"desc":"Remove unused variable 'getCityFromCoordinates'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getCityFromCoordinates' is assigned a value but never used.","line":159,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":159,"endColumn":31},{"ruleId":"no-unused-vars","severity":1,"message":"'getAQILabel' is assigned a value but never used.","line":212,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":212,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"getAQILabel"},"fix":{"range":[7548,7842],"text":""},"desc":"Remove unused variable 'getAQILabel'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getAQILabel' is assigned a value but never used.","line":212,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":212,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":27,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback, useMemo, useRef } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from \"@/components/ui/GlassCard\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { MapPin, Layers, Loader2, AlertTriangle, Wind, Cloud, Sun, CloudRain, Thermometer, Droplets, Eye, Gauge, Compass } from \"lucide-react\";\nimport { useToast } from \"@/components/ui/use-toast\";\nimport { supabase } from \"@/integrations/supabase/client\";\nimport LeafletMap from \"./LeafletMap\";\nimport Header from \"@/components/Header\";\nimport WindDashboard from \"./WindDashboard\";\nimport WeatherForecast from \"./WeatherForecast\";\nimport LocationPermissionBanner from \"./LocationPermissionBanner\";\n\n// Use centralized weather store instead of useWeatherData hook\nimport { useWeatherStore } from \"@/store/weatherStore\";\nimport { useGeolocation } from \"@/hooks/useGeolocation\";\nimport { logGeolocation, logData } from \"@/lib/logger\";\nimport { formatTemperature, formatWindSpeed, formatHumidity, formatVisibility } from \"@/lib/formatters\";\n\n// UserLocation interface is now handled by LocationData from useGeolocation hook\n\ninterface AirQualityData {\n  aqi: number;\n  location: string;\n  timestamp: string;\n}\n\ninterface WeatherStatsProps {\n  showMobileMenu?: boolean;\n  onMobileMenuToggle?: () => void;\n  isDemoMode?: boolean;\n}\n\nexport default function WeatherStats({ showMobileMenu, onMobileMenuToggle, isDemoMode = false }: WeatherStatsProps = {}): JSX.Element {\n  const [airQualityData, setAirQualityData] = useState<AirQualityData | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const { toast } = useToast();\n\n  // Use new geolocation hook for proper location handling\n  const {\n    locationData,\n    hasUserConsent,\n    permissionStatus,\n    requestLocation,\n    getIPBasedLocationAsync,\n    isRequesting: isRequestingLocation\n  } = useGeolocation();\n\n  // Handle IP-based location at component level to avoid Rules of Hooks violation\n  const handleIPBasedLocation = useCallback(async () => {\n    try {\n      await getIPBasedLocationAsync();\n    } catch (error) {\n      logGeolocation.error('IP-based location failed', { error: error.message });\n    }\n  }, [getIPBasedLocationAsync]);\n\n  // Memoize location object to prevent unnecessary re-renders\n  const memoizedLocation = useMemo(() => {\n    if (!locationData) return null;\n    return {\n      latitude: locationData.latitude,\n      longitude: locationData.longitude\n    };\n  }, [locationData?.latitude, locationData?.longitude]);\n\n  // Use centralized weather store instead of useWeatherData hook\n  const { \n    weatherData: currentWeather,\n    forecastData: forecast,\n    isLoading: weatherLoading,\n    error: weatherError,\n    fetchWeatherData,\n    fetchForecastData,\n    setCoordinates\n  } = useWeatherStore();\n\n  // Debug logging for weather data (reduced frequency)\n  useEffect(() => {\n    if (process.env.NODE_ENV === 'development') {\n      logGeolocation.debug('Location data changed', { city: locationData?.city, country: locationData?.country });\n      logData.debug('Weather store state', {\n        loading: weatherLoading,\n        error: weatherError,\n        hasCurrentWeather: !!currentWeather\n      });\n    }\n  }, [locationData, weatherLoading, weatherError, currentWeather]);\n\n  // Trigger weather data fetch only when location truly changes\n  useEffect(() => {\n    if (!locationData?.latitude || !locationData?.longitude) return;\n    \n    if (!currentWeather && !weatherLoading) {\n      logGeolocation.debug('Location available, triggering weather data fetch for coordinates', { latitude: locationData.latitude, longitude: locationData.longitude });\n      \n      // Update weather store coordinates\n      setCoordinates({ latitude: locationData.latitude, longitude: locationData.longitude });\n      \n      // Fetch weather and forecast data using centralized store\n      const fetchData = async () => {\n        try {\n          await Promise.all([\n            fetchWeatherData({ latitude: locationData.latitude, longitude: locationData.longitude }),\n            fetchForecastData({ latitude: locationData.latitude, longitude: locationData.longitude })\n          ]);\n          console.log('WeatherStats: Weather and forecast data fetched successfully');\n        } catch (error) {\n          console.error('WeatherStats: Failed to fetch weather data:', error);\n        }\n      };\n      \n      fetchData();\n    }\n  }, [locationData?.latitude, locationData?.longitude, currentWeather, weatherLoading, setCoordinates, fetchWeatherData, fetchForecastData]);\n\n  // Location permissions are now handled by useGeolocation hook\n\n  // Session storage cleanup is now handled by useGeolocation hook\n\n  // Helper function to convert wind direction degrees to cardinal directions\n  const getWindDirection = (degrees: number): string => {\n    const directions = ['N', 'NNE', 'NE', 'ENE', 'E', 'ESE', 'SE', 'SSE', 'S', 'SSW', 'SW', 'WSW', 'W', 'WNW', 'NW', 'NNW'];\n    const index = Math.round(degrees / 22.5) % 16;\n    return directions[index];\n  };\n\n\n\n  // Location handling is now managed by useGeolocation hook\n\n  const fetchAirQualityData = async (lat: number, lon: number): Promise<void> => {\n    try {\n\n      const { data: response, error } = await supabase.functions.invoke('fetchAQI', {\n        body: { lat, lon }\n      });\n\n      if (error) {\n        console.error('Error fetching air quality data:', error);\n        return;\n      }\n\n      if (response) {\n        setAirQualityData({\n          aqi: response.aqi,\n          location: response.location,\n          timestamp: response.timestamp\n        });\n      }\n    } catch (err) {\n      console.error('Error fetching air quality data:', err);\n    }\n  };\n\n  const getCityFromCoordinates = async (lat: number, lon: number): Promise<{city: string, state: string, country: string}> => {\n    try {\n      // Use environment variable for API key\n      const apiKey = import.meta.env.VITE_OPENWEATHERMAP_API_KEY;\n      \n      // If no API key is available, skip the API call and use coordinates\n      if (!apiKey || apiKey.trim() === '') {\n        console.warn('OpenWeatherMap API key not configured, using coordinates as fallback');\n        return {\n          city: `Location`,\n          state: `(${lat.toFixed(4)}, ${lon.toFixed(4)})`,\n          country: ''\n        };\n      }\n      \n      const response = await fetch(\n        `https://api.openweathermap.org/geo/1.0/reverse?lat=${lat}&lon=${lon}&limit=1&appid=${apiKey}`\n      );\n      \n      if (!response.ok) {\n        throw new Error(`API request failed: ${response.status}`);\n      }\n      \n      const data = await response.json();\n      const location = data[0];\n      \n      return {\n        city: location?.name || 'Your Location',\n        state: location?.state || '',\n        country: location?.country || ''\n      };\n    } catch (err) {\n      console.error('Error getting city name:', err);\n      // Fallback to coordinates if API fails\n      return {\n        city: `Your Location`,\n        state: `(${lat.toFixed(4)}, ${lon.toFixed(4)})`,\n        country: ''\n      };\n    }\n  };\n\n\n\n  const getAQIColor = (aqi: number): string => {\n    if (aqi <= 50) return \"bg-green-500\";\n    if (aqi <= 100) return \"bg-yellow-500\";\n    if (aqi <= 150) return \"bg-orange-500\";\n    if (aqi <= 200) return \"bg-red-500\";\n    if (aqi <= 300) return \"bg-purple-500\";\n    return \"bg-red-800\";\n  };\n\n  const getAQILabel = (aqi: number): string => {\n    if (aqi <= 50) return \"Good\";\n    if (aqi <= 100) return \"Moderate\";\n    if (aqi <= 150) return \"Unhealthy for Sensitive Groups\";\n    if (aqi <= 200) return \"Unhealthy\";\n    if (aqi <= 300) return \"Very Unhealthy\";\n    return \"Hazardous\";\n  };\n\n  // Location permission management is now handled by useGeolocation hook\n\n  if (loading) {\n    return (\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <Header\n          title=\"Weather & Air Quality Stats\"\n          subtitle=\"Comprehensive environmental monitoring\"\n          showMobileMenu={showMobileMenu}\n          onMobileMenuToggle={onMobileMenuToggle}\n        />\n\n        <div className=\"flex items-center justify-center min-h-[400px]\">\n          <div className=\"text-center space-y-4\">\n            <Loader2 className=\"h-8 w-8 animate-spin mx-auto text-primary\" />\n            <p className=\"text-muted-foreground\">Getting your location...</p>\n            <p className=\"text-xs text-muted-foreground\">Please allow location access when prompted</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!locationData && !loading) {\n    return (\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <Header\n          title=\"Weather & Air Quality Stats\"\n          subtitle=\"Comprehensive environmental monitoring\"\n          showMobileMenu={showMobileMenu}\n          onMobileMenuToggle={onMobileMenuToggle}\n        />\n\n        <div className=\"flex items-center justify-center min-h-[400px]\">\n          <div className=\"text-center space-y-4 max-w-md\">\n            <MapPin className=\"h-12 w-12 text-primary mx-auto\" />\n            <h3 className=\"text-lg font-semibold\">\n              Enable Location Services\n            </h3>\n            <p className=\"text-muted-foreground\">\n              Allow location access to view air quality data and nearby monitoring stations on the map.\n            </p>\n            \n            <div className=\"text-sm text-muted-foreground space-y-2 p-4 bg-muted/50 rounded-lg\">\n              <p><strong>What we'll show you:</strong></p>\n              <ul className=\"text-left list-disc list-inside space-y-1\">\n                <li>Your current location on the map</li>\n                <li>Nearby air quality monitoring stations</li>\n                <li>Real-time air quality data for your area</li>\n                <li>Interactive map with detailed station information</li>\n              </ul>\n            </div>\n            \n            <Button onClick={() => requestLocation()} className=\"w-full\" size=\"lg\">\n              <MapPin className=\"h-4 w-4 mr-2\" />\n              Enable Location & View Map\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (error && !locationData) {\n    return (\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <Header\n          title=\"Weather & Air Quality Stats\"\n          subtitle=\"Comprehensive environmental monitoring\"\n          showMobileMenu={showMobileMenu}\n          onMobileMenuToggle={onMobileMenuToggle}\n        />\n\n        <div className=\"flex items-center justify-center min-h-[400px]\">\n          <div className=\"text-center space-y-4 max-w-md\">\n            <AlertTriangle className=\"h-12 w-12 text-destructive mx-auto\" />\n            <h3 className=\"text-lg font-semibold\">Location Access Required</h3>\n            <p className=\"text-muted-foreground max-w-sm\">{error}</p>\n            \n            <div className=\"text-sm text-muted-foreground space-y-2 p-4 bg-muted/50 rounded-lg\">\n              <p><strong>How to enable location access:</strong></p>\n              <ol className=\"text-left list-decimal list-inside space-y-1\">\n                <li>Allow location access when prompted</li>\n                <li>Check browser settings if no prompt appears</li>\n                <li>On mobile: Settings → Privacy → Location Services</li>\n                <li>Refresh the page after enabling location</li>\n              </ol>\n            </div>\n            \n            <div className=\"flex flex-col gap-2\">\n              <Button onClick={() => requestLocation()} variant=\"outline\" className=\"w-full\">\n                <MapPin className=\"h-4 w-4 mr-2\" />\n                Try Again Now\n              </Button>\n              <Button \n                onClick={handleIPBasedLocation}\n                variant=\"secondary\"\n                className=\"w-full\"\n              >\n                Use IP-Based Location\n              </Button>\n              <Button \n                onClick={() => window.location.reload()} \n                variant=\"secondary\"\n                className=\"w-full\"\n              >\n                Refresh Page\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <Header\n        title=\"Weather & Air Quality Stats\"\n        subtitle=\"Comprehensive environmental monitoring\"\n        showMobileMenu={showMobileMenu}\n        onMobileMenuToggle={onMobileMenuToggle}\n      />\n\n      {/* Location Permission Banner */}\n      {!isDemoMode && (\n        <LocationPermissionBanner\n          onLocationRequest={async () => {\n            try {\n              await requestLocation();\n            } catch (error) {\n              console.error('Location request failed:', error);\n            }\n          }}\n          onSkip={() => {\n            // Call useIPBasedLocation at component level, not in callback\n            handleIPBasedLocation();\n          }}\n          permissionStatus={permissionStatus}\n          locationSource={locationData?.source}\n          city={locationData?.city}\n          country={locationData?.country}\n        />\n      )}\n\n      {/* Demo Mode Banner */}\n      {isDemoMode && (\n        <motion.div\n          className=\"bg-gradient-to-r from-blue-500 to-purple-600 text-white p-4 rounded-lg shadow-lg\"\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5, ease: \"easeOut\" }}\n        >\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center\">\n                <span className=\"text-white font-bold text-sm\">🎯</span>\n              </div>\n              <div>\n                <h3 className=\"font-semibold\">Demo Mode</h3>\n                <p className=\"text-sm text-blue-100\">You're viewing a limited preview. Create an account to unlock all features!</p>\n              </div>\n            </div>\n            <Button\n              size=\"sm\"\n              onClick={() => window.location.href = \"/onboarding\"}\n              className=\"bg-white text-blue-600 hover:bg-blue-50\"\n            >\n              Get Started\n            </Button>\n          </div>\n        </motion.div>\n      )}\n\n      {/* Weather Stats Overview */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        {/* Air Quality Card */}\n        <GlassCard className=\"floating-card\">\n          <GlassCardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <GlassCardTitle className=\"text-sm font-medium\">Air Quality Index</GlassCardTitle>\n            <Badge variant={airQualityData?.aqi && airQualityData.aqi <= 50 ? \"default\" : \"destructive\"}>\n              {airQualityData?.aqi || 'N/A'}\n            </Badge>\n          </GlassCardHeader>\n          <GlassCardContent>\n            <div className=\"text-2xl font-bold\">\n              {airQualityData?.aqi ? (\n                airQualityData.aqi <= 50 ? 'Good' :\n                airQualityData.aqi <= 100 ? 'Moderate' :\n                airQualityData.aqi <= 150 ? 'Unhealthy for Sensitive Groups' :\n                airQualityData.aqi <= 200 ? 'Unhealthy' :\n                airQualityData.aqi <= 300 ? 'Very Unhealthy' : 'Hazardous'\n              ) : 'Unknown'}\n            </div>\n            <p className=\"text-xs text-muted-foreground\">\n              {airQualityData?.location} • {airQualityData?.timestamp ? new Date(airQualityData.timestamp).toLocaleString() : 'N/A'}\n            </p>\n          </GlassCardContent>\n        </GlassCard>\n\n        {/* Location Card */}\n        <GlassCard className=\"floating-card\">\n          <GlassCardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <GlassCardTitle className=\"text-sm font-medium\">Current Location</GlassCardTitle>\n            <MapPin className=\"h-4 w-4 text-muted-foreground\" />\n          </GlassCardHeader>\n          <GlassCardContent>\n            <div className=\"text-2xl font-bold\">{locationData?.city || 'Unknown'}</div>\n            <p className=\"text-xs text-muted-foreground\">\n              {locationData?.country}\n            </p>\n            <p className=\"text-xs text-muted-foreground\">\n              {locationData?.latitude?.toFixed(4)}, {locationData?.longitude?.toFixed(4)}\n            </p>\n          </GlassCardContent>\n        </GlassCard>\n\n        {/* Weather Conditions Card */}\n        <GlassCard className=\"floating-card\">\n          <GlassCardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <GlassCardTitle className=\"text-sm font-medium\">Weather Conditions</GlassCardTitle>\n            {currentWeather?.weatherCondition === 'Rain' ? (\n              <CloudRain className=\"h-4 w-4 text-muted-foreground\" />\n            ) : currentWeather?.weatherCondition === 'Clouds' ? (\n              <Cloud className=\"h-4 w-4 text-muted-foreground\" />\n            ) : (\n              <Sun className=\"h-4 w-4 text-muted-foreground\" />\n            )}\n          </GlassCardHeader>\n          <GlassCardContent>\n            {weatherLoading ? (\n              <div className=\"text-2xl font-bold\">Loading...</div>\n            ) : currentWeather ? (\n              <>\n                <div className=\"text-2xl font-bold flex items-center gap-2\">\n                  <Thermometer className=\"h-6 w-6 text-orange-500\" />\n                  {currentWeather.temperature}°C\n                </div>\n                <div className=\"text-sm text-muted-foreground space-y-1 mt-2\">\n                  <div className=\"flex items-center gap-2\">\n                    <Droplets className=\"h-3 w-3 text-blue-500\" />\n                    Humidity: {currentWeather.humidity}%\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <Wind className=\"h-5 w-5 text-slate-600 dark:text-slate-400\" />\n                    <span>Wind Speed</span>\n                  </div>\n                  <div className=\"text-2xl font-bold text-slate-700 dark:text-slate-300\">\n                    {currentWeather.windSpeed} km/h\n                  </div>\n                  {currentWeather.feelsLikeTemperature && (\n                    <div className=\"flex items-center gap-2\">\n                      <Eye className=\"h-3 w-3 text-purple-500\" />\n                      Feels like: {currentWeather.feelsLikeTemperature}°C\n                    </div>\n                  )}\n                </div>\n              </>\n            ) : (\n              <div className=\"text-2xl font-bold text-muted-foreground\">\n                {weatherError ? 'Weather data unavailable' : 'No Data'}\n              </div>\n            )}\n            <p className=\"text-xs text-muted-foreground mt-2\">\n              {currentWeather?.timestamp ? \n                `Updated: ${new Date(currentWeather.timestamp).toLocaleTimeString()}` : \n                weatherLoading ? 'Loading weather data...' : 'Weather data unavailable'\n              }\n            </p>\n            {/* Show refresh status instead of error messages */}\n            {weatherError && !currentWeather && (\n              <div className=\"text-xs text-muted-foreground mt-2 p-2 bg-muted/30 rounded\">\n                <div className=\"flex items-center gap-2\">\n                  <Loader2 className=\"h-3 w-3 animate-spin\" />\n                  <span>Refreshing weather data...</span>\n                </div>\n              </div>\n            )}\n            {/* Debug info in development */}\n            {process.env.NODE_ENV === 'development' && (\n              <div className=\"text-xs text-muted-foreground mt-2 p-2 bg-muted/30 rounded\">\n                <strong>Debug:</strong> Loading: {weatherLoading.toString()}, \n                Has Data: {(!!currentWeather).toString()}, \n                Error: {weatherError || 'None'}\n              </div>\n            )}\n          </GlassCardContent>\n        </GlassCard>\n      </div>\n\n      {/* Comprehensive Weather Data */}\n      {locationData && currentWeather && (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n          {/* Temperature & Feels Like */}\n          <GlassCard className=\"floating-card\">\n            <GlassCardHeader className=\"pb-2\">\n              <GlassCardTitle className=\"text-sm font-medium flex items-center gap-2\">\n                <Thermometer className=\"h-4 w-4\" />\n                Temperature\n              </GlassCardTitle>\n            </GlassCardHeader>\n            <GlassCardContent className=\"pt-0\">\n              <div className=\"text-2xl font-bold text-orange-600 dark:text-orange-400\">\n                {currentWeather.temperature}°C\n              </div>\n              <p className=\"text-xs text-muted-foreground\">\n                Feels like {currentWeather.feelsLikeTemperature || currentWeather.temperature}°C\n              </p>\n            </GlassCardContent>\n          </GlassCard>\n\n          {/* Humidity & Pressure */}\n          <GlassCard className=\"floating-card\">\n            <GlassCardHeader className=\"pb-2\">\n              <GlassCardTitle className=\"text-sm font-medium flex items-center gap-2\">\n                <Droplets className=\"h-4 w-4\" />\n                Humidity\n              </GlassCardTitle>\n            </GlassCardHeader>\n            <GlassCardContent className=\"pt-0\">\n              <div className=\"text-2xl font-bold text-blue-600 dark:text-blue-400\">\n                {currentWeather.humidity}%\n              </div>\n              <p className=\"text-xs text-muted-foreground\">\n                Dew point {currentWeather.airPressure || 'N/A'} hPa\n              </p>\n            </GlassCardContent>\n          </GlassCard>\n\n          {/* Wind Information */}\n          <GlassCard className=\"floating-card\">\n            <GlassCardHeader className=\"pb-2\">\n              <GlassCardTitle className=\"text-sm font-medium flex items-center gap-2\">\n                <Wind className=\"h-4 w-4\" />\n                Wind\n              </GlassCardTitle>\n            </GlassCardHeader>\n            <GlassCardContent className=\"pt-0\">\n              <div className=\"text-2xl font-bold text-slate-700 dark:text-slate-300\">\n                {currentWeather.windSpeed} km/h\n              </div>\n              <div className=\"text-sm text-muted-foreground\">\n                {currentWeather.windDirection}° {getWindDirection(currentWeather.windDirection)}\n              </div>\n            </GlassCardContent>\n          </GlassCard>\n\n          {/* Visibility & UV */}\n          <GlassCard className=\"floating-card\">\n            <GlassCardHeader className=\"pb-2\">\n              <GlassCardTitle className=\"text-sm font-medium flex items-center gap-2\">\n                <Eye className=\"h-4 w-4\" />\n                Visibility\n              </GlassCardTitle>\n            </GlassCardHeader>\n            <GlassCardContent className=\"pt-0\">\n              <div className=\"text-2xl font-bold text-purple-600 dark:text-orange-400\">\n                {currentWeather.visibility || 'N/A'} km\n              </div>\n              <p className=\"text-xs text-muted-foreground\">\n                UV index {currentWeather.uvIndex || 'N/A'}\n              </p>\n            </GlassCardContent>\n          </GlassCard>\n        </div>\n      )}\n\n      {/* Wind Dashboard */}\n      {locationData && (\n        <WindDashboard \n          latitude={locationData.latitude} \n          longitude={locationData.longitude} \n        />\n      )}\n\n      {/* Weather Forecast */}\n      {locationData && (\n        <WeatherForecast \n          latitude={locationData.latitude} \n          longitude={locationData.longitude} \n        />\n      )}\n\n\n\n      {/* Map Container - Google Maps Style */}\n      <GlassCard className=\"floating-card relative h-[calc(100vh-200px)] min-h-[600px] shadow-card overflow-hidden\">\n        <GlassCardContent className=\"p-0 h-full relative\">\n          {/* Map Header - Fixed at top */}\n          <div className=\"absolute top-0 left-0 right-0 z-30 bg-gradient-to-r from-card/95 via-card/90 to-card/95 backdrop-blur-md border-b border-border/50\">\n            <div className=\"p-4\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-4\">\n                  <div>\n                    <h1 className=\"text-xl font-bold text-foreground\">\n                      Weather & Air Quality Map\n                    </h1>\n                    <p className=\"text-sm text-muted-foreground\">\n                      {locationData ? `${locationData.city}, ${locationData.country}` : 'Loading location...'}\n                    </p>\n                  </div>\n                  {airQualityData && (\n                    <div className=\"flex items-center gap-3\">\n                      <Badge \n                        variant=\"secondary\"\n                        className={`${getAQIColor(airQualityData.aqi)} text-white border-0 px-3 py-1 text-sm font-semibold`}\n                      >\n                        AQI {airQualityData.aqi}\n                      </Badge>\n                      <span className=\"text-xs text-muted-foreground\">\n                        Last updated: {airQualityData.timestamp}\n                      </span>\n                    </div>\n                  )}\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Button variant=\"outline\" size=\"sm\" className=\"gap-2\">\n                    <Layers className=\"h-4 w-4\" />\n                    Map Layers\n                  </Button>\n                  <Button variant=\"outline\" size=\"sm\" className=\"gap-2\">\n                    <MapPin className=\"h-4 w-4\" />\n                    My Location\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Leaflet Map Integration - Full width/height within card */}\n          <div className=\"w-full h-full pt-20\">\n            <LeafletMap\n              userLocation={locationData}\n              airQualityData={airQualityData}\n            />\n          </div>\n        </GlassCardContent>\n      </GlassCard>\n\n      {/* Information Grid Beneath Map */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n        {/* Location Information Card */}\n        {locationData && (\n          <GlassCard>\n            <GlassCardHeader className=\"flex flex-row items-center space-y-0 pb-2\">\n              <MapPin className=\"h-4 w-4 text-primary mr-2\" />\n              <GlassCardTitle className=\"text-sm font-medium\">Location Details</GlassCardTitle>\n            </GlassCardHeader>\n            <GlassCardContent className=\"space-y-3\">\n              <div className=\"space-y-2\">\n                <div className=\"flex justify-between\">\n                  <span className=\"text-sm text-muted-foreground\">City:</span>\n                  <span className=\"text-sm font-medium\">{locationData.city}</span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-sm text-muted-foreground\">Country:</span>\n                  <span className=\"text-sm font-medium\">{locationData.country}</span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-sm text-muted-foreground\">Coordinates:</span>\n                  <span className=\"text-sm font-medium\">\n                    {locationData.latitude.toFixed(4)}, {locationData.longitude.toFixed(4)}\n                  </span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-sm text-muted-foreground\">Source:</span>\n                  <span className=\"text-sm font-medium capitalize\">{locationData.source}</span>\n                </div>\n              </div>\n            </GlassCardContent>\n          </GlassCard>\n        )}\n\n        {/* Weather Summary Card */}\n        {currentWeather && (\n          <GlassCard>\n            <GlassCardHeader className=\"flex flex-row items-center space-y-0 pb-2\">\n              <Cloud className=\"h-4 w-4 text-blue-500 mr-2\" />\n              <GlassCardTitle className=\"text-sm font-medium\">Weather Summary</GlassCardTitle>\n            </GlassCardHeader>\n            <GlassCardContent className=\"space-y-3\">\n              <div className=\"grid grid-cols-2 gap-3 text-sm\">\n                <div className=\"flex items-center gap-2\">\n                  <Thermometer className=\"h-3 w-3 text-red-500\" />\n                  <span className=\"text-muted-foreground\">Temp:</span>\n                  <span className=\"font-medium\">{formatTemperature(currentWeather.temperature)}</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Droplets className=\"h-3 w-3 text-blue-500\" />\n                  <span className=\"text-muted-foreground\">Humidity:</span>\n                  <span className=\"font-medium\">{formatHumidity(currentWeather.humidity)}</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Wind className=\"h-3 w-3 text-green-500\" />\n                  <span className=\"text-muted-foreground\">Wind:</span>\n                  <span className=\"font-medium\">{formatWindSpeed(currentWeather.windSpeed)}</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Eye className=\"h-3 w-3 text-purple-500\" />\n                  <span className=\"text-muted-foreground\">Visibility:</span>\n                  <span className=\"font-medium\">{formatVisibility(currentWeather.visibility)}</span>\n                </div>\n              </div>\n              {currentWeather.feelsLikeTemperature && (\n                <div className=\"flex items-center gap-2 text-sm\">\n                  <Thermometer className=\"h-3 w-3 text-orange-500\" />\n                  <span className=\"text-muted-foreground\">Feels like:</span>\n                  <span className=\"font-medium\">{currentWeather.feelsLikeTemperature}°C</span>\n                </div>\n              )}\n            </GlassCardContent>\n          </GlassCard>\n        )}\n\n        {/* Map Legend Card */}\n        <GlassCard>\n          <GlassCardHeader className=\"flex flex-row items-center space-y-0 pb-2\">\n            <Layers className=\"h-4 w-4 text-muted-foreground mr-2\" />\n            <GlassCardTitle className=\"text-sm font-medium\">Map Legend</GlassCardTitle>\n          </GlassCardHeader>\n          <GlassCardContent className=\"space-y-2\">\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-3 h-3 rounded-full bg-blue-500\"></div>\n                <span className=\"text-xs text-muted-foreground\">Your Location</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-3 h-3 rounded-full bg-green-500\"></div>\n                <span className=\"text-xs text-muted-foreground\">Good Air Quality</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-3 h-3 rounded-full bg-yellow-500\"></div>\n                <span className=\"text-xs text-muted-foreground\">Moderate Air Quality</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-3 h-3 rounded-full bg-red-500\"></div>\n                <span className=\"text-xs text-muted-foreground\">Poor Air Quality</span>\n              </div>\n            </div>\n          </GlassCardContent>\n        </GlassCard>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\WeatherStatsCard.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Compass' is defined but never used.","line":5,"column":100,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":107,"suggestions":[{"messageId":"removeVar","data":{"varName":"Compass"},"fix":{"range":[373,382],"text":""},"desc":"Remove unused variable 'Compass'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Compass' is defined but never used.","line":5,"column":100,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":107},{"ruleId":"no-unused-vars","severity":1,"message":"'useWeatherData' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"useWeatherData"},"fix":{"range":[469,525],"text":""},"desc":"Remove unused variable 'useWeatherData'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useWeatherData' is defined but never used.","line":7,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, useMemo } from \"react\";\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from \"@/components/ui/GlassCard\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Sun, Cloud, CloudRain, Thermometer, Droplets, Eye, RefreshCw, AlertTriangle, Wind, Gauge, Compass, Loader2 } from \"lucide-react\";\nimport { useToast } from \"@/components/ui/use-toast\";\nimport { useWeatherData } from \"@/hooks/useWeatherData\";\nimport { formatTemperature, formatWindSpeed, formatHumidity, formatVisibility, formatAirPressure } from \"@/lib/formatters\";\n\ninterface WeatherData {\n  temperature: number;\n  feelsLike: number;\n  humidity: number;\n  rainProbability: number;\n  sunrise: string;\n  sunset: string;\n  weatherCode: number;\n  description: string;\n  windSpeed?: number;\n  windDirection?: number;\n  airPressure?: number;\n  visibility?: number;\n}\n\ninterface WeatherStatsCardProps {\n  latitude: number;\n  longitude: number;\n}\n\n// Memoize the component to prevent unnecessary re-renders\nconst WeatherStatsCard = React.memo(({ \n  latitude, \n  longitude \n}: WeatherStatsCardProps): JSX.Element => {\n  const [weatherData, setWeatherData] = useState<WeatherData | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [lastUpdated, setLastUpdated] = useState<string | null>(null);\n  const { toast } = useToast();\n\n  // Memoize coordinates with explicit typing and initialization\n  const memoizedCoordinates = useMemo<{ latitude: number; longitude: number }>(() => {\n    return {\n      latitude: Number(latitude) || 0,\n      longitude: Number(longitude) || 0\n    };\n  }, [latitude, longitude]);\n\n  // Memoize fetch function to prevent recreation on every render\n  const fetchWeatherData = useCallback(async (): Promise<void> => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      // Validate coordinates before making API call\n      if (!latitude || !longitude || isNaN(latitude) || isNaN(longitude)) {\n        throw new Error('Invalid coordinates provided');\n      }\n\n      if (process.env.NODE_ENV === 'development') {\n        console.log('WeatherStatsCard: Fetching weather data for coordinates:', { latitude, longitude });\n      }\n\n      const apiKey = import.meta.env.VITE_OPENWEATHERMAP_API_KEY;\n      if (!apiKey) {\n        console.error('WeatherStatsCard: OpenWeatherMap API key not configured');\n        throw new Error('OpenWeatherMap API key not configured');\n      }\n\n      if (process.env.NODE_ENV === 'development') {\n        console.log('WeatherStatsCard: API key configured, making request to OpenWeatherMap');\n        console.log('WeatherStatsCard: API key length:', apiKey.length);\n        console.log('WeatherStatsCard: API key starts with:', apiKey.substring(0, 4) + '...');\n      }\n\n      const response = await fetch(\n        `https://api.openweathermap.org/data/2.5/weather?lat=${latitude}&lon=${longitude}&appid=${apiKey}&units=metric`\n      );\n\n      if (process.env.NODE_ENV === 'development') {\n        console.log('WeatherStatsCard: API response status:', response.status);\n      }\n\n      if (response.ok) {\n        const data = await response.json();\n        \n        setWeatherData({\n          temperature: data.main.temp,\n          feelsLike: data.main.feels_like,\n          humidity: data.main.humidity,\n          rainProbability: data.pop ? data.pop * 100 : 0,\n          sunrise: new Date(data.sys.sunrise * 1000).toLocaleTimeString('en-US', { \n            hour: '2-digit', \n            minute: '2-digit',\n            hour12: true \n          }),\n          sunset: new Date(data.sys.sunset * 1000).toLocaleTimeString('en-US', { \n            hour: '2-digit', \n            minute: '2-digit',\n            hour12: true \n          }),\n          weatherCode: data.weather[0].id,\n          description: data.weather[0].description,\n          windSpeed: data.wind?.speed ? data.wind.speed * 3.6 : undefined, // Convert m/s to km/h\n          windDirection: data.wind?.deg,\n          airPressure: data.main.pressure,\n          visibility: data.visibility ? data.visibility / 1000 : undefined // Convert m to km\n        });\n        \n        setLastUpdated(new Date().toISOString());\n        toast({\n          title: \"Weather Updated\",\n          description: \"Successfully fetched current weather data\",\n        });\n      } else {\n        // Provide more specific error messages based on status code\n        let errorMessage = `API request failed: ${response.status}`;\n        if (response.status === 400) {\n          errorMessage = 'Invalid coordinates or API key';\n        } else if (response.status === 401) {\n          errorMessage = 'Invalid API key';\n        } else if (response.status === 429) {\n          errorMessage = 'API rate limit exceeded';\n        } else if (response.status >= 500) {\n          errorMessage = 'Weather service temporarily unavailable';\n        }\n        throw new Error(errorMessage);\n      }\n    } catch (error) {\n      console.error('Error fetching weather data:', error);\n      setError('Failed to fetch weather data');\n      toast({\n        title: \"Weather Error\",\n        description: \"Unable to fetch weather data. Please try again later.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setLoading(false);\n    }\n  }, [latitude, longitude, toast]);\n\n  // Weather icon mapping function\n  const getWeatherIcon = (weatherCode: number) => {\n    if (weatherCode >= 200 && weatherCode < 300) return <Cloud className=\"h-6 w-6 text-yellow-500\" />; // Thunderstorm\n    if (weatherCode >= 300 && weatherCode < 400) return <CloudRain className=\"h-6 w-6 text-blue-500\" />; // Drizzle\n    if (weatherCode >= 500 && weatherCode < 600) return <CloudRain className=\"h-6 w-6 text-blue-600\" />; // Rain\n    if (weatherCode >= 600 && weatherCode < 700) return <Cloud className=\"h-6 w-6 text-blue-400\" />; // Snow\n    if (weatherCode >= 700 && weatherCode < 800) return <Cloud className=\"h-6 w-6 text-slate-500\" />; // Atmosphere (fog, mist)\n    if (weatherCode === 800) return <Sun className=\"h-6 w-6 text-yellow-500\" />; // Clear\n    if (weatherCode >= 801 && weatherCode < 900) return <Cloud className=\"h-6 w-6 text-slate-400\" />; // Clouds\n    return <Cloud className=\"h-6 w-6 text-slate-500\" />; // Default\n  };\n\n  // Helper function to convert wind direction degrees to cardinal directions\n  const getWindDirection = (degrees: number): string => {\n    const directions = ['N', 'NNE', 'NE', 'ENE', 'E', 'ESE', 'SE', 'SSE', 'S', 'SSW', 'SW', 'WSW', 'W', 'WNW', 'NW', 'NNW'];\n    const index = Math.round(degrees / 22.5) % 16;\n    return directions[index];\n  };\n\n  const getTemperatureColor = (temp: number): string => {\n    if (temp < 0) return 'text-blue-600';\n    if (temp < 15) return 'text-green-600';\n    if (temp < 25) return 'text-yellow-600';\n    if (temp < 35) return 'text-orange-600';\n    return 'text-red-600';\n  };\n\n  // Fetch weather data when coordinates change (memoized coordinates)\n  useEffect(() => {\n    if (memoizedCoordinates.latitude && memoizedCoordinates.longitude && \n        !isNaN(memoizedCoordinates.latitude) && !isNaN(memoizedCoordinates.longitude)) {\n      fetchWeatherData();\n    }\n  }, [memoizedCoordinates.latitude, memoizedCoordinates.longitude, fetchWeatherData]);\n\n  // Auto-refresh every 15 minutes (memoized coordinates)\n  useEffect(() => {\n    if (!memoizedCoordinates.latitude || !memoizedCoordinates.longitude || \n        isNaN(memoizedCoordinates.latitude) || isNaN(memoizedCoordinates.longitude)) {\n      return; // Don't set up auto-refresh if coordinates are invalid\n    }\n\n    const interval = setInterval(fetchWeatherData, 15 * 60 * 1000);\n    return () => clearInterval(interval);\n  }, [memoizedCoordinates.latitude, memoizedCoordinates.longitude, fetchWeatherData]);\n\n  // Show message if coordinates are not available\n  if (!latitude || !longitude || isNaN(latitude) || isNaN(longitude)) {\n    return (\n      <GlassCard className=\"floating-card\">\n        <GlassCardHeader>\n          <GlassCardTitle className=\"flex items-center gap-2\">\n            <Thermometer className=\"h-5 w-5 text-blue-600\" />\n            <span className=\"font-bold\">Weather Information</span>\n          </GlassCardTitle>\n        </GlassCardHeader>\n        <GlassCardContent>\n          <div className=\"text-center py-8 text-muted-foreground\">\n            <AlertTriangle className=\"h-12 w-12 mx-auto mb-4 text-muted-foreground/50\" />\n            <p>Weather data unavailable</p>\n            <p className=\"text-sm\">Location coordinates not available</p>\n          </div>\n        </GlassCardContent>\n      </GlassCard>\n    );\n  }\n\n  if (loading && !weatherData) {\n    return (\n      <GlassCard variant=\"subtle\">\n        <GlassCardHeader>\n          <GlassCardTitle className=\"text-sm font-medium flex items-center gap-2\">\n            <Loader2 className=\"h-4 w-4 animate-spin\" />\n            Loading Weather Data...\n          </GlassCardTitle>\n        </GlassCardHeader>\n        <GlassCardContent className=\"pt-0\">\n          <div className=\"text-center py-4\">\n            <p className=\"text-sm text-muted-foreground\">Fetching current weather conditions...</p>\n          </div>\n        </GlassCardContent>\n      </GlassCard>\n    );\n  }\n\n  if (error && !weatherData) {\n    return (\n      <GlassCard variant=\"elevated\">\n        <GlassCardHeader>\n          <GlassCardTitle className=\"flex items-center gap-2\">\n            <Thermometer className=\"h-5 w-5\" />\n            <span className=\"font-bold\">Current Weather</span>\n          </GlassCardTitle>\n        </GlassCardHeader>\n        <GlassCardContent>\n          <div className=\"text-center py-8 space-y-4\">\n            <AlertTriangle className=\"h-12 w-12 text-destructive mx-auto\" />\n            <p className=\"text-muted-foreground\">{error}</p>\n            <Button onClick={fetchWeatherData} variant=\"outline\" className=\"btn-modern\">\n              <RefreshCw className=\"h-4 w-4 mr-2\" />\n              Retry\n            </Button>\n          </div>\n        </GlassCardContent>\n      </GlassCard>\n    );\n  }\n\n  return (\n    <GlassCard variant=\"default\">\n      <GlassCardHeader>\n        <div className=\"flex items-center justify-between\">\n          <GlassCardTitle className=\"flex items-center gap-2\">\n            <Thermometer className=\"h-5 w-4\" />\n            <span className=\"font-bold\">Current Weather</span>\n          </GlassCardTitle>\n          <Button onClick={fetchWeatherData} size=\"sm\" variant=\"outline\" className=\"btn-modern\">\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\n            Refresh\n          </Button>\n        </div>\n      </GlassCardHeader>\n      <GlassCardContent>\n        {weatherData ? (\n          <div className=\"space-y-4\">\n            {/* Main Weather Display */}\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-4\">\n                {getWeatherIcon(weatherData.weatherCode)}\n                <div>\n                  <div className={`text-3xl font-bold ${getTemperatureColor(weatherData.temperature)}`}>\n                    {formatTemperature(weatherData.temperature)}\n                  </div>\n                  <div className=\"text-sm text-muted-foreground\">\n                    Feels like {formatTemperature(weatherData.feelsLike)}\n                  </div>\n                </div>\n              </div>\n              <div className=\"text-right\">\n                <Badge variant=\"secondary\" className=\"capitalize\">\n                  {weatherData.description}\n                </Badge>\n              </div>\n            </div>\n\n            {/* Weather Stats Grid */}\n            <div className=\"grid grid-cols-2 gap-4\">\n              <GlassCard variant=\"subtle\" className=\"text-center p-3\">\n                <div className=\"flex items-center justify-center gap-2 mb-2\">\n                  <Droplets className=\"h-4 w-4 text-blue-500\" />\n                  <span className=\"text-sm font-semibold\">Humidity</span>\n                </div>\n                <div className=\"text-xl font-bold text-blue-600\">\n                  {formatHumidity(weatherData.humidity)}\n                </div>\n              </GlassCard>\n\n              <GlassCard variant=\"subtle\" className=\"text-center p-3\">\n                <div className=\"flex items-center justify-center gap-2 mb-2\">\n                  <CloudRain className=\"h-4 w-4 text-blue-500\" />\n                  <span className=\"text-sm font-semibold\">Rain Chance</span>\n                </div>\n                <div className=\"text-xl font-bold text-blue-600\">\n                  {formatHumidity(weatherData.rainProbability)}\n                </div>\n              </GlassCard>\n            </div>\n\n            {/* Additional Weather Data */}\n            {(weatherData.windSpeed || weatherData.airPressure || weatherData.visibility) && (\n              <div className=\"grid grid-cols-2 gap-4\">\n                {weatherData.windSpeed && (\n                  <GlassCard variant=\"subtle\" className=\"text-center p-3\">\n                    <div className=\"flex items-center justify-center gap-2 mb-2\">\n                      <Wind className=\"h-4 w-4 text-slate-500\" />\n                      <span className=\"text-sm font-semibold\">Wind</span>\n                    </div>\n                    <div className=\"text-lg font-semibold text-slate-600\">\n                      {formatWindSpeed(weatherData.windSpeed)}\n                    </div>\n                    {weatherData.windDirection && (\n                      <div className=\"text-xs text-muted-foreground\">\n                        {weatherData.windDirection}° {getWindDirection(weatherData.windDirection)}\n                      </div>\n                    )}\n                  </GlassCard>\n                )}\n\n                {weatherData.airPressure && (\n                  <GlassCard variant=\"subtle\" className=\"text-center p-3\">\n                    <div className=\"flex items-center justify-center gap-2 mb-2\">\n                      <Gauge className=\"h-4 w-4 text-purple-500\" />\n                      <span className=\"text-sm font-semibold\">Pressure</span>\n                    </div>\n                    <div className=\"text-lg font-semibold text-purple-600\">\n                      {formatAirPressure(weatherData.airPressure)}\n                    </div>\n                  </GlassCard>\n                )}\n\n                {weatherData.visibility && (\n                  <GlassCard variant=\"subtle\" className=\"text-center p-3\">\n                    <div className=\"flex items-center justify-center gap-2 mb-2\">\n                      <Eye className=\"h-4 w-4 text-indigo-500\" />\n                      <span className=\"text-sm font-semibold\">Visibility</span>\n                    </div>\n                    <div className=\"text-lg font-semibold text-indigo-600\">\n                      {formatVisibility(weatherData.visibility)}\n                    </div>\n                  </GlassCard>\n                )}\n              </div>\n            )}\n\n            {/* Sunrise/Sunset */}\n            <div className=\"grid grid-cols-2 gap-4\">\n              <GlassCard variant=\"subtle\" className=\"text-center p-3\">\n                <div className=\"flex items-center justify-center gap-2 mb-2\">\n                  <Sun className=\"h-4 w-4 text-yellow-500\" />\n                  <span className=\"text-sm font-semibold\">Sunrise</span>\n                </div>\n                <div className=\"text-lg font-semibold text-yellow-600\">\n                  {weatherData.sunrise}\n                </div>\n              </GlassCard>\n\n              <GlassCard variant=\"subtle\" className=\"text-center p-3\">\n                <div className=\"flex items-center justify-center gap-2 mb-2\">\n                  <Sun className=\"h-4 w-4 text-orange-500\" />\n                  <span className=\"text-sm font-semibold\">Sunset</span>\n                </div>\n                <div className=\"text-lg font-semibold text-orange-600\">\n                  {weatherData.sunset}\n                </div>\n              </GlassCard>\n            </div>\n\n            {/* Last Updated */}\n            {lastUpdated && (\n              <div className=\"text-center text-xs text-muted-foreground pt-2\">\n                Last updated: {new Date(lastUpdated).toLocaleTimeString()}\n              </div>\n            )}\n          </div>\n        ) : (\n          <div className=\"text-center py-8 text-muted-foreground\">\n            No weather data available\n          </div>\n        )}\n              </GlassCardContent>\n      </GlassCard>\n  );\n});\n\nexport default WeatherStatsCard;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\WindDashboard.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchWindData'. Either include it or remove the dependency array.","line":125,"column":6,"nodeType":"ArrayExpression","endLine":125,"endColumn":27,"suggestions":[{"desc":"Update the dependencies array to be: [fetchWindData, latitude, longitude]","fix":{"range":[4252,4273],"text":"[fetchWindData, latitude, longitude]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from \"@/components/ui/GlassCard\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Wind, Gauge, Compass, TrendingUp, AlertTriangle, RefreshCw } from \"lucide-react\";\nimport { useToast } from \"@/components/ui/use-toast\";\n\ninterface WindData {\n  windSpeed: number;\n  windDirection: number;\n  gustSpeed: number;\n  timestamp: string;\n}\n\ninterface WindDashboardProps {\n  latitude: number;\n  longitude: number;\n}\n\nexport default function WindDashboard({ latitude, longitude }: WindDashboardProps): JSX.Element {\n  const [windData, setWindData] = useState<WindData | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [lastUpdated, setLastUpdated] = useState<string | null>(null);\n  const { toast } = useToast();\n\n  const fetchWindData = async (): Promise<void> => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      // Try Open-Meteo API first\n      const openMeteoResponse = await fetch(\n        `https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current=wind_speed_10m,wind_direction_10m,wind_gusts_10m&timezone=auto`\n      );\n\n      if (openMeteoResponse.ok) {\n        const data = await openMeteoResponse.json();\n        const current = data.current;\n        \n        setWindData({\n          windSpeed: current.wind_speed_10m,\n          windDirection: current.wind_direction_10m,\n          gustSpeed: current.wind_gusts_10m || 0,\n          timestamp: current.time\n        });\n        \n        setLastUpdated(new Date().toISOString());\n        toast({\n          title: \"Wind Data Updated\",\n          description: \"Successfully fetched wind data from Open-Meteo\",\n        });\n        return;\n      }\n    } catch (error) {\n      console.warn('Open-Meteo API failed:', error);\n    }\n\n    // Fallback to Windy API if Open-Meteo fails\n    try {\n      const windyResponse = await fetch(\n        `https://api.windy.com/api/point-forecast/v2?lat=${latitude}&lon=${longitude}&key=${import.meta.env.VITE_WINDY_API_KEY || 'demo'}&model=gfs&parameters=wind`\n      );\n\n      if (windyResponse.ok) {\n        const data = await windyResponse.json();\n        // Extract wind data from Windy API response\n        // Note: This is a simplified example - actual Windy API response structure may differ\n        const windInfo = data.wind || {};\n        \n        setWindData({\n          windSpeed: windInfo.speed || 0,\n          windDirection: windInfo.direction || 0,\n          gustSpeed: windInfo.gust || 0,\n          timestamp: new Date().toISOString()\n        });\n        \n        setLastUpdated(new Date().toISOString());\n        toast({\n          title: \"Wind Data Updated\",\n          description: \"Successfully fetched wind data from Windy API (fallback)\",\n        });\n        return;\n      }\n    } catch (error) {\n      console.warn('Windy API also failed:', error);\n    }\n\n    // If both APIs fail, show error\n    setError('Failed to fetch wind data from both Open-Meteo and Windy APIs');\n    toast({\n      title: \"Wind Data Error\",\n      description: \"Unable to fetch wind data. Please try again later.\",\n      variant: \"destructive\",\n    });\n  };\n\n  const getWindDirection = (degrees: number): string => {\n    const directions = ['N', 'NNE', 'NE', 'ENE', 'E', 'ESE', 'SE', 'SSE', 'S', 'SSW', 'SW', 'WSW', 'W', 'WNW', 'NW', 'NNW'];\n    const index = Math.round(degrees / 22.5) % 16;\n    return directions[index];\n  };\n\n  const getWindSpeedColor = (speed: number): string => {\n    if (speed < 10) return 'text-green-600';\n    if (speed < 25) return 'text-yellow-600';\n    if (speed < 40) return 'text-orange-600';\n    return 'text-red-600';\n  };\n\n  const getWindSpeedLabel = (speed: number): string => {\n    if (speed < 5) return 'Light';\n    if (speed < 15) return 'Moderate';\n    if (speed < 25) return 'Strong';\n    if (speed < 40) return 'Very Strong';\n    return 'Extreme';\n  };\n\n  useEffect(() => {\n    fetchWindData();\n    \n    // Refresh every 15 minutes\n    const interval = setInterval(fetchWindData, 15 * 60 * 1000);\n    return () => clearInterval(interval);\n  }, [latitude, longitude]);\n\n  if (loading && !windData) {\n    return (\n      <GlassCard>\n        <GlassCardHeader>\n          <GlassCardTitle className=\"flex items-center gap-2\">\n            <Wind className=\"h-5 w-5\" />\n            Wind Dashboard\n          </GlassCardTitle>\n        </GlassCardHeader>\n        <GlassCardContent>\n          <div className=\"flex items-center justify-center py-8\">\n            <div className=\"text-center space-y-2\">\n              <RefreshCw className=\"h-8 w-8 animate-spin text-primary mx-auto\" />\n              <p className=\"text-muted-foreground\">Loading wind data...</p>\n            </div>\n          </div>\n        </GlassCardContent>\n      </GlassCard>\n    );\n  }\n\n  if (error && !windData) {\n    return (\n      <GlassCard>\n        <GlassCardHeader>\n          <GlassCardTitle className=\"flex items-center gap-2\">\n            <Wind className=\"h-5 w-5\" />\n            Wind Dashboard\n          </GlassCardTitle>\n        </GlassCardHeader>\n        <GlassCardContent>\n          <div className=\"text-center py-8 space-y-4\">\n            <AlertTriangle className=\"h-12 w-12 text-destructive mx-auto\" />\n            <p className=\"text-muted-foreground\">{error}</p>\n            <Button onClick={fetchWindData} variant=\"outline\">\n              <RefreshCw className=\"h-4 w-4 mr-2\" />\n              Retry\n            </Button>\n          </div>\n        </GlassCardContent>\n      </GlassCard>\n    );\n  }\n\n  return (\n    <GlassCard>\n      <GlassCardHeader>\n        <div className=\"flex items-center justify-between\">\n          <GlassCardTitle className=\"flex items-center gap-2\">\n            <Wind className=\"h-5 w-5\" />\n            Wind Dashboard\n          </GlassCardTitle>\n          <Button onClick={fetchWindData} size=\"sm\" variant=\"outline\">\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\n            Refresh\n          </Button>\n        </div>\n      </GlassCardHeader>\n      <GlassCardContent>\n        {windData ? (\n          <div className=\"space-y-6\">\n            {/* Wind Rose Visualization */}\n            <div className=\"flex justify-center\">\n              <div className=\"relative w-32 h-32\">\n                {/* Wind Rose Circle */}\n                <div className=\"absolute inset-0 border-2 border-primary/60 rounded-full\"></div>\n                \n                {/* Wind Direction Arrow */}\n                <div \n                  className=\"absolute inset-4 bg-primary/20 rounded-full flex items-center justify-center\"\n                  style={{\n                    transform: `rotate(${windData.windDirection}deg)`\n                  }}\n                >\n                  <div className=\"w-2 h-14 bg-primary rounded-full relative shadow-lg\">\n                    <div className=\"absolute -top-1 left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-5 border-r-5 border-b-5 border-transparent border-b-primary\"></div>\n                  </div>\n                </div>\n                \n                {/* Direction Labels - Enhanced visibility with better contrast */}\n                <div className=\"absolute -top-3 left-1/2 transform -translate-x-1/2 text-sm font-bold text-primary bg-card border border-primary/30 px-2 py-1 rounded-md shadow-lg\">N</div>\n                <div className=\"absolute -bottom-3 left-1/2 transform -translate-x-1/2 text-sm font-bold text-primary bg-card border border-primary/30 px-2 py-1 rounded-md shadow-lg\">S</div>\n                <div className=\"absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 text-sm font-bold text-primary bg-card border border-primary/30 px-2 py-1 rounded-md shadow-lg\">W</div>\n                <div className=\"absolute right-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 text-sm font-bold text-primary bg-card border border-primary/30 px-2 py-1 rounded-md shadow-lg\">E</div>\n                \n                {/* Secondary Direction Labels for better orientation */}\n                <div className=\"absolute top-3 right-3 text-xs font-semibold text-muted-foreground bg-card/90 border border-muted-foreground/30 px-1.5 py-0.5 rounded shadow-md\">NE</div>\n                <div className=\"absolute top-3 left-3 text-xs font-semibold text-muted-foreground bg-card/90 border border-muted-foreground/30 px-1.5 py-0.5 rounded shadow-md\">NW</div>\n                <div className=\"absolute bottom-3 right-3 text-xs font-semibold text-muted-foreground bg-card/90 border border-muted-foreground/30 px-1.5 py-0.5 rounded shadow-md\">SE</div>\n                <div className=\"absolute bottom-3 left-3 text-xs font-semibold text-muted-foreground bg-card/90 border border-muted-foreground/30 px-1.5 py-0.5 rounded shadow-md\">SW</div>\n              </div>\n            </div>\n\n            {/* Wind Stats Grid */}\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              {/* Wind Speed */}\n              <div className=\"text-center p-4 bg-muted/30 rounded-lg\">\n                <div className=\"flex items-center justify-center gap-2 mb-2\">\n                  <Gauge className=\"h-5 w-5 text-primary\" />\n                  <span className=\"text-sm font-medium\">Wind Speed</span>\n                </div>\n                <div className={`text-3xl font-bold ${getWindSpeedColor(windData.windSpeed)}`}>\n                  {windData.windSpeed.toFixed(1)}\n                </div>\n                <div className=\"text-sm text-muted-foreground\">km/h</div>\n                <Badge variant=\"secondary\" className=\"mt-2\">\n                  {getWindSpeedLabel(windData.windSpeed)}\n                </Badge>\n              </div>\n\n              {/* Wind Direction */}\n              <div className=\"text-center p-4 bg-muted/30 rounded-lg\">\n                <div className=\"flex items-center justify-center gap-2 mb-2\">\n                  <Compass className=\"h-5 w-5 text-primary\" />\n                  <span className=\"text-sm font-medium\">Direction</span>\n                </div>\n                <div className=\"text-3xl font-bold text-primary\">\n                  {getWindDirection(windData.windDirection)}\n                </div>\n                <div className=\"text-sm text-muted-foreground\">\n                  {windData.windDirection.toFixed(0)}°\n                </div>\n              </div>\n\n              {/* Gust Speed */}\n              <div className=\"text-center p-4 bg-muted/30 rounded-lg\">\n                <div className=\"flex items-center justify-center gap-2 mb-2\">\n                  <TrendingUp className=\"h-5 w-5 text-primary\" />\n                  <span className=\"text-sm font-medium\">Gust Speed</span>\n                </div>\n                <div className=\"text-3xl font-bold text-orange-600\">\n                  {windData.gustSpeed.toFixed(1)}\n                </div>\n                <div className=\"text-sm text-muted-foreground\">km/h</div>\n                {windData.gustSpeed > windData.windSpeed * 1.5 && (\n                  <Badge variant=\"destructive\" className=\"mt-2\">\n                    High Gusts\n                  </Badge>\n                )}\n              </div>\n            </div>\n\n            {/* Last Updated */}\n            {lastUpdated && (\n              <div className=\"text-center text-xs text-muted-foreground\">\n                Last updated: {new Date(lastUpdated).toLocaleString()}\n              </div>\n            )}\n          </div>\n        ) : (\n          <div className=\"text-center py-8 text-muted-foreground\">\n            No wind data available\n          </div>\n        )}\n      </GlassCardContent>\n    </GlassCard>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\dev\\DevToolsWrapper.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'isInitialized' is assigned a value but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"isInitialized"},"fix":{"range":[213,226],"text":""},"desc":"Remove unused variable 'isInitialized'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isInitialized' is assigned a value but never used.","line":7,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, lazy, Suspense, useState } from 'react';\n\n// Lazy load the MemoryDevTools component\nconst MemoryDevTools = lazy(() => import('./MemoryDevTools'));\n\nexport function DevToolsWrapper() {\n  const [isInitialized, setIsInitialized] = useState(false);\n\n  // Add memory debugging tools to window\n  useEffect(() => {\n    // Only initialize in development\n    if (!import.meta.env.DEV) {\n      console.log('[DevTools] Running in production, DevTools disabled');\n      return;\n    }\n    \n    console.log('[DevTools] Initializing development tools...');\n\n    // Initialize memory debugging tools\n    import('@/utils/memory')\n      .then(({ memoryProfiler }) => {\n        // Create debug object\n        const debugObj = {\n          gc: () => memoryProfiler.forceGarbageCollection(),\n          takeSnapshot: (label: string) => memoryProfiler.takeHeapSnapshot(label),\n          getMemoryInfo: () => {\n            const mem = (performance as any).memory;\n            return mem ? {\n              usedJSHeapSize: mem.usedJSHeapSize,\n              totalJSHeapSize: mem.totalJSHeapSize,\n              jsHeapSizeLimit: mem.jsHeapSizeLimit,\n              usedMB: (mem.usedJSHeapSize / 1024 / 1024).toFixed(2) + ' MB',\n              totalMB: (mem.totalJSHeapSize / 1024 / 1024).toFixed(2) + ' MB',\n              limitMB: (mem.jsHeapSizeLimit / 1024 / 1024).toFixed(2) + ' MB',\n              usagePercent: ((mem.usedJSHeapSize / mem.jsHeapSizeLimit) * 100).toFixed(2) + '%',\n            } : { error: 'Memory API not available' };\n          },\n          checkForLeaks: () => {\n            const leaks: string[] = [];\n            \n            try {\n              // Check for detached DOM elements\n              const detached: Element[] = [];\n              const walker = document.createTreeWalker(\n                document,\n                NodeFilter.SHOW_ELEMENT,\n                { acceptNode: () => NodeFilter.FILTER_ACCEPT }\n              );\n              \n              const nodes: Element[] = [];\n              let node: Node | null;\n              \n              while ((node = walker.nextNode())) {\n                if (node instanceof Element) {\n                  nodes.push(node);\n                }\n              }\n              \n              for (const node of nodes) {\n                if (!document.contains(node)) {\n                  detached.push(node);\n                }\n              }\n              \n              if (detached.length > 0) {\n                leaks.push(`Found ${detached.length} detached DOM elements`);\n                console.warn('Detached elements:', detached);\n              }\n              \n              // Check for event listeners on window\n              const listeners = (window as any).getEventListeners?.(window) || {};\n              const listenerCount = Object.values(listeners).reduce((count: number, events: unknown) => {\n                const eventArray = Array.isArray(events) ? events : [];\n                return count + eventArray.length;\n              }, 0);\n                \n              // Arbitrary threshold of 50 event listeners\n              if (typeof listenerCount === 'number' && listenerCount > 50) {\n                leaks.push(`High number of event listeners (${listenerCount}) on window`);\n              }\n              \n              return leaks.length > 0 ? leaks : ['No memory leaks detected'];\n            } catch (error) {\n              console.error('Error checking for leaks:', error);\n              return ['Error checking for leaks: ' + (error as Error).message];\n            }\n          }\n        };\n        \n        // Add to window for easy access\n        (window as any).__MEMORY_DEBUG__ = debugObj;\n        setIsInitialized(true);\n        console.log('[DevTools] Memory debugging tools initialized');\n        \n        // Log initial memory info\n        try {\n          const memInfo = debugObj.getMemoryInfo();\n          console.log('[DevTools] Initial memory info:', memInfo);\n        } catch (error) {\n          console.warn('[DevTools] Could not get initial memory info:', error);\n        }\n      })\n      .catch(error => {\n        console.warn('Failed to load memory profiler:', error);\n        // Provide a safe fallback\n        (window as any).__MEMORY_DEBUG__ = {\n          getMemoryInfo: () => ({ error: 'Memory debug tools failed to load' }),\n          gc: () => console.warn('Memory debug tools not available'),\n          takeSnapshot: () => console.warn('Memory debug tools not available'),\n          checkForLeaks: () => ['Memory debug tools not available']\n        };\n        setIsInitialized(true);\n      });\n      \n    // Cleanup function\n    return () => {\n      if ((window as any).__MEMORY_DEBUG__) {\n        delete (window as any).__MEMORY_DEBUG__;\n      }\n    };\n  }, []);\n\n  return (\n    <Suspense fallback={null}>\n      <MemoryDevTools defaultOpen={false} enableProfiler={false} />\n    </Suspense>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\dev\\MemoryDebugPanel.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":222,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":222,"endColumn":32},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'mountTime.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'mountTime.current' to a variable inside the effect, and use that variable in the cleanup function.","line":235,"column":91,"nodeType":"Identifier","endLine":235,"endColumn":98},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'renderCount.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'renderCount.current' to a variable inside the effect, and use that variable in the cleanup function.","line":235,"column":133,"nodeType":"Identifier","endLine":235,"endColumn":140}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo } from 'react';\nimport { measureMemory, logComponentInstances, forceGarbageCollection } from '@/utils/memoryUtils';\n\ninterface MemoryInfo {\n  usedJSHeapSize: number;\n  totalJSHeapSize: number;\n  jsHeapSizeLimit: number;\n}\n\nexport function MemoryDebugPanel() {\n  const [isOpen, setIsOpen] = useState(false);\n  const [memory, setMemory] = useState<MemoryInfo | null>(null);\n  const [samples, setSamples] = useState<number[]>([]);\n  const maxSamples = 60; // Track last minute of data (at 1 sample per second)\n  \n  // Toggle panel visibility\n  const togglePanel = () => setIsOpen(!isOpen);\n  \n  // Format bytes to human-readable string\n  const formatBytes = (bytes: number): string => {\n    if (bytes === 0) return '0 B';\n    const k = 1024;\n    const sizes = ['B', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n  };\n  \n  // Calculate memory usage percentage\n  const memoryUsagePercent = useMemo(() => {\n    if (!memory) return 0;\n    return Math.min(100, (memory.usedJSHeapSize / memory.jsHeapSizeLimit) * 100);\n  }, [memory]);\n  \n  // Get memory usage color based on percentage\n  const getMemoryColor = (percent: number): string => {\n    if (percent > 90) return 'bg-red-500';\n    if (percent > 70) return 'bg-yellow-500';\n    return 'bg-green-500';\n  };\n  \n  // Update memory info at regular intervals\n  useEffect(() => {\n    const updateMemoryInfo = () => {\n      const memInfo = measureMemory();\n      if (memInfo) {\n        setMemory({\n          usedJSHeapSize: memInfo.usedJSHeapSize,\n          totalJSHeapSize: memInfo.totalJSHeapSize,\n          jsHeapSizeLimit: memInfo.jsHeapSizeLimit,\n        });\n        \n        // Track memory samples for chart\n        setSamples(prev => {\n          const newSamples = [...prev, memInfo.usedJSHeapSize];\n          return newSamples.slice(-maxSamples);\n        });\n      }\n    };\n    \n    // Initial update\n    updateMemoryInfo();\n    \n    // Set up interval for updates\n    const intervalId = setInterval(updateMemoryInfo, 1000);\n    \n    // Clean up\n    return () => clearInterval(intervalId);\n  }, []);\n  \n  // Handle garbage collection\n  const handleGarbageCollect = () => {\n    const success = forceGarbageCollection();\n    if (success) {\n      console.log('Garbage collection triggered');\n    }\n  };\n  \n  // Calculate memory stats\n  const stats = useMemo(() => {\n    if (samples.length < 2) return null;\n    \n    const used = samples[samples.length - 1];\n    const min = Math.min(...samples);\n    const max = Math.max(...samples);\n    const avg = samples.reduce((sum, val) => sum + val, 0) / samples.length;\n    const trend = used > samples[Math.max(0, samples.length - 2)] ? '↑' : '↓';\n    \n    return { used, min, max, avg, trend };\n  }, [samples]);\n  \n  if (!isOpen) {\n    return (\n      <button\n        onClick={togglePanel}\n        className=\"fixed bottom-4 right-4 bg-blue-600 text-white p-2 rounded-full shadow-lg z-50\"\n        title=\"Memory Debug\"\n      >\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          className=\"h-6 w-6\"\n          fill=\"none\"\n          viewBox=\"0 0 24 24\"\n          stroke=\"currentColor\"\n        >\n          <path\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            strokeWidth={2}\n            d=\"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6h2m7-6h8m0 0h-2m2 6h2M5 15H3m12-6h.01M12 3h.01M12 15h.01M12 12h.01M12 18h.01M12 21h.01M12 6h.01M12 9h.01\"\n          />\n        </svg>\n      </button>\n    );\n  }\n  \n  return (\n    <div className=\"fixed bottom-4 right-4 w-80 bg-white dark:bg-gray-800 rounded-lg shadow-xl z-50 border border-gray-200 dark:border-gray-700 overflow-hidden\">\n      <div className=\"bg-blue-600 text-white p-3 flex justify-between items-center\">\n        <h3 className=\"font-semibold\">Memory Debugger</h3>\n        <div className=\"flex space-x-2\">\n          <button\n            onClick={handleGarbageCollect}\n            className=\"p-1 rounded hover:bg-blue-700\"\n            title=\"Run Garbage Collection\"\n          >\n            ♻️\n          </button>\n          <button\n            onClick={logComponentInstances}\n            className=\"p-1 rounded hover:bg-blue-700\"\n            title=\"Log Component Instances\"\n          >\n            📋\n          </button>\n          <button\n            onClick={togglePanel}\n            className=\"p-1 rounded hover:bg-blue-700\"\n            title=\"Close\"\n          >\n            ×\n          </button>\n        </div>\n      </div>\n      \n      <div className=\"p-4 space-y-4\">\n        {memory ? (\n          <>\n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between text-sm\">\n                <span>Memory Usage:</span>\n                <span>\n                  {formatBytes(memory.usedJSHeapSize)} / {formatBytes(memory.jsHeapSizeLimit)}\n                </span>\n              </div>\n              <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5\">\n                <div\n                  className={`h-2.5 rounded-full ${getMemoryColor(memoryUsagePercent)}`}\n                  style={{ width: `${memoryUsagePercent}%` }}\n                />\n              </div>\n              <div className=\"flex justify-between text-xs text-gray-500 dark:text-gray-400\">\n                <span>0%</span>\n                <span>100%</span>\n              </div>\n            </div>\n            \n            {stats && (\n              <div className=\"grid grid-cols-2 gap-2 text-sm\">\n                <div className=\"bg-gray-100 dark:bg-gray-700 p-2 rounded\">\n                  <div className=\"text-xs text-gray-500 dark:text-gray-400\">Current</div>\n                  <div>{formatBytes(stats.used)} {stats.trend}</div>\n                </div>\n                <div className=\"bg-gray-100 dark:bg-gray-700 p-2 rounded\">\n                  <div className=\"text-xs text-gray-500 dark:text-gray-400\">Average</div>\n                  <div>{formatBytes(stats.avg)}</div>\n                </div>\n                <div className=\"bg-gray-100 dark:bg-gray-700 p-2 rounded\">\n                  <div className=\"text-xs text-gray-500 dark:text-gray-400\">Min</div>\n                  <div>{formatBytes(stats.min)}</div>\n                </div>\n                <div className=\"bg-gray-100 dark:bg-gray-700 p-2 rounded\">\n                  <div className=\"text-xs text-gray-500 dark:text-gray-400\">Max</div>\n                  <div>{formatBytes(stats.max)}</div>\n                </div>\n              </div>\n            )}\n            \n            <div className=\"h-20 bg-gray-100 dark:bg-gray-700 rounded p-2\">\n              <div className=\"h-full flex items-end space-x-px\">\n                {samples.map((sample, i) => {\n                  const percent = (sample / (memory.jsHeapSizeLimit * 0.8)) * 100; // Cap at 80% for better visibility\n                  return (\n                    <div\n                      key={i}\n                      className={`flex-1 ${getMemoryColor(percent)}`}\n                      style={{\n                        height: `${Math.min(100, percent)}%`,\n                      }}\n                      title={`${formatBytes(sample)} (${i}s ago)`}\n                    />\n                  );\n                })}\n              </div>\n            </div>\n          </>\n        ) : (\n          <div className=\"text-center py-4 text-gray-500\">\n            Memory API not available in this browser\n          </div>\n        )}\n        \n        <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-2\">\n          <p>Tip: Look for increasing memory usage over time as a sign of memory leaks.</p>\n          <p>Check the console for detailed component instance tracking.</p>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// HOC to add memory debugging to any component\nexport function withMemoryDebug<P>(WrappedComponent: React.ComponentType<P>, componentName: string) {\n  return function WithMemoryDebug(props: P) {\n    const mountTime = React.useRef(performance.now());\n    const renderCount = React.useRef(0);\n    \n    renderCount.current++;\n    \n    React.useEffect(() => {\n      const mountDuration = performance.now() - mountTime.current;\n      console.log(`[Memory] ${componentName} mounted in ${mountDuration.toFixed(2)}ms`);\n      \n      return () => {\n        const unmountTime = performance.now();\n        console.log(`[Memory] ${componentName} unmounted after ${(unmountTime - mountTime.current).toFixed(2)}ms with ${renderCount.current} renders`);\n      };\n    }, []);\n    \n    return <WrappedComponent {...(props as any)} />;\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\dev\\MemoryDevTools.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'MemoryProfiler' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"MemoryProfiler"},"fix":{"range":[74,89],"text":""},"desc":"Remove unused variable 'MemoryProfiler'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MemoryProfiler' is defined but never used.","line":2,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":24},{"ruleId":"no-unused-vars","severity":1,"message":"'MemoryLeakDetector' is defined but never used.","line":2,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"MemoryLeakDetector"},"fix":{"range":[88,108],"text":""},"desc":"Remove unused variable 'MemoryLeakDetector'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MemoryLeakDetector' is defined but never used.","line":2,"column":26,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":44},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'countEventListeners' was used before it was defined.","line":91,"column":28,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":91,"endColumn":47},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'countDetachedElements' was used before it was defined.","line":92,"column":28,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":92,"endColumn":49}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\nimport { MemoryProfiler, MemoryLeakDetector, MemoryUsageWarning } from './MemoryLeakDetector';\nimport { memoryProfiler } from '@/utils/memoryProfiler';\n\ninterface MemoryDevToolsProps {\n  /**\n   * Whether to show the dev tools by default\n   * @default false\n   */\n  defaultOpen?: boolean;\n  \n  /**\n   * Whether to enable the memory profiler by default\n   * @default false\n   */\n  enableProfiler?: boolean;\n  \n  /**\n   * Whether to enable memory leak detection\n   * @default true in development, false in production\n   */\n  enableLeakDetection?: boolean;\n  \n  /**\n   * Whether to show memory usage warnings\n   * @default true\n   */\n  showWarnings?: boolean;\n}\n\n/**\n * A development tool for monitoring and debugging memory usage in React applications.\n * Provides a floating panel with memory usage information and controls.\n */\nexport function MemoryDevTools({\n  defaultOpen = false,\n  enableProfiler = false,\n  enableLeakDetection = process.env.NODE_ENV === 'development',\n  showWarnings = true,\n}: MemoryDevToolsProps) {\n  const [isOpen, setIsOpen] = useState(defaultOpen);\n  const [isProfiling, setIsProfiling] = useState(enableProfiler);\n  const [stats, setStats] = useState<{\n    heapSize: string;\n    nodeCount: number;\n    listenerCount: number;\n    detachedNodes: number;\n    lastSnapshot?: string;\n  } | null>(null);\n  \n  // Toggle the dev tools panel\n  const togglePanel = useCallback(() => {\n    setIsOpen(prev => !prev);\n  }, []);\n  \n  // Toggle memory profiling\n  const toggleProfiling = useCallback(() => {\n    if (isProfiling) {\n      memoryProfiler.stop();\n      setIsProfiling(false);\n    } else {\n      memoryProfiler.start(2000); // Take a snapshot every 2 seconds\n      setIsProfiling(true);\n    }\n  }, [isProfiling]);\n  \n  // Force garbage collection\n  const handleGarbageCollect = useCallback(() => {\n    const success = memoryProfiler.forceGarbageCollection();\n    if (success) {\n      console.log('Garbage collection triggered');\n    }\n  }, []);\n  \n  // Take a heap snapshot\n  const takeHeapSnapshot = useCallback(() => {\n    memoryProfiler.takeHeapSnapshot(`Snapshot ${new Date().toISOString()}`);\n  }, []);\n  \n  // Update stats periodically\n  useEffect(() => {\n    if (!isOpen) return;\n    \n    const updateStats = () => {\n      if ('memory' in performance) {\n        const mem = (performance as any).memory;\n        if (mem) {\n          setStats({\n            heapSize: `${(mem.usedJSHeapSize / 1024 / 1024).toFixed(2)} MB`,\n            nodeCount: document.getElementsByTagName('*').length,\n            listenerCount: countEventListeners(),\n            detachedNodes: countDetachedElements(),\n            lastSnapshot: new Date().toLocaleTimeString(),\n          });\n        }\n      }\n    };\n    \n    // Initial update\n    updateStats();\n    \n    // Update every 2 seconds\n    const intervalId = setInterval(updateStats, 2000);\n    \n    return () => clearInterval(intervalId);\n  }, [isOpen]);\n  \n  // Start/stop profiling based on the prop\n  useEffect(() => {\n    if (enableProfiler) {\n      memoryProfiler.start(2000);\n      setIsProfiling(true);\n    }\n    \n    return () => {\n      memoryProfiler.stop();\n    };\n  }, [enableProfiler]);\n  \n  // Count event listeners (approximate)\n  const countEventListeners = () => {\n    let count = 0;\n    const elements = document.getElementsByTagName('*');\n    for (let i = 0; i < elements.length; i++) {\n      const elem = elements[i];\n      if ((elem as any).__events) {\n        count += Object.keys((elem as any).__events).length;\n      }\n    }\n    return count;\n  };\n  \n  // Count detached DOM elements (approximate)\n  const countDetachedElements = () => {\n    let count = 0;\n    const walker = document.createTreeWalker(\n      document,\n      NodeFilter.SHOW_ELEMENT,\n      null,\n      false\n    );\n    \n    const nodes: Element[] = [];\n    let node: Node | null;\n    \n    while ((node = walker.nextNode())) {\n      if (node instanceof Element) {\n        nodes.push(node);\n      }\n    }\n    \n    for (const node of nodes) {\n      if (!document.contains(node)) {\n        count++;\n      }\n    }\n    \n    return count;\n  };\n  \n  // Don't render in production unless explicitly enabled\n  if (process.env.NODE_ENV === 'production' && !defaultOpen) {\n    return showWarnings ? <MemoryUsageWarning /> : null;\n  }\n  \n  return (\n    <>\n      {showWarnings && <MemoryUsageWarning />}\n      \n      {/* Floating toggle button */}\n      <button\n        onClick={togglePanel}\n        className=\"fixed bottom-4 right-4 bg-blue-600 text-white p-3 rounded-full shadow-lg z-50 flex items-center justify-center\"\n        style={{ width: '50px', height: '50px' }}\n        title=\"Memory Dev Tools\"\n      >\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          className=\"h-6 w-6\"\n          fill=\"none\"\n          viewBox=\"0 0 24 24\"\n          stroke=\"currentColor\"\n        >\n          <path\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            strokeWidth={2}\n            d=\"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6h2m7-6h8m0 0h-2m2 6h-2M5 15H3m12-6h.01M12 3h.01M12 15h.01M12 21h.01M12 9h.01M12 18h.01m-6.36-2.63l-1.42 1.42m0 0l-2.83 2.83m2.83-2.83l-2.83-2.83m2.83 2.83l1.41-1.41m0 0l2.83-2.83m-2.83 2.83l2.83 2.83\"\n          />\n        </svg>\n      </button>\n      \n      {/* Dev tools panel */}\n      {isOpen && (\n        <div className=\"fixed bottom-20 right-4 w-80 bg-white dark:bg-gray-800 rounded-lg shadow-xl z-50 border border-gray-200 dark:border-gray-700 overflow-hidden\">\n          <div className=\"bg-blue-600 text-white p-3 flex justify-between items-center\">\n            <h3 className=\"font-semibold\">Memory Dev Tools</h3>\n            <div className=\"flex space-x-2\">\n              <button\n                onClick={togglePanel}\n                className=\"p-1 rounded hover:bg-blue-700\"\n                title=\"Close\"\n              >\n                ×\n              </button>\n            </div>\n          </div>\n          \n          <div className=\"p-4 space-y-4\">\n            {/* Memory Stats */}\n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between items-center\">\n                <h4 className=\"font-medium\">Memory Usage</h4>\n                <div className=\"text-xs text-blue-100 bg-blue-900 px-2 py-1 rounded\">\n                  {stats ? `Updated: ${stats.lastSnapshot}` : 'Loading...'}\n                </div>\n              </div>\n              \n              {stats ? (\n                <div className=\"grid grid-cols-2 gap-2 text-sm\">\n                  <div className=\"bg-gray-100 dark:bg-gray-700 p-2 rounded\">\n                    <div className=\"text-xs text-gray-500 dark:text-gray-400\">Heap Size</div>\n                    <div>{stats.heapSize}</div>\n                  </div>\n                  <div className=\"bg-gray-100 dark:bg-gray-700 p-2 rounded\">\n                    <div className=\"text-xs text-gray-500 dark:text-gray-400\">DOM Nodes</div>\n                    <div>{stats.nodeCount}</div>\n                  </div>\n                  <div className=\"bg-gray-100 dark:bg-gray-700 p-2 rounded\">\n                    <div className=\"text-xs text-gray-500 dark:text-gray-400\">Event Listeners</div>\n                    <div>{stats.listenerCount}</div>\n                  </div>\n                  <div className=\"bg-gray-100 dark:bg-gray-700 p-2 rounded\">\n                    <div className=\"text-xs text-gray-500 dark:text-gray-400\">Detached Nodes</div>\n                    <div className={stats.detachedNodes > 0 ? 'text-red-600 dark:text-red-400' : ''}>\n                      {stats.detachedNodes}\n                    </div>\n                  </div>\n                </div>\n              ) : (\n                <div className=\"text-center py-2 text-gray-500\">\n                  Loading memory stats...\n                </div>\n              )}\n            </div>\n            \n            {/* Actions */}\n            <div className=\"space-y-2\">\n              <h4 className=\"font-medium\">Actions</h4>\n              <div className=\"grid grid-cols-2 gap-2\">\n                <button\n                  onClick={toggleProfiling}\n                  className={`px-3 py-2 rounded text-sm font-medium ${\n                    isProfiling \n                      ? 'bg-red-500 hover:bg-red-600 text-white' \n                      : 'bg-blue-500 hover:bg-blue-600 text-white'\n                  }`}\n                >\n                  {isProfiling ? 'Stop Profiling' : 'Start Profiling'}\n                </button>\n                \n                <button\n                  onClick={handleGarbageCollect}\n                  className=\"px-3 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded text-sm font-medium\"\n                >\n                  GC Collect\n                </button>\n                \n                <button\n                  onClick={takeHeapSnapshot}\n                  className=\"px-3 py-2 bg-green-500 hover:bg-green-600 text-white rounded text-sm font-medium\"\n                >\n                  Take Snapshot\n                </button>\n                \n                <button\n                  onClick={() => {\n                    console.log('Current memory profile:', memoryProfiler);\n                    console.log('Component instances:', (window as any).__REACT_DEVTOOLS_GLOBAL_HOOK__?.getFiberRoots ? \n                      'React DevTools detected' : 'React DevTools not found');\n                  }}\n                  className=\"px-3 py-2 bg-yellow-500 hover:bg-yellow-600 text-white rounded text-sm font-medium\"\n                >\n                  Debug Info\n                </button>\n              </div>\n            </div>\n            \n            {/* Memory Leak Detection */}\n            {enableLeakDetection && (\n              <div className=\"space-y-2\">\n                <h4 className=\"font-medium\">Leak Detection</h4>\n                <div className=\"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 p-3 rounded\">\n                  <div className=\"flex\">\n                    <div className=\"flex-shrink-0\">\n                      <svg\n                        className=\"h-5 w-5 text-yellow-400\"\n                        xmlns=\"http://www.w3.org/2000/svg\"\n                        viewBox=\"0 0 20 20\"\n                        fill=\"currentColor\"\n                      >\n                        <path\n                          fillRule=\"evenodd\"\n                          d=\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\"\n                          clipRule=\"evenodd\"\n                        />\n                      </svg>\n                    </div>\n                    <div className=\"ml-3\">\n                      <p className=\"text-sm text-yellow-700 dark:text-yellow-300\">\n                        Memory leak detection is enabled. Check the console for warnings.\n                      </p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n            \n            <div className=\"text-xs text-gray-500 dark:text-gray-400 pt-2 border-t border-gray-200 dark:border-gray-700\">\n              <p>Open browser dev tools for detailed memory profiling.</p>\n              <p>In Chrome: Memory tab → Take snapshot</p>\n            </div>\n          </div>\n        </div>\n      )}\n    </>\n  );\n}\n\n// Default export with default props\nexport default MemoryDevTools;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\dev\\MemoryLeakDetector.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'leakDetector.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'leakDetector.current' to a variable inside the effect, and use that variable in the cleanup function.","line":32,"column":37,"nodeType":"Identifier","endLine":32,"endColumn":44},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":59,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":59,"endColumn":34},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":80,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":80,"endColumn":33},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'mountTime.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'mountTime.current' to a variable inside the effect, and use that variable in the cleanup function.","line":104,"column":48,"nodeType":"Identifier","endLine":104,"endColumn":55},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'renderCount.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'renderCount.current' to a variable inside the effect, and use that variable in the cleanup function.","line":115,"column":34,"nodeType":"Identifier","endLine":115,"endColumn":41}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useRef, useState } from 'react';\nimport { createLeakDetector } from '@/utils/memoryUtils';\nimport { debugLog, debugWarn, debugError, debugTrace } from '@/utils/debugFlags';\n\ninterface MemoryLeakDetectorProps {\n  componentName: string;\n  children: React.ReactNode;\n  warnThreshold?: number; // Number of instances before warning\n  errorThreshold?: number; // Number of instances before error\n}\n\n/**\n * Component that tracks instances and warns about potential memory leaks\n */\nexport function MemoryLeakDetector({\n  componentName,\n  children,\n  warnThreshold = 5,\n  errorThreshold = 10,\n}: MemoryLeakDetectorProps) {\n  const [instanceCount, setInstanceCount] = useState(0);\n  const leakDetector = useRef(createLeakDetector(componentName));\n  const instanceRef = useRef({});\n  \n  // Track this component instance\n  useEffect(() => {\n    const cleanup = leakDetector.current.track(instanceRef.current);\n    setInstanceCount(leakDetector.current.getInstanceCount());\n    \n    return () => {\n      cleanup();\n      setInstanceCount(leakDetector.current.getInstanceCount());\n    };\n  }, []);\n  \n  // Check for potential leaks\n  useEffect(() => {\n    if (instanceCount >= errorThreshold) {\n      debugError(\n        'MemoryLeakDetector',\n        `${componentName} has ${instanceCount} instances (error threshold ${errorThreshold})`\n      );\n      debugTrace('MemoryLeakDetector', `${componentName} instance stack trace`);\n    } else if (instanceCount >= warnThreshold) {\n      debugWarn(\n        'MemoryLeakDetector',\n        `${componentName} has ${instanceCount} instances (warn threshold ${warnThreshold})`\n      );\n    }\n  }, [instanceCount, componentName, warnThreshold, errorThreshold]);\n  \n  // Only show the wrapped component, no extra DOM elements\n  return <>{children}</>;\n}\n\n/**\n * HOC to add memory leak detection to a component\n */\nexport function withLeakDetection<P>(\n  WrappedComponent: React.ComponentType<P>,\n  componentName: string,\n  options: { warnThreshold?: number; errorThreshold?: number } = {}\n) {\n  return function WithLeakDetection(props: P) {\n    return (\n      <MemoryLeakDetector \n        componentName={componentName}\n        warnThreshold={options.warnThreshold}\n        errorThreshold={options.errorThreshold}\n      >\n        <WrappedComponent {...(props as any)} />\n      </MemoryLeakDetector>\n    );\n  };\n}\n\n/**\n * Hook to track component mounts/unmounts and potential memory leaks\n */\nexport function useLeakDetection(componentName: string) {\n  const mountTime = useRef(performance.now());\n  const renderCount = useRef(0);\n  const leakDetector = useRef(createLeakDetector(componentName));\n  const instanceRef = useRef({});\n  \n  // Track this component instance\n  useEffect(() => {\n    renderCount.current++;\n    \n    // Track the instance\n    const cleanup = leakDetector.current.track(instanceRef.current);\n    \n    // Log mount\n    debugLog('MemoryLeakDetector', `[Mount] ${componentName} mounted`, {\n      renders: renderCount.current\n    });\n    \n    return () => {\n      // Clean up\n      cleanup();\n      \n      // Log unmount with duration\n      const unmountTime = performance.now();\n      const duration = unmountTime - mountTime.current;\n      debugLog('MemoryLeakDetector', `[Unmount] ${componentName}`, {\n        durationMs: duration,\n        renders: renderCount.current\n      });\n      \n      // If component was mounted for a short time, it might be a memory leak\n      if (duration < 1000 && renderCount.current > 5) {\n        debugWarn(\n          'MemoryLeakDetector',\n          `${componentName} mounted/unmounted quickly`,\n          { renders: renderCount.current, durationMs: duration }\n        );\n      }\n    };\n  }, [componentName]);\n  \n  // Return the current instance count for manual checking\n  return {\n    getInstanceCount: () => leakDetector.current.getInstanceCount(),\n    renderCount: renderCount.current,\n  };\n}\n\n/**\n * Component that shows a warning when memory usage is high\n */\nexport function MemoryUsageWarning() {\n  const [isHighMemory, setIsHighMemory] = useState(false);\n  const [memoryInfo, setMemoryInfo] = useState<{\n    used: number;\n    total: number;\n    limit: number;\n  } | null>(null);\n  \n  useEffect(() => {\n    if ('performance' in window && 'memory' in (performance as any)) {\n      const checkMemory = () => {\n        const mem = (performance as any).memory;\n        if (mem) {\n          const used = mem.usedJSHeapSize || 0;\n          const total = mem.totalJSHeapSize || 1;\n          const limit = mem.jsHeapSizeLimit || total * 2;\n          \n          setMemoryInfo({\n            used,\n            total,\n            limit,\n          });\n          \n          // Consider memory high if using more than 70% of available memory\n          const isHigh = used > limit * 0.7;\n          setIsHighMemory(isHigh);\n          \n          if (isHigh) {\n            debugWarn(\n              'MemoryUsageWarning',\n              `High memory usage detected`,\n              { percentUsed: Math.round((used / limit) * 100) }\n            );\n          }\n        }\n      };\n      \n      // Check memory every 5 seconds\n      const interval = setInterval(checkMemory, 5000);\n      checkMemory();\n      \n      return () => clearInterval(interval);\n    }\n    \n    return () => {};\n  }, []);\n  \n  if (!isHighMemory || !memoryInfo) {\n    return null;\n  }\n  \n  const percentUsed = Math.round((memoryInfo.used / memoryInfo.limit) * 100);\n  \n  return (\n    <div className=\"fixed bottom-4 left-4 bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded shadow-lg z-50 max-w-sm\">\n      <div className=\"flex\">\n        <div className=\"flex-shrink-0\">\n          <svg\n            className=\"h-5 w-5 text-yellow-600\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            viewBox=\"0 0 20 20\"\n            fill=\"currentColor\"\n          >\n            <path\n              fillRule=\"evenodd\"\n              d=\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\"\n              clipRule=\"evenodd\"\n            />\n          </svg>\n        </div>\n        <div className=\"ml-3\">\n          <p className=\"text-sm font-medium\">\n            High Memory Usage: {percentUsed}% of available memory\n          </p>\n          <p className=\"text-sm mt-1\">\n            This may cause performance issues. Consider closing unused tabs or refreshing the page.\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\dev\\MemoryProfiler.tsx","messages":[{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'styles' was used before it was defined.","line":43,"column":19,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":43,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'minUsed' is assigned a value but never used.","line":50,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":50,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"minUsed"},"fix":{"range":[1631,1704],"text":""},"desc":"Remove unused variable 'minUsed'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'minUsed' is assigned a value but never used.","line":50,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":50,"endColumn":16},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'styles' was used before it was defined.","line":53,"column":17,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":53,"endColumn":23},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'styles' was used before it was defined.","line":54,"column":19,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":54,"endColumn":25},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'styles' was used before it was defined.","line":58,"column":27,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":58,"endColumn":33},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'styles' was used before it was defined.","line":58,"column":47,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":58,"endColumn":53},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'styles' was used before it was defined.","line":64,"column":19,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":64,"endColumn":25},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'styles' was used before it was defined.","line":71,"column":21,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":71,"endColumn":27},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'styles' was used before it was defined.","line":76,"column":20,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":76,"endColumn":26}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState, useRef } from 'react';\n\nexport function MemoryProfiler() {\n  const [memory, setMemory] = useState<{\n    jsHeapSizeLimit?: number;\n    totalJSHeapSize?: number;\n    usedJSHeapSize?: number;\n  }>({});\n\n  const [active, setActive] = useState(false);\n  const [stats, setStats] = useState<Array<{time: string; used: number}>>([]);\n  const statsRef = useRef<Array<{time: string; used: number}>>([]);\n  const maxStats = 60; // Keep last 60 seconds of data\n\n  useEffect(() => {\n    if (!active || !(window as any).performance?.memory) return;\n\n    const interval = setInterval(() => {\n      const { usedJSHeapSize } = (window.performance as any).memory;\n      const now = new Date();\n      const timeStr = `${now.getMinutes()}:${now.getSeconds()}`;\n      \n      const newStat = {\n        time: timeStr,\n        used: Math.round(usedJSHeapSize / 1024 / 1024)\n      };\n      \n      statsRef.current = [...(statsRef.current.slice(-(maxStats - 1))), newStat];\n      setStats(statsRef.current);\n      \n      setMemory({\n        jsHeapSizeLimit: Math.round((window.performance as any).memory.jsHeapSizeLimit / 1024 / 1024),\n        totalJSHeapSize: Math.round((window.performance as any).memory.totalJSHeapSize / 1024 / 1024),\n        usedJSHeapSize: Math.round(usedJSHeapSize / 1024 / 1024),\n      });\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, [active]);\n\n  if (!(window as any).performance?.memory) {\n    return (\n      <div style={styles.container}>\n        <div>Performance.memory API not available</div>\n      </div>\n    );\n  }\n\n  const maxUsed = Math.max(...stats.map(s => s.used), 10);\n  const minUsed = Math.min(...stats.length ? stats.map(s => s.used) : [0]);\n\n  return (\n    <div style={styles.container}>\n      <div style={styles.header}>\n        <h3>Memory Usage</h3>\n        <button \n          onClick={() => setActive(!active)}\n          style={active ? styles.stopButton : styles.startButton}\n        >\n          {active ? 'Stop' : 'Start'}\n        </button>\n      </div>\n      \n      <div style={styles.stats}>\n        <div>Used: <strong>{memory.usedJSHeapSize || '--'} MB</strong></div>\n        <div>Total: {memory.totalJSHeapSize || '--'} MB</div>\n        <div>Limit: {memory.jsHeapSizeLimit || '--'} MB</div>\n      </div>\n      \n      {active && stats.length > 0 && (\n        <div style={styles.chart}>\n          {stats.map((stat, i) => (\n            <div \n              key={i}\n              style={{\n                ...styles.bar,\n                height: `${(stat.used / (maxUsed * 1.1)) * 50}px`,\n                backgroundColor: stat.used > (memory.jsHeapSizeLimit || 0) * 0.7 \n                  ? '#ff6b6b' \n                  : stat.used > (memory.jsHeapSizeLimit || 0) * 0.5 \n                    ? '#ffd166' \n                    : '#06d6a0'\n              }}\n              title={`${stat.time} - ${stat.used}MB`}\n            />\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n\nconst styles = {\n  container: {\n    position: 'fixed' as const,\n    bottom: '20px',\n    right: '20px',\n    backgroundColor: 'rgba(0, 0, 0, 0.85)',\n    color: 'white',\n    padding: '12px',\n    borderRadius: '8px',\n    fontSize: '12px',\n    fontFamily: 'monospace',\n    zIndex: 9999,\n    maxWidth: '300px',\n    boxShadow: '0 4px 6px rgba(0, 0, 0, 0.1)',\n  },\n  header: {\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: '8px',\n  },\n  stats: {\n    marginBottom: '8px',\n    lineHeight: '1.4',\n  },\n  chart: {\n    display: 'flex',\n    alignItems: 'flex-end',\n    height: '60px',\n    gap: '2px',\n    marginTop: '8px',\n  },\n  bar: {\n    flex: 1,\n    minWidth: '2px',\n    backgroundColor: '#06d6a0',\n    borderRadius: '2px',\n    transition: 'height 0.3s ease',\n  },\n  startButton: {\n    backgroundColor: '#4CAF50',\n    color: 'white',\n    border: 'none',\n    padding: '4px 8px',\n    borderRadius: '4px',\n    cursor: 'pointer',\n    fontSize: '12px',\n  },\n  stopButton: {\n    backgroundColor: '#f44336',\n    color: 'white',\n    border: 'none',\n    padding: '4px 8px',\n    borderRadius: '4px',\n    cursor: 'pointer',\n    fontSize: '12px',\n  },\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\AQIDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\BalanceChart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\Combobox.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\DashboardHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\ErrorDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\GlassCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\LoadingSkeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\PollutantCards.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'name' is defined but never used.","line":7,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"name"},"fix":{"range":[287,300],"text":""},"desc":"Remove unused variable 'name'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'value' is defined but never used.","line":7,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":49,"suggestions":[{"messageId":"removeVar","data":{"varName":"value"},"fix":{"range":[299,314],"text":""},"desc":"Remove unused variable 'value'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'unit' is defined but never used.","line":7,"column":51,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":63,"suggestions":[{"messageId":"removeVar","data":{"varName":"unit"},"fix":{"range":[314,328],"text":""},"desc":"Remove unused variable 'unit'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { GlassCard, GlassCardContent } from \"@/components/ui/GlassCard\";\nimport { getPollutantInfo, createPollutantCards } from \"@/lib/airQualityUtils\";\nimport { AirQualityData } from \"@/hooks/useAirQuality\";\n\ninterface PollutantCardsProps {\n  data: AirQualityData;\n  onPollutantClick: (name: string, value: number, unit: string) => void;\n}\n\nexport const PollutantCards = ({ data, onPollutantClick }: PollutantCardsProps): JSX.Element => {\n  const pollutantCards = createPollutantCards(data);\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n      {pollutantCards.map((pollutant) => {\n        const info = getPollutantInfo(pollutant.code, pollutant.value);\n        const isAboveThreshold = pollutant.threshold && pollutant.value > pollutant.threshold;\n        \n        return (\n          <button\n            key={pollutant.code}\n            className=\"w-full text-left\"\n            onClick={() => onPollutantClick(info.label, pollutant.value, info.unit)}\n          >\n            <GlassCard \n              className={`cursor-pointer transition-all hover:scale-105 ${\n                isAboveThreshold ? 'border-red-300 bg-red-50/50' : 'border-border'\n              }`}\n            >\n              <GlassCardContent className=\"p-4 text-center\">\n                <div className=\"text-2xl font-bold mb-2\">{info.label}</div>\n                <div className={`text-3xl font-bold ${isAboveThreshold ? 'text-red-600' : 'text-primary'}`}>\n                  {pollutant.value !== null ? pollutant.value.toFixed(1) : 'N/A'}\n                </div>\n                <div className=\"text-sm text-muted-foreground\">{info.unit}</div>\n                {pollutant.threshold && (\n                  <div className={`text-xs mt-2 ${\n                    isAboveThreshold ? 'text-red-600' : 'text-green-600'\n                  }`}>\n                    {isAboveThreshold ? 'Above threshold' : 'Below threshold'}\n                  </div>\n                )}\n              </GlassCardContent>\n            </GlassCard>\n          </button>\n        );\n      })}\n    </div>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\ProgressGauge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\RefreshProgressBar.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Progress' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"Progress"},"fix":{"range":[27,79],"text":""},"desc":"Remove unused variable 'Progress'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Progress' is defined but never used.","line":2,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":18},{"ruleId":"no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"Button"},"fix":{"range":[80,128],"text":""},"desc":"Remove unused variable 'Button'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":3,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Progress } from '@/components/ui/progress';\nimport { Button } from '@/components/ui/button';\nimport { RefreshCw, Clock } from 'lucide-react';\nimport { cn } from '@/lib/utils';\n\ninterface RefreshProgressBarProps {\n  timeUntilRefresh: number;\n  isRefreshing: boolean;\n  onManualRefresh: () => void;\n  isUsingCachedData?: boolean;\n  className?: string;\n}\n\nexport function RefreshProgressBar({\n  timeUntilRefresh,\n  isRefreshing,\n  onManualRefresh,\n  isUsingCachedData = false,\n  className\n}: RefreshProgressBarProps) {\n  // Calculate progress percentage (15 minutes = 900 seconds)\n  const totalTime = 900; // 15 minutes in seconds\n  const progress = ((totalTime - timeUntilRefresh) / totalTime) * 100;\n  \n  // Format time remaining\n  const formatTime = (seconds: number): string => {\n    const minutes = Math.floor(seconds / 60);\n    const remainingSeconds = seconds % 60;\n    return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;\n  };\n\n  // Get progress bar color based on time remaining\n  const getProgressColor = (): string => {\n    if (timeUntilRefresh > 600) return 'bg-green-500'; // > 10 minutes\n    if (timeUntilRefresh > 300) return 'bg-yellow-500'; // > 5 minutes\n    if (timeUntilRefresh > 60) return 'bg-orange-500'; // > 1 minute\n    return 'bg-red-500'; // < 1 minute\n  };\n\n  return (\n    <div className={cn(\n      \"w-full bg-white/10 backdrop-blur-lg border border-white/20 rounded-xl p-4 space-y-3 shadow-lg\",\n      isUsingCachedData && \"border-amber-200/50 bg-amber-50/10\",\n      className\n    )}>\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-2\">\n          <Clock className=\"w-4 h-4 text-gray-300\" />\n          <span className=\"text-sm font-medium text-gray-300\">\n            {isUsingCachedData ? 'Showing cached data' : 'Next automatic refresh'}\n          </span>\n        </div>\n        \n        <div className=\"flex items-center gap-2\">\n          <span className=\"text-sm font-mono text-white\">\n            {formatTime(timeUntilRefresh)}\n          </span>\n          \n          <button\n            onClick={onManualRefresh}\n            disabled={isRefreshing}\n            className=\"flex items-center gap-2 px-3 py-1 bg-blue-500/20 hover:bg-blue-500/30 border border-blue-400/30 rounded-md transition-colors disabled:opacity-50\"\n          >\n            <RefreshCw className={`w-4 h-4 ${isRefreshing ? 'animate-spin' : ''}`} />\n            <span className=\"text-sm text-white\">Refresh</span>\n          </button>\n        </div>\n      </div>\n      \n      <div className=\"space-y-2\">\n        <div className=\"w-full bg-gray-700/30 rounded-full h-2\">\n          <div \n            className={cn(\"h-2 rounded-full transition-all duration-1000\", getProgressColor())}\n            style={{ width: `${progress}%` }}\n          />\n        </div>\n        \n        {isUsingCachedData && (\n          <div className=\"flex items-center gap-2 text-xs text-amber-300\">\n            <div className=\"w-2 h-2 bg-amber-400 rounded-full animate-pulse\" />\n            <span>Data from last automatic refresh - fresh data available in {formatTime(timeUntilRefresh)}</span>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\StatCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\UserPointsDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\accordion.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\alert-dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\alert.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\aspect-ratio.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\avatar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\badge.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":36,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":36,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\breadcrumb.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\button.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":58,"column":18,"nodeType":"Identifier","messageId":"namedExport","endLine":58,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-ds-small text-body-md font-heading ring-offset-background transition-smooth focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90 hover:shadow-hover\",\n        destructive:\n          \"bg-error text-error-foreground hover:bg-error/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n        success: \"bg-success text-success-foreground hover:bg-success/90\",\n        warning: \"bg-warning text-warning-foreground hover:bg-warning/90\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-ds-small px-3\",\n        lg: \"h-11 rounded-ds-small px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\calendar.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'_props' is defined but never used.","line":55,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":55,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"_props"},"fix":{"range":[2392,2405],"text":""},"desc":"Remove unused variable '_props'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_props' is defined but never used.","line":55,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":55,"endColumn":31},{"ruleId":"no-unused-vars","severity":1,"message":"'_props' is defined but never used.","line":56,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":56,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"_props"},"fix":{"range":[2467,2480],"text":""},"desc":"Remove unused variable '_props'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_props' is defined but never used.","line":56,"column":26,"nodeType":null,"messageId":"unusedVar","endLine":56,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\";\nimport { ChevronLeft, ChevronRight } from \"lucide-react\";\nimport { DayPicker } from \"react-day-picker\";\n\nimport { cn } from \"@/lib/utils\";\nimport { buttonVariants } from \"@/components/ui/button\";\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>;\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ ..._props }) => <ChevronLeft className=\"h-4 w-4\" />,\n        IconRight: ({ ..._props }) => <ChevronRight className=\"h-4 w-4\" />,\n      }}\n      {...props}\n    />\n  );\n}\nCalendar.displayName = \"Calendar\";\n\nexport { Calendar };\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\carousel.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'api' is defined but never used.","line":19,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"api"},"fix":{"range":[586,602],"text":""},"desc":"Remove unused variable 'api'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\chart.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'k' is defined but never used.","line":10,"column":4,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":5,"suggestions":[{"messageId":"removeVar","data":{"varName":"k"},"fix":{"range":[237,238],"text":""},"desc":"Remove unused variable 'k'."}]},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'ChartStyle' was used before it was defined.","line":58,"column":10,"nodeType":"JSXIdentifier","messageId":"noUseBeforeDefine","endLine":58,"endColumn":20},{"ruleId":"no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":70,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":70,"endColumn":8,"suggestions":[{"messageId":"removeVar","data":{"varName":"_"},"fix":{"range":[2397,2398],"text":""},"desc":"Remove unused variable '_'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":70,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":70,"endColumn":8},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'getPayloadConfigFromPayload' was used before it was defined.","line":141,"column":26,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":141,"endColumn":53},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'getPayloadConfigFromPayload' was used before it was defined.","line":188,"column":32,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":188,"endColumn":59},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'getPayloadConfigFromPayload' was used before it was defined.","line":288,"column":30,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":288,"endColumn":57}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([_, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item.dataKey || item.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\checkbox.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\collapsible.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\command.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\context-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\drawer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\dropdown-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\form.tsx","messages":[{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'FormItemContext' was used before it was defined.","line":44,"column":40,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":44,"endColumn":55},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":168,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":168,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  ControllerProps,\n  FieldPath,\n  FieldValues,\n  FormProvider,\n  useFormContext,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message) : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\hover-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\input-otp.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\menubar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\navigation-menu.tsx","messages":[{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'NavigationMenuViewport' was used before it was defined.","line":21,"column":6,"nodeType":"JSXIdentifier","messageId":"noUseBeforeDefine","endLine":21,"endColumn":28},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":119,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":119,"endColumn":29}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\pagination.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\popover.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\progress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\radio-group.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\resizable.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\scroll-area.tsx","messages":[{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'ScrollBar' was used before it was defined.","line":18,"column":6,"nodeType":"JSXIdentifier","messageId":"noUseBeforeDefine","endLine":18,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\separator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\sheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\sidebar.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'open' is defined but never used.","line":30,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"open"},"fix":{"range":[947,960],"text":""},"desc":"Remove unused variable 'open'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'open' is defined but never used.","line":32,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"open"},"fix":{"range":[1010,1023],"text":""},"desc":"Remove unused variable 'open'."}]},{"ruleId":"no-redeclare","severity":1,"message":"'SidebarContext' is already defined.","line":37,"column":7,"nodeType":"Identifier","messageId":"redeclared","endLine":37,"endColumn":21},{"ruleId":"no-unused-vars","severity":1,"message":"'open' is defined but never used.","line":53,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":53,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"open"},"fix":{"range":[1507,1520],"text":""},"desc":"Remove unused variable 'open'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'value' is defined but never used.","line":76,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":76,"endColumn":41,"suggestions":[{"messageId":"removeVar","data":{"varName":"value"},"fix":{"range":[2098,2112],"text":""},"desc":"Remove unused variable 'value'."}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":760,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":760,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { VariantProps, cva } from \"class-variance-authority\"\nimport { PanelLeft } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport { Sheet, SheetContent } from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar:state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContext = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContext | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nconst SidebarProvider = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    defaultOpen?: boolean\n    open?: boolean\n    onOpenChange?: (open: boolean) => void\n  }\n>(\n  (\n    {\n      defaultOpen = true,\n      open: openProp,\n      onOpenChange: setOpenProp,\n      className,\n      style,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const isMobile = useIsMobile()\n    const [openMobile, setOpenMobile] = React.useState(false)\n\n    // This is the internal state of the sidebar.\n    // We use openProp and setOpenProp for control from outside the component.\n    const [_open, _setOpen] = React.useState(defaultOpen)\n    const open = openProp ?? _open\n    const setOpen = React.useCallback(\n      (value: boolean | ((value: boolean) => boolean)) => {\n        const openState = typeof value === \"function\" ? value(open) : value\n        if (setOpenProp) {\n          setOpenProp(openState)\n        } else {\n          _setOpen(openState)\n        }\n\n        // This sets the cookie to keep the sidebar state.\n        document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n      },\n      [setOpenProp, open]\n    )\n\n    // Helper to toggle the sidebar.\n    const toggleSidebar = React.useCallback(() => {\n      return isMobile\n        ? setOpenMobile((open) => !open)\n        : setOpen((open) => !open)\n    }, [isMobile, setOpen, setOpenMobile])\n\n    // Adds a keyboard shortcut to toggle the sidebar.\n    React.useEffect(() => {\n      const handleKeyDown = (event: KeyboardEvent) => {\n        if (\n          event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n          (event.metaKey || event.ctrlKey)\n        ) {\n          event.preventDefault()\n          toggleSidebar()\n        }\n      }\n\n      window.addEventListener(\"keydown\", handleKeyDown)\n      return () => window.removeEventListener(\"keydown\", handleKeyDown)\n    }, [toggleSidebar])\n\n    // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n    // This makes it easier to style the sidebar with Tailwind classes.\n    const state = open ? \"expanded\" : \"collapsed\"\n\n    const contextValue = React.useMemo<SidebarContext>(\n      () => ({\n        state,\n        open,\n        setOpen,\n        isMobile,\n        openMobile,\n        setOpenMobile,\n        toggleSidebar,\n      }),\n      [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n    )\n\n    return (\n      <SidebarContext.Provider value={contextValue}>\n        <TooltipProvider delayDuration={0}>\n          <div\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH,\n                \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n                ...style,\n              } as React.CSSProperties\n            }\n            className={cn(\n              \"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\",\n              className\n            )}\n            ref={ref}\n            {...props}\n          >\n            {children}\n          </div>\n        </TooltipProvider>\n      </SidebarContext.Provider>\n    )\n  }\n)\nSidebarProvider.displayName = \"SidebarProvider\"\n\nconst Sidebar = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    side?: \"left\" | \"right\"\n    variant?: \"sidebar\" | \"floating\" | \"inset\"\n    collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n  }\n>(\n  (\n    {\n      side = \"left\",\n      variant = \"sidebar\",\n      collapsible = \"offcanvas\",\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n    if (collapsible === \"none\") {\n      return (\n        <div\n          className={cn(\n            \"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\",\n            className\n          )}\n          ref={ref}\n          {...props}\n        >\n          {children}\n        </div>\n      )\n    }\n\n    if (isMobile) {\n      return (\n        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n          <SheetContent\n            data-sidebar=\"sidebar\"\n            data-mobile=\"true\"\n            className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n              } as React.CSSProperties\n            }\n            side={side}\n          >\n            <div className=\"flex h-full w-full flex-col\">{children}</div>\n          </SheetContent>\n        </Sheet>\n      )\n    }\n\n    return (\n      <div\n        ref={ref}\n        className=\"group peer hidden md:block text-sidebar-foreground\"\n        data-state={state}\n        data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n        data-variant={variant}\n        data-side={side}\n      >\n        {/* This is what handles the sidebar gap on desktop */}\n        <div\n          className={cn(\n            \"duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear\",\n            \"group-data-[collapsible=offcanvas]:w-0\",\n            \"group-data-[side=right]:rotate-180\",\n            variant === \"floating\" || variant === \"inset\"\n              ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\"\n          )}\n        />\n        <div\n          className={cn(\n            \"duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex\",\n            side === \"left\"\n              ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n              : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n            // Adjust the padding for floating and inset variants.\n            variant === \"floating\" || variant === \"inset\"\n              ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n            className\n          )}\n          {...props}\n        >\n          <div\n            data-sidebar=\"sidebar\"\n            className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\"\n          >\n            {children}\n          </div>\n        </div>\n      </div>\n    )\n  }\n)\nSidebar.displayName = \"Sidebar\"\n\nconst SidebarTrigger = React.forwardRef<\n  React.ElementRef<typeof Button>,\n  React.ComponentProps<typeof Button>\n>(({ className, onClick, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      ref={ref}\n      data-sidebar=\"trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeft />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n})\nSidebarTrigger.displayName = \"SidebarTrigger\"\n\nconst SidebarRail = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\">\n>(({ className, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <button\n      ref={ref}\n      data-sidebar=\"rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex\",\n        \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarRail.displayName = \"SidebarRail\"\n\nconst SidebarInset = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"main\">\n>(({ className, ...props }, ref) => {\n  return (\n    <main\n      ref={ref}\n      className={cn(\n        \"relative flex min-h-svh flex-1 flex-col bg-background\",\n        \"peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInset.displayName = \"SidebarInset\"\n\nconst SidebarInput = React.forwardRef<\n  React.ElementRef<typeof Input>,\n  React.ComponentProps<typeof Input>\n>(({ className, ...props }, ref) => {\n  return (\n    <Input\n      ref={ref}\n      data-sidebar=\"input\"\n      className={cn(\n        \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInput.displayName = \"SidebarInput\"\n\nconst SidebarHeader = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarHeader.displayName = \"SidebarHeader\"\n\nconst SidebarFooter = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarFooter.displayName = \"SidebarFooter\"\n\nconst SidebarSeparator = React.forwardRef<\n  React.ElementRef<typeof Separator>,\n  React.ComponentProps<typeof Separator>\n>(({ className, ...props }, ref) => {\n  return (\n    <Separator\n      ref={ref}\n      data-sidebar=\"separator\"\n      className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\n      {...props}\n    />\n  )\n})\nSidebarSeparator.displayName = \"SidebarSeparator\"\n\nconst SidebarContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarContent.displayName = \"SidebarContent\"\n\nconst SidebarGroup = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarGroup.displayName = \"SidebarGroup\"\n\nconst SidebarGroupLabel = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\"\n\nconst SidebarGroupAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupAction.displayName = \"SidebarGroupAction\"\n\nconst SidebarGroupContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"group-content\"\n    className={cn(\"w-full text-sm\", className)}\n    {...props}\n  />\n))\nSidebarGroupContent.displayName = \"SidebarGroupContent\"\n\nconst SidebarMenu = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu\"\n    className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n    {...props}\n  />\n))\nSidebarMenu.displayName = \"SidebarMenu\"\n\nconst SidebarMenuItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    data-sidebar=\"menu-item\"\n    className={cn(\"group/menu-item relative\", className)}\n    {...props}\n  />\n))\nSidebarMenuItem.displayName = \"SidebarMenuItem\"\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst SidebarMenuButton = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    isActive?: boolean\n    tooltip?: string | React.ComponentProps<typeof TooltipContent>\n  } & VariantProps<typeof sidebarMenuButtonVariants>\n>(\n  (\n    {\n      asChild = false,\n      isActive = false,\n      variant = \"default\",\n      size = \"default\",\n      tooltip,\n      className,\n      ...props\n    },\n    ref\n  ) => {\n    const Comp = asChild ? Slot : \"button\"\n    const { isMobile, state } = useSidebar()\n\n    const button = (\n      <Comp\n        ref={ref}\n        data-sidebar=\"menu-button\"\n        data-size={size}\n        data-active={isActive}\n        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n        {...props}\n      />\n    )\n\n    if (!tooltip) {\n      return button\n    }\n\n    if (typeof tooltip === \"string\") {\n      tooltip = {\n        children: tooltip,\n      }\n    }\n\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>{button}</TooltipTrigger>\n        <TooltipContent\n          side=\"right\"\n          align=\"center\"\n          hidden={state !== \"collapsed\" || isMobile}\n          {...tooltip}\n        />\n      </Tooltip>\n    )\n  }\n)\nSidebarMenuButton.displayName = \"SidebarMenuButton\"\n\nconst SidebarMenuAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    showOnHover?: boolean\n  }\n>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuAction.displayName = \"SidebarMenuAction\"\n\nconst SidebarMenuBadge = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"menu-badge\"\n    className={cn(\n      \"absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none\",\n      \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n      \"peer-data-[size=sm]/menu-button:top-1\",\n      \"peer-data-[size=default]/menu-button:top-1.5\",\n      \"peer-data-[size=lg]/menu-button:top-2.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\"\n\nconst SidebarMenuSkeleton = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    showIcon?: boolean\n  }\n>(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"rounded-md h-8 flex gap-2 px-2 items-center\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 flex-1 max-w-[--skeleton-width]\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n})\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\"\n\nconst SidebarMenuSub = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu-sub\"\n    className={cn(\n      \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuSub.displayName = \"SidebarMenuSub\"\n\nconst SidebarMenuSubItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ ...props }, ref) => <li ref={ref} {...props} />)\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\"\n\nconst SidebarMenuSubButton = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentProps<\"a\"> & {\n    asChild?: boolean\n    size?: \"sm\" | \"md\"\n    isActive?: boolean\n  }\n>(({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\"\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\slider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\sonner.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":29,"column":19,"nodeType":"Identifier","messageId":"namedExport","endLine":29,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useTheme } from \"@/contexts/ThemeContext\"\nimport { Toaster as Sonner, toast } from \"sonner\"\n\ntype ToasterProps = React.ComponentProps<typeof Sonner>\n\nconst Toaster = ({ ...props }: ToasterProps) => {\n  const { isDark } = useTheme()\n\n  return (\n    <Sonner\n      theme={isDark ? \"dark\" : \"light\"}\n      className=\"toaster group\"\n      toastOptions={{\n        classNames: {\n          toast:\n            \"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg\",\n          description: \"group-[.toast]:text-muted-foreground\",\n          actionButton:\n            \"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground\",\n          cancelButton:\n            \"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground\",\n        },\n      }}\n      {...props}\n    />\n  )\n}\n\nexport { Toaster, toast }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\switch.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\table.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\tabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\textarea.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\toast.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\toaster.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\toggle-group.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\toggle.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":43,"column":18,"nodeType":"Identifier","messageId":"namedExport","endLine":43,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3\",\n        sm: \"h-9 px-2.5\",\n        lg: \"h-11 px-5\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\tooltip.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\components\\ui\\use-toast.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\config\\connectionResilience.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\config\\logging.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'config' is assigned a value but never used.","line":178,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":178,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"config"},"fix":{"range":[4946,4987],"text":""},"desc":"Remove unused variable 'config'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'config' is assigned a value but never used.","line":178,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":178,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Logging Configuration for Breath Safe\n * \n * This file contains all logging configuration settings including:\n * - Environment-specific log levels\n * - Performance monitoring thresholds\n * - Rate limiting settings\n * - Category-specific configurations\n */\n\nexport const LOGGING_CONFIG = {\n  // Environment-based configuration\n  development: {\n    level: 'DEBUG' as const,\n    enablePerformanceLogs: true,\n    maxLogEntries: 2000,\n    rateLimitWindow: 30000, // 30 seconds\n    rateLimitMax: 20, // Max 20 logs per 30 seconds per category\n  },\n  production: {\n    level: 'ERROR' as const,\n    enablePerformanceLogs: false,\n    maxLogEntries: 1000,\n    rateLimitWindow: 60000, // 1 minute\n    rateLimitMax: 10, // Max 10 logs per minute per category\n  },\n  \n  // Category-specific rate limiting\n  categories: {\n    geolocation: {\n      level: 'INFO' as const,\n      rateLimit: 5, // Max 5 logs per window\n      description: 'Location services and GPS operations'\n    },\n    channel: {\n      level: 'INFO' as const,\n      rateLimit: 3, // Max 3 logs per window\n      description: 'WebSocket channel management'\n    },\n    navigation: {\n      level: 'DEBUG' as const,\n      rateLimit: 2, // Max 2 logs per window\n      description: 'Page navigation and routing'\n    },\n    connection: {\n      level: 'WARN' as const,\n      rateLimit: 5, // Max 5 logs per window\n      description: 'Connection health and WebSocket status'\n    },\n    validation: {\n      level: 'INFO' as const,\n      rateLimit: 3, // Max 3 logs per window\n      description: 'Data validation and form processing'\n    },\n    data: {\n      level: 'INFO' as const,\n      rateLimit: 10, // Max 10 logs per window\n      description: 'API calls and data operations'\n    },\n    ui: {\n      level: 'DEBUG' as const,\n      rateLimit: 5, // Max 5 logs per window\n      description: 'User interface interactions'\n    },\n    system: {\n      level: 'ERROR' as const,\n      rateLimit: 20, // Max 20 logs per window\n      description: 'System-level operations and errors'\n    },\n    auth: {\n      level: 'WARN' as const,\n      rateLimit: 10, // Max 10 logs per window\n      description: 'Authentication and authorization'\n    },\n    performance: {\n      level: 'INFO' as const,\n      rateLimit: 15, // Max 15 logs per window\n      description: 'Performance metrics and timing'\n    }\n  },\n  \n  // Performance monitoring thresholds\n  performance: {\n    // Log operations that take longer than these thresholds\n    thresholds: {\n      geolocation: 5000, // 5 seconds\n      weatherFetch: 3000, // 3 seconds\n      channelSubscription: 2000, // 2 seconds\n      navigation: 1000, // 1 second\n      dataValidation: 500, // 500ms\n    },\n    \n    // Memory usage thresholds (MB)\n    memory: {\n      warning: 100, // Warn if memory usage exceeds 100MB\n      error: 200, // Error if memory usage exceeds 200MB\n    },\n    \n    // Bundle size thresholds (KB)\n    bundle: {\n      warning: 300, // Warn if main bundle exceeds 300KB\n      error: 500, // Error if main bundle exceeds 500KB\n    }\n  },\n  \n  // Notification and alert settings\n  notifications: {\n    // Show performance warnings in development\n    showPerformanceWarnings: process.env.NODE_ENV === 'development',\n    \n    // Alert on critical errors\n    alertOnCriticalErrors: true,\n    \n    // Maximum notifications to show simultaneously\n    maxSimultaneous: 3,\n    \n    // Auto-hide duration for different log levels\n    autoHide: {\n      ERROR: 10000, // 10 seconds\n      WARN: 8000,   // 8 seconds\n      INFO: 5000,   // 5 seconds\n      DEBUG: 3000,  // 3 seconds\n    }\n  },\n  \n  // Security and privacy settings\n  security: {\n    // Never log sensitive data\n    sensitiveFields: [\n      'password',\n      'token',\n      'apiKey',\n      'secret',\n      'privateKey',\n      'sessionId',\n      'userId',\n      'email'\n    ],\n    \n    // Sanitize data before logging\n    sanitizeData: true,\n    \n    // Mask sensitive values\n    maskPatterns: {\n      email: /([a-zA-Z0-9._%+-]+)@([a-zA-Z0-9.-]+\\.[a-zA-Z]{2,})/g,\n      phone: /(\\d{3})-(\\d{3})-(\\d{4})/g,\n      creditCard: /(\\d{4})-(\\d{4})-(\\d{4})-(\\d{4})/g\n    }\n  },\n  \n  // Export and reporting settings\n  export: {\n    // Enable log export functionality\n    enabled: process.env.NODE_ENV === 'development',\n    \n    // Export formats\n    formats: ['json', 'csv', 'txt'],\n    \n    // Maximum export size (MB)\n    maxExportSize: 10,\n    \n    // Auto-export on errors\n    autoExportOnErrors: true,\n    \n    // Export retention (days)\n    retentionDays: 30\n  }\n} as const;\n\n// Helper function to get current environment configuration\nexport const getCurrentLoggingConfig = () => {\n  const env = process.env.NODE_ENV || 'development';\n  return LOGGING_CONFIG[env as keyof typeof LOGGING_CONFIG] || LOGGING_CONFIG.development;\n};\n\n// Helper function to check if logging is enabled for a category\nexport const isLoggingEnabled = (category: string, level: 'ERROR' | 'WARN' | 'INFO' | 'DEBUG') => {\n  const config = getCurrentLoggingConfig();\n  const categoryConfig = LOGGING_CONFIG.categories[category as keyof typeof LOGGING_CONFIG.categories];\n  \n  if (!categoryConfig) return true; // Default to enabled if no category config\n  \n  const levelPriority = { ERROR: 4, WARN: 3, INFO: 2, DEBUG: 1 };\n  const configLevel = LOGGING_CONFIG.categories[category as keyof typeof LOGGING_CONFIG.categories]?.level || 'DEBUG';\n  \n  return levelPriority[level] >= levelPriority[configLevel];\n};\n\n// Helper function to get rate limit for a category\nexport const getCategoryRateLimit = (category: string) => {\n  const categoryConfig = LOGGING_CONFIG.categories[category as keyof typeof LOGGING_CONFIG.categories];\n  return categoryConfig?.rateLimit || getCurrentLoggingConfig().rateLimitMax;\n};\n\n// Performance monitoring helpers\nexport const shouldLogPerformance = (operation: string, duration: number) => {\n  const threshold = LOGGING_CONFIG.performance.thresholds[operation as keyof typeof LOGGING_CONFIG.performance.thresholds];\n  return threshold ? duration > threshold : false;\n};\n\n// Security helpers\nexport const sanitizeLogData = (data: any): any => {\n  if (!LOGGING_CONFIG.security.sanitizeData) return data;\n  \n  if (typeof data === 'object' && data !== null) {\n    const sanitized: any = Array.isArray(data) ? [] : {};\n    \n    for (const [key, value] of Object.entries(data)) {\n      if (LOGGING_CONFIG.security.sensitiveFields.includes(key)) {\n        sanitized[key] = '[REDACTED]';\n      } else if (typeof value === 'object' && value !== null) {\n        sanitized[key] = sanitizeLogData(value);\n      } else {\n        sanitized[key] = value;\n      }\n    }\n    \n    return sanitized;\n  }\n  \n  return data;\n};\n\nexport default LOGGING_CONFIG;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\config\\maps.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\contexts\\AuthContext.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'AuthError' is defined but never used.","line":2,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"AuthError"},"fix":{"range":[122,133],"text":""},"desc":"Remove unused variable 'AuthError'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AuthError' is defined but never used.","line":2,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":34},{"ruleId":"no-unused-vars","severity":1,"message":"'email' is defined but never used.","line":13,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"email"},"fix":{"range":[454,468],"text":""},"desc":"Remove unused variable 'email'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'password' is defined but never used.","line":13,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":43,"suggestions":[{"messageId":"removeVar","data":{"varName":"password"},"fix":{"range":[467,485],"text":""},"desc":"Remove unused variable 'password'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'fullName' is defined but never used.","line":13,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":62,"suggestions":[{"messageId":"removeVar","data":{"varName":"fullName"},"fix":{"range":[485,504],"text":""},"desc":"Remove unused variable 'fullName'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'profile' is assigned a value but never used.","line":161,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":161,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"profile"},"fix":{"range":[5030,5044],"text":""},"desc":"Remove unused variable 'profile'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'profile' is assigned a value but never used.","line":161,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":161,"endColumn":28},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":259,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":259,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useEffect, useState, useRef, useCallback } from 'react';\nimport { User, Session, AuthError } from '@supabase/supabase-js';\nimport { supabase } from '@/integrations/supabase/client';\n\ninterface AuthContextType {\n  user: User | null;\n  session: Session | null;\n  loading: boolean;\n  isAuthenticated: boolean;\n  profileValidated: boolean;\n  validationAttempted: boolean;\n  signOut: () => Promise<void>;\n  signUp: (email: string, password: string, fullName?: string) => Promise<void>;\n  validateProfile: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\ninterface AuthProviderProps {\n  children: React.ReactNode;\n}\n\nexport function AuthProvider({ children }: AuthProviderProps) {\n  const [user, setUser] = useState<User | null>(null);\n  const [session, setSession] = useState<Session | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [profileValidated, setProfileValidated] = useState(false);\n  const [validationAttempted, setValidationAttempted] = useState(false);\n  \n  // Use refs to prevent duplicate auth state changes\n  const lastAuthEvent = useRef<string | null>(null);\n  const lastUserId = useRef<string | null>(null);\n  const authListenerRef = useRef<{ unsubscribe: () => void } | null>(null);\n\n  // Get initial session\n  useEffect(() => {\n    let mounted = true;\n\n    const getInitialSession = async () => {\n      try {\n        const { data: { session }, error } = await supabase.auth.getSession();\n        \n        if (error) {\n          console.error('Error getting initial session:', error);\n          return;\n        }\n\n        if (mounted) {\n          setSession(session);\n          setUser(session?.user ?? null);\n          \n          // Track initial session\n          if (session?.user?.id) {\n            lastUserId.current = session.user.id;\n            lastAuthEvent.current = 'INITIAL_SESSION';\n          }\n          \n          setLoading(false);\n        }\n      } catch (error) {\n        console.error('Error in getInitialSession:', error);\n        if (mounted) {\n          setLoading(false);\n        }\n      }\n    };\n\n    getInitialSession();\n\n    return () => {\n      mounted = false;\n    };\n  }, []);\n\n  // Set up auth state change listener (ONCE)\n  useEffect(() => {\n    // Only set up listener if we don't already have one\n    if (authListenerRef.current) {\n      console.log('Auth listener already exists, skipping setup');\n      return;\n    }\n\n    console.log('🔐 Setting up auth state change listener...');\n    \n    const { data: { subscription } } = supabase.auth.onAuthStateChange(\n      (event, session) => {\n        const userId = session?.user?.id;\n        \n        // Prevent duplicate INITIAL_SESSION events for the same user\n        if (event === 'INITIAL_SESSION' && \n            lastAuthEvent.current === 'INITIAL_SESSION' && \n            lastUserId.current === userId) {\n          console.log('Auth state change: Skipping duplicate INITIAL_SESSION for user:', userId);\n          return;\n        }\n        \n        // Prevent duplicate events for the same user and event type\n        if (lastAuthEvent.current === event && lastUserId.current === userId) {\n          console.log('Auth state change: Skipping duplicate event:', event, 'for user:', userId);\n          return;\n        }\n        \n        // Prevent duplicate SIGNED_IN events that occur rapidly\n        if (event === 'SIGNED_IN' && \n            lastAuthEvent.current === 'SIGNED_IN' && \n            lastUserId.current === userId) {\n          console.log('Auth state change: Skipping duplicate SIGNED_IN for user:', userId);\n          return;\n        }\n        \n        console.log('Auth state change:', event, 'for user:', userId);\n        \n        // Update state\n        setSession(session);\n        setUser(session?.user ?? null);\n        \n        // Track this event\n        lastAuthEvent.current = event;\n        lastUserId.current = userId;\n        \n        // Handle specific events\n        if (event === 'SIGNED_IN' || event === 'TOKEN_REFRESHED') {\n          if (session?.user) {\n            setProfileValidated(false);\n            setValidationAttempted(false);\n          }\n        } else if (event === 'SIGNED_OUT') {\n          setProfileValidated(false);\n          setValidationAttempted(false);\n        }\n        \n        // Update loading state\n        if (event === 'INITIAL_SESSION') {\n          setLoading(false);\n        }\n      }\n    );\n\n    // Store the subscription for cleanup\n    authListenerRef.current = subscription;\n\n    // Cleanup function\n    return () => {\n      if (authListenerRef.current) {\n        console.log('🔐 Cleaning up auth state change listener...');\n        authListenerRef.current.unsubscribe();\n        authListenerRef.current = null;\n      }\n    };\n  }, []);\n\n  // Profile validation function\n  const validateProfile = useCallback(async () => {\n    if (!user || validationAttempted) {\n      return;\n    }\n\n    try {\n      setValidationAttempted(true);\n      \n      const { data: profile, error } = await supabase\n        .from('profiles')\n        .select('*')\n        .eq('user_id', user.id)\n        .single();\n\n      if (error) {\n        if (error.code === 'PGRST116') {\n          // Profile doesn't exist, create one\n          const { error: insertError } = await supabase\n            .from('profiles')\n            .insert({\n              user_id: user.id,\n              email: user.email,\n              full_name: user.user_metadata?.full_name || '',\n              total_points: 0\n            });\n\n          if (insertError) {\n            console.error('Error creating profile:', insertError);\n            return;\n          }\n          \n          setProfileValidated(true);\n          console.log('Profile created and validated');\n        } else {\n          console.error('Error fetching profile:', error);\n        }\n      } else {\n        setProfileValidated(true);\n        console.log('Profile validated');\n      }\n    } catch (error) {\n      console.error('Error in validateProfile:', error);\n    }\n  }, [user, validationAttempted]);\n\n  // Sign out function\n  const signOut = useCallback(async () => {\n    try {\n      console.log('🔐 Signing out...');\n      const { error } = await supabase.auth.signOut();\n      if (error) {\n        console.error('Error signing out:', error);\n      } else {\n        console.log('✅ Signed out successfully');\n      }\n    } catch (error) {\n      console.error('Error in signOut:', error);\n    }\n  }, []);\n\n  // Sign up function\n  const signUp = useCallback(async (email: string, password: string, fullName?: string) => {\n    try {\n      console.log('🔐 Signing up user:', email);\n      const { error } = await supabase.auth.signUp({\n        email,\n        password,\n        options: {\n          data: {\n            full_name: fullName || ''\n          },\n          emailRedirectTo: `${window.location.origin}/`\n        }\n      });\n\n      if (error) {\n        console.error('Error signing up:', error);\n        throw error;\n      } else {\n        console.log('✅ Signed up successfully');\n      }\n    } catch (error) {\n      console.error('Error in signUp:', error);\n      throw error;\n    }\n  }, []);\n\n  const value: AuthContextType = {\n    user,\n    session,\n    loading,\n    isAuthenticated: !!user,\n    profileValidated,\n    validationAttempted,\n    signOut,\n    signUp,\n    validateProfile\n  };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth(): AuthContextType {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\contexts\\LocationContext.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":65,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":65,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":65,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":65,"endColumn":27},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":231,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":231,"endColumn":35}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useEffect, useRef, useCallback } from 'react';\n\ninterface LocationContextType {\n  hasUserConsent: boolean;\n  hasRequestedPermission: boolean;\n  isRequestingPermission: boolean;\n  locationPermission: 'granted' | 'denied' | 'prompt' | 'unknown';\n  requestLocationPermission: () => Promise<boolean>;\n  resetLocationPermission: () => void;\n  getCurrentLocation: () => Promise<GeolocationPosition>;\n}\n\nconst LocationContext = createContext<LocationContextType | undefined>(undefined);\n\ninterface LocationProviderProps {\n  children: React.ReactNode;\n}\n\nexport function LocationProvider({ children }: LocationProviderProps) {\n  const [hasUserConsent, setHasUserConsent] = useState(false);\n  const [hasRequestedPermission, setHasRequestedPermission] = useState(false);\n  const [isRequestingPermission, setIsRequestingPermission] = useState(false);\n  const [locationPermission, setLocationPermission] = useState<'granted' | 'denied' | 'prompt' | 'unknown'>('unknown');\n  \n  // Use refs to prevent multiple permission checks\n  const permissionCheckedRef = useRef(false);\n  const permissionCheckInProgressRef = useRef(false);\n\n  // Check location permission on mount\n  useEffect(() => {\n    // Prevent multiple permission checks\n    if (permissionCheckedRef.current || permissionCheckInProgressRef.current) {\n      return;\n    }\n    \n    permissionCheckInProgressRef.current = true;\n    console.log('📍 Starting location permission check...');\n    \n    const checkLocationPermission = async () => {\n      try {\n        // Check if we have stored permission\n        const storedPermission = localStorage.getItem('breath-safe-location-permission');\n        \n        if (storedPermission === 'granted') {\n          // Check if browser still has permission\n          if (navigator.permissions && navigator.permissions.query) {\n            try {\n              const permissionStatus = await navigator.permissions.query({ name: 'geolocation' as PermissionName });\n              setLocationPermission(permissionStatus.state);\n              \n              if (permissionStatus.state === 'granted') {\n                setHasUserConsent(true);\n                setHasRequestedPermission(true);\n                permissionCheckedRef.current = true;\n                console.log('📍 Permission check completed - user has consent');\n                return;\n              } else if (permissionStatus.state === 'denied') {\n                setHasUserConsent(false);\n                setHasRequestedPermission(true);\n                localStorage.removeItem('breath-safe-location-permission');\n                permissionCheckedRef.current = true;\n                console.log('📍 Permission check completed - user denied consent');\n                return;\n              }\n            } catch (error) {\n              console.log('📍 Permission API not supported, using stored permission');\n            }\n          }\n          \n          // If permission API not supported, trust stored permission\n          setHasUserConsent(true);\n          setHasRequestedPermission(true);\n          setLocationPermission('granted');\n          permissionCheckedRef.current = true;\n          console.log('📍 Permission check completed - using stored permission');\n        } else if (storedPermission === 'denied') {\n          setHasUserConsent(false);\n          setHasRequestedPermission(true);\n          setLocationPermission('denied');\n          permissionCheckedRef.current = true;\n          console.log('📍 Permission check completed - stored permission denied');\n        } else {\n          // No stored permission, mark as checked but not consented\n          setHasUserConsent(false);\n          setHasRequestedPermission(true);\n          setLocationPermission('prompt');\n          permissionCheckedRef.current = true;\n          console.log('📍 Permission check completed - no stored permission');\n        }\n      } catch (error) {\n        console.error('📍 Error during permission check:', error);\n        // Mark as checked even if there was an error\n        setHasUserConsent(false);\n        setHasRequestedPermission(true);\n        setLocationPermission('unknown');\n        permissionCheckedRef.current = true;\n      } finally {\n        permissionCheckInProgressRef.current = false;\n      }\n    };\n\n    checkLocationPermission();\n  }, []); // Empty dependency array to run only once on mount\n\n  // CRITICAL FIX: Ensure hasRequestedPermission is always set to true after a reasonable timeout\n  // This prevents the dashboard from being stuck on \"checking location permissions\"\n  useEffect(() => {\n    const timeoutId = setTimeout(() => {\n      if (!hasRequestedPermission) {\n        console.log('📍 Location permission check timeout - forcing completion');\n        setHasRequestedPermission(true);\n        permissionCheckedRef.current = true;\n      }\n    }, 2000); // Reduced from 5 seconds to 2 seconds for better UX\n\n    return () => clearTimeout(timeoutId);\n  }, [hasRequestedPermission]);\n\n  // Function to request location permission\n  const requestLocationPermission = useCallback(async (): Promise<boolean> => {\n    if (!navigator.geolocation) {\n      console.log('📍 Geolocation not supported by browser');\n      return false;\n    }\n\n    // Prevent multiple simultaneous permission requests\n    if (isRequestingPermission) {\n      console.log('📍 Location permission request already in progress, skipping duplicate request');\n      return false;\n    }\n\n    try {\n      setIsRequestingPermission(true);\n      console.log('📍 Starting location permission request...');\n      \n      // Request location permission\n      const position = await new Promise<GeolocationPosition>((resolve, reject) => {\n        navigator.geolocation.getCurrentPosition(resolve, reject, {\n          timeout: 30000,\n          enableHighAccuracy: false,\n          maximumAge: 10 * 60 * 1000\n        });\n      });\n\n      if (position) {\n        console.log('📍 Location permission granted successfully');\n        setHasUserConsent(true);\n        setLocationPermission('granted');\n        // Store permission in localStorage\n        localStorage.setItem('breath-safe-location-permission', 'granted');\n        return true;\n      }\n      return false;\n    } catch (error) {\n      // Handle specific error types, reduce console noise\n      if (error instanceof GeolocationPositionError) {\n        switch (error.code) {\n          case 1: // PERMISSION_DENIED\n            console.log('📍 Location permission denied by user');\n            setLocationPermission('denied');\n            localStorage.setItem('breath-safe-location-permission', 'denied');\n            break;\n          case 2: // POSITION_UNAVAILABLE\n            console.log('📍 Location position unavailable');\n            setLocationPermission('prompt');\n            break;\n          case 3: // TIMEOUT\n            console.log('📍 Location request timed out');\n            setLocationPermission('prompt');\n            break;\n          default:\n            console.log('📍 Location permission error:', error.message);\n        }\n      } else {\n        console.log('📍 Location permission request failed:', error);\n      }\n      \n      return false;\n    } finally {\n      setIsRequestingPermission(false);\n    }\n  }, [isRequestingPermission]);\n\n  // Function to get current location (only if permission granted)\n  const getCurrentLocation = useCallback(async (): Promise<GeolocationPosition> => {\n    if (!hasUserConsent) {\n      throw new Error('Location access not yet granted. Please request permission first.');\n    }\n\n    if (!navigator.geolocation) {\n      throw new Error('Geolocation not supported by your browser');\n    }\n\n    return new Promise<GeolocationPosition>((resolve, reject) => {\n      navigator.geolocation.getCurrentPosition(resolve, reject, {\n        timeout: 30000,\n        enableHighAccuracy: false,\n        maximumAge: 10 * 60 * 1000\n      });\n    });\n  }, [hasUserConsent]);\n\n  // Function to reset location permission\n  const resetLocationPermission = useCallback(() => {\n    console.log('📍 Resetting location permission...');\n    localStorage.removeItem('breath-safe-location-permission');\n    setHasUserConsent(false);\n    setHasRequestedPermission(false);\n    setLocationPermission('unknown');\n    permissionCheckedRef.current = false;\n    permissionCheckInProgressRef.current = false;\n  }, []);\n\n  const value: LocationContextType = {\n    hasUserConsent,\n    hasRequestedPermission,\n    isRequestingPermission,\n    locationPermission,\n    requestLocationPermission,\n    resetLocationPermission,\n    getCurrentLocation\n  };\n\n  return (\n    <LocationContext.Provider value={value}>\n      {children}\n    </LocationContext.Provider>\n  );\n}\n\nexport function useLocationContext(): LocationContextType {\n  const context = useContext(LocationContext);\n  if (context === undefined) {\n    throw new Error('useLocation must be used within a LocationProvider');\n  }\n  return context;\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\contexts\\OptimizedRealtimeContext.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'callback' is defined but never used.","line":16,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":62,"suggestions":[{"messageId":"removeVar","data":{"varName":"callback"},"fix":{"range":[394,426],"text":""},"desc":"Remove unused variable 'callback'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":16,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":53,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[405,417],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'callback' is defined but never used.","line":17,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":59,"suggestions":[{"messageId":"removeVar","data":{"varName":"callback"},"fix":{"range":[469,501],"text":""},"desc":"Remove unused variable 'callback'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":17,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":50,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[480,492],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'callback' is defined but never used.","line":18,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":66,"suggestions":[{"messageId":"removeVar","data":{"varName":"callback"},"fix":{"range":[551,583],"text":""},"desc":"Remove unused variable 'callback'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":18,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":57,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[562,574],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"@typescript-eslint/no-unsafe-function-type","severity":1,"message":"The `Function` type accepts any function-like value.\nPrefer explicitly defining any function parameters and return type.","line":34,"column":51,"nodeType":"Identifier","messageId":"bannedFunctionType","endLine":34,"endColumn":59},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'subscriptionsRef.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'subscriptionsRef.current' to a variable inside the effect, and use that variable in the cleanup function.","line":54,"column":24,"nodeType":"Identifier","endLine":54,"endColumn":31},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":61,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":61,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[1823,1835],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'user'. Either include it or remove the dependency array.","line":103,"column":6,"nodeType":"ArrayExpression","endLine":103,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [user]","fix":{"range":[3219,3229],"text":"[user]"}}]},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":109,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":109,"endColumn":55,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[3433,3445],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":111,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":111,"endColumn":52,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[3572,3584],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":113,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":113,"endColumn":59,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[3710,3722],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":124,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":124,"endColumn":28}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":14,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, {\n  createContext,\n  useContext,\n  useEffect,\n  useRef,\n  useState,\n  useCallback,\n  useMemo,\n} from 'react';\nimport { useAuth } from './AuthContext';\nimport { realtimeManager, cleanupAllChannels } from '@/lib/realtimeClient';\n\ninterface RealtimeContextType {\n  connectionStatus: 'connected' | 'reconnecting' | 'disconnected';\n  isConnected: boolean;\n  subscribeToNotifications: (callback: (payload: any) => void) => () => void;\n  subscribeToUserPoints: (callback: (payload: any) => void) => () => void;\n  subscribeToUserProfilePoints: (callback: (payload: any) => void) => () => void;\n}\n\nconst RealtimeContext = createContext<RealtimeContextType | undefined>(undefined);\n\ninterface RealtimeProviderProps {\n  children: React.ReactNode;\n}\n\nexport function RealtimeProvider({ children }: RealtimeProviderProps) {\n  const { user } = useAuth();\n  const [connectionStatus, setConnectionStatus] = useState<\n    'connected' | 'reconnecting' | 'disconnected'\n  >('disconnected');\n  \n  // Track active subscriptions\n  const subscriptionsRef = useRef<Map<string, Set<Function>>>(new Map());\n  const isMounted = useRef(true);\n  \n  // Set up connection status listener\n  useEffect(() => {\n    isMounted.current = true;\n    \n    const handleStatusChange = (status: 'connected' | 'reconnecting' | 'disconnected') => {\n      if (isMounted.current) {\n        setConnectionStatus(status);\n      }\n    };\n    \n    // Subscribe to connection status changes\n    const unsubscribe = realtimeManager.onConnectionStatus(handleStatusChange);\n    \n    return () => {\n      isMounted.current = false;\n      unsubscribe();\n      cleanupAllChannels();\n      subscriptionsRef.current.clear();\n    };\n  }, []);\n  \n  // Subscribe to a channel with automatic cleanup\n  const subscribe = useCallback((\n    channelName: string,\n    callback: (payload: any) => void,\n    options: { isPersistent?: boolean } = {}\n  ) => {\n    if (!isMounted.current || !user) {\n      return () => {};\n    }\n    \n    const fullChannelName = `${channelName}-${user.id}`;\n    \n    // Initialize the channel if it doesn't exist\n    if (!subscriptionsRef.current.has(fullChannelName)) {\n      subscriptionsRef.current.set(fullChannelName, new Set());\n    }\n    \n    const channelSubscriptions = subscriptionsRef.current.get(fullChannelName)!;\n    \n    // Add the callback to the subscription set\n    channelSubscriptions.add(callback);\n    \n    // Subscribe to the channel if this is the first subscription\n    if (channelSubscriptions.size === 1) {\n      realtimeManager.subscribe(fullChannelName, (payload: any) => {\n        const callbacks = subscriptionsRef.current.get(fullChannelName);\n        callbacks?.forEach(cb => cb(payload));\n      });\n    }\n    \n    // Return cleanup function\n    return () => {\n      if (!isMounted.current) return;\n      \n      const callbacks = subscriptionsRef.current.get(fullChannelName);\n      if (callbacks) {\n        callbacks.delete(callback);\n        \n        // If no more callbacks, unsubscribe from the channel\n        if (callbacks.size === 0 && !options.isPersistent) {\n          realtimeManager.unsubscribe(fullChannelName);\n          subscriptionsRef.current.delete(fullChannelName);\n        }\n      }\n    };\n  }, [user?.id]);\n  \n  // Context value with memoized callbacks\n  const contextValue = useMemo(() => ({\n    connectionStatus,\n    isConnected: connectionStatus === 'connected',\n    subscribeToNotifications: (callback: (payload: any) => void) => \n      subscribe('user-notifications', callback, { isPersistent: true }),\n    subscribeToUserPoints: (callback: (payload: any) => void) =>\n      subscribe('user-points', callback, { isPersistent: true }),\n    subscribeToUserProfilePoints: (callback: (payload: any) => void) =>\n      subscribe('user-profile-points', callback, { isPersistent: false }),\n  }), [connectionStatus, subscribe]);\n  \n  return (\n    <RealtimeContext.Provider value={contextValue}>\n      {children}\n    </RealtimeContext.Provider>\n  );\n}\n\nexport function useRealtime() {\n  const context = useContext(RealtimeContext);\n  if (context === undefined) {\n    throw new Error('useRealtime must be used within a RealtimeProvider');\n  }\n  return context;\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\contexts\\RealtimeContext.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'callback' is defined but never used.","line":21,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":62,"suggestions":[{"messageId":"removeVar","data":{"varName":"callback"},"fix":{"range":[493,525],"text":""},"desc":"Remove unused variable 'callback'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":21,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":53,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[504,516],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'callback' is defined but never used.","line":22,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":59,"suggestions":[{"messageId":"removeVar","data":{"varName":"callback"},"fix":{"range":[568,600],"text":""},"desc":"Remove unused variable 'callback'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":22,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":50,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[579,591],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'callback' is defined but never used.","line":23,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":66,"suggestions":[{"messageId":"removeVar","data":{"varName":"callback"},"fix":{"range":[650,682],"text":""},"desc":"Remove unused variable 'callback'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":23,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":57,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[661,673],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":37,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[1041,1053],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":38,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":38,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[1080,1092],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":100,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":100,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[3139,3151],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":167,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":167,"endColumn":55,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[5001,5013],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":169,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":169,"endColumn":52,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[5152,5164],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":171,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":171,"endColumn":59,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[5303,5315],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":196,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":196,"endColumn":28}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { \n  createContext, \n  useContext, \n  useEffect, \n  useRef, \n  useState, \n  useCallback,\n  useMemo\n} from 'react';\nimport { useAuth } from './AuthContext';\nimport {\n  cleanupAllChannels,\n  addConnectionStatusListener,\n  subscribeToChannel,\n  unsubscribeFromChannel\n} from '@/lib/realtimeClient';\nimport { useThrottle } from '@/hooks/usePerformance';\n\ninterface RealtimeContextType {\n  connectionStatus: 'connected' | 'reconnecting' | 'disconnected';\n  subscribeToNotifications: (callback: (payload: any) => void) => () => void;\n  subscribeToUserPoints: (callback: (payload: any) => void) => () => void;\n  subscribeToUserProfilePoints: (callback: (payload: any) => void) => () => void;\n  isConnected: boolean;\n}\n\nconst RealtimeContext = createContext<RealtimeContextType | undefined>(undefined);\n\ninterface RealtimeProviderProps {\n  children: React.ReactNode;\n}\n\n// Throttle time for connection status updates to prevent excessive re-renders\nconst STATUS_UPDATE_THROTTLE_MS = 1000;\n\ntype SubscriptionEntry = {\n  callbacks: Set<(payload: any) => void>;\n  aggregator: (payload: any) => void;\n  options: { isPersistent?: boolean };\n  isSubscribed: boolean;\n};\n\n// Memoize the context value to prevent unnecessary re-renders\nfunction useRealtimeContextValue() {\n  const { user } = useAuth();\n  const [connectionStatus, setConnectionStatus] = useState<'connected' | 'reconnecting' | 'disconnected'>('disconnected');\n  \n  // Use refs to track state without causing re-renders\n  const activeSubscriptionsRef = useRef<Map<string, SubscriptionEntry>>(new Map());\n  const statusListenerCleanupRef = useRef<(() => void) | null>(null);\n  const mountedRef = useRef(true);\n  \n  // Throttle the connection status updates\n  const throttledSetConnectionStatus = useThrottle((status: 'connected' | 'reconnecting' | 'disconnected') => {\n    if (mountedRef.current) {\n      setConnectionStatus(status);\n    }\n  }, STATUS_UPDATE_THROTTLE_MS);\n\n  // Cleanup function for the effect\n  const cleanup = useCallback(() => {\n    if (statusListenerCleanupRef.current) {\n      statusListenerCleanupRef.current();\n      statusListenerCleanupRef.current = null;\n    }\n    \n    // Clean up all subscriptions when unmounting\n    activeSubscriptionsRef.current.forEach((entry, channelName) => {\n      unsubscribeFromChannel(channelName, entry.aggregator);\n    });\n    \n    activeSubscriptionsRef.current.clear();\n  }, []);\n\n  // Set up connection status listener\n  useEffect(() => {\n    mountedRef.current = true;\n    \n    // Clean up any existing listeners\n    if (statusListenerCleanupRef.current) {\n      statusListenerCleanupRef.current();\n    }\n    \n    // Set up new status listener\n    statusListenerCleanupRef.current = addConnectionStatusListener((status) => {\n      if (mountedRef.current) {\n        throttledSetConnectionStatus(status);\n      }\n    });\n    \n    return () => {\n      mountedRef.current = false;\n      cleanup();\n    };\n  }, [cleanup, throttledSetConnectionStatus]);\n\n  // Define the cleanup function outside the useCallback to avoid hooks after early returns\n  const subscribe = useCallback((\n    channelName: string,\n    callback: (payload: any) => void,\n    options: { isPersistent?: boolean } = {}\n  ) => {\n    if (!mountedRef.current || !user?.id) {\n      return () => {};\n    }\n\n    let entry = activeSubscriptionsRef.current.get(channelName);\n\n    if (!entry) {\n      const aggregator = (payload: any) => {\n        const currentEntry = activeSubscriptionsRef.current.get(channelName);\n        if (!currentEntry) {\n          return;\n        }\n\n        currentEntry.callbacks.forEach((cb) => {\n          try {\n            cb(payload);\n          } catch (error) {\n            console.error(`[RealtimeContext] Error in subscription callback for ${channelName}:`, error);\n          }\n        });\n      };\n\n      entry = {\n        callbacks: new Set(),\n        aggregator,\n        options: { ...options },\n        isSubscribed: false\n      };\n      activeSubscriptionsRef.current.set(channelName, entry);\n    } else if (options.isPersistent) {\n      entry.options.isPersistent = true;\n    }\n\n    const wasEmpty = entry.callbacks.size === 0;\n    entry.callbacks.add(callback);\n\n    if (!entry.isSubscribed || wasEmpty) {\n      subscribeToChannel(channelName, entry.aggregator);\n      entry.isSubscribed = true;\n    }\n\n    return () => {\n      if (!mountedRef.current) {\n        return;\n      }\n\n      const currentEntry = activeSubscriptionsRef.current.get(channelName);\n      if (!currentEntry) {\n        return;\n      }\n\n      currentEntry.callbacks.delete(callback);\n\n      if (currentEntry.callbacks.size === 0 && !currentEntry.options.isPersistent) {\n        unsubscribeFromChannel(channelName, currentEntry.aggregator);\n        activeSubscriptionsRef.current.delete(channelName);\n      }\n    };\n  }, [user?.id]);\n\n  // Exposed methods\n  const contextValue = useMemo(() => ({\n    connectionStatus,\n    isConnected: connectionStatus === 'connected',\n    subscribeToNotifications: (callback: (payload: any) => void) => \n      subscribe(`user-notifications-${user?.id}`, callback, { isPersistent: true }),\n    subscribeToUserPoints: (callback: (payload: any) => void) => \n      subscribe(`user-points-${user?.id}`, callback, { isPersistent: true }),\n    subscribeToUserProfilePoints: (callback: (payload: any) => void) => \n      subscribe(`user-profile-points-${user?.id}`, callback, { isPersistent: false }),\n  }), [connectionStatus, subscribe, user?.id]);\n  \n  return contextValue;\n}\n\nexport function RealtimeProvider({ children }: RealtimeProviderProps) {\n  const contextValue = useRealtimeContextValue();\n  \n  // Clean up on unmount\n  useEffect(() => {\n    return () => {\n      // Clean up all channels when the provider unmounts\n      cleanupAllChannels();\n    };\n  }, []);\n  \n  return (\n    <RealtimeContext.Provider value={contextValue}>\n      {children}\n    </RealtimeContext.Provider>\n  );\n}\n\nexport function useRealtime(): RealtimeContextType {\n  const context = useContext(RealtimeContext);\n  if (context === undefined) {\n    throw new Error('useRealtime must be used within a RealtimeProvider');\n  }\n  return context;\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\contexts\\ThemeContext.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'theme' is defined but never used.","line":7,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"theme"},"fix":{"range":[181,193],"text":""},"desc":"Remove unused variable 'theme'."}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":13,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":13,"endColumn":22}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useEffect, useState } from 'react';\n\ntype Theme = 'light' | 'dark' | 'system';\n\ninterface ThemeContextType {\n  theme: Theme;\n  setTheme: (theme: Theme) => void;\n  isDark: boolean;\n}\n\nconst ThemeContext = createContext<ThemeContextType | undefined>(undefined);\n\nexport const useTheme = () => {\n  const context = useContext(ThemeContext);\n  if (context === undefined) {\n    throw new Error('useTheme must be used within a ThemeProvider');\n  }\n  return context;\n};\n\ninterface ThemeProviderProps {\n  children: React.ReactNode;\n}\n\nexport const ThemeProvider: React.FC<ThemeProviderProps> = ({ children }) => {\n  const [theme, setTheme] = useState<Theme>(() => {\n    // Check localStorage first\n    const savedTheme = localStorage.getItem('breath-safe-theme') as Theme;\n    if (savedTheme && ['light', 'dark', 'system'].includes(savedTheme)) {\n      return savedTheme;\n    }\n    // Default to system\n    return 'system';\n  });\n\n  const [isDark, setIsDark] = useState(false);\n\n  useEffect(() => {\n    const root = window.document.documentElement;\n    \n    const updateTheme = () => {\n      let effectiveTheme: 'light' | 'dark';\n      \n      if (theme === 'system') {\n        effectiveTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';\n      } else {\n        effectiveTheme = theme;\n      }\n      \n      root.classList.remove('light', 'dark');\n      root.classList.add(effectiveTheme);\n      setIsDark(effectiveTheme === 'dark');\n    };\n\n    updateTheme();\n    \n    // Listen for system theme changes\n    const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\n    const handleChange = () => {\n      if (theme === 'system') {\n        updateTheme();\n      }\n    };\n    \n    mediaQuery.addEventListener('change', handleChange);\n    \n    return () => mediaQuery.removeEventListener('change', handleChange);\n  }, [theme]);\n\n  useEffect(() => {\n    localStorage.setItem('breath-safe-theme', theme);\n  }, [theme]);\n\n  const value: ThemeContextType = {\n    theme,\n    setTheme,\n    isDark,\n  };\n\n  return (\n    <ThemeContext.Provider value={value}>\n      {children}\n    </ThemeContext.Provider>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\contexts\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\data\\articles.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\devtools\\Profiler.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\use-mobile.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\use-toast.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'actionTypes' is assigned a value but only used as a type.","line":18,"column":7,"nodeType":null,"messageId":"usedOnlyAsType","endLine":18,"endColumn":18},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'dispatch' was used before it was defined.","line":65,"column":5,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":65,"endColumn":13},{"ruleId":"no-unused-vars","severity":1,"message":"'state' is defined but never used.","line":129,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":129,"endColumn":37,"suggestions":[{"messageId":"removeVar","data":{"varName":"state"},"fix":{"range":[2828,2840],"text":""},"desc":"Remove unused variable 'state'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\n\r\nimport type {\r\n  ToastActionElement,\r\n  ToastProps,\r\n} from \"@/components/ui/toast\"\r\n\r\nconst TOAST_LIMIT = 1\r\nconst TOAST_REMOVE_DELAY = 1000000\r\n\r\ntype ToasterToast = ToastProps & {\r\n  id: string\r\n  title?: React.ReactNode\r\n  description?: React.ReactNode\r\n  action?: ToastActionElement\r\n}\r\n\r\nconst actionTypes = {\r\n  ADD_TOAST: \"ADD_TOAST\",\r\n  UPDATE_TOAST: \"UPDATE_TOAST\",\r\n  DISMISS_TOAST: \"DISMISS_TOAST\",\r\n  REMOVE_TOAST: \"REMOVE_TOAST\",\r\n} as const\r\n\r\nlet count = 0\r\n\r\nfunction genId() {\r\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\r\n  return count.toString()\r\n}\r\n\r\ntype ActionType = typeof actionTypes\r\n\r\ntype Action =\r\n  | {\r\n      type: ActionType[\"ADD_TOAST\"]\r\n      toast: ToasterToast\r\n    }\r\n  | {\r\n      type: ActionType[\"UPDATE_TOAST\"]\r\n      toast: Partial<ToasterToast>\r\n    }\r\n  | {\r\n      type: ActionType[\"DISMISS_TOAST\"]\r\n      toastId?: ToasterToast[\"id\"]\r\n    }\r\n  | {\r\n      type: ActionType[\"REMOVE_TOAST\"]\r\n      toastId?: ToasterToast[\"id\"]\r\n    }\r\n\r\ninterface State {\r\n  toasts: ToasterToast[]\r\n}\r\n\r\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\r\n\r\nconst addToRemoveQueue = (toastId: string) => {\r\n  if (toastTimeouts.has(toastId)) {\r\n    return\r\n  }\r\n\r\n  const timeout = setTimeout(() => {\r\n    toastTimeouts.delete(toastId)\r\n    dispatch({\r\n      type: \"REMOVE_TOAST\",\r\n      toastId: toastId,\r\n    })\r\n  }, TOAST_REMOVE_DELAY)\r\n\r\n  toastTimeouts.set(toastId, timeout)\r\n}\r\n\r\nexport const reducer = (state: State, action: Action): State => {\r\n  switch (action.type) {\r\n    case \"ADD_TOAST\":\r\n      return {\r\n        ...state,\r\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\r\n      }\r\n\r\n    case \"UPDATE_TOAST\":\r\n      return {\r\n        ...state,\r\n        toasts: state.toasts.map((t) =>\r\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\r\n        ),\r\n      }\r\n\r\n    case \"DISMISS_TOAST\": {\r\n      const { toastId } = action\r\n\r\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\r\n      // but I'll keep it here for simplicity\r\n      if (toastId) {\r\n        addToRemoveQueue(toastId)\r\n      } else {\r\n        state.toasts.forEach((toast) => {\r\n          addToRemoveQueue(toast.id)\r\n        })\r\n      }\r\n\r\n      return {\r\n        ...state,\r\n        toasts: state.toasts.map((t) =>\r\n          t.id === toastId || toastId === undefined\r\n            ? {\r\n                ...t,\r\n                open: false,\r\n              }\r\n            : t\r\n        ),\r\n      }\r\n    }\r\n    case \"REMOVE_TOAST\":\r\n      if (action.toastId === undefined) {\r\n        return {\r\n          ...state,\r\n          toasts: [],\r\n        }\r\n      }\r\n      return {\r\n        ...state,\r\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\r\n      }\r\n  }\r\n}\r\n\r\nconst listeners: Array<(state: State) => void> = []\r\n\r\nlet memoryState: State = { toasts: [] }\r\n\r\nfunction dispatch(action: Action) {\r\n  memoryState = reducer(memoryState, action)\r\n  const snapshot = [...listeners]\r\n  for (const listener of snapshot) {\r\n    listener(memoryState)\r\n  }\r\n}\r\n\r\ntype Toast = Omit<ToasterToast, \"id\">\r\n\r\nfunction toast({ ...props }: Toast) {\r\n  const id = genId()\r\n\r\n  const update = (props: ToasterToast) =>\r\n    dispatch({\r\n      type: \"UPDATE_TOAST\",\r\n      toast: { ...props, id },\r\n    })\r\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\r\n\r\n  dispatch({\r\n    type: \"ADD_TOAST\",\r\n    toast: {\r\n      ...props,\r\n      id,\r\n      open: true,\r\n      onOpenChange: (open) => {\r\n        if (!open) dismiss()\r\n      },\r\n    },\r\n  })\r\n\r\n  return {\r\n    id: id,\r\n    dismiss,\r\n    update,\r\n  }\r\n}\r\n\r\nfunction useToast() {\r\n  const [state, setState] = React.useState<State>(memoryState)\r\n\r\n  const stableDispatch = React.useCallback((action: Action) => {\r\n    dispatch(action)\r\n  }, [])\r\n\r\n  React.useEffect(() => {\r\n    listeners.push(setState)\r\n    return () => {\r\n      const index = listeners.indexOf(setState)\r\n      if (index > -1) {\r\n        listeners.splice(index, 1)\r\n      }\r\n    }\r\n  }, [])\r\n\r\n  const dismiss = React.useCallback((toastId?: string) => {\r\n    stableDispatch({ type: \"DISMISS_TOAST\", toastId })\r\n  }, [stableDispatch])\r\n\r\n  return React.useMemo(\r\n    () => ({\r\n      ...state,\r\n      toast,\r\n      dismiss,\r\n    }),\r\n    [state, dismiss]\r\n  )\r\n}\r\n\r\nexport { useToast, toast }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useAchievements.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'goodAirStreak' is assigned a value but never used.","line":263,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":263,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"goodAirStreak"},"fix":{"range":[7707,7811],"text":""},"desc":"Remove unused variable 'goodAirStreak'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goodAirStreak' is assigned a value but never used.","line":263,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":263,"endColumn":26},{"ruleId":"no-unused-vars","severity":1,"message":"'weeklyStreak' is assigned a value but never used.","line":264,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":264,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"weeklyStreak"},"fix":{"range":[7818,7920],"text":""},"desc":"Remove unused variable 'weeklyStreak'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'weeklyStreak' is assigned a value but never used.","line":264,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":264,"endColumn":25},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'badgeDefinitions'. Either include it or remove the dependency array.","line":363,"column":6,"nodeType":"ArrayExpression","endLine":363,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [badgeDefinitions]","fix":{"range":[11008,11010],"text":"[badgeDefinitions]"}}]},{"ruleId":"no-unused-vars","severity":1,"message":"'progress' is assigned a value but never used.","line":375,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":375,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"progress"},"fix":{"range":[11338,11423],"text":""},"desc":"Remove unused variable 'progress'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'progress' is assigned a value but never used.","line":375,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":375,"endColumn":17},{"ruleId":"no-unused-vars","severity":1,"message":"'badgeProgress' is assigned a value but never used.","line":380,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":380,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"badgeProgress"},"fix":{"range":[11559,11647],"text":""},"desc":"Remove unused variable 'badgeProgress'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'badgeProgress' is assigned a value but never used.","line":380,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":380,"endColumn":22}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\nimport { useAuth } from '@/contexts/AuthContext';\n\ninterface Achievement {\n  id: string;\n  name: string;\n  description: string;\n  icon: string;\n  category: string;\n  points_reward: number;\n  criteria_type: string;\n  criteria_value: number;\n  criteria_unit: string | null;\n  is_active: boolean;\n  created_at: string;\n  updated_at: string;\n}\n\ninterface UserAchievement {\n  id: string;\n  user_id: string;\n  achievement_id: string;\n  progress: number;\n  max_progress: number;\n  unlocked: boolean;\n  unlocked_at: string | null;\n  achievement?: Achievement;\n}\n\ninterface Badge {\n  id: string;\n  name: string;\n  description: string;\n  icon: string;\n  color: string;\n  pointsRequired: number;\n  unlocked: boolean;\n  unlockedAt?: string;\n  progress: number;\n  maxProgress: number;\n}\n\nexport const useAchievements = () => {\n  const { user } = useAuth();\n  const [achievements, setAchievements] = useState<Achievement[]>([]);\n  const [userAchievements, setUserAchievements] = useState<UserAchievement[]>([]);\n  const [badges, setBadges] = useState<Badge[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  // Define the badge system based on points thresholds\n  const badgeDefinitions: Omit<Badge, 'unlocked' | 'unlockedAt' | 'progress' | 'maxProgress'>[] = [\n    {\n      id: 'bronze-starter',\n      name: 'Bronze Starter',\n      description: 'Begin your journey with 10,000 points',\n      icon: '🥉',\n      color: 'bg-amber-500',\n      pointsRequired: 10000\n    },\n    {\n      id: 'silver-explorer',\n      name: 'Silver Explorer',\n      description: 'Explore air quality monitoring with 20,000 points',\n      icon: '🥈',\n      color: 'bg-gray-400',\n      pointsRequired: 20000\n    },\n    {\n      id: 'gold-enthusiast',\n      name: 'Gold Enthusiast',\n      description: 'Show your dedication with 30,000 points',\n      icon: '🥇',\n      color: 'bg-yellow-500',\n      pointsRequired: 30000\n    },\n    {\n      id: 'platinum-guardian',\n      name: 'Platinum Guardian',\n      description: 'Guard air quality with 40,000 points',\n      icon: '💎',\n      color: 'bg-blue-400',\n      pointsRequired: 40000\n    },\n    {\n      id: 'diamond-master',\n      name: 'Diamond Master',\n      description: 'Master the art of monitoring with 50,000 points',\n      icon: '💠',\n      color: 'bg-purple-500',\n      pointsRequired: 50000\n    },\n    {\n      id: 'emerald-expert',\n      name: 'Emerald Expert',\n      description: 'Expert level achieved with 60,000 points',\n      icon: '🟢',\n      color: 'bg-green-500',\n      pointsRequired: 60000\n    },\n    {\n      id: 'ruby-champion',\n      name: 'Ruby Champion',\n      description: 'Champion status unlocked with 70,000 points',\n      icon: '🔴',\n      color: 'bg-red-500',\n      pointsRequired: 70000\n    },\n    {\n      id: 'sapphire-legend',\n      name: 'Sapphire Legend',\n      description: 'Legendary status with 80,000 points',\n      icon: '🔵',\n      color: 'bg-indigo-500',\n      pointsRequired: 80000\n    },\n    {\n      id: 'obsidian-elite',\n      name: 'Obsidian Elite',\n      description: 'Elite status achieved with 90,000 points',\n      icon: '⚫',\n      color: 'bg-gray-800',\n      pointsRequired: 90000\n    },\n    {\n      id: 'crystal-legend',\n      name: 'Crystal Legend',\n      description: 'Ultimate legend status with 100,000 points',\n      icon: '✨',\n      color: 'bg-gradient-to-r from-purple-500 to-pink-500',\n      pointsRequired: 100000\n    }\n  ];\n\n  const fetchAchievements = useCallback(async () => {\n    if (!user) return;\n\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      // Get all available achievements\n      const { data: allAchievements, error: achievementsError } = await supabase\n        .from('achievements')\n        .select('*')\n        .eq('is_active', true)\n        .order('created_at', { ascending: true });\n\n      if (achievementsError) throw achievementsError;\n\n      // Get user's earned achievements\n      const { data: userAchievementsData, error: userAchievementsError } = await supabase\n        .from('user_achievements')\n        .select('*')\n        .eq('user_id', user.id);\n\n      if (userAchievementsError) throw userAchievementsError;\n\n      setAchievements(allAchievements || []);\n      setUserAchievements(userAchievementsData || []);\n    } catch (err: any) {\n      console.error('Error fetching achievements:', err);\n      setError(err.message || 'Failed to fetch achievements');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [user]);\n\n  const initializeUserAchievements = useCallback(async () => {\n    if (!user) return { success: false, error: 'No user found' };\n\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      // Get all available achievements\n      const { data: allAchievementsData, error: achievementsError } = await supabase\n        .from('achievements')\n        .select('*')\n        .eq('is_active', true);\n\n      if (achievementsError) throw achievementsError;\n\n      // Create user achievement records for each achievement\n      const userAchievementRecords = allAchievementsData.map(achievement => ({\n        user_id: user.id,\n        achievement_id: achievement.id,\n        progress: 0,\n        max_progress: achievement.criteria_value,\n        unlocked: false,\n        unlocked_at: null\n      }));\n\n      // Insert user achievements\n      const { error: insertError } = await supabase\n        .from('user_achievements')\n        .upsert(userAchievementRecords, { \n          onConflict: 'user_id,achievement_id',\n          ignoreDuplicates: true \n        });\n\n      if (insertError) throw insertError;\n\n      // Refresh achievements after initialization\n      await fetchAchievements();\n      \n      return { success: true };\n    } catch (err: any) {\n      console.error('Error initializing achievements:', err);\n      setError(err.message || 'Failed to initialize achievements');\n      return { success: false, error: err.message };\n    } finally {\n      setIsLoading(false);\n    }\n  }, [user, fetchAchievements]);\n\n  // Check and update achievements manually\n  const checkAchievements = useCallback(async () => {\n    if (!user) return { success: false, error: 'No user found' };\n    \n    try {\n      setIsLoading(true);\n      setError(null);\n      \n      // Get user's current data\n      const { data: profileData, error: profileError } = await supabase\n        .from('profiles')\n        .select('total_points')\n        .eq('user_id', user.id)\n        .single();\n      \n      if (profileError) throw profileError;\n      \n      const totalPoints = profileData?.total_points || 0;\n      \n      // Get total readings count\n      const { count: totalReadings, error: readingsError } = await supabase\n        .from('air_quality_readings')\n        .select('*', { count: 'exact', head: true })\n        .eq('user_id', user.id);\n      \n      if (readingsError) throw readingsError;\n      \n      // Get good air quality days count (AQI <= 50)\n      const { count: goodAirDays, error: goodAirError } = await supabase\n        .from('air_quality_readings')\n        .select('*', { count: 'exact', head: true })\n        .eq('user_id', user.id)\n        .lte('aqi', 50);\n      \n      if (goodAirError) throw goodAirError;\n      \n      // Get current streaks\n      const { data: streaksData, error: streaksError } = await supabase\n        .from('user_streaks')\n        .select('streak_type, current_streak')\n        .eq('user_id', user.id);\n      \n      if (streaksError) throw streaksError;\n      \n      const dailyStreak = streaksData?.find(s => s.streak_type === 'daily_reading')?.current_streak || 0;\n      const goodAirStreak = streaksData?.find(s => s.streak_type === 'good_air_quality')?.current_streak || 0;\n      const weeklyStreak = streaksData?.find(s => s.streak_type === 'weekly_activity')?.current_streak || 0;\n      \n      // Update reading count achievements\n      await supabase\n        .from('user_achievements')\n        .update({ progress: totalReadings || 0 })\n        .eq('user_id', user.id)\n        .in('achievement_id', \n          achievements.filter(a => a.criteria_type === 'count' && a.category === 'reading').map(a => a.id)\n        );\n      \n      // Update good air quality achievements\n      await supabase\n        .from('user_achievements')\n        .update({ progress: goodAirDays || 0 })\n        .eq('user_id', user.id)\n        .in('achievement_id', \n          achievements.filter(a => a.criteria_type === 'quality').map(a => a.id)\n        );\n      \n      // Update streak-based achievements\n      await supabase\n        .from('user_achievements')\n        .update({ progress: dailyStreak })\n        .eq('user_id', user.id)\n        .in('achievement_id', \n          achievements.filter(a => a.criteria_type === 'streak' && a.category === 'streak').map(a => a.id)\n        );\n      \n      // Update points-based achievements\n      await supabase\n        .from('user_achievements')\n        .update({ progress: totalPoints })\n        .eq('user_id', user.id)\n        .in('achievement_id', \n          achievements.filter(a => a.criteria_type === 'points').map(a => a.id)\n        );\n      \n      // Check and unlock achievements\n      await supabase\n        .from('user_achievements')\n        .update({ \n          unlocked: true,\n          unlocked_at: new Date().toISOString()\n        })\n        .eq('user_id', user.id)\n        .gte('progress', 'max_progress')\n        .eq('unlocked', false);\n      \n      // Refresh achievements data\n      await fetchAchievements();\n      \n      return { success: true };\n    } catch (err: any) {\n      console.error('Error checking achievements:', err);\n      setError(err.message || 'Failed to check achievements');\n      return { success: false, error: err.message };\n    } finally {\n      setIsLoading(false);\n    }\n  }, [user, achievements, fetchAchievements]);\n\n  const refreshAchievements = useCallback(async () => {\n    if (!user) return;\n\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      // Refresh achievements data\n      await fetchAchievements();\n      \n      return { success: true };\n    } catch (err: any) {\n      console.error('Error refreshing achievements:', err);\n      setError(err.message || 'Failed to refresh achievements');\n      return { success: false, error: err.message };\n    } finally {\n      setIsLoading(false);\n    }\n  }, [user, fetchAchievements]);\n\n  // Update badges based on user points\n  const updateBadges = useCallback((totalPoints: number) => {\n    const updatedBadges = badgeDefinitions.map(badge => {\n      const unlocked = totalPoints >= badge.pointsRequired;\n      const progress = Math.min(totalPoints, badge.pointsRequired);\n      const maxProgress = badge.pointsRequired;\n      \n      return {\n        ...badge,\n        unlocked,\n        progress,\n        maxProgress,\n        unlockedAt: unlocked ? new Date().toISOString() : undefined\n      };\n    });\n\n    setBadges(updatedBadges);\n  }, []);\n\n  useEffect(() => {\n    if (user) {\n      fetchAchievements();\n    }\n  }, [user, fetchAchievements]);\n\n  // Calculate progress and earned achievements\n  const earnedAchievements = userAchievements.filter(ua => ua.unlocked);\n  const totalAchievements = achievements.length;\n  const earnedCount = earnedAchievements.length;\n  const progress = totalAchievements > 0 ? (earnedCount / totalAchievements) * 100 : 0;\n\n  // Calculate badge progress\n  const unlockedBadges = badges.filter(badge => badge.unlocked);\n  const totalBadges = badges.length;\n  const badgeProgress = totalBadges > 0 ? (unlockedBadges.length / totalBadges) * 100 : 0;\n\n  return {\n    achievements,\n    userAchievements,\n    badges,\n    isLoading,\n    error,\n    fetchAchievements,\n    initializeUserAchievements,\n    checkAchievements,\n    refreshAchievements,\n    updateBadges\n  };\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useAirQuality.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useAirQuality_BROKEN.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":1,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"useState"},"fix":{"range":[20,30],"text":""},"desc":"Remove unused variable 'useState'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":1,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":31},{"ruleId":"no-unused-vars","severity":1,"message":"'useAppStore' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"useAppStore"},"fix":{"range":[184,222],"text":""},"desc":"Remove unused variable 'useAppStore'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useAppStore' is defined but never used.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":21},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'finalData', 'safeCoordinates', and 'user'. Either include them or remove the dependency array.","line":533,"column":6,"nodeType":"ArrayExpression","endLine":533,"endColumn":133,"suggestions":[{"desc":"Update the dependencies array to be: [user.id, finalData.aqi, finalData.pm25, finalData.pm10, finalData.dataSource, safeCoordinates.lat, safeCoordinates.lng, user, finalData, safeCoordinates]","fix":{"range":[20823,20950],"text":"[user.id, finalData.aqi, finalData.pm25, finalData.pm10, finalData.dataSource, safeCoordinates.lat, safeCoordinates.lng, user, finalData, safeCoordinates]"}}]},{"ruleId":"no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":551,"column":68,"nodeType":"Identifier","messageId":"unusedVar","endLine":551,"endColumn":69,"suggestions":[{"messageId":"removeVar","data":{"varName":"_"},"fix":{"range":[21617,21618],"text":""},"desc":"Remove unused variable '_'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":551,"column":68,"nodeType":null,"messageId":"unusedVar","endLine":551,"endColumn":69},{"ruleId":"no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":556,"column":61,"nodeType":"Identifier","messageId":"unusedVar","endLine":556,"endColumn":62,"suggestions":[{"messageId":"removeVar","data":{"varName":"_"},"fix":{"range":[21839,21840],"text":""},"desc":"Remove unused variable '_'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":556,"column":61,"nodeType":null,"messageId":"unusedVar","endLine":556,"endColumn":62},{"ruleId":"no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":557,"column":59,"nodeType":"Identifier","messageId":"unusedVar","endLine":557,"endColumn":60,"suggestions":[{"messageId":"removeVar","data":{"varName":"_"},"fix":{"range":[21947,21948],"text":""},"desc":"Remove unused variable '_'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":557,"column":59,"nodeType":null,"messageId":"unusedVar","endLine":557,"endColumn":60},{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":562,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":562,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":562,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":562,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useCallback, useState, useEffect, useRef, useMemo } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { supabase } from \"@/integrations/supabase/client\";\nimport { useAppStore } from \"@/store\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { useGeolocation } from \"@/hooks/useGeolocation\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useGlobalEnvironmentalData } from \"@/hooks/useGlobalEnvironmentalData\";\n\n// Refresh lock mechanism to prevent duplicate pulls on manual refresh\nconst REFRESH_LOCK_KEY = 'breath_safe_refresh_lock';\nconst REFRESH_LOCK_DURATION = 14 * 60 * 1000; // 14 minutes (slightly less than 15 to ensure smooth operation)\n\n// Data validation caching to prevent duplicate validation logs\nconst VALIDATION_CACHE_KEY = 'breath_safe_validation_cache';\nconst VALIDATION_CACHE_DURATION = 5 * 60 * 1000; // 5 minutes cache duration\n\n// Helper function to check if refresh is locked\nconst isRefreshLocked = (): boolean => {\n  try {\n    const lockData = localStorage.getItem(REFRESH_LOCK_KEY);\n    if (!lockData) return false;\n    \n    const { timestamp } = JSON.parse(lockData);\n    const now = Date.now();\n    const timeSinceLastRefresh = now - timestamp;\n    \n    // If less than 14 minutes have passed, refresh is locked\n    return timeSinceLastRefresh < REFRESH_LOCK_DURATION;\n  } catch {\n    return false;\n  }\n};\n\n// Helper function to set refresh lock\nconst setRefreshLock = (): void => {\n  try {\n    const lockData = {\n      timestamp: Date.now(),\n      duration: REFRESH_LOCK_DURATION\n    };\n    localStorage.setItem(REFRESH_LOCK_KEY, JSON.stringify(lockData));\n    console.log('🔒 [useAirQuality] Refresh lock set for 14 minutes');\n  } catch (error) {\n    console.warn('Failed to set refresh lock:', error);\n  }\n};\n\n// Helper function to clear refresh lock\nconst clearRefreshLock = (): void => {\n  try {\n    localStorage.removeItem(REFRESH_LOCK_KEY);\n    console.log('🔓 [useAirQuality] Refresh lock cleared');\n  } catch (error) {\n    console.warn('Failed to clear refresh lock:', error);\n  }\n};\n\n// Helper function to check validation cache\nconst getValidationCache = (dataSignature: string): { timestamp: number; result: boolean } | null => {\n  try {\n    const cacheData = localStorage.getItem(VALIDATION_CACHE_KEY);\n    if (!cacheData) return null;\n    \n    const cache = JSON.parse(cacheData);\n    const cached = cache[dataSignature];\n    \n    if (cached && (Date.now() - cached.timestamp) < VALIDATION_CACHE_DURATION) {\n      return cached;\n    }\n    \n    return null;\n  } catch {\n    return null;\n  }\n};\n\n// Helper function to set validation cache\nconst setValidationCache = (dataSignature: string, result: boolean): void => {\n  try {\n    const cacheData = localStorage.getItem(VALIDATION_CACHE_KEY);\n    const cache = cacheData ? JSON.parse(cacheData) : {};\n    \n    cache[dataSignature] = {\n      timestamp: Date.now(),\n      result\n    };\n    \n    // Clean up old cache entries (keep only last 100)\n    const entries = Object.entries(cache);\n    if (entries.length > 100) {\n      const sortedEntries = entries.sort((a, b) => (b[1] as any).timestamp - (a[1] as any).timestamp);\n      const cleanedCache = Object.fromEntries(sortedEntries.slice(0, 100));\n      localStorage.setItem(VALIDATION_CACHE_KEY, JSON.stringify(cleanedCache));\n    } else {\n      localStorage.setItem(VALIDATION_CACHE_KEY, JSON.stringify(cache));\n    }\n  } catch (error) {\n    console.warn('Failed to set validation cache:', error);\n  }\n};\n\nexport interface AirQualityData {\n  aqi: number;\n  pm25: number;\n  pm10: number;\n  no2: number;\n  so2: number;\n  co: number;\n  o3: number;\n  location: string;\n  userLocation: string;\n  coordinates: { lat: number; lon: number };\n  userCoordinates: { lat: number; lon: number };\n  timestamp: string;\n  dataSource: string;\n  userPoints?: number;\n  currencyRewards?: number;\n  canWithdraw?: boolean;\n  environmental?: {\n    temperature: number;\n    humidity: number;\n    windSpeed?: number;\n    windDirection?: number;\n    windGust?: number;\n    airPressure?: number;\n    rainProbability?: number;\n    uvIndex?: number;\n    visibility?: number;\n    weatherCondition?: string;\n    feelsLikeTemperature?: number;\n    sunriseTime?: string;\n    sunsetTime?: string;\n  };\n}\n\nexport const useAirQuality = () => {\n  const { user } = useAuth();\n  const { locationData } = useGeolocation();\n  const { toast } = useToast();\n  \n  // Ref to track if we've already saved this data to prevent infinite loops\n  const savedDataRef = useRef<Set<string>>(new Set());\n  \n  // Get coordinates from geolocation hook\n  const safeCoordinates = locationData ? { lat: locationData.latitude, lng: locationData.longitude } : null;\n  \n  // Get global environmental data from server-side collection\n  const { \n    data: globalEnvironmentalData, \n    isLoading: globalDataLoading, \n    error: globalDataError,\n    refetch: refetchGlobalData \n  } = useGlobalEnvironmentalData({\n    latitude: safeCoordinates?.lat,\n    longitude: safeCoordinates?.lng,\n    maxDistanceKm: 50,\n    autoRefresh: true,\n    refreshInterval: 900000 // 15 minutes\n  });\n\n  // Transform global data to AirQualityData format\n  const transformGlobalData = useCallback((globalData: any): AirQualityData => {\n    if (!globalData) return null;\n    \n    console.log('🔍 [useAirQuality] Transforming global data:', {\n      dataSource: globalData.data_source,\n      aqi: globalData.aqi,\n      city: globalData.city_name\n    });\n    \n    // CRITICAL FIX: Enhanced data source validation to prevent \"Initial Data\" contamination\n    // ACCEPT: OpenWeatherMap API, OpenAQ API, and other legitimate API sources\n    // REJECT: Only mock, test, placeholder, demo, fake, and initial data\n    if (globalData.data_source && \n        (globalData.data_source.toLowerCase().includes('mock') ||\n         globalData.data_source.toLowerCase().includes('test') ||\n         globalData.data_source.toLowerCase().includes('placeholder') ||\n         globalData.data_source.toLowerCase().includes('demo') ||\n         globalData.data_source.toLowerCase().includes('fake') ||\n         globalData.data_source === 'Initial Data' ||  // Exact match for Initial Data\n         globalData.data_source.toLowerCase().includes('initial data') ||  // Case-insensitive check\n         globalData.data_source.toLowerCase().includes('initial'))) {\n      console.warn('🚨 [useAirQuality] Detected contaminated data source:', globalData.data_source);\n      console.warn('🚨 [useAirQuality] This data will be rejected to prevent contamination');\n      return null; // Reject contaminated data\n    }\n    \n    // Validate AQI values - accept all legitimate OpenWeatherMap API values\n    if (globalData.aqi !== undefined && globalData.aqi !== null) {\n      // AQICN API returns direct AQI values (0-500 scale)\n      // These are legitimate values and should always be accepted\n      if (globalData.data_source === 'AQICN' || globalData.data_source === 'AQICN + OpenWeatherMap API') {\n        console.log('✅ [useAirQuality] Using legitimate AQICN data with AQI:', globalData.aqi, 'from:', globalData.data_source);\n      } else if (globalData.data_source === 'OpenWeatherMap API') {\n        console.log('✅ [useAirQuality] Using legitimate OpenWeatherMap data with AQI:', globalData.aqi, 'from:', globalData.data_source);\n      } else if (globalData.aqi < 0 || globalData.aqi > 500) {\n        // Only reject if AQI is outside valid range (0-500) and not from legitimate APIs\n        console.warn('🚨 [useAirQuality] Detected invalid AQI value:', globalData.aqi, 'from source:', globalData.data_source);\n        return null;\n      }\n    }\n    \n    console.log('✅ [useAirQuality] Using legitimate global data from:', globalData.data_source);\n    \n    return {\n      aqi: globalData.aqi || 0,\n      pm25: globalData.pm25 || 0,\n      pm10: globalData.pm10 || 0,\n      no2: globalData.no2 || 0,\n      so2: globalData.so2 || 0,\n      co: globalData.co || 0,\n      o3: globalData.o3 || 0,\n      location: globalData.city_name || 'Unknown City',\n      userLocation: globalData.city_name || 'Unknown City',\n      coordinates: { \n        lat: globalData.latitude || 0, \n        lon: globalData.longitude || 0 \n      },\n      userCoordinates: { \n        lat: globalData.latitude || 0, \n        lon: globalData.longitude || 0 \n      },\n      timestamp: globalData.collection_timestamp || new Date().toISOString(),\n      dataSource: globalData.data_source || 'Server-side Collection',\n      environmental: globalData.temperature ? {\n        temperature: globalData.temperature,\n        humidity: globalData.humidity,\n        windSpeed: globalData.wind_speed,\n        windDirection: globalData.wind_direction,\n        windGust: globalData.wind_gust,\n        airPressure: globalData.air_pressure,\n        visibility: globalData.visibility,\n        weatherCondition: globalData.weather_condition,\n        feelsLikeTemperature: globalData.feels_like_temperature,\n        sunriseTime: globalData.sunrise_time,\n        sunsetTime: globalData.sunset_time\n      } : undefined\n    };\n  }, []);\n\n  // Use global data when available, fallback to legacy API if needed\n  const airQualityData = globalEnvironmentalData ? transformGlobalData(globalEnvironmentalData) : null;\n  \n  // CRITICAL FIX: Enhanced debugging and user feedback for data contamination\n  if (globalEnvironmentalData && !airQualityData) {\n    console.warn('⚠️ [useAirQuality] Global data was rejected during transformation:', {\n      originalData: globalEnvironmentalData,\n      dataSource: globalEnvironmentalData.data_source,\n      aqi: globalEnvironmentalData.aqi,\n      city: globalEnvironmentalData.city_name,\n      timestamp: globalEnvironmentalData.collection_timestamp\n    });\n    \n    // Show user-friendly error message for contaminated data\n    if (globalEnvironmentalData.data_source === 'Initial Data') {\n      console.warn('🚨 [useAirQuality] Detected \"Initial Data\" placeholder - this indicates database needs real data');\n      console.warn('🚨 [useAirQuality] The scheduled data collection system should populate the database with real AQICN + OpenWeatherMap API data');\n    }\n  }\n  \n  // Enhanced fallback logic: Only use AQICN API if no legitimate global data is available\n  const shouldUseAQICNAPI = !globalEnvironmentalData || \n                            (globalEnvironmentalData && !airQualityData && \n                             globalEnvironmentalData.data_source === 'Initial Data');\n  \n  // AQICN API direct fetch (when necessary)\n  const aqicnQuery = useQuery({\n    queryKey: ['air-quality-aqicn', safeCoordinates?.lat, safeCoordinates?.lng],\n    queryFn: async () => {\n      if (!safeCoordinates?.lat || !safeCoordinates?.lng) {\n        throw new Error('Coordinates not available');\n      }\n\n      try {\n        console.log('🔄 [useAirQuality] Fetching AQICN data directly');\n        \n        const { data, error } = await supabase.functions.invoke('fetchAQI', {\n          body: { \n            lat: safeCoordinates.lat, \n            lon: safeCoordinates.lng \n          }\n        });\n\n        if (error) throw error;\n        if (!data) throw new Error('No data received');\n\n        // Check if API returned an error\n        if (data.error) {\n          throw new Error(data.message || 'AQICN API unavailable');\n        }\n\n        // Transform AQICN API response\n        const transformedData: AirQualityData = {\n          aqi: data.aqi || 0,\n          pm25: data.pollutants?.pm25 || 0,\n          pm10: data.pollutants?.pm10 || 0,\n          no2: data.pollutants?.no2 || 0,\n          so2: data.pollutants?.so2 || 0,\n          co: data.pollutants?.co || 0,\n          o3: data.pollutants?.o3 || 0,\n          location: data.city || 'Unknown Location',\n          userLocation: data.city || 'Unknown Location',\n          coordinates: { lat: safeCoordinates.lat, lon: safeCoordinates.lng },\n          userCoordinates: { lat: safeCoordinates.lat, lon: safeCoordinates.lng },\n          timestamp: data.timestamp || new Date().toISOString(),\n          dataSource: 'AQICN',\n          environmental: data.environmental ? {\n            temperature: data.environmental.temperature,\n            humidity: data.environmental.humidity,\n            airPressure: data.environmental.pressure\n          } : undefined\n        };\n\n        console.log('✅ [useAirQuality] AQICN API fetch successful:', transformedData);\n        console.log(`✅ [DataSourceValidator] dataSource: 'AQICN' - Location: ${transformedData.location}, AQI: ${transformedData.aqi}`);\n        return transformedData;\n      } catch (error) {\n        console.error('❌ [useAirQuality] AQICN API fetch failed:', error);\n        // Don't throw, return null to allow error handling\n        return null;\n      }\n    },\n    enabled: shouldUseAQICNAPI && !!safeCoordinates?.lat && !!safeCoordinates?.lng,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    gcTime: 10 * 60 * 1000, // 10 minutes\n    retry: 2,\n    retryDelay: 1000,\n  });\n\n  // Combine global data with AQICN direct fetch\n  const finalData = useMemo(() => {\n    if (!airQualityData && !aqicnQuery.data) {\n      // No data available - show error message instead of fallback\n      return {\n        aqi: 0,\n        pm25: 0,\n        pm10: 0,\n        no2: 0,\n        so2: 0,\n        co: 0,\n        o3: 0,\n        location: 'Unknown Location',\n        userLocation: 'Unknown Location',\n        coordinates: { lat: 0, lon: 0 },\n        userCoordinates: { lat: 0, lon: 0 },\n        timestamp: new Date().toISOString(),\n        dataSource: 'No Data Available',\n        error: true,\n        message: '⚠️ Live air quality data unavailable, please check back later.'\n      };\n    }\n    \n    const data = airQualityData || aqicnQuery.data;\n    return {\n      ...data,\n      // Ensure we have a stable timestamp\n      timestamp: data.timestamp || new Date().toISOString()\n    };\n  }, [airQualityData, aqicnQuery.data]);\n  \n  const isLoading = globalDataLoading || (aqicnQuery.isLoading && !globalEnvironmentalData);\n  const error = globalDataError || aqicnQuery.error;\n\n  // Manual refresh function\n  const refreshData = useCallback(async () => {\n    console.log('🔄 [useAirQuality] Manual refresh requested');\n    \n    // Check refresh lock\n    if (isRefreshLocked()) {\n      console.log('⏳ [useAirQuality] Refresh locked, waiting for cooldown');\n      toast({\n        title: \"Refresh Cooldown\",\n        description: \"Please wait before refreshing again\",\n        variant: \"default\",\n      });\n      return;\n    }\n\n    // Set refresh lock\n    setRefreshLock();\n\n    try {\n      if (globalEnvironmentalData) {\n        // Refresh global data\n        await refetchGlobalData();\n        toast({\n          title: \"Data Refreshed\",\n          description: \"Air quality data has been updated\",\n          variant: \"default\",\n        });\n      } else {\n        // Refresh AQICN data\n        await aqicnQuery.refetch();\n        toast({\n          title: \"Data Refreshed\",\n          description: \"Air quality data has been updated\",\n          variant: \"default\",\n        });\n      }\n    } catch (error) {\n      console.error('❌ [useAirQuality] Refresh failed:', error);\n      toast({\n        title: \"Refresh Failed\",\n        description: \"Failed to refresh air quality data\",\n        variant: \"destructive\",\n      });\n    } finally {\n      // Clear refresh lock after successful refresh\n      clearRefreshLock();\n    }\n  }, [globalEnvironmentalData, refetchGlobalData, aqicnQuery, toast]);\n\n  // Save reading to user history when data is available (with loop prevention)\n  useEffect(() => {\n    if (!user || !finalData || !safeCoordinates) return;\n\n    // Create a stable data signature that doesn't change on every render\n    // Remove environmental data from signature as it changes object references\n    const dataSignature = `${user.id}-${finalData.aqi}-${finalData.pm25}-${finalData.pm10}-${finalData.dataSource}-${Math.floor(Date.now() / (5 * 60 * 1000))}`; // 5-minute window\n    \n    // Check if we've already saved this exact data signature\n    if (savedDataRef.current.has(dataSignature)) {\n      console.log('🔄 [useAirQuality] Data already saved, skipping duplicate save');\n      return;\n    }\n\n    // Only save if we have meaningful data changes (not just timestamp updates)\n    const hasMeaningfulData = finalData.aqi > 0 || finalData.pm25 > 0 || finalData.pm10 > 0;\n    if (!hasMeaningfulData) {\n      console.log('🔄 [useAirQuality] No meaningful data to save, skipping');\n      return;\n    }\n\n    const saveReading = async () => {\n      try {\n        // Check if we already have the same data in the database\n        const { data: existingReadings, error: checkError } = await supabase\n          .from('air_quality_readings')\n          .select('aqi, pm25, pm10, no2, so2, co, o3')\n          .eq('user_id', user.id)\n          .order('timestamp', { ascending: false })\n          .limit(1);\n\n        if (checkError) {\n          console.warn('⚠️ [useAirQuality] Could not check existing readings:', checkError);\n        } else if (existingReadings && existingReadings.length > 0) {\n          const latest = existingReadings[0];\n          \n          // Create data signature for caching\n          const dataSignature = `${finalData.aqi}-${finalData.pm25}-${finalData.pm10}-${finalData.no2}-${finalData.so2}-${finalData.co}-${finalData.o3}`;\n          \n          // Check validation cache first\n          const cachedValidation = getValidationCache(dataSignature);\n          if (cachedValidation) {\n            // Use cached result - no need to log again\n            if (!cachedValidation.result) {\n              return; // Skip save based on cached validation\n            }\n          }\n          \n          // Check if the new data is significantly different from the latest reading\n          const isSignificantlyDifferent = \n            Math.abs(latest.aqi - finalData.aqi) > 1 ||\n            Math.abs(latest.pm25 - finalData.pm25) > 0.1 ||\n            Math.abs(latest.pm10 - finalData.pm10) > 0.1 ||\n            Math.abs(latest.no2 - finalData.no2) > 0.01 ||\n            Math.abs(latest.so2 - finalData.so2) > 0.01 ||\n            Math.abs(latest.co - finalData.co) > 0.01 ||\n            Math.abs(latest.o3 - finalData.o3) > 0.01;\n\n          if (!isSignificantlyDifferent) {\n            // Cache the validation result and log only once per session\n            setValidationCache(dataSignature, false);\n            console.log('🔄 [useAirQuality] Data validation: skipping save (cached for 5 minutes)');\n            return;\n          }\n          \n          // Cache the positive validation result\n          setValidationCache(dataSignature, true);\n        }\n\n        const { error } = await supabase\n          .from('air_quality_readings')\n          .insert({\n            user_id: user.id,\n            aqi: finalData.aqi,\n            pm25: finalData.pm25,\n            pm10: finalData.pm10,\n            no2: finalData.no2,\n            so2: finalData.so2,\n            co: finalData.co,\n            o3: finalData.o3,\n            latitude: safeCoordinates.lat,\n            longitude: safeCoordinates.lng,\n            location_name: finalData.location || 'Unknown Location',\n            timestamp: new Date().toISOString(),\n            data_source: finalData.dataSource || 'Global Environmental Data',\n            // Add environmental data if available (check for error state first)\n            temperature: (finalData as any).environmental?.temperature || null,\n            humidity: (finalData as any).environmental?.humidity || null,\n            wind_speed: (finalData as any).environmental?.windSpeed || null,\n            wind_direction: (finalData as any).environmental?.windDirection || null,\n            air_pressure: (finalData as any).environmental?.airPressure || null,\n            visibility: (finalData as any).environmental?.visibility || null,\n            weather_condition: (finalData as any).environmental?.weatherCondition || null\n          });\n\n        if (error) {\n          console.error('❌ [useAirQuality] Failed to save reading:', error);\n        } else {\n          console.log('✅ [useAirQuality] Reading saved to history');\n          // Mark this data signature as saved to prevent duplicate saves\n          savedDataRef.current.add(dataSignature);\n          \n          // Clean up old signatures to prevent memory leaks (keep only last 50)\n          if (savedDataRef.current.size > 50) {\n            const signaturesArray = Array.from(savedDataRef.current);\n            savedDataRef.current = new Set(signaturesArray.slice(-25));\n          }\n        }\n      } catch (error) {\n        console.error('❌ [useAirQuality] Error saving reading:', error);\n      }\n    };\n\n    // Add debounce to prevent rapid successive saves\n    const debounceTimer = setTimeout(() => {\n      saveReading();\n    }, 1000); // 1 second debounce\n\n    return () => clearTimeout(debounceTimer);\n  }, [user?.id, finalData?.aqi, finalData?.pm25, finalData?.pm10, finalData?.dataSource, safeCoordinates?.lat, safeCoordinates?.lng]);\n\n  // Set refresh lock when global environmental data is fetched\n  useEffect(() => {\n    if (globalEnvironmentalData && !isRefreshLocked()) {\n      console.log('🔒 [useAirQuality] Setting refresh lock for new global data');\n      setRefreshLock();\n    }\n  }, [globalEnvironmentalData]);\n\n  // Periodic validation summary logging (every 10 minutes)\n  useEffect(() => {\n    const logValidationSummary = () => {\n      try {\n        const cacheData = localStorage.getItem(VALIDATION_CACHE_KEY);\n        if (cacheData) {\n          const cache = JSON.parse(cacheData);\n          const now = Date.now();\n          const recentValidations = Object.entries(cache).filter(([_, data]: [string, any]) => \n            (now - data.timestamp) < VALIDATION_CACHE_DURATION\n          );\n          \n          if (recentValidations.length > 0) {\n            const skippedCount = recentValidations.filter(([_, data]: [string, any]) => !data.result).length;\n            const savedCount = recentValidations.filter(([_, data]: [string, any]) => data.result).length;\n            \n            console.log(`📊 [useAirQuality] Validation summary (last 5 min): ${savedCount} saved, ${skippedCount} skipped`);\n          }\n        }\n      } catch (error) {\n        // Silently handle cache read errors\n      }\n    };\n\n    // Log summary every 10 minutes\n    const summaryInterval = setInterval(logValidationSummary, 10 * 60 * 1000);\n    \n    // Initial summary after 1 minute\n    const initialSummary = setTimeout(logValidationSummary, 60 * 1000);\n    \n    return () => {\n      clearInterval(summaryInterval);\n      clearTimeout(initialSummary);\n    };\n  }, []);\n\n  return {\n    data: finalData,\n    isLoading,\n    error,\n    refreshData,\n    isRefreshing: aqicnQuery.isRefetching,\n    lastUpdated: finalData?.timestamp,\n    dataSource: finalData?.dataSource || 'Unknown',\n    coordinates: finalData?.coordinates,\n    userCoordinates: finalData?.userCoordinates\n  };\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useAuth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useConnectionHealth.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'useRef' is defined but never used.","line":1,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":50,"suggestions":[{"messageId":"removeVar","data":{"varName":"useRef"},"fix":{"range":[41,49],"text":""},"desc":"Remove unused variable 'useRef'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useRef' is defined but never used.","line":1,"column":44,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":50},{"ruleId":"no-unused-vars","severity":1,"message":"'supabase' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"supabase"},"fix":{"range":[66,124],"text":""},"desc":"Remove unused variable 'supabase'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'supabase' is defined but never used.","line":2,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":18},{"ruleId":"no-unused-vars","severity":1,"message":"'setConnectionQuality' is assigned a value but never used.","line":25,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":49,"suggestions":[{"messageId":"removeVar","data":{"varName":"setConnectionQuality"},"fix":{"range":[704,726],"text":""},"desc":"Remove unused variable 'setConnectionQuality'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setConnectionQuality' is assigned a value but never used.","line":25,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":25,"endColumn":49}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback, useEffect, useRef } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\n\ninterface ConnectionHealthState {\n  status: 'connected' | 'connecting' | 'disconnected' | 'reconnecting' | 'error';\n  lastCheck: Date | null;\n  reconnectAttempts: number;\n  isHealthy: boolean;\n}\n\ninterface ConnectionQuality {\n  quality: 'excellent' | 'good' | 'fair' | 'poor';\n  latency?: number;\n  packetLoss?: number;\n}\n\nexport function useConnectionHealth() {\n  const [connectionState, setConnectionState] = useState<ConnectionHealthState>({\n    status: 'connected',\n    lastCheck: new Date(),\n    reconnectAttempts: 0,\n    isHealthy: true\n  });\n  \n  const [connectionQuality, setConnectionQuality] = useState<ConnectionQuality>({\n    quality: 'excellent'\n  });\n\n  // Simple connection health check without complex state updates\n  const checkConnectionHealth = useCallback(async () => {\n    try {\n      // Basic health check - if we're here, connection is working\n      setConnectionState(prev => ({\n        ...prev,\n        lastCheck: new Date(),\n        isHealthy: true\n      }));\n    } catch (error) {\n      console.warn('Connection health check warning:', error);\n      // Don't change status on warnings to prevent loops\n    }\n  }, []);\n\n  // Manual reconnection function\n  const forceReconnect = useCallback(async () => {\n    setConnectionState(prev => ({\n      ...prev,\n      status: 'connecting',\n      reconnectAttempts: prev.reconnectAttempts + 1\n    }));\n\n    try {\n      // Simple reconnection logic\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      setConnectionState(prev => ({\n        ...prev,\n        status: 'connected',\n        isHealthy: true\n      }));\n    } catch (error) {\n      console.error('Reconnection failed:', error);\n      setConnectionState(prev => ({\n        ...prev,\n        status: 'error',\n        isHealthy: false\n      }));\n    }\n  }, []);\n\n  // Send heartbeat to check connection\n  const sendHeartbeat = useCallback(async () => {\n    try {\n      await checkConnectionHealth();\n    } catch (error) {\n      console.warn('Heartbeat failed:', error);\n    }\n  }, [checkConnectionHealth]);\n\n  // Periodic health check\n  useEffect(() => {\n    const interval = setInterval(checkConnectionHealth, 30000); // 30 seconds\n    return () => clearInterval(interval);\n  }, [checkConnectionHealth]);\n\n  return {\n    connectionState,\n    connectionQuality,\n    forceReconnect,\n    sendHeartbeat,\n    checkConnectionHealth\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useDataCollectionDebug.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'globalError' is assigned a value but never used.","line":68,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":68,"endColumn":51,"suggestions":[{"messageId":"removeVar","data":{"varName":"globalError"},"fix":{"range":[2150,2170],"text":""},"desc":"Remove unused variable 'globalError'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'globalError' is assigned a value but never used.","line":68,"column":40,"nodeType":null,"messageId":"unusedVar","endLine":68,"endColumn":51},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'checkDataCollectionStatus'. Either include it or remove the dependency array.","line":110,"column":6,"nodeType":"ArrayExpression","endLine":110,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: [checkDataCollectionStatus, user]","fix":{"range":[3536,3542],"text":"[checkDataCollectionStatus, user]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\n\r\ninterface DataCollectionStatus {\r\n  hasRecentReadings: boolean;\r\n  totalReadings: number;\r\n  lastReadingDate: string | null;\r\n  pointsCalculated: boolean;\r\n  totalPoints: number;\r\n  dataSourceStatus: string;\r\n}\r\n\r\nexport const useDataCollectionDebug = () => {\r\n  const { user } = useAuth();\r\n  const [status, setStatus] = useState<DataCollectionStatus>({\r\n    hasRecentReadings: false,\r\n    totalReadings: 0,\r\n    lastReadingDate: null,\r\n    pointsCalculated: false,\r\n    totalPoints: 0,\r\n    dataSourceStatus: 'Unknown'\r\n  });\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const checkDataCollectionStatus = async () => {\r\n    if (!user) return;\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      // Check recent readings (last 7 days)\r\n      const { data: recentReadings, error: readingsError } = await supabase\r\n        .from('air_quality_readings')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .gte('timestamp', new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString())\r\n        .order('timestamp', { ascending: false });\r\n\r\n      if (readingsError) {\r\n        console.error('Error fetching recent readings:', readingsError);\r\n        return;\r\n      }\r\n\r\n      // Check total readings count\r\n      const { count: totalCount, error: countError } = await supabase\r\n        .from('air_quality_readings')\r\n        .select('*', { count: 'exact', head: true })\r\n        .eq('user_id', user.id);\r\n\r\n      if (countError) {\r\n        console.error('Error fetching total readings count:', countError);\r\n        return;\r\n      }\r\n\r\n      // Check user points\r\n      const { data: profileData, error: profileError } = await supabase\r\n        .from('profiles')\r\n        .select('total_points')\r\n        .eq('user_id', user.id)\r\n        .single();\r\n\r\n      if (profileError) {\r\n        console.error('Error fetching user points:', profileError);\r\n        return;\r\n      }\r\n\r\n      // Check global environmental data (server-side collection)\r\n      const { data: globalData, error: globalError } = await supabase\r\n        .from('global_environmental_data')\r\n        .select('*')\r\n        .eq('is_active', true)\r\n        .order('created_at', { ascending: false })\r\n        .limit(5);\r\n\r\n      const hasRecentReadings = recentReadings && recentReadings.length > 0;\r\n      const lastReadingDate = recentReadings && recentReadings.length > 0 \r\n        ? recentReadings[0].timestamp \r\n        : null;\r\n\r\n      setStatus({\r\n        hasRecentReadings,\r\n        totalReadings: totalCount || 0,\r\n        lastReadingDate,\r\n        pointsCalculated: (profileData?.total_points || 0) > 0,\r\n        totalPoints: profileData?.total_points || 0,\r\n        dataSourceStatus: globalData && globalData.length > 0 ? 'Server-side collection active' : 'No server-side data'\r\n      });\r\n\r\n      // Log debug information\r\n      console.log('🔍 Data Collection Debug Status:', {\r\n        hasRecentReadings,\r\n        totalReadings: totalCount || 0,\r\n        lastReadingDate,\r\n        totalPoints: profileData?.total_points || 0,\r\n        globalDataCount: globalData?.length || 0,\r\n        recentReadingsCount: recentReadings?.length || 0\r\n      });\r\n\r\n    } catch (error) {\r\n      console.error('Error in data collection debug:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      checkDataCollectionStatus();\r\n    }\r\n  }, [user]);\r\n\r\n  return {\r\n    status,\r\n    isLoading,\r\n    refreshStatus: checkDataCollectionStatus\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useEmergencyConnectionHealth.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'supabase' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"supabase"},"fix":{"range":[58,116],"text":""},"desc":"Remove unused variable 'supabase'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'supabase' is defined but never used.","line":2,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":18},{"ruleId":"no-undef","severity":1,"message":"'EmergencyConnectionError' is not defined.","line":30,"column":40,"nodeType":"Identifier","messageId":"undef","endLine":30,"endColumn":64}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback, useEffect } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\n\ninterface EmergencyConnectionState {\n  status: 'connected' | 'connecting' | 'disconnected' | 'reconnecting' | 'error';\n  isHealthy: boolean;\n  lastCheck: string | null;\n  reconnectAttempts: number;\n  networkQuality: 'excellent' | 'good' | 'fair' | 'poor';\n  isOnline: boolean;\n  lastNetworkChange: string | null;\n  errors: Array<{\n    message: string;\n    timestamp: string;\n    type: string;\n  }>;\n  latency: number | null;\n  lastHeartbeat: number;\n}\n\nexport function useEmergencyConnectionHealth() {\n  const [connectionState, setConnectionState] = useState<EmergencyConnectionState>({\n    status: 'connected',\n    lastCheck: new Date(),\n    reconnectAttempts: 0,\n    isHealthy: true,\n    emergencyMode: false\n  });\n\n  const [errors, setErrors] = useState<EmergencyConnectionError[]>([]);\n\n  // Emergency reconnection function\n  const reconnect = useCallback(async () => {\n    setConnectionState(prev => ({\n      ...prev,\n      status: 'connecting',\n      reconnectAttempts: prev.reconnectAttempts + 1,\n      emergencyMode: true\n    }));\n\n    try {\n      // Emergency reconnection logic with shorter timeout\n      await new Promise(resolve => setTimeout(resolve, 500));\n      setConnectionState(prev => ({\n        ...prev,\n        status: 'connected',\n        isHealthy: true,\n        emergencyMode: false\n      }));\n    } catch (error) {\n      console.error('Emergency reconnection failed:', error);\n      setConnectionState(prev => ({\n        ...prev,\n        status: 'error',\n        isHealthy: false,\n        emergencyMode: true\n      }));\n    }\n  }, []);\n\n  // Reset errors\n  const resetErrors = useCallback(() => {\n    setErrors([]);\n  }, []);\n\n  // Simple health check\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setConnectionState(prev => ({\n        ...prev,\n        lastCheck: new Date()\n      }));\n    }, 15000); // 15 seconds for emergency mode\n    return () => clearInterval(interval);\n  }, []);\n\n  return {\n    connectionState,\n    errors,\n    reconnect,\n    resetErrors\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useEnhancedConnectionHealth.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'supabase' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"supabase"},"fix":{"range":[58,116],"text":""},"desc":"Remove unused variable 'supabase'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'supabase' is defined but never used.","line":2,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":18},{"ruleId":"no-unused-vars","severity":1,"message":"'connectionStates' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"connectionStates"},"fix":{"range":[126,143],"text":""},"desc":"Remove unused variable 'connectionStates'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'connectionStates' is defined but never used.","line":3,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":26}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback, useEffect } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\nimport { connectionStates, type ConnectionState } from '@/lib/connectionStates';\n\ninterface EnhancedConnectionState {\n  status: ConnectionState;\n  lastCheck: Date;\n  reconnectAttempts: number;\n  isHealthy: boolean;\n  networkQuality: 'excellent' | 'good' | 'fair' | 'poor';\n  latency: number;\n}\n\ninterface ConnectionError {\n  message: string;\n  timestamp: Date;\n  type: string;\n}\n\nexport function useEnhancedConnectionHealth() {\n  const [connectionState, setConnectionState] = useState<EnhancedConnectionState>({\n    status: 'connected',\n    lastCheck: new Date(),\n    reconnectAttempts: 0,\n    isHealthy: true,\n    networkQuality: 'excellent',\n    latency: 0\n  });\n\n  const [errors, setErrors] = useState<ConnectionError[]>([]);\n\n  // Simple connection health check without complex state updates\n  const checkConnectionHealth = useCallback(async () => {\n    try {\n      // Basic health check - if we're here, connection is working\n      setConnectionState(prev => ({\n        ...prev,\n        lastCheck: new Date(),\n        isHealthy: true\n      }));\n    } catch (error) {\n      console.warn('Enhanced connection health check warning:', error);\n      // Don't change status on warnings to prevent loops\n    }\n  }, []);\n\n  // Send heartbeat to check connection\n  const sendHeartbeat = useCallback(async () => {\n    try {\n      await checkConnectionHealth();\n    } catch (error) {\n      console.warn('Enhanced heartbeat failed:', error);\n    }\n  }, [checkConnectionHealth]);\n\n  // Manual reconnection function\n  const reconnect = useCallback(async () => {\n    setConnectionState(prev => ({\n      ...prev,\n      status: 'connecting',\n      reconnectAttempts: prev.reconnectAttempts + 1\n    }));\n\n    try {\n      // Simple reconnection logic\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      setConnectionState(prev => ({\n        ...prev,\n        status: 'connected',\n        isHealthy: true\n      }));\n    } catch (error) {\n      console.error('Enhanced reconnection failed:', error);\n      setConnectionState(prev => ({\n        ...prev,\n        status: 'error',\n        isHealthy: false\n      }));\n    }\n  }, []);\n\n  // Reset errors\n  const resetErrors = useCallback(() => {\n    setErrors([]);\n  }, []);\n\n  // Periodic health check\n  useEffect(() => {\n    const interval = setInterval(checkConnectionHealth, 30000); // 30 seconds\n    return () => clearInterval(interval);\n  }, [checkConnectionHealth]);\n\n  return {\n    connectionState,\n    errors,\n    checkConnectionHealth,\n    sendHeartbeat,\n    reconnect,\n    resetErrors\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useGeolocation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useGlobalEnvironmentalData.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'functionError' is defined but never used.","line":69,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":69,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'functionError' is defined but never used.","line":69,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":69,"endColumn":29},{"ruleId":"no-unused-vars","severity":1,"message":"'functionError' is defined but never used.","line":132,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":132,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'functionError' is defined but never used.","line":132,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":132,"endColumn":29},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'calculateHaversineDistance' was used before it was defined.","line":150,"column":35,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":150,"endColumn":61},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'calculateHaversineDistance' was used before it was defined.","line":154,"column":45,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":154,"endColumn":71},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'calculateHaversineDistance' was used before it was defined.","line":163,"column":28,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":163,"endColumn":54}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { supabase } from '@/integrations/supabase/client';\nimport { GlobalEnvironmentalData } from '@/types';\nimport { useAuth } from '@/contexts/AuthContext';\n\ninterface UseGlobalEnvironmentalDataOptions {\n  latitude?: number;\n  longitude?: number;\n  maxDistanceKm?: number;\n  cityName?: string;\n  autoRefresh?: boolean;\n  refreshInterval?: number;\n}\n\ninterface UseGlobalEnvironmentalDataReturn {\n  data: GlobalEnvironmentalData | null;\n  allCitiesData: GlobalEnvironmentalData[];\n  isLoading: boolean;\n  error: Error | null;\n  refetch: () => Promise<void>;\n  lastUpdated: string | null;\n  dataAge: number; // in minutes\n}\n\n/**\n * Hook for fetching environmental data from server-side collected data\n * This replaces direct API calls with database queries for better performance\n */\nexport const useGlobalEnvironmentalData = (\n  options: UseGlobalEnvironmentalDataOptions = {}\n): UseGlobalEnvironmentalDataReturn => {\n  const {\n    latitude,\n    longitude,\n    maxDistanceKm = 50,\n    cityName,\n    autoRefresh = true,\n    refreshInterval = 900000 // 15 minutes\n  } = options;\n\n  const { user } = useAuth();\n  const [lastUpdated, setLastUpdated] = useState<string | null>(null);\n\n  // Function to get all active environmental data for all cities\n  const getAllCitiesEnvironmentalData = useCallback(async (): Promise<GlobalEnvironmentalData[]> => {\n    try {\n      console.log('🌍 [GlobalData] Fetching environmental data for all cities');\n      \n      // Try to use the database function first\n      try {\n        const { data, error } = await supabase\n          .rpc('get_all_active_environmental_data');\n\n        if (error) {\n          console.warn('⚠️ [GlobalData] Database function failed, trying direct table query:', error);\n          throw error; // This will trigger the fallback\n        }\n\n        if (data && data.length > 0) {\n          console.log(`✅ [GlobalData] Found data for ${data.length} cities via function`);\n          // Use the most recent timestamp as last updated\n          const mostRecent = data.reduce((latest, current) => \n            new Date(current.collection_timestamp) > new Date(latest.collection_timestamp) ? current : latest\n          );\n          setLastUpdated(mostRecent.collection_timestamp);\n          return data as GlobalEnvironmentalData[];\n        }\n      } catch (functionError) {\n        console.log('🔄 [GlobalData] Falling back to direct table query...');\n      }\n\n      // Fallback: Direct table query if function doesn't exist\n      const { data, error } = await supabase\n        .from('global_environmental_data')\n        .select('*')\n        .eq('is_active', true)\n        .order('collection_timestamp', { ascending: false });\n\n      if (error) {\n        console.error('❌ [GlobalData] Error fetching all cities data:', error);\n        throw error;\n      }\n\n      if (data && data.length > 0) {\n        console.log(`✅ [GlobalData] Found data for ${data.length} cities via direct query`);\n        // Use the most recent timestamp as last updated\n        const mostRecent = data.reduce((latest, current) => \n          new Date(current.collection_timestamp) > new Date(latest.collection_timestamp) ? current : latest\n        );\n        setLastUpdated(mostRecent.collection_timestamp);\n        return data as GlobalEnvironmentalData[];\n      }\n\n      console.log('⚠️ [GlobalData] No environmental data found for any cities');\n      return [];\n    } catch (error) {\n      console.error('❌ [GlobalData] Failed to fetch all cities data:', error);\n      throw error;\n    }\n  }, []);\n\n  // Function to get nearest environmental data for given coordinates\n  const getNearestEnvironmentalData = useCallback(async (): Promise<GlobalEnvironmentalData | null> => {\n    if (!latitude || !longitude) {\n      console.log('useGlobalEnvironmentalData: No coordinates provided, cannot fetch nearest data');\n      return null;\n    }\n\n    try {\n      console.log(`🌍 [GlobalData] Fetching nearest environmental data for coordinates: ${latitude}, ${longitude}`);\n      \n      // Try to use the database function first\n      try {\n        const { data, error } = await supabase\n          .rpc('get_nearest_environmental_data', {\n            p_latitude: latitude,\n            p_longitude: longitude,\n            p_max_distance_km: maxDistanceKm\n          });\n\n        if (error) {\n          console.warn('⚠️ [GlobalData] Database function failed, trying direct table query:', error);\n          throw error; // This will trigger the fallback\n        }\n\n        if (data && data.length > 0) {\n          console.log(`✅ [GlobalData] Found nearest data via function: ${data[0].city_name}`);\n          setLastUpdated(data[0].collection_timestamp);\n          return data[0] as GlobalEnvironmentalData;\n        }\n      } catch (functionError) {\n        console.log('🔄 [GlobalData] Falling back to direct table query...');\n      }\n\n      // Fallback: Direct table query with manual distance calculation\n      const { data, error } = await supabase\n        .from('global_environmental_data')\n        .select('*')\n        .eq('is_active', true);\n\n      if (error) {\n        console.error('❌ [GlobalData] Error fetching nearest environmental data:', error);\n        throw error;\n      }\n\n      if (data && data.length > 0) {\n        // Manual distance calculation using Haversine formula\n        const nearestData = data.reduce((nearest, current) => {\n          const currentDistance = calculateHaversineDistance(\n            latitude, longitude,\n            current.latitude, current.longitude\n          );\n          const nearestDistance = nearest ? calculateHaversineDistance(\n            latitude, longitude,\n            nearest.latitude, nearest.longitude\n          ) : Infinity;\n          \n          return currentDistance < nearestDistance ? current : nearest;\n        });\n\n        if (nearestData) {\n          const distance = calculateHaversineDistance(\n            latitude, longitude,\n            nearestData.latitude, nearestData.longitude\n          );\n          \n          if (distance <= maxDistanceKm) {\n            console.log(`✅ [GlobalData] Found nearest data via direct query: ${nearestData.city_name} (${distance.toFixed(1)}km)`);\n            setLastUpdated(nearestData.collection_timestamp);\n            // Convert to GlobalEnvironmentalData type by adding missing properties\n            return {\n              ...nearestData,\n              created_at: nearestData.created_at || new Date().toISOString()\n            } as GlobalEnvironmentalData;\n          } else {\n            console.log(`⚠️ [GlobalData] Nearest data too far: ${nearestData.city_name} (${distance.toFixed(1)}km > ${maxDistanceKm}km)`);\n          }\n        }\n      }\n\n      console.log('⚠️ [GlobalData] No environmental data found within range');\n      return null;\n    } catch (error) {\n      console.error('❌ [GlobalData] Failed to fetch nearest environmental data:', error);\n      throw error;\n    }\n  }, [latitude, longitude, maxDistanceKm]);\n\n  // Helper function to calculate distance between two coordinates (Haversine formula)\n  const calculateHaversineDistance = (lat1: number, lon1: number, lat2: number, lon2: number): number => {\n    const R = 6371; // Earth's radius in kilometers\n    const dLat = (lat2 - lat1) * Math.PI / 180;\n    const dLon = (lon2 - lon1) * Math.PI / 180;\n    const a = \n      Math.sin(dLat/2) * Math.sin(dLat/2) +\n      Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * \n      Math.sin(dLon/2) * Math.sin(dLon/2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n    return R * c;\n  };\n\n  // Function to get environmental data for a specific city\n  const getCityEnvironmentalData = useCallback(async (): Promise<GlobalEnvironmentalData | null> => {\n    if (!cityName) {\n      console.log('useGlobalEnvironmentalData: No city name provided, cannot fetch city data');\n      return null;\n    }\n\n    try {\n      console.log(`🌍 [GlobalData] Fetching environmental data for city: ${cityName}`);\n      \n      const { data, error } = await supabase\n        .from('global_environmental_data')\n        .select('*')\n        .eq('city_name', cityName)\n        .eq('is_active', true)\n        .single();\n\n      if (error) {\n        console.error(`❌ [GlobalData] Error fetching data for ${cityName}:`, error);\n        throw error;\n      }\n\n      if (data) {\n        console.log(`✅ [GlobalData] Found data for ${cityName}`);\n        setLastUpdated(data.collection_timestamp);\n        return data as GlobalEnvironmentalData;\n      }\n\n      console.log(`⚠️ [GlobalData] No data found for city: ${cityName}`);\n      return null;\n    } catch (error) {\n      console.error(`❌ [GlobalData] Failed to fetch data for ${cityName}:`, error);\n      throw error;\n    }\n  }, [cityName]);\n\n  // Determine which query function to use based on options\n  const queryFunction = useMemo(() => {\n    if (cityName) {\n      return getCityEnvironmentalData;\n    } else if (latitude && longitude) {\n      return getNearestEnvironmentalData;\n    } else {\n      return getAllCitiesEnvironmentalData;\n    }\n  }, [cityName, latitude, longitude, getCityEnvironmentalData, getNearestEnvironmentalData, getAllCitiesEnvironmentalData]);\n\n  // React Query for data fetching\n  const query = useQuery({\n    queryKey: ['global-environmental-data', latitude, longitude, cityName, maxDistanceKm],\n    queryFn: queryFunction,\n    enabled: !!user, // Only run when user is authenticated\n    refetchInterval: autoRefresh ? refreshInterval : false,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    gcTime: 15 * 60 * 1000, // 15 minutes\n    retry: 3,\n    retryDelay: 2000,\n  });\n\n  // Calculate data age in minutes\n  const dataAge = useMemo(() => {\n    if (!lastUpdated) return 0;\n    const ageMs = Date.now() - new Date(lastUpdated).getTime();\n    return Math.floor(ageMs / (1000 * 60));\n  }, [lastUpdated]);\n\n  // Manual refetch function\n  const refetch = useCallback(async () => {\n    console.log('🔄 [GlobalData] Manual refetch requested');\n    try {\n      await query.refetch();\n    } catch (error) {\n      console.error('❌ [GlobalData] Manual refetch failed:', error);\n    }\n  }, [query]);\n\n  // Log data age for debugging\n  useEffect(() => {\n    if (dataAge > 0) {\n      console.log(`⏰ [GlobalData] Data age: ${dataAge} minutes`);\n    }\n  }, [dataAge]);\n\n  // Log when data is being refetched\n  useEffect(() => {\n    if (query.isRefetching) {\n      console.log('🔄 [GlobalData] Refreshing environmental data...');\n    }\n  }, [query.isRefetching]);\n\n  return {\n    data: query.data as GlobalEnvironmentalData | null,\n    allCitiesData: Array.isArray(query.data) ? query.data as GlobalEnvironmentalData[] : [],\n    isLoading: query.isLoading,\n    error: query.error,\n    refetch,\n    lastUpdated,\n    dataAge\n  };\n};\n\nexport default useGlobalEnvironmentalData;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useGlobalSearch.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useGracefulRealtime.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":12,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[322,334],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'userId' is defined but never used.","line":30,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":9,"suggestions":[{"messageId":"removeVar","data":{"varName":"userId"},"fix":{"range":[777,787],"text":""},"desc":"Remove unused variable 'userId'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'userId' is defined but never used.","line":30,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":9},{"ruleId":"no-unused-vars","severity":1,"message":"'timeout' is assigned a value but never used.","line":36,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"timeout"},"fix":{"range":[878,894],"text":""},"desc":"Remove unused variable 'timeout'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'timeout' is assigned a value but never used.","line":36,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":36,"endColumn":12}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useRef, useCallback } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\n\ninterface UseGracefulRealtimeOptions {\n  channelName: string;\n  userId?: string;\n  config?: {\n    timeout?: number;\n    maxRetries?: number;\n    fallbackPollingInterval?: number;\n  };\n  onData?: (payload: any) => void;\n  enabled?: boolean;\n}\n\ninterface GracefulRealtimeState {\n  isRealtimeAvailable: boolean;\n  fallbackPolling: boolean;\n  connectionStatus: 'connecting' | 'connected' | 'fallback' | 'failed';\n  lastUpdate: Date | null;\n  retryCount: number;\n}\n\n/**\n * Hook that provides graceful degradation when realtime fails\n * Falls back to polling when WebSocket connections are unavailable\n */\nexport function useGracefulRealtime({\n  channelName,\n  userId,\n  config = {},\n  onData,\n  enabled = true\n}: UseGracefulRealtimeOptions) {\n  const {\n    timeout = 10000,\n    maxRetries = 3,\n    fallbackPollingInterval = 30000\n  } = config;\n\n  const [state, setState] = useState<GracefulRealtimeState>({\n    isRealtimeAvailable: false,\n    fallbackPolling: false,\n    connectionStatus: 'connecting',\n    lastUpdate: null,\n    retryCount: 0\n  });\n\n  const realtimeChannelRef = useRef<any>(null);\n  const fallbackIntervalRef = useRef<NodeJS.Timeout | null>(null);\n  const retryTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const isDestroyedRef = useRef(false);\n\n  // Check if realtime is available\n  const checkRealtimeAvailability = useCallback(async (): Promise<boolean> => {\n    try {\n      const isConnected = supabase.realtime.isConnected();\n      const isConnecting = supabase.realtime.isConnecting();\n      \n      return isConnected || isConnecting;\n    } catch (error) {\n      console.warn('Realtime availability check failed:', error);\n      return false;\n    }\n  }, []);\n\n  // Start fallback polling\n  const startFallbackPolling = useCallback(() => {\n    if (isDestroyedRef.current || !onData) return;\n\n    console.log(`🔄 [GracefulRealtime] Starting fallback polling for ${channelName}`);\n    \n    setState(prevState => ({\n      ...prevState,\n      fallbackPolling: true,\n      connectionStatus: 'fallback'\n    }));\n\n    // Set up polling interval\n    fallbackIntervalRef.current = setInterval(async () => {\n      if (isDestroyedRef.current) return;\n\n      try {\n        // Simulate data fetch (replace with actual API call)\n        const mockData = {\n          channel: channelName,\n          timestamp: new Date().toISOString(),\n          type: 'fallback_poll'\n        };\n\n        onData(mockData);\n        setState(prevState => ({\n          ...prevState,\n          lastUpdate: new Date()\n        }));\n\n      } catch (error) {\n        console.error('Fallback polling failed:', error);\n      }\n    }, fallbackPollingInterval);\n  }, [channelName, fallbackPollingInterval, onData]);\n\n  // Stop fallback polling\n  const stopFallbackPolling = useCallback(() => {\n    if (fallbackIntervalRef.current) {\n      clearInterval(fallbackIntervalRef.current);\n      fallbackIntervalRef.current = null;\n    }\n\n    setState(prevState => ({\n      ...prevState,\n      fallbackPolling: false\n    }));\n  }, []);\n\n  // Attempt realtime connection\n  const attemptRealtimeConnection = useCallback(async () => {\n    if (isDestroyedRef.current || !enabled) return;\n\n    try {\n      setState(prevState => ({\n        ...prevState,\n        connectionStatus: 'connecting'\n      }));\n\n      const isAvailable = await checkRealtimeAvailability();\n      \n      if (isAvailable) {\n        // Create realtime channel\n        const channel = supabase.channel(channelName);\n        \n        if (onData) {\n          channel.on('*', (event: any, payload: any) => {\n            if (!isDestroyedRef.current && onData) {\n              onData(payload);\n              setState(prevState => ({\n                ...prevState,\n                lastUpdate: new Date()\n              }));\n            }\n          });\n        }\n\n        const subscription = channel.subscribe((status, error) => {\n          if (status === 'SUBSCRIBED') {\n            console.log(`✅ [GracefulRealtime] Successfully connected to ${channelName}`);\n            setState(prevState => ({\n              ...prevState,\n              isRealtimeAvailable: true,\n              connectionStatus: 'connected',\n              retryCount: 0\n            }));\n            stopFallbackPolling();\n          } else if (status === 'CHANNEL_ERROR' || status === 'TIMED_OUT') {\n            console.warn(`❌ [GracefulRealtime] Channel error for ${channelName}:`, error);\n            setState(prevState => ({\n              ...prevState,\n              isRealtimeAvailable: false,\n              connectionStatus: 'failed'\n            }));\n            startFallbackPolling();\n          }\n        });\n\n        realtimeChannelRef.current = subscription;\n\n      } else {\n        throw new Error('Realtime not available');\n      }\n\n    } catch (error) {\n      console.warn(`⚠️ [GracefulRealtime] Realtime connection failed for ${channelName}:`, error);\n      \n      setState(prevState => ({\n        ...prevState,\n        isRealtimeAvailable: false,\n        connectionStatus: 'failed'\n      }));\n\n      // Start fallback polling\n      startFallbackPolling();\n    }\n  }, [channelName, enabled, onData, checkRealtimeAvailability, startFallbackPolling, stopFallbackPolling]);\n\n  // Retry connection with exponential backoff\n  const retryConnection = useCallback(async () => {\n    if (isDestroyedRef.current || state.retryCount >= maxRetries) return;\n\n    const delay = Math.min(1000 * Math.pow(2, state.retryCount), 10000);\n    \n    retryTimeoutRef.current = setTimeout(async () => {\n      if (!isDestroyedRef.current) {\n        setState(prevState => ({\n          ...prevState,\n          retryCount: prevState.retryCount + 1\n        }));\n        \n        await attemptRealtimeConnection();\n      }\n    }, delay);\n  }, [state.retryCount, maxRetries, attemptRealtimeConnection]);\n\n  // Cleanup function\n  const cleanup = useCallback(() => {\n    if (isDestroyedRef.current) return;\n\n    console.log(`🧹 [GracefulRealtime] Cleaning up ${channelName}`);\n    \n    // Cleanup realtime channel\n    if (realtimeChannelRef.current) {\n      try {\n        realtimeChannelRef.current.unsubscribe();\n      } catch (error) {\n        console.warn('Error unsubscribing from realtime channel:', error);\n      }\n      realtimeChannelRef.current = null;\n    }\n\n    // Stop fallback polling\n    stopFallbackPolling();\n\n    // Clear retry timeout\n    if (retryTimeoutRef.current) {\n      clearTimeout(retryTimeoutRef.current);\n      retryTimeoutRef.current = null;\n    }\n  }, [channelName, stopFallbackPolling]);\n\n  // Initialize connection\n  useEffect(() => {\n    if (!enabled) return;\n\n    attemptRealtimeConnection();\n\n    return () => {\n      cleanup();\n    };\n  }, [enabled, attemptRealtimeConnection, cleanup]);\n\n  // Auto-retry on failure\n  useEffect(() => {\n    if (state.connectionStatus === 'failed' && state.retryCount < maxRetries) {\n      retryConnection();\n    }\n  }, [state.connectionStatus, state.retryCount, maxRetries, retryConnection]);\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      isDestroyedRef.current = true;\n      cleanup();\n    };\n  }, [cleanup]);\n\n  return {\n    isRealtimeAvailable: state.isRealtimeAvailable,\n    fallbackPolling: state.fallbackPolling,\n    connectionStatus: state.connectionStatus,\n    lastUpdate: state.lastUpdate,\n    retryCount: state.retryCount,\n    cleanup,\n    retry: retryConnection\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useMemoryMonitor.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'checkForLeaks'. Either include it or remove the dependency array.","line":88,"column":6,"nodeType":"ArrayExpression","endLine":88,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [checkForLeaks, interval]","fix":{"range":[2796,2806],"text":"[checkForLeaks, interval]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'mountTime.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'mountTime.current' to a variable inside the effect, and use that variable in the cleanup function.","line":111,"column":99,"nodeType":"Identifier","endLine":111,"endColumn":106},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'renderCount.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'renderCount.current' to a variable inside the effect, and use that variable in the cleanup function.","line":111,"column":141,"nodeType":"Identifier","endLine":111,"endColumn":148}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useRef } from 'react';\n\ninterface MemoryInfo {\n  jsHeapSizeLimit?: number;\n  totalJSHeapSize?: number;\n  usedJSHeapSize?: number;\n}\n\nexport function useMemoryMonitor(interval = 10000) {\n  const intervalRef = useRef<number>();\n  const lastUsedRef = useRef<number>(0);\n  const lastTotalRef = useRef<number>(0);\n  const leakDetectedRef = useRef<boolean>(false);\n  const checkCountRef = useRef<number>(0);\n  \n  const getMemoryInfo = (): MemoryInfo => {\n    if ('memory' in performance) {\n      return (performance as any).memory;\n    }\n    return {};\n  };\n  \n  const formatBytes = (bytes: number): string => {\n    if (bytes === 0) return '0 B';\n    const k = 1024;\n    const sizes = ['B', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n  };\n  \n  const checkForLeaks = () => {\n    const memory = getMemoryInfo();\n    \n    if (!memory.usedJSHeapSize || !memory.totalJSHeapSize) {\n      console.log('[Memory Monitor] Memory API not available');\n      return;\n    }\n    \n    const used = memory.usedJSHeapSize;\n    const total = memory.totalJSHeapSize;\n    \n    // Check for significant growth in memory usage\n    if (lastUsedRef.current > 0) {\n      const growth = used - lastUsedRef.current;\n      const growthPercentage = (growth / lastUsedRef.current) * 100;\n      \n      // If memory grows by more than 20% between checks, it might be a leak\n      if (growthPercentage > 20 && checkCountRef.current > 3) {\n        leakDetectedRef.current = true;\n        console.warn(`[Memory Monitor] Potential memory leak detected: ${formatBytes(growth)} (${growthPercentage.toFixed(2)}%) increase in memory usage`);\n        \n        // Log component tree or other diagnostics if needed\n        if ((window as any).React) {\n          console.log('[Memory Monitor] Current React component tree:', \n            (window as any).React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED\n              ?.ReactCurrentOwner?.current?.elementType);\n        }\n      }\n    }\n    \n    lastUsedRef.current = used;\n    lastTotalRef.current = total;\n    checkCountRef.current++;\n    \n    // Log memory usage every 5 checks\n    if (checkCountRef.current % 5 === 0) {\n      console.log(`[Memory Monitor] Used: ${formatBytes(used)} | Total: ${formatBytes(total)}`);\n    }\n  };\n  \n  useEffect(() => {\n    // Only run in development\n    if (process.env['NODE_ENV'] !== 'development') {\n      return;\n    }\n    \n    // Check for memory leaks at regular intervals\n    intervalRef.current = window.setInterval(checkForLeaks, interval);\n    \n    // Initial check\n    checkForLeaks();\n    \n    return () => {\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n      }\n    };\n  }, [interval]);\n  \n  return {\n    checkForLeaks,\n    getMemoryInfo,\n    formatBytes,\n    isLeakDetected: leakDetectedRef.current,\n  };\n}\n\nexport function withMemoryMonitor<P>(WrappedComponent: React.ComponentType<P>, componentName: string) {\n  return function WithMemoryMonitor(props: P) {\n    const mountTime = useRef(performance.now());\n    const renderCount = useRef(0);\n    \n    renderCount.current++;\n    \n    useEffect(() => {\n      const mountDuration = performance.now() - mountTime.current;\n      console.log(`[Memory Monitor] ${componentName} mounted in ${mountDuration.toFixed(2)}ms`);\n      \n      return () => {\n        const unmountTime = performance.now();\n        console.log(`[Memory Monitor] ${componentName} unmounted after ${(unmountTime - mountTime.current).toFixed(2)}ms with ${renderCount.current} renders`);\n        \n        // Force garbage collection if available\n        if ((window as any).gc) {\n          (window as any).gc();\n        }\n      };\n    }, []);\n    \n    return React.createElement(WrappedComponent as React.ComponentType<any>, props as any);\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useNotifications.ts","messages":[{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'initializePreferences' was used before it was defined.","line":148,"column":15,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":148,"endColumn":36},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'initializePreferences'. Either include it or remove the dependency array.","line":155,"column":6,"nodeType":"ArrayExpression","endLine":155,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: [initializePreferences, user]","fix":{"range":[4976,4982],"text":"[initializePreferences, user]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { useStableChannelSubscription } from './useStableChannelSubscription';\n\ninterface Notification {\n  id: string;\n  user_id: string;\n  title: string;\n  message: string;\n  type: 'info' | 'success' | 'warning' | 'error';\n  read: boolean;\n  created_at: string;\n  action_url?: string;\n  action_text?: string;\n}\n\ninterface NotificationSettings {\n  email_notifications: boolean;\n  push_notifications: boolean;\n  air_quality_alerts: boolean;\n  weather_alerts: boolean;\n  achievement_notifications: boolean;\n}\n\n// New interface for notification preferences that matches the database schema\ninterface NotificationPreferences {\n  aqi_alerts: boolean;\n  aqi_threshold: number;\n  achievement_notifications: boolean;\n  points_notifications: boolean;\n  withdrawal_notifications: boolean;\n  shop_notifications: boolean;\n  streak_notifications: boolean;\n  daily_reminders: boolean;\n  weekly_summaries: boolean;\n  system_announcements: boolean;\n  maintenance_alerts: boolean;\n  email_notifications: boolean;\n  push_notifications: boolean;\n}\n\nexport const useNotifications = () => {\n  const { user } = useAuth();\n  const [notifications, setNotifications] = useState<Notification[]>([]);\n  const [settings, setSettings] = useState<NotificationSettings>({\n    email_notifications: true,\n    push_notifications: true,\n    air_quality_alerts: true,\n    weather_alerts: true,\n    achievement_notifications: true\n  });\n  const [preferences, setPreferences] = useState<NotificationPreferences | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [isLoading, setIsLoading] = useState(true);\n  const [unreadCount, setUnreadCount] = useState(0);\n\n  // Use stable channel subscription for notifications\n  const { isConnected: notificationsConnected } = useStableChannelSubscription({\n    channelName: `user-notifications-${user?.id || 'anonymous'}`,\n    userId: user?.id,\n    config: {\n      event: 'INSERT',\n      schema: 'public',\n      table: 'notifications', // Correct table name\n      filter: `user_id=eq.${user?.id || 'anonymous'}` // Correct column name\n    },\n    onData: (payload) => {\n      console.log('New notification received:', payload);\n      \n      if (payload.eventType === 'INSERT') {\n        const newNotification = payload.new as Notification;\n        setNotifications(prev => [newNotification, ...prev]);\n        if (!newNotification.read) {\n          setUnreadCount(prev => prev + 1);\n        }\n      } else if (payload.eventType === 'UPDATE') {\n        const updatedNotification = payload.new as Notification;\n        setNotifications(prev => \n          prev.map(n => \n            n.id === updatedNotification.id ? updatedNotification : n\n          )\n        );\n        setUnreadCount(prev => {\n          const oldNotification = notifications.find(n => n.id === updatedNotification.id);\n          if (oldNotification && !oldNotification.read && updatedNotification.read) {\n            return prev - 1;\n          } else if (oldNotification && oldNotification.read && !updatedNotification.read) {\n            return prev + 1;\n          }\n          return prev;\n        });\n      } else if (payload.eventType === 'DELETE') {\n        const deletedNotification = payload.old as Notification;\n        setNotifications(prev => prev.filter(n => n.id !== deletedNotification.id));\n        if (!deletedNotification.read) {\n          setUnreadCount(prev => Math.max(0, prev - 1));\n        }\n      }\n    },\n    enabled: !!user?.id\n  });\n\n  // Fetch notifications from database\n  const fetchNotifications = useCallback(async () => {\n    if (!user) return;\n\n    try {\n      setLoading(true);\n      const { data, error } = await supabase\n        .from('notifications')\n        .select('*')\n        .eq('user_id', user.id)\n        .order('created_at', { ascending: false })\n        .limit(50);\n\n      if (error) throw error;\n\n      setNotifications(data || []);\n      setUnreadCount(data?.filter(n => !n.read).length || 0);\n    } catch (error) {\n      console.error('Error fetching notifications:', error);\n    } finally {\n      setLoading(false);\n    }\n  }, [user]);\n\n  // Fetch notification preferences from the notification_preferences table\n  const fetchPreferences = useCallback(async () => {\n    if (!user) return;\n\n    try {\n      setIsLoading(true);\n      const { data, error } = await supabase\n        .from('notification_preferences')\n        .select('*')\n        .eq('user_id', user.id)\n        .single();\n\n      if (error && error.code !== 'PGRST116') {\n        throw error;\n      }\n\n      if (data) {\n        setPreferences(data);\n      } else {\n        // Create default preferences if none exist\n        await initializePreferences();\n      }\n    } catch (error) {\n      console.error('Error fetching notification preferences:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [user]);\n\n  // Initialize default notification preferences\n  const initializePreferences = useCallback(async () => {\n    if (!user) return;\n\n    try {\n      const defaultPreferences: NotificationPreferences = {\n        aqi_alerts: true,\n        aqi_threshold: 100,\n        achievement_notifications: true,\n        points_notifications: true,\n        withdrawal_notifications: true,\n        shop_notifications: true,\n        streak_notifications: true,\n        daily_reminders: true,\n        weekly_summaries: true,\n        system_announcements: true,\n        maintenance_alerts: true,\n        email_notifications: false,\n        push_notifications: true\n      };\n\n      const { data, error } = await supabase\n        .from('notification_preferences')\n        .insert({\n          user_id: user.id,\n          ...defaultPreferences\n        })\n        .select()\n        .single();\n\n      if (error) throw error;\n\n      setPreferences(data);\n      return data;\n    } catch (error) {\n      console.error('Error initializing notification preferences:', error);\n      throw error;\n    }\n  }, [user]);\n\n  // Update notification preferences\n  const updatePreferences = useCallback(async (newPreferences: NotificationPreferences) => {\n    if (!user) return;\n\n    try {\n      const { data, error } = await supabase\n        .from('notification_preferences')\n        .update(newPreferences)\n        .eq('user_id', user.id)\n        .select()\n        .single();\n\n      if (error) throw error;\n\n      setPreferences(data);\n      return data;\n    } catch (error) {\n      console.error('Error updating notification preferences:', error);\n      throw error;\n    }\n  }, [user]);\n\n  // Fetch notification settings\n  const fetchSettings = useCallback(async () => {\n    if (!user) return;\n\n    try {\n      const { data, error } = await supabase\n        .from('user_settings')\n        .select('settings')\n        .eq('user_id', user.id)\n        .single();\n\n      if (error && error.code !== 'PGRST116') {\n        throw error;\n      }\n\n      if (data?.settings?.notifications) {\n        // Map from the JSONB structure to our interface\n        const notificationSettings = data.settings.notifications;\n        setSettings({\n          email_notifications: notificationSettings.email || true,\n          push_notifications: notificationSettings.push || true,\n          air_quality_alerts: notificationSettings.airQualityAlerts || true,\n          weather_alerts: notificationSettings.weatherAlerts || false,\n          achievement_notifications: notificationSettings.achievementNotifications || true\n        });\n      }\n    } catch (error) {\n      console.error('Error fetching notification settings:', error);\n    }\n  }, [user]);\n\n  // Mark notification as read\n  const markAsRead = useCallback(async (notificationId: string) => {\n    if (!user) return;\n\n    try {\n      const { error } = await supabase\n        .from('notifications')\n        .update({ read: true })\n        .eq('id', notificationId)\n        .eq('user_id', user.id);\n\n      if (error) throw error;\n\n      setNotifications(prev => \n        prev.map(n => \n          n.id === notificationId ? { ...n, read: true } : n\n        )\n      );\n      setUnreadCount(prev => Math.max(0, prev - 1));\n    } catch (error) {\n      console.error('Error marking notification as read:', error);\n    }\n  }, [user]);\n\n  // Mark all notifications as read\n  const markAllAsRead = useCallback(async () => {\n    if (!user) return;\n\n    try {\n      const { error } = await supabase\n        .from('notifications')\n        .update({ read: true })\n        .eq('user_id', user.id)\n        .eq('read', false);\n\n      if (error) throw error;\n\n      setNotifications(prev => \n        prev.map(n => ({ ...n, read: true }))\n      );\n      setUnreadCount(0);\n    } catch (error) {\n      console.error('Error marking all notifications as read:', error);\n    }\n  }, [user]);\n\n  // Delete notification\n  const deleteNotification = useCallback(async (notificationId: string) => {\n    if (!user) return;\n\n    try {\n      const { error } = await supabase\n        .from('notifications')\n        .delete()\n        .eq('id', notificationId)\n        .eq('user_id', user.id);\n\n      if (error) throw error;\n\n      setNotifications(prev => prev.filter(n => n.id !== notificationId));\n      setUnreadCount(prev => {\n        const deletedNotification = notifications.find(n => n.id === notificationId);\n        return deletedNotification && !deletedNotification.read ? prev - 1 : prev;\n      });\n    } catch (error) {\n      console.error('Error deleting notification:', error);\n    }\n  }, [user, notifications]);\n\n  // Update notification settings\n  const updateSettings = useCallback(async (newSettings: Partial<NotificationSettings>) => {\n    if (!user) return;\n\n    try {\n      const updatedSettings = { ...settings, ...newSettings };\n      \n      // First get the current settings to preserve other fields\n      const { data: currentData } = await supabase\n        .from('user_settings')\n        .select('settings')\n        .eq('user_id', user.id)\n        .single();\n\n      const currentSettings = currentData?.settings || {};\n      \n      // Update the notifications section while preserving other settings\n      const updatedFullSettings = {\n        ...currentSettings,\n        notifications: {\n          email: updatedSettings.email_notifications,\n          push: updatedSettings.push_notifications,\n          airQualityAlerts: updatedSettings.air_quality_alerts,\n          weatherAlerts: updatedSettings.weather_alerts,\n          achievementNotifications: updatedSettings.achievement_notifications\n        }\n      };\n\n      const { error } = await supabase\n        .from('user_settings')\n        .upsert({\n          user_id: user.id,\n          settings: updatedFullSettings\n        });\n\n      if (error) throw error;\n\n      setSettings(updatedSettings);\n    } catch (error) {\n      console.error('Error updating notification settings:', error);\n    }\n  }, [user, settings]);\n\n  // Create notification\n  const createNotification = useCallback(async (notification: Omit<Notification, 'id' | 'user_id' | 'created_at'>) => {\n    if (!user) return;\n\n    try {\n      const { data, error } = await supabase\n        .from('notifications')\n        .insert({\n          ...notification,\n          user_id: user.id\n        })\n        .select()\n        .single();\n\n      if (error) throw error;\n\n      setNotifications(prev => [data, ...prev]);\n      if (!data.read) {\n        setUnreadCount(prev => prev + 1);\n      }\n\n      return data;\n    } catch (error) {\n      console.error('Error creating notification:', error);\n      throw error;\n    }\n  }, [user]);\n\n  // Initial data fetch\n  useEffect(() => {\n    if (user) {\n      fetchNotifications();\n      fetchSettings();\n      fetchPreferences(); // Fetch preferences on mount\n    }\n  }, [user, fetchNotifications, fetchSettings, fetchPreferences]);\n\n  return {\n    notifications,\n    settings,\n    loading,\n    unreadCount,\n    markAsRead,\n    markAllAsRead,\n    deleteNotification,\n    updateSettings,\n    createNotification,\n    fetchNotifications,\n    preferences,\n    updatePreferences,\n    initializePreferences,\n    isLoading,\n    notificationsConnected\n  };\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\usePerformance.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'args' is defined but never used.","line":21,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":47,"suggestions":[{"messageId":"removeVar","data":{"varName":"args"},"fix":{"range":[542,546],"text":""},"desc":"Remove unused variable 'args'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'prev' is defined but never used.","line":103,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":103,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"prev"},"fix":{"range":[2693,2701],"text":""},"desc":"Remove unused variable 'prev'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'next' is defined but never used.","line":103,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":103,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"next"},"fix":{"range":[2700,2709],"text":""},"desc":"Remove unused variable 'next'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useCallback, useMemo, useRef, useEffect, useState } from 'react';\n\n// Debounce hook for expensive operations\nexport const useDebounce = <T>(value: T, delay: number): T => {\n  const [debouncedValue, setDebouncedValue] = useState<T>(value);\n\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value, delay]);\n\n  return debouncedValue;\n};\n\n// Throttle hook for frequent events\nexport const useThrottle = <T extends (...args: any[]) => any>(\n  callback: T,\n  delay: number\n): T => {\n  const lastRun = useRef(Date.now());\n\n  return useCallback(\n    (...args: Parameters<T>) => {\n      if (Date.now() - lastRun.current >= delay) {\n        callback(...args);\n        lastRun.current = Date.now();\n      }\n    },\n    [callback, delay]\n  ) as T;\n};\n\n// Intersection Observer hook for lazy loading\nexport const useIntersectionObserver = (\n  options: IntersectionObserverInit = {}\n) => {\n  const [isIntersecting, setIsIntersecting] = useState(false);\n  const [hasIntersected, setHasIntersected] = useState(false);\n  const elementRef = useRef<HTMLElement | null>(null);\n\n  useEffect(() => {\n    const element = elementRef.current;\n    if (!element) return;\n\n    const observer = new IntersectionObserver(([entry]) => {\n      setIsIntersecting(entry.isIntersecting);\n      if (entry.isIntersecting && !hasIntersected) {\n        setHasIntersected(true);\n      }\n    }, options);\n\n    observer.observe(element);\n\n    return () => {\n      observer.disconnect();\n    };\n  }, [options, hasIntersected]);\n\n  return { elementRef, isIntersecting, hasIntersected };\n};\n\n// Virtual scrolling hook for large lists\nexport const useVirtualScrolling = (\n  itemCount: number,\n  itemHeight: number,\n  containerHeight: number,\n  overscan: number = 5\n) => {\n  const [scrollTop, setScrollTop] = useState(0);\n\n  const visibleRange = useMemo(() => {\n    const start = Math.floor(scrollTop / itemHeight);\n    const visibleCount = Math.ceil(containerHeight / itemHeight);\n    const end = Math.min(start + visibleCount + overscan, itemCount);\n\n    return {\n      start: Math.max(0, start - overscan),\n      end,\n      offsetY: start * itemHeight,\n    };\n  }, [scrollTop, itemHeight, containerHeight, overscan, itemCount]);\n\n  const handleScroll = useCallback((event: React.UIEvent<HTMLDivElement>) => {\n    setScrollTop(event.currentTarget.scrollTop);\n  }, []);\n\n  return {\n    visibleRange,\n    handleScroll,\n    totalHeight: itemCount * itemHeight,\n  };\n};\n\n// Memoization hook with custom comparison\nexport const useMemoWithCompare = <T>(\n  factory: () => T,\n  deps: React.DependencyList,\n  compare: (prev: T, next: T) => boolean\n): T => {\n  const ref = useRef<T>();\n  const depsRef = useRef(deps);\n\n  if (!ref.current || !compare(ref.current, factory())) {\n    ref.current = factory();\n  }\n\n  useEffect(() => {\n    depsRef.current = deps;\n  });\n\n  return ref.current!;\n};\n\n// Performance monitoring hook\nexport const usePerformanceMonitor = (componentName: string) => {\n  const renderCount = useRef(0);\n  const lastRenderTime = useRef(performance.now());\n\n  useEffect(() => {\n    renderCount.current += 1;\n    const currentTime = performance.now();\n    const renderTime = currentTime - lastRenderTime.current;\n    \n    if (process.env.NODE_ENV === 'development') {\n      console.log(\n        `[${componentName}] Render #${renderCount.current} took ${renderTime.toFixed(2)}ms`\n      );\n    }\n    \n    lastRenderTime.current = currentTime;\n  });\n\n  const getPerformanceMetrics = useCallback(() => ({\n    renderCount: renderCount.current,\n    averageRenderTime: renderCount.current > 1 \n      ? (performance.now() - lastRenderTime.current) / renderCount.current \n      : 0,\n  }), []);\n\n  return { getPerformanceMetrics };\n};\n\n// Resource preloading hook\nexport const usePreload = (resources: string[]) => {\n  const [loadedResources, setLoadedResources] = useState<Set<string>>(new Set());\n\n  useEffect(() => {\n    const preloadPromises = resources.map((resource) => {\n      return new Promise<void>((resolve) => {\n        if (resource.endsWith('.css')) {\n          const link = document.createElement('link');\n          link.rel = 'stylesheet';\n          link.href = resource;\n          link.onload = () => resolve();\n          link.onerror = () => resolve(); // Continue even if CSS fails\n          document.head.appendChild(link);\n        } else if (resource.endsWith('.js')) {\n          const script = document.createElement('script');\n          script.src = resource;\n          script.onload = () => resolve();\n          script.onerror = () => resolve(); // Continue even if JS fails\n          document.head.appendChild(script);\n        } else {\n          // For images and other resources\n          const img = new Image();\n          img.onload = () => resolve();\n          img.onerror = () => resolve();\n          img.src = resource;\n        }\n      });\n    });\n\n    Promise.all(preloadPromises).then(() => {\n      setLoadedResources(new Set(resources));\n    });\n  }, [resources]);\n\n  return { loadedResources, isLoaded: loadedResources.size === resources.length };\n};\n\n// Memory management hook\nexport const useMemoryManagement = () => {\n  const cleanupFunctions = useRef<Array<() => void>>([]);\n\n  const addCleanup = useCallback((cleanup: () => void) => {\n    cleanupFunctions.current.push(cleanup);\n  }, []);\n\n  const cleanup = useCallback(() => {\n    cleanupFunctions.current.forEach((fn) => {\n      try {\n        fn();\n      } catch (error) {\n        console.error('Cleanup function error:', error);\n      }\n    });\n    cleanupFunctions.current = [];\n  }, []);\n\n  useEffect(() => {\n    return cleanup;\n  }, [cleanup]);\n\n  return { addCleanup, cleanup };\n};\n\n// Network status hook\nexport const useNetworkStatus = () => {\n  const [isOnline, setIsOnline] = useState(navigator.onLine);\n  const [connectionType, setConnectionType] = useState<string>('unknown');\n\n  useEffect(() => {\n    const handleOnline = () => setIsOnline(true);\n    const handleOffline = () => setIsOnline(false);\n    const handleConnectionChange = () => {\n      const connection = (navigator as any).connection;\n      if (connection) {\n        setConnectionType(connection.effectiveType || 'unknown');\n      }\n    };\n\n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n    \n    if ((navigator as any).connection) {\n      (navigator as any).connection.addEventListener('change', handleConnectionChange);\n      handleConnectionChange();\n    }\n\n    return () => {\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n      \n      if ((navigator as any).connection) {\n        (navigator as any).connection.removeEventListener('change', handleConnectionChange);\n      }\n    };\n  }, []);\n\n  return { isOnline, connectionType };\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useProfileValidation.ts","messages":[{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'validateProfile' was used before it was defined.","line":12,"column":7,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":12,"endColumn":22},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'isValidating' and 'validateProfile'. Either include them or remove the dependency array.","line":14,"column":6,"nodeType":"ArrayExpression","endLine":14,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: [isValidating, user, validateProfile]","fix":{"range":[447,453],"text":"[isValidating, user, validateProfile]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\nimport { useAuth } from './useAuth';\n\nexport function useProfileValidation() {\n  const { user, signOut } = useAuth();\n  const [isValidating, setIsValidating] = useState(false);\n  const [profileExists, setProfileExists] = useState<boolean | null>(null);\n\n  useEffect(() => {\n    if (user && !isValidating) {\n      validateProfile();\n    }\n  }, [user]);\n\n  const validateProfile = async () => {\n    if (!user) return;\n    \n    setIsValidating(true);\n    try {\n      const { data, error } = await supabase\n        .from('profiles')\n        .select('id')\n        .eq('user_id', user.id)\n        .single();\n\n      if (error || !data) {\n        // Profile doesn't exist, sign out the user\n        console.warn('User profile not found in database, signing out user');\n        setProfileExists(false);\n        await signOut();\n      } else {\n        setProfileExists(true);\n      }\n    } catch (error) {\n      console.error('Error validating profile:', error);\n      // If there's an error fetching profile, assume it doesn't exist and sign out\n      setProfileExists(false);\n      await signOut();\n    } finally {\n      setIsValidating(false);\n    }\n  };\n\n  return {\n    isValidating,\n    profileExists,\n    validateProfile\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useRealtimeStatus.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useRefreshCountdown.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useSimplifiedConnectionHealth.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'useRef' is defined but never used.","line":1,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":50,"suggestions":[{"messageId":"removeVar","data":{"varName":"useRef"},"fix":{"range":[41,49],"text":""},"desc":"Remove unused variable 'useRef'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useRef' is defined but never used.","line":1,"column":44,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":50},{"ruleId":"no-unused-vars","severity":1,"message":"'supabase' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"supabase"},"fix":{"range":[66,124],"text":""},"desc":"Remove unused variable 'supabase'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'supabase' is defined but never used.","line":2,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":18},{"ruleId":"no-unused-vars","severity":1,"message":"'connectionStates' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"connectionStates"},"fix":{"range":[134,151],"text":""},"desc":"Remove unused variable 'connectionStates'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'connectionStates' is defined but never used.","line":3,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":26},{"ruleId":"no-undef","severity":1,"message":"'SimplifiedConnectionState' is not defined.","line":13,"column":58,"nodeType":"Identifier","messageId":"undef","endLine":13,"endColumn":83},{"ruleId":"no-undef","severity":1,"message":"'SimplifiedConnectionError' is not defined.","line":20,"column":40,"nodeType":"Identifier","messageId":"undef","endLine":20,"endColumn":65}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback, useEffect, useRef } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\nimport { connectionStates, type ConnectionState } from '@/lib/connectionStates';\n\nexport interface ConnectionHealthState {\n  status: ConnectionState;\n  isHealthy: boolean;\n  lastCheck: string | null;\n  reconnectAttempts: number;\n}\n\nexport function useSimplifiedConnectionHealth() {\n  const [connectionState, setConnectionState] = useState<SimplifiedConnectionState>({\n    status: 'connected',\n    lastCheck: new Date(),\n    reconnectAttempts: 0,\n    isHealthy: true\n  });\n\n  const [errors, setErrors] = useState<SimplifiedConnectionError[]>([]);\n\n  // Simple connection check\n  const checkConnection = useCallback(async () => {\n    try {\n      // Basic health check - if we're here, connection is working\n      setConnectionState(prev => ({\n        ...prev,\n        lastCheck: new Date(),\n        isHealthy: true\n      }));\n    } catch (error) {\n      console.warn('Simplified connection check warning:', error);\n      // Don't change status on warnings to prevent loops\n    }\n  }, []);\n\n  // Manual reconnection function\n  const reconnect = useCallback(async () => {\n    setConnectionState(prev => ({\n      ...prev,\n      status: 'connecting',\n      reconnectAttempts: prev.reconnectAttempts + 1\n    }));\n\n    try {\n      // Simple reconnection logic\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      setConnectionState(prev => ({\n        ...prev,\n        status: 'connected',\n        isHealthy: true\n      }));\n    } catch (error) {\n      console.error('Simplified reconnection failed:', error);\n      setConnectionState(prev => ({\n        ...prev,\n        status: 'error',\n        isHealthy: false\n      }));\n    }\n  }, []);\n\n  // Reset errors\n  const resetErrors = useCallback(() => {\n    setErrors([]);\n  }, []);\n\n  // Periodic health check\n  useEffect(() => {\n    const interval = setInterval(checkConnection, 45000); // 45 seconds for simplified mode\n    return () => clearInterval(interval);\n  }, [checkConnection]);\n\n  return {\n    connectionState,\n    errors,\n    checkConnection,\n    reconnect,\n    resetErrors\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useStableChannelSubscription.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":16,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[416,428],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'_userId' is defined but never used.","line":27,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"_userId"},"fix":{"range":[699,718],"text":""},"desc":"Remove unused variable '_userId'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_userId' is defined but never used.","line":27,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":18},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has an unnecessary dependency: 'subscribe'. Either exclude it or remove the dependency array.","line":232,"column":6,"nodeType":"ArrayExpression","endLine":232,"endColumn":39,"suggestions":[{"desc":"Update the dependencies array to be: [channelName, cleanup]","fix":{"range":[7522,7555],"text":"[channelName, cleanup]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":260,"column":6,"nodeType":"ArrayExpression","endLine":260,"endColumn":28,"suggestions":[{"desc":"Update the dependencies array to be: [channelName, cleanup, enabled]","fix":{"range":[8400,8422],"text":"[channelName, cleanup, enabled]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useRef, useCallback } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\nimport { debugLog, debugWarn, debugError } from '@/utils/debugFlags';\n\ninterface ChannelConfig {\n  event?: string;\n  schema?: string;\n  table?: string;\n  filter?: string;\n}\n\ninterface UseStableChannelSubscriptionOptions {\n  channelName: string;\n  userId?: string;\n  config?: ChannelConfig;\n  onData: (payload: any) => void;\n  enabled?: boolean;\n  maxRetries?: number;\n}\n\n/**\n * Stable channel subscription hook that prevents duplicate subscriptions\n * Manages channel lifecycle and provides stable connection management\n */\nexport function useStableChannelSubscription({\n  channelName,\n  userId: _userId,\n  config,\n  onData,\n  enabled = true,\n  maxRetries = 5\n}: UseStableChannelSubscriptionOptions) {\n  const channelRef = useRef<any>(null);\n  const isSubscribedRef = useRef(false);\n  const retryCountRef = useRef(0);\n  const retryTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const isDestroyedRef = useRef(false);\n  const subscriptionTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const isSubscribingRef = useRef(false);\n  const subscribeRef = useRef<(() => Promise<void> | void) | null>(null);\n  \n  // Store stable references to prevent dependency loop\n  const configRef = useRef(config);\n  const onDataRef = useRef(onData);\n  const enabledRef = useRef(enabled);\n  \n  // Create and configure channel - stable function\n  const createChannel = useCallback(() => {\n    debugLog('StableChannel', `createChannel invoked for ${channelName}`);\n    if (isDestroyedRef.current) return null;\n\n    try {\n      const channel = supabase.channel(channelName);\n      debugLog('StableChannel', `channel created for ${channelName}`);\n      \n      // Configure postgres changes if config provided\n      if (configRef.current?.event && configRef.current?.schema && configRef.current?.table) {\n        (channel as any).on(\n          'postgres_changes',\n          {\n            event: configRef.current.event,\n            schema: configRef.current.schema,\n            table: configRef.current.table,\n            filter: configRef.current.filter,\n          },\n          (payload: any) => {\n            if (!isDestroyedRef.current && onDataRef.current) {\n              onDataRef.current(payload);\n            }\n          }\n        );\n      } else {\n        // Generic channel for custom events\n        (channel as any).on('*', (_event: any, payload: any) => {\n          if (!isDestroyedRef.current && onDataRef.current) {\n            onDataRef.current(payload);\n          }\n        });\n      }\n\n      return channel;\n    } catch (error) {\n      debugError('StableChannel', `Error creating channel ${channelName}`, error);\n      return null;\n    }\n  }, [channelName]); // Only depend on channelName\n\n  // Handle channel errors with retry logic - stable function\n  const handleChannelError = useCallback((error: any) => {\n    if (isDestroyedRef.current) return;\n\n    if (error) {\n      debugWarn('StableChannel', `Handling error for ${channelName}`, error);\n    }\n\n    if (retryCountRef.current < maxRetries) {\n      const delay = Math.min(1000 * Math.pow(2, retryCountRef.current), 30000);\n      \n      debugLog('StableChannel', `Retrying ${channelName} in ${delay}ms`, {\n        attempt: retryCountRef.current + 1,\n        maxRetries\n      });\n      \n      retryTimeoutRef.current = setTimeout(() => {\n        if (!isDestroyedRef.current) {\n          retryCountRef.current++;\n          subscribeRef.current?.();\n        }\n      }, delay);\n    } else {\n      debugError('StableChannel', `Max retries reached for ${channelName}`);\n    }\n  }, [channelName, maxRetries]); // Stable dependencies\n\n  // Subscribe to channel - stable function with debouncing\n  const subscribe = useCallback(async () => {\n    if (isDestroyedRef.current || !enabledRef.current || isSubscribedRef.current || isSubscribingRef.current) {\n      debugLog('StableChannel', `Subscription skipped for ${channelName}`, {\n        isDestroyed: isDestroyedRef.current,\n        enabled: enabledRef.current,\n        isSubscribed: isSubscribedRef.current,\n        isSubscribing: isSubscribingRef.current\n      });\n      return;\n    }\n\n    try {\n      debugLog('StableChannel', `Subscribing to ${channelName}`);\n      isSubscribingRef.current = true;\n      \n      const channel = createChannel();\n      if (!channel) {\n        throw new Error('Failed to create channel');\n      }\n\n      const subscription = channel.subscribe((status, error) => {\n        if (isDestroyedRef.current) return;\n\n        switch (status) {\n          case 'SUBSCRIBED':\n            debugLog('StableChannel', `Successfully subscribed to ${channelName}`);\n            isSubscribedRef.current = true;\n            isSubscribingRef.current = false;\n            retryCountRef.current = 0;\n            break;\n            \n          case 'CHANNEL_ERROR':\n            debugError('StableChannel', `Channel error for ${channelName}`, error);\n            isSubscribedRef.current = false;\n            isSubscribingRef.current = false;\n            handleChannelError(error);\n            break;\n            \n          case 'TIMED_OUT':\n            debugWarn('StableChannel', `Channel timeout for ${channelName}`);\n            isSubscribedRef.current = false;\n            isSubscribingRef.current = false;\n            handleChannelError(new Error('Channel timeout'));\n            break;\n            \n          case 'CLOSED':\n            debugLog('StableChannel', `Channel closed for ${channelName}`);\n            isSubscribedRef.current = false;\n            isSubscribingRef.current = false;\n            break;\n        }\n      });\n\n      channelRef.current = subscription;\n\n    } catch (error) {\n      debugError('StableChannel', `Subscription failed for ${channelName}`, error);\n      isSubscribingRef.current = false;\n      handleChannelError(error);\n    }\n  }, [channelName, createChannel, handleChannelError]); // Stable dependencies\n\n  subscribeRef.current = subscribe;\n\n  useEffect(() => {\n    subscribeRef.current = subscribe;\n  }, [subscribe]);\n\n  // Cleanup function - stable function\n  const cleanup = useCallback(() => {\n    if (isDestroyedRef.current) return;\n\n    console.log(`🧹 [StableChannel] Cleaning up ${channelName}`);\n    \n    // Clear all timeouts\n    if (retryTimeoutRef.current) {\n      clearTimeout(retryTimeoutRef.current);\n      retryTimeoutRef.current = null;\n    }\n    \n    if (subscriptionTimeoutRef.current) {\n      clearTimeout(subscriptionTimeoutRef.current);\n      subscriptionTimeoutRef.current = null;\n    }\n\n    // Unsubscribe from channel\n    if (channelRef.current && isSubscribedRef.current) {\n      try {\n        channelRef.current.unsubscribe();\n        isSubscribedRef.current = false;\n        isSubscribingRef.current = false;\n      } catch (error) {\n        console.warn(`⚠️ [StableChannel] Error unsubscribing from ${channelName}:`, error);\n      }\n      channelRef.current = null;\n    }\n  }, [channelName]); // Only depend on channelName\n\n  // Reconnect function - stable function\n  const reconnect = useCallback(async () => {\n    if (isDestroyedRef.current) return;\n\n    console.log(`🔄 [StableChannel] Manual reconnection for ${channelName}`);\n    \n    // Reset retry count for manual reconnection\n    retryCountRef.current = 0;\n    \n    // Cleanup existing connection\n    cleanup();\n    \n    // Wait a bit before reconnecting\n    setTimeout(() => {\n      if (!isDestroyedRef.current) {\n        subscribeRef.current?.();\n      }\n    }, 1000);\n  }, [channelName, cleanup, subscribe]); // Stable dependencies\n\n  // Check if connected - stable function\n  const isConnected = useCallback(() => {\n    return isSubscribedRef.current && channelRef.current;\n  }, []); // No dependencies\n\n  // Initialize subscription - stable effect with debouncing\n  useEffect(() => {\n    if (enabledRef.current) {\n      // Add debouncing to prevent rapid subscription attempts\n      if (subscriptionTimeoutRef.current) {\n        clearTimeout(subscriptionTimeoutRef.current);\n      }\n      \n      subscriptionTimeoutRef.current = setTimeout(() => {\n        if (!isDestroyedRef.current && enabledRef.current) {\n          subscribeRef.current?.();\n        }\n      }, 100); // 100ms debounce\n    }\n\n    return () => {\n      if (subscriptionTimeoutRef.current) {\n        clearTimeout(subscriptionTimeoutRef.current);\n      }\n      cleanup();\n    };\n  }, [channelName, enabled]); // Only depend on channelName and enabled, not the functions\n\n  // Cleanup on unmount - stable effect\n  useEffect(() => {\n    return () => {\n      isDestroyedRef.current = true;\n      cleanup();\n    };\n  }, [cleanup]); // Stable cleanup function\n\n  return {\n    isConnected: isConnected(),\n    isConnecting: !isSubscribedRef.current && enabledRef.current,\n    isSubscribed: isSubscribedRef.current,\n    channelName,\n    cleanup,\n    reconnect\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useUserPoints.ts","messages":[{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'fetchUserPoints' was used before it was defined.","line":80,"column":9,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":80,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { useStableChannelSubscription } from './useStableChannelSubscription';\n\ninterface UserPoints {\n  totalPoints: number;\n  todayReadings: number;\n  weeklyReadings: number;\n  monthlyReadings: number;\n  pointsHistory: PointRecord[];\n  recentEarnings: PointRecord[];\n  streaks?: {\n    daily_reading: number;\n    good_air_quality: number;\n    weekly_activity: number;\n  };\n}\n\ninterface PointRecord {\n  id: string;\n  user_id: string;\n  points_earned: number;\n  aqi_value: number;\n  location_name: string;\n  timestamp: string;\n  created_at: string;\n}\n\nexport const useUserPoints = () => {\n  const { user } = useAuth();\n  const [userPoints, setUserPoints] = useState<UserPoints>({\n    totalPoints: 0,\n    todayReadings: 0,\n    weeklyReadings: 0,\n    monthlyReadings: 0,\n    pointsHistory: [],\n    recentEarnings: []\n  });\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  // Remove conflicting user-profile-points subscription - ProfileView handles this\n  // The profile points updates will come through the parent component's subscription\n\n  // Method to update total points from external sources (like ProfileView)\n  const updateTotalPoints = useCallback((newTotalPoints: number) => {\n    setUserPoints(prev => ({\n      ...prev,\n      totalPoints: newTotalPoints\n    }));\n  }, []);\n\n  // Use stable channel subscription for user points inserts\n  const { isConnected: userPointsConnected } = useStableChannelSubscription({\n    channelName: `user-points-inserts-${user?.id || 'anonymous'}`,\n    userId: user?.id,\n    config: {\n      event: 'INSERT',\n      schema: 'public',\n      table: 'user_points', // Correct table name\n      filter: `user_id=eq.${user?.id || 'anonymous'}` // Correct column name\n    },\n    onData: (payload) => {\n      console.log('New points earned:', payload);\n      if (payload.eventType === 'INSERT') {\n        const newPointRecord = payload.new as PointRecord;\n        \n        // Add to recent earnings\n        setUserPoints(prev => ({\n          ...prev,\n          pointsHistory: [newPointRecord, ...prev.pointsHistory],\n          recentEarnings: [newPointRecord, ...prev.recentEarnings.slice(0, 9)],\n          todayReadings: prev.todayReadings + 1,\n          weeklyReadings: prev.weeklyReadings + 1,\n          monthlyReadings: prev.monthlyReadings + 1\n        }));\n\n        // Refresh total points\n        fetchUserPoints();\n      }\n    },\n    enabled: !!user?.id\n  });\n\n  // Fetch user points data\n  const fetchUserPoints = useCallback(async () => {\n    if (!user) return;\n\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      // Get total points from profiles table\n      const { data: profileData, error: profileError } = await supabase\n        .from('profiles')\n        .select('total_points')\n        .eq('user_id', user.id)\n        .single();\n\n      if (profileError) throw profileError;\n\n      const totalPoints = profileData?.total_points || 0;\n\n      // Get points history\n      const { data: pointsData, error: pointsError } = await supabase\n        .from('user_points')\n        .select('*')\n        .eq('user_id', user.id)\n        .order('created_at', { ascending: false })\n        .limit(100);\n\n      if (pointsError) throw pointsError;\n\n      // Calculate reading counts\n      const now = new Date();\n      const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n      const weekAgo = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);\n      const monthAgo = new Date(now.getFullYear(), now.getMonth() - 1, now.getDate());\n\n      const todayReadings = pointsData?.filter(record => \n        new Date(record.created_at) >= today\n      ).length || 0;\n\n      const weeklyReadings = pointsData?.filter(record => \n        new Date(record.created_at) >= weekAgo\n      ).length || 0;\n\n      const monthlyReadings = pointsData?.filter(record => \n        new Date(record.created_at) >= monthAgo\n      ).length || 0;\n\n      // Get recent earnings (last 10)\n      const recentEarnings = pointsData?.slice(0, 10) || [];\n\n      // Get user streaks\n      const { data: streaksData, error: streaksError } = await supabase\n        .from('user_streaks')\n        .select('streak_type, current_streak')\n        .eq('user_id', user.id);\n\n      if (streaksError) {\n        console.warn('Error fetching streaks:', streaksError);\n      }\n\n      // Process streaks data\n      const streaks = streaksData ? {\n        daily_reading: streaksData.find(s => s.streak_type === 'daily_reading')?.current_streak || 0,\n        good_air_quality: streaksData.find(s => s.streak_type === 'good_air_quality')?.current_streak || 0,\n        weekly_activity: streaksData.find(s => s.streak_type === 'weekly_activity')?.current_streak || 0\n      } : undefined;\n\n      setUserPoints({\n        totalPoints,\n        todayReadings,\n        weeklyReadings,\n        monthlyReadings,\n        pointsHistory: pointsData || [],\n        recentEarnings,\n        streaks\n      });\n\n    } catch (err: any) {\n      console.error('Error fetching user points:', err);\n      setError(err.message || 'Failed to fetch user points');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [user]);\n\n  // Initial data fetch\n  useEffect(() => {\n    if (user) {\n      fetchUserPoints();\n    }\n  }, [user, fetchUserPoints]);\n\n  // Calculate additional metrics\n  const averagePointsPerReading = userPoints.pointsHistory.length > 0 \n    ? userPoints.totalPoints / userPoints.pointsHistory.length \n    : 0;\n\n  const totalReadings = userPoints.pointsHistory.length;\n  const currencyValue = (userPoints.totalPoints / 1000) * 0.1; // $0.1 per 1000 points\n  const canWithdraw = userPoints.totalPoints >= 500000;\n\n  // Calculate badge progress\n  const getCurrentBadge = () => {\n    const totalPoints = userPoints.totalPoints;\n    if (totalPoints >= 100000) return { name: 'Crystal Legend', icon: '✨', color: 'from-purple-500 to-pink-500' };\n    if (totalPoints >= 90000) return { name: 'Obsidian Elite', icon: '⚫', color: 'bg-gray-800' };\n    if (totalPoints >= 80000) return { name: 'Sapphire Legend', icon: '🔵', color: 'bg-indigo-500' };\n    if (totalPoints >= 70000) return { name: 'Ruby Champion', icon: '🔴', color: 'bg-red-500' };\n    if (totalPoints >= 60000) return { name: 'Emerald Expert', icon: '🟢', color: 'bg-green-500' };\n    if (totalPoints >= 50000) return { name: 'Diamond Master', icon: '💠', color: 'bg-purple-500' };\n    if (totalPoints >= 40000) return { name: 'Platinum Guardian', icon: '💎', color: 'bg-blue-400' };\n    if (totalPoints >= 30000) return { name: 'Gold Enthusiast', icon: '🥇', color: 'bg-yellow-500' };\n    if (totalPoints >= 20000) return { name: 'Silver Explorer', icon: '🥈', color: 'bg-gray-400' };\n    if (totalPoints >= 10000) return { name: 'Bronze Starter', icon: '🥉', color: 'bg-amber-500' };\n    return { name: 'Newcomer', icon: '🌱', color: 'bg-green-400' };\n  };\n\n  const getNextBadge = () => {\n    const totalPoints = userPoints.totalPoints;\n    if (totalPoints < 10000) return { name: 'Bronze Starter', pointsRequired: 10000, icon: '🥉' };\n    if (totalPoints < 20000) return { name: 'Silver Explorer', pointsRequired: 20000, icon: '🥈' };\n    if (totalPoints < 30000) return { name: 'Gold Enthusiast', pointsRequired: 30000, icon: '🥇' };\n    if (totalPoints < 40000) return { name: 'Platinum Guardian', pointsRequired: 40000, icon: '💎' };\n    if (totalPoints < 50000) return { name: 'Diamond Master', pointsRequired: 50000, icon: '💠' };\n    if (totalPoints < 60000) return { name: 'Emerald Expert', pointsRequired: 60000, icon: '🟢' };\n    if (totalPoints < 70000) return { name: 'Ruby Champion', pointsRequired: 70000, icon: '🔴' };\n    if (totalPoints < 80000) return { name: 'Sapphire Legend', pointsRequired: 80000, icon: '🔵' };\n    if (totalPoints < 90000) return { name: 'Obsidian Elite', pointsRequired: 90000, icon: '⚫' };\n    if (totalPoints < 100000) return { name: 'Crystal Legend', pointsRequired: 100000, icon: '✨' };\n    return null; // All badges unlocked\n  };\n\n  const currentBadge = getCurrentBadge();\n  const nextBadge = getNextBadge();\n  const pointsToNextBadge = nextBadge ? nextBadge.pointsRequired - userPoints.totalPoints : 0;\n\n  return {\n    userPoints,\n    isLoading,\n    error,\n    averagePointsPerReading,\n    totalReadings,\n    currencyValue,\n    canWithdraw,\n    fetchUserPoints,\n    currentBadge,\n    nextBadge,\n    pointsToNextBadge,\n    streaks: userPoints.streaks,\n    profilePointsConnected: undefined, // Removed as per edit hint\n    userPointsConnected,\n    updateTotalPoints\n  };\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useWeatherData.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'memoizedCoordinates' and 'weatherQuery'. Either include them or remove the dependency array.","line":500,"column":6,"nodeType":"ArrayExpression","endLine":500,"endColumn":91,"suggestions":[{"desc":"Update the dependencies array to be: [memoizedCoordinates, memoizedCoordinates.latitude, memoizedCoordinates.longitude, weatherQuery, weatherQuery.refetch]","fix":{"range":[16529,16614],"text":"[memoizedCoordinates, memoizedCoordinates.latitude, memoizedCoordinates.longitude, weatherQuery, weatherQuery.refetch]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback, useMemo, useRef } from 'react';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { useToast } from '@/components/ui/use-toast';\nimport { supabase } from '@/integrations/supabase/client';\nimport { useAuth } from './useAuth';\n\n// Refresh lock mechanism to prevent duplicate pulls on manual refresh\nconst REFRESH_LOCK_KEY = 'breath_safe_weather_refresh_lock';\nconst REFRESH_LOCK_DURATION = 14 * 60 * 1000; // 14 minutes (slightly less than 15 to ensure smooth operation)\n\n// Helper function to check if refresh is locked\nconst isRefreshLocked = (): boolean => {\n  try {\n    const lockData = localStorage.getItem(REFRESH_LOCK_KEY);\n    if (!lockData) return false;\n    \n    const { timestamp } = JSON.parse(lockData);\n    const now = Date.now();\n    const timeSinceLastRefresh = now - timestamp;\n    \n    // If less than 14 minutes have passed, refresh is locked\n    return timeSinceLastRefresh < REFRESH_LOCK_DURATION;\n  } catch {\n    return false;\n  }\n};\n\n// Helper function to set refresh lock\nconst setRefreshLock = (): void => {\n  try {\n    const lockData = {\n      timestamp: Date.now(),\n      userAgent: navigator.userAgent\n    };\n    localStorage.setItem(REFRESH_LOCK_KEY, JSON.stringify(lockData));\n  } catch (error) {\n    console.warn('Failed to set weather refresh lock:', error);\n  }\n};\n\n// Helper function to clear refresh lock (for manual refresh)\nconst clearRefreshLock = (): void => {\n  try {\n    localStorage.removeItem(REFRESH_LOCK_KEY);\n  } catch (error) {\n    console.warn('Failed to clear weather refresh lock:', error);\n  }\n};\n\nexport interface WeatherData {\n  temperature: number;\n  humidity: number;\n  windSpeed: number;\n  windDirection: number;\n  windGust?: number;\n  airPressure?: number;\n  rainProbability?: number;\n  uvIndex?: number;\n  visibility?: number;\n  weatherCondition: string;\n  feelsLikeTemperature?: number;\n  sunriseTime?: string;\n  sunsetTime?: string;\n  timestamp: string;\n  dataSource: string;\n}\n\nexport interface ForecastData {\n  date: string;\n  temperature: {\n    min: number;\n    max: number;\n    avg: number;\n  };\n  humidity: number;\n  windSpeed: number;\n  windDirection: number;\n  rainProbability: number;\n  weatherCondition: string;\n  uvIndex?: number;\n}\n\nexport interface ComprehensiveReading {\n  id: string;\n  userId: string;\n  latitude: number;\n  longitude: number;\n  locationName?: string;\n  aqi: number;\n  pm25?: number;\n  pm10?: number;\n  no2?: number;\n  so2?: number;\n  co?: number;\n  o3?: number;\n  temperature?: number;\n  humidity?: number;\n  windSpeed?: number;\n  windDirection?: number;\n  windGust?: number;\n  airPressure?: number;\n  rainProbability?: number;\n  uvIndex?: number;\n  visibility?: number;\n  forecastSummary?: any;\n  weatherCondition?: string;\n  feelsLikeTemperature?: number;\n  sunriseTime?: string;\n  sunsetTime?: string;\n  timestamp: string;\n  dataSource: string;\n  createdAt: string;\n}\n\nexport interface UseWeatherDataOptions {\n  latitude?: number;\n  longitude?: number;\n  autoRefresh?: boolean;\n  refreshInterval?: number;\n}\n\nexport function useWeatherData(options: UseWeatherDataOptions = {}) {\n  const { autoRefresh = true, refreshInterval = 900000 } = options; // 15 minutes default\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  // State for current weather data\n  const [currentWeather, setCurrentWeather] = useState<WeatherData | null>(null);\n  const [forecast, setForecast] = useState<ForecastData[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Use refs to track previous coordinates and prevent unnecessary re-renders\n  const prevCoordinatesRef = useRef<{ latitude: number; longitude: number } | null>(null);\n\n  // Memoize coordinates to prevent unnecessary re-renders\n  const memoizedCoordinates = useMemo(() => {\n    if (!options.latitude || !options.longitude) return null;\n    return {\n      latitude: options.latitude,\n      longitude: options.longitude\n    };\n  }, [options.latitude, options.longitude]);\n\n  // Fetch current weather from OpenWeatherMap\n  const fetchCurrentWeather = useCallback(async (lat: number, lon: number): Promise<WeatherData> => {\n    const apiKey = import.meta.env.VITE_OPENWEATHERMAP_API_KEY;\n    if (!apiKey) {\n      throw new Error('OpenWeatherMap API key not configured');\n    }\n\n    const response = await fetch(\n      `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${apiKey}&units=metric`\n    );\n\n    if (!response.ok) {\n      throw new Error(`Weather API error: ${response.status}`);\n    }\n\n    const data = await response.json();\n    \n    return {\n      temperature: data.main.temp,\n      humidity: data.main.humidity,\n      windSpeed: data.wind.speed * 3.6, // Convert m/s to km/h\n      windDirection: data.wind.deg,\n      windGust: data.wind.gust ? data.wind.gust * 3.6 : undefined,\n      airPressure: data.main.pressure,\n      rainProbability: data.rain ? data.rain['1h'] : undefined,\n      uvIndex: undefined, // OpenWeatherMap doesn't provide UV index in basic plan\n      visibility: data.visibility / 1000, // Convert m to km\n      weatherCondition: data.weather[0].main,\n      feelsLikeTemperature: data.main.feels_like,\n      sunriseTime: new Date(data.sys.sunrise * 1000).toLocaleTimeString('en-US', { \n        hour: '2-digit', \n        minute: '2-digit',\n        hour12: false \n      }),\n      sunsetTime: new Date(data.sys.sunset * 1000).toLocaleTimeString('en-US', { \n        hour: '2-digit', \n        minute: '2-digit',\n        hour12: false \n      }),\n      timestamp: new Date().toISOString(),\n      dataSource: 'OpenWeatherMap API'\n    };\n  }, []);\n\n  // Fetch forecast from Open-Meteo\n  const fetchForecast = useCallback(async (lat: number, lon: number): Promise<ForecastData[]> => {\n    const response = await fetch(\n      `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&daily=temperature_2m_max,temperature_2m_min,temperature_2m_mean,precipitation_probability_max,wind_speed_10m_max,wind_direction_10m_dominant&timezone=auto`\n    );\n\n    if (!response.ok) {\n      throw new Error(`Forecast API error: ${response.status}`);\n    }\n\n    const data = await response.json();\n    \n    return data.daily.time.map((date: string, index: number) => ({\n      date,\n      temperature: {\n        min: data.daily.temperature_2m_min[index],\n        max: data.daily.temperature_2m_max[index],\n        avg: data.daily.temperature_2m_mean[index]\n      },\n      humidity: null, // Open-Meteo doesn't provide humidity in daily forecast\n      windSpeed: data.daily.wind_speed_10m_max[index],\n      windDirection: data.daily.wind_direction_10m_dominant[index],\n      rainProbability: data.daily.precipitation_probability_max[index],\n      weatherCondition: null, // Open-Meteo doesn't provide weather conditions\n      uvIndex: undefined\n    }));\n  }, []);\n\n  // Fetch wind data from Open-Meteo\n  const fetchWindData = useCallback(async (lat: number, lon: number) => {\n    const response = await fetch(\n      `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=wind_speed_10m,wind_direction_10m,wind_gusts_10m&timezone=auto`\n    );\n\n    if (!response.ok) {\n      throw new Error(`Wind API error: ${response.status}`);\n    }\n\n    const data = await response.json();\n    \n    return {\n      windSpeed: data.current.wind_speed_10m,\n      windDirection: data.current.wind_direction_10m,\n      windGust: data.current.wind_gusts_10m\n    };\n  }, []);\n\n  // Save comprehensive reading to database\n  const saveComprehensiveReading = useCallback(async (\n    aqiData: any,\n    weatherData: WeatherData,\n    forecastData: ForecastData[],\n    lat: number,\n    lon: number\n  ) => {\n    if (!user) {\n      console.log('No user, skipping save');\n      return null;\n    }\n\n    try {\n      const reading = {\n        user_id: user.id,\n        latitude: lat,\n        longitude: lon,\n        location_name: aqiData.location || 'Unknown Location',\n        aqi: aqiData.aqi,\n        pm25: aqiData.pollutants?.pm2_5,\n        pm10: aqiData.pollutants?.pm10,\n        no2: aqiData.pollutants?.no2,\n        so2: aqiData.pollutants?.so2,\n        co: aqiData.pollutants?.co,\n        o3: aqiData.pollutants?.o3,\n        temperature: weatherData.temperature,\n        humidity: weatherData.humidity,\n        wind_speed: weatherData.windSpeed,\n        wind_direction: weatherData.windDirection,\n        wind_gust: weatherData.windGust,\n        air_pressure: weatherData.airPressure,\n        rain_probability: weatherData.rainProbability,\n        uv_index: weatherData.uvIndex,\n        visibility: weatherData.visibility,\n        forecast_summary: forecastData,\n        weather_condition: weatherData.weatherCondition,\n        feels_like_temperature: weatherData.feelsLikeTemperature,\n        sunrise_time: weatherData.sunriseTime,\n        sunset_time: weatherData.sunsetTime,\n        data_source: 'Integrated Weather System'\n      };\n\n      const { data, error } = await supabase\n        .from('air_quality_readings')\n        .insert(reading)\n        .select()\n        .single();\n\n      if (error) {\n        console.error('Error saving comprehensive reading:', error);\n        throw error;\n      }\n\n      // Invalidate related queries\n      queryClient.invalidateQueries({ queryKey: ['weather-readings', user.id] });\n      queryClient.invalidateQueries({ queryKey: ['air-quality-readings', user.id] });\n\n      return data;\n    } catch (error) {\n      console.error('Error saving comprehensive reading:', error);\n      throw error;\n    }\n  }, [user, queryClient]);\n\n  // Main function to fetch all weather data\n  const fetchAllWeatherData = useCallback(async (lat: number, lon: number) => {\n    // Check refresh lock to prevent duplicate pulls on manual refresh\n    if (isRefreshLocked()) {\n      if (process.env.NODE_ENV === 'development') {\n        console.log('useWeatherData: Refresh locked - preventing duplicate weather data pull on manual refresh');\n      }\n      // Handle rate limiting gracefully without throwing errors\n      console.log('ℹ️ Weather data rate limited, using cached data');\n      return {\n        weather: currentWeather,\n        forecast: forecast\n      };\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      // Fetch all data in parallel\n      const [weatherData, forecastData, windData] = await Promise.all([\n        fetchCurrentWeather(lat, lon),\n        fetchForecast(lat, lon),\n        fetchWindData(lat, lon)\n      ]);\n\n      // Merge wind data with weather data\n      const comprehensiveWeather: WeatherData = {\n        ...weatherData,\n        windSpeed: windData.windSpeed,\n        windDirection: windData.windDirection,\n        windGust: windData.windGust\n      };\n\n      setCurrentWeather(comprehensiveWeather);\n      setForecast(forecastData);\n\n      // Set refresh lock to prevent duplicate pulls on manual refresh\n      setRefreshLock();\n      if (process.env.NODE_ENV === 'development') {\n        console.log('useWeatherData: Refresh lock set - preventing duplicate pulls for 14 minutes');\n      }\n\n      return {\n        weather: comprehensiveWeather,\n        forecast: forecastData\n      };\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to fetch weather data';\n      \n      // Handle rate limiting gracefully\n      if (errorMessage.includes('recently fetched')) {\n        console.log('ℹ️ Weather data rate limited, using cached data');\n        setError(null); // Clear error state\n        // Return cached data if available\n        if (currentWeather) {\n          return {\n            weather: currentWeather,\n            forecast: forecast\n          };\n        }\n      } else {\n        setError(errorMessage);\n        toast({\n          title: 'Weather Data Error',\n          description: errorMessage,\n          variant: 'destructive'\n        });\n      }\n      \n      // Don't throw the error, handle it gracefully\n      return {\n        weather: currentWeather,\n        forecast: forecast\n      };\n    } finally {\n      setLoading(false);\n    }\n  }, [fetchCurrentWeather, fetchForecast, fetchWindData, toast, currentWeather, forecast]);\n\n  // Manual refresh function that clears the refresh lock\n  const manualRefresh = useCallback(async () => {\n    try {\n      // Clear refresh lock for manual refresh\n      clearRefreshLock();\n      if (process.env.NODE_ENV === 'development') {\n        console.log('useWeatherData: Manual refresh - cleared refresh lock');\n      }\n      \n      if (memoizedCoordinates?.latitude && memoizedCoordinates?.longitude) {\n        await fetchAllWeatherData(memoizedCoordinates.latitude, memoizedCoordinates.longitude);\n        if (process.env.NODE_ENV === 'development') {\n          console.log('useWeatherData: Manual refresh completed');\n        }\n      }\n    } catch (error) {\n      console.error('Manual weather refresh failed:', error);\n      throw error;\n    }\n  }, [memoizedCoordinates, fetchAllWeatherData]);\n\n  // React Query for weather data with memoized coordinates\n  const weatherQuery = useQuery({\n    queryKey: ['weather-data', memoizedCoordinates?.latitude, memoizedCoordinates?.longitude],\n    queryFn: () => {\n      if (!memoizedCoordinates?.latitude || !memoizedCoordinates?.longitude) {\n        throw new Error('Latitude and longitude are required');\n      }\n      return fetchAllWeatherData(memoizedCoordinates.latitude, memoizedCoordinates.longitude);\n    },\n    enabled: !!(memoizedCoordinates?.latitude && memoizedCoordinates?.longitude),\n    refetchInterval: autoRefresh ? refreshInterval : false,\n    staleTime: 300000, // 5 minutes\n    gcTime: 900000, // 15 minutes\n    retry: 3,\n    retryDelay: 1000,\n  });\n\n  // React Query for user's weather readings\n  const userReadingsQuery = useQuery({\n    queryKey: ['weather-readings', user?.id],\n    queryFn: async () => {\n      if (!user) return [];\n\n      const { data, error } = await supabase\n        .from('air_quality_readings')\n        .select('*')\n        .eq('user_id', user.id)\n        .order('timestamp', { ascending: false })\n        .limit(50);\n\n      if (error) throw error;\n      return data || [];\n    },\n    enabled: !!user,\n    staleTime: 60000, // 1 minute\n  });\n\n  // Mutation for saving comprehensive readings\n  const saveReadingMutation = useMutation({\n    mutationFn: ({ aqiData, weatherData, forecastData, lat, lon }: {\n      aqiData: any;\n      weatherData: WeatherData;\n      forecastData: ForecastData[];\n      lat: number;\n      lon: number;\n    }) => saveComprehensiveReading(aqiData, weatherData, forecastData, lat, lon),\n    onSuccess: () => {\n      toast({\n        title: 'Data Saved',\n        description: 'Weather and air quality data saved successfully',\n      });\n    },\n    onError: (error) => {\n      toast({\n        title: 'Save Error',\n        description: `Failed to save data: ${error.message}`,\n        variant: 'destructive'\n      });\n    }\n  });\n\n  // Auto-refresh effect with memoized coordinates\n  useEffect(() => {\n    if (!autoRefresh || !memoizedCoordinates?.latitude || !memoizedCoordinates?.longitude) return;\n\n    const interval = setInterval(() => {\n      if (memoizedCoordinates?.latitude && memoizedCoordinates?.longitude) {\n        fetchAllWeatherData(memoizedCoordinates.latitude, memoizedCoordinates.longitude);\n      }\n    }, refreshInterval);\n\n    return () => clearInterval(interval);\n  }, [autoRefresh, refreshInterval, memoizedCoordinates, fetchAllWeatherData]);\n\n  // Handle coordinate changes and trigger data fetch (with deep comparison)\n  useEffect(() => {\n    if (!memoizedCoordinates?.latitude || !memoizedCoordinates?.longitude) return;\n    \n    // Deep comparison to prevent unnecessary fetches\n    const prevCoords = prevCoordinatesRef.current;\n    const coordinatesChanged = !prevCoords || \n      prevCoords.latitude !== memoizedCoordinates.latitude || \n      prevCoords.longitude !== memoizedCoordinates.longitude;\n    \n    if (coordinatesChanged) {\n      if (process.env.NODE_ENV === 'development') {\n        console.log('useWeatherData: Coordinates changed, triggering data fetch:', memoizedCoordinates.latitude, memoizedCoordinates.longitude);\n      }\n      // Reset state when coordinates change\n      setCurrentWeather(null);\n      setForecast([]);\n      setError(null);\n      // Update previous coordinates reference\n      prevCoordinatesRef.current = { ...memoizedCoordinates };\n      // Trigger the query to fetch new data\n      weatherQuery.refetch();\n    }\n  }, [memoizedCoordinates?.latitude, memoizedCoordinates?.longitude, weatherQuery.refetch]);\n\n  // Memoized values\n  const weatherSummary = useMemo(() => {\n    if (!currentWeather) return null;\n\n    return {\n      current: currentWeather,\n      forecast: forecast.slice(0, 7), // Next 7 days\n      lastUpdated: currentWeather.timestamp\n    };\n  }, [currentWeather, forecast]);\n\n  return {\n    // Current state\n    currentWeather,\n    forecast,\n    loading: loading || weatherQuery.isLoading,\n    error: error || weatherQuery.error?.message,\n    \n    // Queries\n    weatherQuery,\n    userReadingsQuery,\n    \n    // Actions\n    fetchAllWeatherData,\n    saveReadingMutation,\n    manualRefresh, // Add manualRefresh to the return object\n    \n    // Computed values\n    weatherSummary,\n    \n    // Utilities\n    refetch: weatherQuery.refetch,\n    isStale: weatherQuery.isStale\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useWebSocket.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'event' is defined but never used.","line":6,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":35,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[302,321],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'event' is defined but never used.","line":7,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[345,357],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'event' is defined but never used.","line":8,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[382,399],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":9,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[424,436],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'url'. Either include it or remove the dependency array.","line":59,"column":6,"nodeType":"ArrayExpression","endLine":59,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [url]","fix":{"range":[1985,1987],"text":"[url]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'url'. Either include it or remove the dependency array.","line":67,"column":6,"nodeType":"ArrayExpression","endLine":67,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [url]","fix":{"range":[2220,2222],"text":"[url]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'url'. Either include it or remove the dependency array.","line":74,"column":6,"nodeType":"ArrayExpression","endLine":74,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [url]","fix":{"range":[2484,2486],"text":"[url]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'url'. Either include it or remove the dependency array.","line":81,"column":6,"nodeType":"ArrayExpression","endLine":81,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [url]","fix":{"range":[2717,2719],"text":"[url]"}}]},{"ruleId":"no-unused-vars","severity":1,"message":"'data' is defined but never used.","line":177,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":177,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[5740,5747],"text":""},"desc":"Remove unused variable 'data'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState, useCallback, useRef } from 'react';\r\nimport { connectionManager, ConnectionOptions } from '@/lib/connectionManager';\r\nimport { debugLog, debugWarn, debugError } from '@/utils/debugFlags';\r\n\r\nexport interface UseWebSocketOptions extends ConnectionOptions {\r\n  onMessage?: (event: MessageEvent) => void;\r\n  onOpen?: (event: Event) => void;\r\n  onClose?: (event: CloseEvent) => void;\r\n  onError?: (error: Event) => void;\r\n  reconnectOnUnmount?: boolean;\r\n}\r\n\r\nexport function useWebSocket(\r\n  url: string | null,\r\n  options: UseWebSocketOptions = {}\r\n) {\r\n  const {\r\n    onMessage,\r\n    onOpen,\r\n    onClose,\r\n    onError,\r\n    reconnectOnUnmount = false,\r\n    ...connectionOptions\r\n  } = options;\r\n\r\n  const [isConnected, setIsConnected] = useState(false);\r\n  const [lastMessage, setLastMessage] = useState<MessageEvent | null>(null);\r\n  const [error, setError] = useState<Error | null>(null);\r\n  const reconnectOnUnmountRef = useRef(reconnectOnUnmount);\r\n  const connectionOptionsRef = useRef(connectionOptions);\r\n  const onMessageRef = useRef(onMessage);\r\n  const onOpenRef = useRef(onOpen);\r\n  const onCloseRef = useRef(onClose);\r\n  const onErrorRef = useRef(onError);\r\n  const connectionIdRef = useRef<string | null>(null);\r\n\r\n  connectionOptionsRef.current = connectionOptions;\r\n  onMessageRef.current = onMessage;\r\n  onOpenRef.current = onOpen;\r\n  onCloseRef.current = onClose;\r\n  onErrorRef.current = onError;\r\n\r\n  const getConnectionId = useCallback((value: string | null) => {\r\n    if (!value) return null;\r\n\r\n    try {\r\n      const parsed = new URL(value);\r\n      return `${parsed.protocol}//${parsed.host}${parsed.pathname}`.toLowerCase();\r\n    } catch {\r\n      return value.toLowerCase();\r\n    }\r\n  }, []);\r\n\r\n  // Handle message events\r\n  const handleMessage = useCallback((event: MessageEvent) => {\r\n    setLastMessage(event);\r\n    onMessageRef.current?.(event);\r\n    debugLog('WebSocket', 'Message received', { url, data: event.data });\r\n  }, []);\r\n\r\n  // Handle connection open\r\n  const handleOpen = useCallback((event: Event) => {\r\n    setIsConnected(true);\r\n    setError(null);\r\n    onOpenRef.current?.(event);\r\n    debugLog('WebSocket', 'Connection opened', { url });\r\n  }, []);\r\n\r\n  // Handle connection close\r\n  const handleClose = useCallback((event: CloseEvent) => {\r\n    setIsConnected(false);\r\n    onCloseRef.current?.(event);\r\n    debugWarn('WebSocket', 'Connection closed', { url, code: event.code, reason: event.reason });\r\n  }, []);\r\n\r\n  // Handle errors\r\n  const handleError = useCallback((event: Event) => {\r\n    setError(new Error('WebSocket error'));\r\n    onErrorRef.current?.(event);\r\n    debugError('WebSocket', 'Connection error', { url, event });\r\n  }, []);\r\n\r\n  // Send message function\r\n  const sendMessage = useCallback(async (data: any) => {\r\n    const connectionId = connectionIdRef.current;\r\n    if (!connectionId) {\r\n      throw new Error('WebSocket URL is not set');\r\n    }\r\n    debugLog('WebSocket', 'Sending message', { connectionId, data });\r\n    await connectionManager.send(connectionId, data);\r\n  }, []);\r\n\r\n  // Connect to WebSocket\r\n  const connect = useCallback(async () => {\r\n    if (!url) {\r\n      debugWarn('WebSocket', 'Connect called with null URL');\r\n      return;\r\n    }\r\n\r\n    const connectionId = getConnectionId(url);\r\n    connectionIdRef.current = connectionId;\r\n    debugLog('WebSocket', 'Connecting', { url, connectionId, options: connectionOptionsRef.current });\r\n\r\n    try {\r\n      const ws = await connectionManager.connect(url, connectionOptionsRef.current);\r\n      \r\n      // Set up event listeners\r\n      ws.addEventListener('message', handleMessage);\r\n      ws.addEventListener('open', handleOpen);\r\n      ws.addEventListener('close', handleClose);\r\n      ws.addEventListener('error', handleError);\r\n\r\n      return () => {\r\n        ws.removeEventListener('message', handleMessage);\r\n        ws.removeEventListener('open', handleOpen);\r\n        ws.removeEventListener('close', handleClose);\r\n        ws.removeEventListener('error', handleError);\r\n\r\n        if (!reconnectOnUnmountRef.current && connectionId) {\r\n          debugLog('WebSocket', 'Disconnecting on cleanup', { connectionId });\r\n          connectionManager.disconnect(connectionId);\r\n        }\r\n      };\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err : new Error('Failed to connect to WebSocket'));\r\n      debugError('WebSocket', 'Failed to connect', { url, error: err });\r\n      return undefined;\r\n    }\r\n  }, [url, getConnectionId, handleMessage, handleOpen, handleClose, handleError]);\r\n\r\n  // Effect to handle connection lifecycle\r\n  useEffect(() => {\r\n    if (!url) return;\r\n\r\n    let cleanup: (() => void) | undefined;\r\n    \r\n    // Connect to WebSocket\r\n    connect().then((cleanupFn) => {\r\n      cleanup = cleanupFn;\r\n    });\r\n\r\n    // Cleanup function\r\n    return () => {\r\n      cleanup?.();\r\n    };\r\n  }, [url, connect]);\r\n\r\n  // Update reconnectOnUnmount ref when prop changes\r\n  useEffect(() => {\r\n    reconnectOnUnmountRef.current = reconnectOnUnmount;\r\n  }, [reconnectOnUnmount]);\r\n\r\n  useEffect(() => {\r\n    connectionIdRef.current = getConnectionId(url);\r\n    debugLog('WebSocket', 'Connection ID updated', { url, connectionId: connectionIdRef.current });\r\n  }, [url, getConnectionId]);\r\n\r\n  return {\r\n    isConnected,\r\n    lastMessage,\r\n    error,\r\n    sendMessage,\r\n    reconnect: connect,\r\n    disconnect: useCallback(() => {\r\n      const connectionId = connectionIdRef.current;\r\n      if (connectionId) {\r\n        connectionManager.disconnect(connectionId);\r\n      }\r\n    }, []),\r\n  };\r\n}\r\n\r\n// Hook for subscribing to WebSocket events\r\nexport function useWebSocketEvent<T = any>(\r\n  url: string | null,\r\n  eventType: string,\r\n  callback: (data: T) => void,\r\n  options: Omit<UseWebSocketOptions, 'onMessage'> = {}\r\n) {\r\n  const callbackRef = useRef(callback);\r\n  \r\n  // Update callback ref when it changes\r\n  useEffect(() => {\r\n    callbackRef.current = callback;\r\n  }, [callback]);\r\n\r\n  const handleMessage = useCallback((event: MessageEvent) => {\r\n    try {\r\n      const data = typeof event.data === 'string' ? JSON.parse(event.data) : event.data;\r\n      if (data.type === eventType) {\r\n        callbackRef.current(data.payload);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error processing WebSocket message:', error);\r\n    }\r\n  }, [eventType]);\r\n\r\n  return useWebSocket(url, {\r\n    ...options,\r\n    onMessage: handleMessage,\r\n  });\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\hooks\\useWithdrawalRequests.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\integrations\\supabase\\client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\integrations\\supabase\\realtime.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":26,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[707,719],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'channel' is defined but never used.","line":59,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":59,"endColumn":70,"suggestions":[{"messageId":"removeVar","data":{"varName":"channel"},"fix":{"range":[1855,1886],"text":""},"desc":"Remove unused variable 'channel'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'channel' is defined but never used.","line":59,"column":39,"nodeType":null,"messageId":"unusedVar","endLine":59,"endColumn":46}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { RealtimeChannel } from '@supabase/supabase-js';\nimport { \n  subscribeToChannel, \n  unsubscribeFromChannel, \n  cleanupAllChannels,\n  getChannelStatus,\n  isChannelActive,\n  resetConnectionState,\n  getConnectionStatus\n} from '@/lib/realtimeClient';\n\n// Environment flag to disable realtime entirely\nconst REALTIME_ENABLED = import.meta.env.VITE_SUPABASE_REALTIME_ENABLED !== 'false';\n\n/**\n * Create a realtime channel with retry logic and graceful fallback\n * @deprecated Use subscribeToChannel from @/lib/realtimeClient instead\n */\nexport function createRealtimeChannel(\n  channelName: string,\n  config: {\n    event: string;\n    schema: string;\n    table: string;\n    filter?: string;\n    callback: (payload: any) => void;\n  }\n): RealtimeChannel | null {\n  // If realtime is disabled, return null\n  if (!REALTIME_ENABLED) {\n    console.warn(`[Realtime] Realtime disabled. Channel '${channelName}' not created.`);\n    return null;\n  }\n\n  // Use the new singleton connection manager\n  subscribeToChannel(channelName, config.callback, {\n    event: config.event,\n    schema: config.schema,\n    table: config.table,\n    filter: config.filter,\n  });\n\n  // Return a mock channel object for backward compatibility\n  // The actual channel management is handled by the singleton\n  return {\n    // Mock implementation - actual functionality is handled by the singleton\n    on: () => ({ on: () => ({ on: () => ({ subscribe: () => ({}) }) }) }),\n    subscribe: () => ({} as RealtimeChannel),\n    unsubscribe: () => Promise.resolve(),\n    send: () => Promise.resolve({ data: null, error: null }),\n    onError: () => ({ on: () => ({ on: () => ({ subscribe: () => ({}) }) }) }),\n  } as RealtimeChannel;\n}\n\n/**\n * Remove a realtime channel safely\n * @deprecated Use unsubscribeFromChannel from @/lib/realtimeClient instead\n */\nexport function removeRealtimeChannel(channel: RealtimeChannel | null): void {\n  // This function is deprecated - channels are managed by the singleton\n  // No action needed as the singleton handles cleanup\n  console.warn('[Realtime] removeRealtimeChannel is deprecated. Use unsubscribeFromChannel instead.');\n}\n\n/**\n * Check if realtime is currently enabled\n * @deprecated Use getConnectionStatus from @/lib/realtimeClient instead\n */\nexport function isRealtimeEnabled(): boolean {\n  const status = getConnectionStatus();\n  return REALTIME_ENABLED && status !== 'disconnected';\n}\n\n/**\n * Reset realtime state (useful for testing or re-enabling)\n * @deprecated Use resetConnectionState from @/lib/realtimeClient instead\n */\nexport function resetRealtimeState(): void {\n  resetConnectionState();\n}\n\n/**\n * Get current realtime status for debugging\n * @deprecated Use getChannelStatus from @/lib/realtimeClient instead\n */\nexport function getRealtimeStatus(): {\n  enabled: boolean;\n  disabled: boolean;\n  retryCount: number;\n  connectionAttempts: number;\n} {\n  const channelStatus = getChannelStatus();\n  const connectionStatus = getConnectionStatus();\n  \n  return {\n    enabled: REALTIME_ENABLED,\n    disabled: connectionStatus === 'disconnected',\n    retryCount: channelStatus.reconnectAttempts,\n    connectionAttempts: channelStatus.totalChannels,\n  };\n}\n\n// Export the new functions for easy migration\nexport {\n  subscribeToChannel,\n  unsubscribeFromChannel,\n  cleanupAllChannels,\n  getChannelStatus,\n  isChannelActive,\n  resetConnectionState,\n  getConnectionStatus\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\integrations\\supabase\\types.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":553,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":553,"endColumn":9,"suggestions":[{"messageId":"removeVar","data":{"varName":"_"},"fix":{"range":[15647,15648],"text":""},"desc":"Remove unused variable '_'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":636,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":636,"endColumn":9,"suggestions":[{"messageId":"removeVar","data":{"varName":"_"},"fix":{"range":[18283,18284],"text":""},"desc":"Remove unused variable '_'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export type Json =\n  | string\n  | number\n  | boolean\n  | null\n  | { [key: string]: Json | undefined }\n  | Json[]\n\nexport type Database = {\n  // Allows to automatically instantiate createClient with right options\n  // instead of createClient<Database, { PostgrestVersion: 'XX' }>(URL, KEY)\n  __InternalSupabase: {\n    PostgrestVersion: \"13.0.4\"\n  }\n  public: {\n    Tables: {\n      affiliate_products: {\n        Row: {\n          affiliate_url: string\n          coverage_area: string | null\n          created_at: string\n          description: string | null\n          id: string\n          image_url: string | null\n          is_active: boolean | null\n          name: string\n          price_range: string | null\n          rating: number | null\n          retailer: string\n        }\n        Insert: {\n          affiliate_url: string\n          coverage_area?: string | null\n          created_at?: string\n          description?: string | null\n          id?: string\n          image_url?: string | null\n          is_active?: boolean | null\n          name: string\n          price_range?: string | null\n          rating?: number | null\n          retailer: string\n        }\n        Update: {\n          affiliate_url?: string\n          coverage_area?: string | null\n          created_at?: string\n          description?: string | null\n          id?: string\n          image_url?: string | null\n          is_active?: boolean | null\n          name?: string\n          price_range?: string | null\n          rating?: number | null\n          retailer?: string\n        }\n        Relationships: []\n      }\n      air_quality_readings: {\n        Row: {\n          aqi: number\n          co: number | null\n          created_at: string\n          id: string\n          latitude: number\n          location_name: string | null\n          longitude: number\n          no2: number | null\n          o3: number | null\n          pm10: number | null\n          pm25: number | null\n          so2: number | null\n          timestamp: string\n          user_id: string\n        }\n        Insert: {\n          aqi: number\n          co?: number | null\n          created_at?: string\n          id?: string\n          latitude: number\n          location_name?: string | null\n          longitude: number\n          no2?: number | null\n          o3?: number | null\n          pm10?: number | null\n          pm25?: number | null\n          so2?: number | null\n          timestamp?: string\n          user_id: string\n        }\n        Update: {\n          aqi?: number\n          co?: number | null\n          created_at?: string\n          id?: string\n          latitude?: number\n          location_name?: string | null\n          longitude?: number\n          no2?: number | null\n          o3?: number | null\n          pm10?: number | null\n          pm25?: number | null\n          so2?: number | null\n          timestamp?: string\n          user_id?: string\n        }\n        Relationships: []\n      }\n      pollutant_details: {\n        Row: {\n          created_at: string\n          description: string\n          health_effects: string | null\n          id: string\n          name: string\n          pollutant_code: string\n          safe_levels: string | null\n        }\n        Insert: {\n          created_at?: string\n          description: string\n          health_effects?: string | null\n          id?: string\n          name: string\n          pollutant_code: string\n          safe_levels?: string | null\n        }\n        Update: {\n          created_at?: string\n          description?: string\n          health_effects?: string | null\n          id?: string\n          name?: string\n          pollutant_code?: string\n          safe_levels?: string | null\n        }\n        Relationships: []\n      }\n      profiles: {\n        Row: {\n          avatar_url: string | null\n          created_at: string\n          email: string | null\n          full_name: string | null\n          id: string\n          total_points: number | null\n          updated_at: string\n          user_id: string\n        }\n        Insert: {\n          avatar_url?: string | null\n          created_at?: string\n          email?: string | null\n          full_name?: string | null\n          id?: string\n          total_points?: number | null\n          updated_at?: string\n          user_id: string\n        }\n        Update: {\n          avatar_url?: string | null\n          created_at?: string\n          email?: string | null\n          full_name?: string | null\n          id?: string\n          total_points?: number | null\n          updated_at?: string\n          user_id?: string\n        }\n        Relationships: []\n      }\n      user_points: {\n        Row: {\n          aqi_value: number\n          created_at: string\n          id: string\n          location_name: string | null\n          points_earned: number\n          timestamp: string\n          user_id: string\n        }\n        Insert: {\n          aqi_value: number\n          created_at?: string\n          id?: string\n          location_name?: string | null\n          points_earned: number\n          timestamp?: string\n          user_id: string\n        }\n        Update: {\n          aqi_value?: number\n          created_at?: string\n          id?: string\n          location_name?: string | null\n          points_earned?: number\n          timestamp?: string\n          user_id?: string\n        }\n        Relationships: []\n      }\n      achievements: {\n        Row: {\n          id: string\n          name: string\n          description: string\n          icon: string\n          category: string\n          points_reward: number\n          criteria_type: string\n          criteria_value: number\n          criteria_unit: string | null\n          is_active: boolean\n          created_at: string\n          updated_at: string\n        }\n        Insert: {\n          id?: string\n          name: string\n          description: string\n          icon: string\n          category: string\n          points_reward: number\n          criteria_type: string\n          criteria_value: number\n          criteria_unit?: string | null\n          is_active?: boolean\n          created_at?: string\n          updated_at?: string\n        }\n        Update: {\n          id?: string\n          name?: string\n          description?: string\n          icon?: string\n          category?: string\n          points_reward?: number\n          criteria_type?: string\n          criteria_value?: number\n          criteria_unit?: string | null\n          is_active?: boolean\n          created_at?: string\n          updated_at?: string\n        }\n        Relationships: []\n      }\n      user_achievements: {\n        Row: {\n          id: string\n          user_id: string\n          achievement_id: string\n          progress: number\n          max_progress: number\n          unlocked: boolean\n          unlocked_at: string | null\n          created_at: string\n          updated_at: string\n        }\n        Insert: {\n          id?: string\n          user_id: string\n          achievement_id: string\n          progress?: number\n          max_progress: number\n          unlocked?: boolean\n          unlocked_at?: string | null\n          created_at?: string\n          updated_at?: string\n        }\n        Update: {\n          id?: string\n          user_id?: string\n          achievement_id?: string\n          progress?: number\n          max_progress?: number\n          unlocked?: boolean\n          unlocked_at?: string | null\n          created_at?: string\n          updated_at?: string\n        }\n        Relationships: []\n      }\n      user_streaks: {\n        Row: {\n          id: string\n          user_id: string\n          streak_type: string\n          current_streak: number\n          max_streak: number\n          last_activity_date: string\n          created_at: string\n          updated_at: string\n        }\n        Insert: {\n          id?: string\n          user_id: string\n          streak_type: string\n          current_streak?: number\n          max_streak?: number\n          last_activity_date: string\n          created_at?: string\n          updated_at?: string\n        }\n        Update: {\n          id?: string\n          user_id?: string\n          streak_type?: string\n          current_streak?: number\n          max_streak?: number\n          last_activity_date?: string\n          created_at?: string\n          updated_at?: string\n        }\n        Relationships: []\n      }\n      withdrawal_requests: {\n        Row: {\n          id: string\n          user_id: string\n          amount: number\n          method: string\n          status: string\n          paypal_email: string | null\n          mpesa_phone: string | null\n          notes: string | null\n          processed_at: string | null\n          created_at: string\n          updated_at: string\n        }\n        Insert: {\n          id?: string\n          user_id: string\n          amount: number\n          method: string\n          status?: string\n          paypal_email?: string | null\n          mpesa_phone?: string | null\n          notes?: string | null\n          processed_at?: string | null\n          created_at?: string\n          updated_at?: string\n        }\n        Update: {\n          id?: string\n          user_id?: string\n          amount?: number\n          method?: string\n          status?: string\n          paypal_email?: string | null\n          mpesa_phone?: string | null\n          notes?: string | null\n          processed_at?: string | null\n          created_at?: string\n          updated_at?: string\n        }\n        Relationships: []\n      }\n      notifications: {\n        Row: {\n          id: string\n          user_id: string\n          type: Database[\"public\"][\"Enums\"][\"notification_type\"]\n          priority: Database[\"public\"][\"Enums\"][\"notification_priority\"]\n          title: string\n          message: string\n          data: Json | null\n          read: boolean\n          action_url: string | null\n          expires_at: string | null\n          created_at: string\n          read_at: string | null\n        }\n        Insert: {\n          id?: string\n          user_id: string\n          type: Database[\"public\"][\"Enums\"][\"notification_type\"]\n          priority?: Database[\"public\"][\"Enums\"][\"notification_priority\"]\n          title: string\n          message: string\n          data?: Json | null\n          read?: boolean\n          action_url?: string | null\n          expires_at?: string | null\n          created_at?: string\n          read_at?: string | null\n        }\n        Update: {\n          id?: string\n          user_id?: string\n          type?: Database[\"public\"][\"Enums\"][\"notification_type\"]\n          priority?: Database[\"public\"][\"Enums\"][\"notification_priority\"]\n          title?: string\n          message?: string\n          data?: Json | null\n          read?: boolean\n          action_url?: string | null\n          expires_at?: string | null\n          created_at?: string\n          read_at?: string | null\n        }\n        Relationships: []\n      }\n      notification_preferences: {\n        Row: {\n          id: string\n          user_id: string\n          aqi_alerts: boolean\n          aqi_threshold: number\n          achievement_notifications: boolean\n          points_notifications: boolean\n          withdrawal_notifications: boolean\n          shop_notifications: boolean\n          streak_notifications: boolean\n          daily_reminders: boolean\n          weekly_summaries: boolean\n          system_announcements: boolean\n          maintenance_alerts: boolean\n          email_notifications: boolean\n          push_notifications: boolean\n          created_at: string\n          updated_at: string\n        }\n        Insert: {\n          id?: string\n          user_id: string\n          aqi_alerts?: boolean\n          aqi_threshold?: number\n          achievement_notifications?: boolean\n          points_notifications?: boolean\n          withdrawal_notifications?: boolean\n          shop_notifications?: boolean\n          streak_notifications?: boolean\n          daily_reminders?: boolean\n          weekly_summaries?: boolean\n          system_announcements?: boolean\n          maintenance_alerts?: boolean\n          email_notifications?: boolean\n          push_notifications?: boolean\n          created_at?: string\n          updated_at?: string\n        }\n        Update: {\n          id?: string\n          user_id?: string\n          aqi_alerts?: boolean\n          aqi_threshold?: number\n          achievement_notifications?: boolean\n          points_notifications?: boolean\n          withdrawal_notifications?: boolean\n          shop_notifications?: boolean\n          streak_notifications?: boolean\n          daily_reminders?: boolean\n          weekly_summaries?: boolean\n          system_announcements?: boolean\n          maintenance_alerts?: boolean\n          email_notifications?: boolean\n          push_notifications?: boolean\n          created_at?: string\n          updated_at?: string\n        }\n        Relationships: []\n      }\n      global_environmental_data: {\n        Row: {\n          id: string\n          city_name: string\n          country: string\n          latitude: number\n          longitude: number\n          aqi: number\n          pm25: number | null\n          pm10: number | null\n          no2: number | null\n          so2: number | null\n          co: number | null\n          o3: number | null\n          temperature: number | null\n          humidity: number | null\n          wind_speed: number | null\n          wind_direction: number | null\n          wind_gust: number | null\n          air_pressure: number | null\n          visibility: number | null\n          weather_condition: string | null\n          feels_like_temperature: number | null\n          sunrise_time: string | null\n          sunset_time: string | null\n          data_source: string\n          collection_timestamp: string\n          is_active: boolean\n        }\n        Insert: {\n          id?: string\n          city_name: string\n          country: string\n          latitude: number\n          longitude: number\n          aqi: number\n          pm25?: number | null\n          pm10?: number | null\n          no2?: number | null\n          so2?: number | null\n          co?: number | null\n          o3?: number | null\n          temperature?: number | null\n          humidity?: number | null\n          wind_speed?: number | null\n          wind_direction?: number | null\n          wind_gust?: number | null\n          air_pressure?: number | null\n          visibility?: number | null\n          weather_condition?: string | null\n          feels_like_temperature?: number | null\n          sunrise_time?: string | null\n          sunset_time?: string | null\n          data_source: string\n          collection_timestamp?: string\n          is_active?: boolean\n        }\n        Update: {\n          id?: string\n          city_name?: string\n          country?: string\n          latitude?: number\n          longitude?: number\n          aqi?: number\n          pm25?: number | null\n          pm10?: number | null\n          no2?: number | null\n          so2?: number | null\n          co?: number | null\n          o3?: number | null\n          temperature?: number | null\n          humidity?: number | null\n          wind_speed?: number | null\n          wind_direction?: number | null\n          wind_gust?: number | null\n          air_pressure?: number | null\n          visibility?: number | null\n          weather_condition?: string | null\n          feels_like_temperature?: number | null\n          sunrise_time?: string | null\n          sunset_time?: string | null\n          data_source?: string\n          collection_timestamp?: string\n          is_active?: boolean\n        }\n        Relationships: []\n      }\n    }\n    Views: {\n      [_ in never]: never\n    }\n    Functions: {\n      get_all_active_environmental_data: {\n        Args: Record<string, never>\n        Returns: {\n          id: string\n          city_name: string\n          country: string\n          latitude: number\n          longitude: number\n          aqi: number\n          pm25: number | null\n          pm10: number | null\n          no2: number | null\n          so2: number | null\n          co: number | null\n          o3: number | null\n          temperature: number | null\n          humidity: number | null\n          wind_speed: number | null\n          wind_direction: number | null\n          wind_gust: number | null\n          air_pressure: number | null\n          visibility: number | null\n          weather_condition: string | null\n          feels_like_temperature: number | null\n          sunrise_time: string | null\n          sunset_time: string | null\n          data_source: string\n          collection_timestamp: string\n          is_active: boolean\n        }[]\n      }\n      get_nearest_environmental_data: {\n        Args: {\n          p_latitude: number\n          p_longitude: number\n          p_max_distance_km?: number\n        }\n        Returns: {\n          id: string\n          city_name: string\n          country: string\n          latitude: number\n          longitude: number\n          aqi: number\n          pm25: number | null\n          pm10: number | null\n          no2: number | null\n          so2: number | null\n          co: number | null\n          o3: number | null\n          temperature: number | null\n          humidity: number | null\n          wind_speed: number | null\n          wind_direction: number | null\n          wind_gust: number | null\n          air_pressure: number | null\n          visibility: number | null\n          weather_condition: string | null\n          feels_like_temperature: number | null\n          sunrise_time: string | null\n          sunset_time: string | null\n          data_source: string\n          collection_timestamp: string\n          is_active: boolean\n          distance_km: number\n        }[]\n      }\n      reset_user_achievements_to_locked: {\n        Args: {\n          p_user_id: string\n        }\n        Returns: number\n      }\n    }\n    Enums: {\n      app_role: \"user\" | \"admin\"\n      notification_type: \"aqi_alert\" | \"achievement_unlocked\" | \"points_earned\" | \"withdrawal_approved\" | \"withdrawal_rejected\" | \"shop_new_item\" | \"shop_sale\" | \"streak_milestone\" | \"daily_reminder\" | \"weekly_summary\" | \"system_announcement\" | \"maintenance\" | \"welcome\"\n      notification_priority: \"low\" | \"medium\" | \"high\" | \"urgent\"\n    }\n    CompositeTypes: {\n      [_ in never]: never\n    }\n  }\n}\n\ntype DatabaseWithoutInternals = Omit<Database, \"__InternalSupabase\">\n\ntype DefaultSchema = DatabaseWithoutInternals[Extract<keyof Database, \"public\">]\n\nexport type Tables<\n  DefaultSchemaTableNameOrOptions extends\n    | keyof (DefaultSchema[\"Tables\"] & DefaultSchema[\"Views\"])\n    | { schema: keyof DatabaseWithoutInternals },\n  TableName extends DefaultSchemaTableNameOrOptions extends {\n    schema: keyof DatabaseWithoutInternals\n  }\n    ? keyof (DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions[\"schema\"]][\"Tables\"] &\n        DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions[\"schema\"]][\"Views\"])\n    : never = never,\n> = DefaultSchemaTableNameOrOptions extends {\n  schema: keyof DatabaseWithoutInternals\n}\n  ? (DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions[\"schema\"]][\"Tables\"] &\n      DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions[\"schema\"]][\"Views\"])[TableName] extends {\n      Row: infer R\n    }\n    ? R\n    : never\n  : DefaultSchemaTableNameOrOptions extends keyof (DefaultSchema[\"Tables\"] &\n        DefaultSchema[\"Views\"])\n    ? (DefaultSchema[\"Tables\"] &\n        DefaultSchema[\"Views\"])[DefaultSchemaTableNameOrOptions] extends {\n        Row: infer R\n      }\n      ? R\n      : never\n    : never\n\nexport type TablesInsert<\n  DefaultSchemaTableNameOrOptions extends\n    | keyof DefaultSchema[\"Tables\"]\n    | { schema: keyof DatabaseWithoutInternals },\n  TableName extends DefaultSchemaTableNameOrOptions extends {\n    schema: keyof DatabaseWithoutInternals\n  }\n    ? keyof DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions[\"schema\"]][\"Tables\"]\n    : never = never,\n> = DefaultSchemaTableNameOrOptions extends {\n  schema: keyof DatabaseWithoutInternals\n}\n  ? DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions[\"schema\"]][\"Tables\"][TableName] extends {\n      Insert: infer I\n    }\n    ? I\n    : never\n  : DefaultSchemaTableNameOrOptions extends keyof DefaultSchema[\"Tables\"]\n    ? DefaultSchema[\"Tables\"][DefaultSchemaTableNameOrOptions] extends {\n        Insert: infer I\n      }\n      ? I\n      : never\n    : never\n\nexport type TablesUpdate<\n  DefaultSchemaTableNameOrOptions extends\n    | keyof DefaultSchema[\"Tables\"]\n    | { schema: keyof DatabaseWithoutInternals },\n  TableName extends DefaultSchemaTableNameOrOptions extends {\n    schema: keyof DatabaseWithoutInternals\n  }\n    ? keyof DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions[\"schema\"]][\"Tables\"]\n    : never = never,\n> = DefaultSchemaTableNameOrOptions extends {\n  schema: keyof DatabaseWithoutInternals\n}\n  ? DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions[\"schema\"]][\"Tables\"][TableName] extends {\n      Update: infer U\n    }\n    ? U\n    : never\n  : DefaultSchemaTableNameOrOptions extends keyof DefaultSchema[\"Tables\"]\n    ? DefaultSchema[\"Tables\"][DefaultSchemaTableNameOrOptions] extends {\n        Update: infer U\n      }\n      ? U\n      : never\n    : never\n\nexport type Enums<\n  DefaultSchemaEnumNameOrOptions extends\n    | keyof DefaultSchema[\"Enums\"]\n    | { schema: keyof DatabaseWithoutInternals },\n  EnumName extends DefaultSchemaEnumNameOrOptions extends {\n    schema: keyof DatabaseWithoutInternals\n  }\n    ? keyof DatabaseWithoutInternals[DefaultSchemaEnumNameOrOptions[\"schema\"]][\"Enums\"]\n    : never = never,\n> = DefaultSchemaEnumNameOrOptions extends {\n  schema: keyof DatabaseWithoutInternals\n}\n  ? DatabaseWithoutInternals[DefaultSchemaEnumNameOrOptions[\"schema\"]][\"Enums\"][EnumName]\n  : DefaultSchemaEnumNameOrOptions extends keyof DefaultSchema[\"Enums\"]\n    ? DefaultSchema[\"Enums\"][DefaultSchemaEnumNameOrOptions]\n    : never\n\nexport type CompositeTypes<\n  PublicCompositeTypeNameOrOptions extends\n    | keyof DefaultSchema[\"CompositeTypes\"]\n    | { schema: keyof DatabaseWithoutInternals },\n  CompositeTypeName extends PublicCompositeTypeNameOrOptions extends {\n    schema: keyof DatabaseWithoutInternals\n  }\n    ? keyof DatabaseWithoutInternals[PublicCompositeTypeNameOrOptions[\"schema\"]][\"CompositeTypes\"]\n    : never = never,\n> = PublicCompositeTypeNameOrOptions extends {\n  schema: keyof DatabaseWithoutInternals\n}\n  ? DatabaseWithoutInternals[PublicCompositeTypeNameOrOptions[\"schema\"]][\"CompositeTypes\"][CompositeTypeName]\n  : PublicCompositeTypeNameOrOptions extends keyof DefaultSchema[\"CompositeTypes\"]\n    ? DefaultSchema[\"CompositeTypes\"][PublicCompositeTypeNameOrOptions]\n    : never\n\nexport const Constants = {\n  public: {\n    Enums: {\n      app_role: [\"user\", \"admin\"],\n      notification_type: [\"aqi_alert\", \"achievement_unlocked\", \"points_earned\", \"withdrawal_approved\", \"withdrawal_rejected\", \"shop_new_item\", \"shop_sale\", \"streak_milestone\", \"daily_reminder\", \"weekly_summary\", \"system_announcement\", \"maintenance\", \"welcome\"],\n      notification_priority: [\"low\", \"medium\", \"high\", \"urgent\"],\n    },\n  },\n} as const\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\lib\\airQualityUtils.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'value' is defined but never used.","line":21,"column":48,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":61,"suggestions":[{"messageId":"removeVar","data":{"varName":"value"},"fix":{"range":[717,732],"text":""},"desc":"Remove unused variable 'value'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'value' is defined but never used.","line":21,"column":48,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":53}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Helper functions for AQI display\nexport const getAQIColor = (aqi: number): string => {\n  if (aqi <= 50) return \"text-green-500\";\n  if (aqi <= 100) return \"text-yellow-500\";\n  if (aqi <= 150) return \"text-orange-500\";\n  if (aqi <= 200) return \"text-red-500\";\n  if (aqi <= 300) return \"text-purple-500\";\n  return \"text-red-800\";\n};\n\nexport const getAQILabel = (aqi: number): string => {\n  if (aqi <= 50) return \"Good\";\n  if (aqi <= 100) return \"Moderate\";\n  if (aqi <= 150) return \"Unhealthy for Sensitive Groups\";\n  if (aqi <= 200) return \"Unhealthy\";\n  if (aqi <= 300) return \"Very Unhealthy\";\n  return \"Hazardous\";\n};\n\n// Helper function to get pollutant display info\nexport const getPollutantInfo = (code: string, value: number) => {\n  const pollutantMap: Record<string, { label: string; unit: string; icon?: string }> = {\n    'PM25': { label: \"PM2.5\", unit: \"µg/m³\" },\n    'PM10': { label: \"PM10\", unit: \"µg/m³\" },\n    'PM1': { label: \"PM1\", unit: \"µg/m³\" },\n    'NO2': { label: \"NO₂\", unit: \"µg/m³\" },\n    'SO2': { label: \"SO₂\", unit: \"µg/m³\" },\n    'CO': { label: \"CO\", unit: \"mg/m³\" },\n    'O3': { label: \"O₃\", unit: \"µg/m³\" },\n    'TEMPERATURE': { label: \"Temperature\", unit: \"°C\" },\n    'HUMIDITY': { label: \"Humidity\", unit: \"%\" },\n    'PM003': { label: \"PM0.3\", unit: \"particles/cm³\" }\n  };\n  \n  return pollutantMap[code] || { label: code, unit: \"N/A\" };\n};\n\n// Create pollutant cards data based on available data\nexport const createPollutantCards = (data: { \n  pm25: number; \n  pm10: number; \n  no2: number;\n  so2: number;\n  co: number;\n  o3: number;\n  environmental?: { temperature: number; humidity: number } \n}) => {\n  if (!data) return [];\n  \n  const pollutants = [\n    { code: 'PM25', value: data.pm25, threshold: 12, showIfZero: false },\n    { code: 'PM10', value: data.pm10, threshold: 54, showIfZero: false },\n    { code: 'PM1', value: data.pm25 * 0.7, threshold: 8, showIfZero: false }, // Estimate PM1 from PM2.5\n    { code: 'NO2', value: data.no2, threshold: 53, showIfZero: false },\n    { code: 'SO2', value: data.so2, threshold: 35, showIfZero: false },\n    { code: 'CO', value: data.co, threshold: 4.4, showIfZero: false },\n    { code: 'O3', value: data.o3, threshold: 54, showIfZero: false },\n    { code: 'TEMPERATURE', value: data.environmental?.temperature || null, threshold: null, showIfZero: true },\n    { code: 'HUMIDITY', value: data.environmental?.humidity || null, threshold: null, showIfZero: true },\n    { code: 'PM003', value: data.pm25 * 2, threshold: null, showIfZero: false } // Estimate PM0.3 from PM2.5\n  ];\n  \n  // Filter pollutants based on data availability\n  return pollutants.filter(pollutant => {\n    if (pollutant.showIfZero) {\n      // Only show environmental sensors if they have real data\n      return pollutant.value !== null && pollutant.value !== undefined;\n    }\n    // Only show pollutant sensors if they have meaningful data\n    return pollutant.value > 0;\n  });\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\lib\\channelManager.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":10,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[265,277],"text":""},"desc":"Remove unused variable 'payload'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { RealtimeChannel } from '@supabase/supabase-js';\nimport { supabase } from '@/integrations/supabase/client';\n\n// Channel configuration interface\ninterface ChannelConfig {\n  event?: string;\n  schema?: string;\n  table?: string;\n  filter?: string;\n  callback: (payload: any) => void;\n}\n\n// Channel state tracking\ninterface ChannelState {\n  channel: RealtimeChannel;\n  config: ChannelConfig;\n  isActive: boolean;\n  lastActivity: number;\n  errorCount: number;\n  lastError: number;\n  isCircuitOpen: boolean;\n  circuitOpenTime: number;\n}\n\n// Circuit breaker configuration\ninterface CircuitBreakerConfig {\n  failureThreshold: number;      // Number of failures before opening circuit\n  recoveryTimeout: number;       // Time to wait before attempting recovery\n  monitorInterval: number;       // How often to check circuit state\n}\n\n/**\n * Centralized Channel Manager with Circuit Breaker Pattern\n * Reduces subscription churn and provides robust error handling\n */\nexport class ChannelManager {\n  private static instance: ChannelManager;\n  private channels: Map<string, ChannelState> = new Map();\n  private subscriptionQueue: Array<{ channelName: string; config: ChannelConfig }> = [];\n  private isProcessing: boolean = false;\n  private circuitBreakerConfig: CircuitBreakerConfig;\n  private healthCheckInterval: NodeJS.Timeout | null = null;\n  private isDestroyed: boolean = false;\n\n  private constructor() {\n    this.circuitBreakerConfig = {\n      failureThreshold: 3,        // Open circuit after 3 failures\n      recoveryTimeout: 30000,     // Wait 30 seconds before recovery attempt\n      monitorInterval: 10000      // Check circuit state every 10 seconds\n    };\n\n    this.startHealthMonitoring();\n  }\n\n  public static getInstance(): ChannelManager {\n    if (!ChannelManager.instance) {\n      ChannelManager.instance = new ChannelManager();\n    }\n    return ChannelManager.instance;\n  }\n\n  /**\n   * Subscribe to a channel with batching and circuit breaker protection\n   */\n  public async subscribe(\n    channelName: string, \n    config: ChannelConfig\n  ): Promise<RealtimeChannel | null> {\n    if (this.isDestroyed) {\n      console.warn(`[ChannelManager] Manager destroyed, cannot subscribe to ${channelName}`);\n      return null;\n    }\n\n    // Check if channel already exists and is healthy\n    const existingChannel = this.channels.get(channelName);\n    if (existingChannel && existingChannel.isActive && !existingChannel.isCircuitOpen) {\n      console.log(`[ChannelManager] Channel ${channelName} already exists and healthy, reusing...`);\n      \n      // Update callback if different\n      if (existingChannel.config.callback !== config.callback) {\n        existingChannel.config.callback = config.callback;\n        console.log(`[ChannelManager] Updated callback for ${channelName}`);\n      }\n      \n      return existingChannel.channel;\n    }\n\n    // Check circuit breaker status\n    if (existingChannel?.isCircuitOpen) {\n      const timeSinceCircuitOpen = Date.now() - existingChannel.circuitOpenTime;\n      if (timeSinceCircuitOpen < this.circuitBreakerConfig.recoveryTimeout) {\n        console.warn(`[ChannelManager] Circuit breaker open for ${channelName}, waiting for recovery...`);\n        return null;\n      } else {\n        console.log(`[ChannelManager] Attempting circuit recovery for ${channelName}`);\n        existingChannel.isCircuitOpen = false;\n        existingChannel.errorCount = 0;\n      }\n    }\n\n    // Add to subscription queue for batching\n    this.subscriptionQueue.push({ channelName, config });\n    \n    if (!this.isProcessing) {\n      this.processQueue();\n    }\n\n    // Return existing channel if available, otherwise null\n    return existingChannel?.channel || null;\n  }\n\n  /**\n   * Process subscription queue with batching and rate limiting\n   */\n  private async processQueue(): Promise<void> {\n    if (this.isProcessing || this.subscriptionQueue.length === 0) {\n      return;\n    }\n\n    this.isProcessing = true;\n    console.log(`[ChannelManager] Processing ${this.subscriptionQueue.length} channel subscriptions`);\n\n    while (this.subscriptionQueue.length > 0) {\n      const { channelName, config } = this.subscriptionQueue.shift()!;\n      \n      try {\n        const channel = await this.createChannel(channelName, config);\n        if (channel) {\n          this.channels.set(channelName, {\n            channel,\n            config,\n            isActive: true,\n            lastActivity: Date.now(),\n            errorCount: 0,\n            lastError: 0,\n            isCircuitOpen: false,\n            circuitOpenTime: 0\n          });\n          console.log(`[ChannelManager] Successfully created channel ${channelName}`);\n        }\n        \n        // Add small delay to prevent overwhelming the connection\n        await new Promise(resolve => setTimeout(resolve, 100));\n        \n      } catch (error) {\n        console.error(`[ChannelManager] Failed to create channel ${channelName}:`, error);\n        this.handleChannelError(channelName, error);\n      }\n    }\n\n    this.isProcessing = false;\n    console.log(`[ChannelManager] Queue processing completed`);\n  }\n\n  /**\n   * Create a new channel with proper error handling\n   */\n  private async createChannel(\n    channelName: string, \n    config: ChannelConfig\n  ): Promise<RealtimeChannel | null> {\n    try {\n      console.log(`[ChannelManager] Creating channel ${channelName}`);\n      \n      const channel = supabase.channel(channelName);\n      \n      // Configure postgres changes if config provided\n      if (config.event && config.schema && config.table) {\n        // Fix: Ensure proper postgres_changes configuration with correct binding\n        (channel as any).on(\n          'postgres_changes',\n          {\n            event: config.event,\n            schema: config.schema,\n            table: config.table,\n            filter: config.filter,\n          },\n          (payload: any) => {\n            this.updateChannelActivity(channelName);\n            config.callback(payload);\n          }\n        );\n      } else {\n        // Generic channel for custom events\n        (channel as any).on('*', (event: any, payload: any) => {\n          this.updateChannelActivity(channelName);\n          config.callback(payload);\n        });\n      }\n\n      // Subscribe to the channel\n      const subscription = channel.subscribe((status, error) => {\n        if (status === 'SUBSCRIBED') {\n          console.info(`[ChannelManager] Successfully subscribed to ${channelName}`);\n          this.updateChannelActivity(channelName);\n        } else if (status === 'CHANNEL_ERROR' || status === 'TIMED_OUT') {\n          console.error(`[ChannelManager] Channel ${channelName} subscription error:`, {\n            status,\n            error: error?.message || error,\n            channelName,\n            timestamp: new Date().toISOString()\n          });\n          this.handleChannelError(channelName, error);\n        } else if (status === 'CLOSED') {\n          console.info(`[ChannelManager] Channel ${channelName} closed`);\n          this.markChannelInactive(channelName);\n        }\n      });\n\n      return subscription;\n      \n    } catch (error) {\n      console.error(`[ChannelManager] Error creating channel ${channelName}:`, error);\n      this.handleChannelError(channelName, error);\n      return null;\n    }\n  }\n\n  /**\n   * Handle channel errors with circuit breaker pattern\n   */\n  private handleChannelError(channelName: string, error: any): void {\n    const channelState = this.channels.get(channelName);\n    if (!channelState) return;\n\n    const now = Date.now();\n    channelState.lastError = now;\n    channelState.errorCount++;\n\n    console.error(`[ChannelManager] Channel ${channelName} error (${channelState.errorCount}/${this.circuitBreakerConfig.failureThreshold}):`, {\n      error: error?.message || error,\n      channelName,\n      timestamp: new Date().toISOString(),\n      errorCount: channelState.errorCount\n    });\n\n    // Check if circuit should be opened\n    if (channelState.errorCount >= this.circuitBreakerConfig.failureThreshold) {\n      channelState.isCircuitOpen = true;\n      channelState.circuitOpenTime = now;\n      channelState.isActive = false;\n      \n      console.warn(`[ChannelManager] Circuit breaker opened for ${channelName} due to ${channelState.errorCount} consecutive failures`);\n      \n      // Attempt to close circuit after recovery timeout\n      setTimeout(() => {\n        if (this.channels.has(channelName)) {\n          const state = this.channels.get(channelName)!;\n          if (state.isCircuitOpen) {\n            console.log(`[ChannelManager] Attempting to close circuit for ${channelName}`);\n            state.isCircuitOpen = false;\n            state.errorCount = 0;\n          }\n        }\n      }, this.circuitBreakerConfig.recoveryTimeout);\n    }\n  }\n\n  /**\n   * Update channel activity timestamp\n   */\n  private updateChannelActivity(channelName: string): void {\n    const channelState = this.channels.get(channelName);\n    if (channelState) {\n      channelState.lastActivity = Date.now();\n      channelState.isActive = true;\n    }\n  }\n\n  /**\n   * Mark channel as inactive\n   */\n  private markChannelInactive(channelName: string): void {\n    const channelState = this.channels.get(channelName);\n    if (channelState) {\n      channelState.isActive = false;\n    }\n  }\n\n  /**\n   * Unsubscribe from a channel\n   */\n  public unsubscribe(channelName: string): void {\n    if (this.isDestroyed) return;\n\n    const channelState = this.channels.get(channelName);\n    if (!channelState) return;\n\n    try {\n      console.log(`[ChannelManager] Unsubscribing from ${channelName}`);\n      \n      if (channelState.channel) {\n        // Use the proper Supabase method instead of unsubscribe()\n        supabase.removeChannel(channelState.channel);\n      }\n      this.channels.delete(channelName);\n      \n      console.log(`[ChannelManager] Successfully unsubscribed from ${channelName}`);\n      \n    } catch (error) {\n      console.error(`[ChannelManager] Error unsubscribing from ${channelName}:`, error);\n      // Force remove from tracking even if Supabase removal fails\n      this.channels.delete(channelName);\n    }\n  }\n\n  /**\n   * Get channel status information\n   */\n  public getChannelStatus(channelName: string): {\n    exists: boolean;\n    isActive: boolean;\n    isCircuitOpen: boolean;\n    errorCount: number;\n    lastActivity: number;\n    lastError: number;\n  } | null {\n    const channelState = this.channels.get(channelName);\n    if (!channelState) return null;\n\n    return {\n      exists: true,\n      isActive: channelState.isActive,\n      isCircuitOpen: channelState.isCircuitOpen,\n      errorCount: channelState.errorCount,\n      lastActivity: channelState.lastActivity,\n      lastError: channelState.lastError\n    };\n  }\n\n  /**\n   * Get overall manager status\n   */\n  public getStatus(): {\n    totalChannels: number;\n    activeChannels: number;\n    openCircuits: number;\n    queueLength: number;\n    isProcessing: boolean;\n  } {\n    let activeChannels = 0;\n    let openCircuits = 0;\n\n    for (const channelState of this.channels.values()) {\n      if (channelState.isActive) activeChannels++;\n      if (channelState.isCircuitOpen) openCircuits++;\n    }\n\n    return {\n      totalChannels: this.channels.size,\n      activeChannels,\n      openCircuits,\n      queueLength: this.subscriptionQueue.length,\n      isProcessing: this.isProcessing\n    };\n  }\n\n  /**\n   * Start health monitoring\n   */\n  private startHealthMonitoring(): void {\n    this.healthCheckInterval = setInterval(() => {\n      if (this.isDestroyed) return;\n\n      const now = Date.now();\n      const staleThreshold = 5 * 60 * 1000; // 5 minutes\n\n      for (const [channelName, channelState] of this.channels.entries()) {\n        // Check for stale channels\n        if (now - channelState.lastActivity > staleThreshold && channelState.isActive) {\n          console.warn(`[ChannelManager] Channel ${channelName} appears stale, checking health...`);\n          this.checkChannelHealth(channelName);\n        }\n      }\n    }, this.circuitBreakerConfig.monitorInterval);\n  }\n\n  /**\n   * Check individual channel health\n   */\n  private checkChannelHealth(channelName: string): void {\n    const channelState = this.channels.get(channelName);\n    if (!channelState) return;\n\n    try {\n      // Try to access a property to check if the channel is still valid\n      if (channelState.channel && typeof channelState.channel.subscribe === 'function') {\n        // Channel appears healthy\n        channelState.lastActivity = Date.now();\n      } else {\n        console.warn(`[ChannelManager] Channel ${channelName} appears unhealthy, will retry on next error`);\n        channelState.isActive = false;\n      }\n    } catch (error) {\n      console.warn(`[ChannelManager] Channel ${channelName} health check failed:`, error);\n      channelState.isActive = false;\n    }\n  }\n\n  /**\n   * Cleanup all channels\n   */\n  public cleanupAllChannels(): void {\n    if (this.isDestroyed) return;\n\n    console.log(`[ChannelManager] Cleaning up ${this.channels.size} channels`);\n    \n    for (const [channelName, channelState] of this.channels.entries()) {\n      try {\n        if (channelState.channel) {\n          // Use the proper Supabase method instead of unsubscribe()\n          supabase.removeChannel(channelState.channel);\n        }\n        console.log(`[ChannelManager] Removed channel ${channelName}`);\n      } catch (error) {\n        console.error(`[ChannelManager] Error cleaning up channel ${channelName}:`, error);\n      }\n    }\n    \n    this.channels.clear();\n    this.subscriptionQueue = [];\n    this.isProcessing = false;\n    \n    console.log('[ChannelManager] All channels cleaned up');\n  }\n\n  /**\n   * Destroy the manager\n   */\n  public destroy(): void {\n    if (this.isDestroyed) return;\n\n    console.log('[ChannelManager] Destroying channel manager');\n    this.isDestroyed = true;\n    \n    if (this.healthCheckInterval) {\n      clearInterval(this.healthCheckInterval);\n      this.healthCheckInterval = null;\n    }\n    \n    this.cleanupAllChannels();\n    \n    // Reset instance to allow recreation if needed\n    ChannelManager.instance = null as any;\n  }\n\n  /**\n   * Reset the manager state\n   */\n  public reset(): void {\n    if (this.isDestroyed) return;\n\n    console.log('[ChannelManager] Resetting channel manager');\n    this.cleanupAllChannels();\n  }\n}\n\n// Export singleton instance\nlet channelManager: ChannelManager | null = null;\n\nexport function getChannelManager(): ChannelManager {\n  if (!channelManager) {\n    channelManager = ChannelManager.getInstance();\n  }\n  return channelManager;\n}\n\n// Export convenience functions\nexport function subscribeToChannel(\n  channelName: string, \n  config: ChannelConfig\n): Promise<RealtimeChannel | null> {\n  return getChannelManager().subscribe(channelName, config);\n}\n\nexport function unsubscribeFromChannel(channelName: string): void {\n  getChannelManager().unsubscribe(channelName);\n}\n\nexport function getChannelStatus(channelName: string) {\n  return getChannelManager().getChannelStatus(channelName);\n}\n\nexport function getManagerStatus() {\n  return getChannelManager().getStatus();\n}\n\nexport function cleanupAllChannels(): void {\n  getChannelManager().cleanupAllChannels();\n}\n\nexport function destroyChannelManager(): void {\n  if (channelManager) {\n    channelManager.destroy();\n    channelManager = null;\n  }\n}\n\nexport function resetChannelManager(): void {\n  if (channelManager) {\n    channelManager.reset();\n  }\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\lib\\connectionManager.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":28,"column":68,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":80,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[792,804],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'connection' is assigned a value but never used.","line":111,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":111,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"connection"},"fix":{"range":[3223,3296],"text":""},"desc":"Remove unused variable 'connection'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'connection' is assigned a value but never used.","line":111,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":111,"endColumn":27},{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":156,"column":76,"nodeType":"Identifier","messageId":"unusedVar","endLine":156,"endColumn":88,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[4549,4561],"text":""},"desc":"Remove unused variable 'error'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { EventEmitter } from 'events';\nimport { memoryMonitor } from '@/utils/memoryMonitor';\n\nexport interface ConnectionOptions {\n  maxReconnectAttempts?: number;\n  reconnectDelay?: number;\n  maxReconnectDelay?: number;\n  timeout?: number;\n  debug?: boolean;\n}\n\nexport interface ConnectionStatus {\n  isConnected: boolean;\n  lastActivity: number;\n  reconnectAttempts: number;\n  lastError?: Error;\n}\n\nexport class ConnectionManager extends EventEmitter {\n  private static instance: ConnectionManager;\n  \n  private connections: Map<string, {\n    ws: WebSocket | null;\n    status: ConnectionStatus;\n    options: Required<ConnectionOptions>;\n    reconnectTimeout: NodeJS.Timeout | null;\n    pingInterval: NodeJS.Timeout | null;\n    messageQueue: Array<{ data: any; resolve: () => void; reject: (error: Error) => void }>;\n  }> = new Map();\n  \n  private defaultOptions: Required<ConnectionOptions> = {\n    maxReconnectAttempts: 5,\n    reconnectDelay: 1000,\n    maxReconnectDelay: 30000,\n    timeout: 10000,\n    debug: process.env.NODE_ENV === 'development',\n  };\n  \n  private constructor() {\n    super();\n    this.setupGlobalHandlers();\n  }\n  \n  static getInstance(): ConnectionManager {\n    if (!ConnectionManager.instance) {\n      ConnectionManager.instance = new ConnectionManager();\n    }\n    return ConnectionManager.instance;\n  }\n  \n  private setupGlobalHandlers() {\n    // Clean up on page unload\n    if (typeof window !== 'undefined') {\n      window.addEventListener('beforeunload', () => this.cleanupAll());\n    }\n    \n    // Monitor memory usage\n    memoryMonitor.addListener((usage) => {\n      if (usage.percentUsed > 90) {\n        this.log('High memory usage detected, cleaning up idle connections');\n        this.cleanupIdleConnections(5 * 60 * 1000); // 5 minutes\n      }\n    });\n  }\n  \n  private log(...args: any[]) {\n    if (this.defaultOptions.debug) {\n      console.log('[ConnectionManager]', ...args);\n    }\n  }\n  \n  private error(...args: any[]) {\n    console.error('[ConnectionManager]', ...args);\n  }\n  \n  connect(url: string, options: ConnectionOptions = {}): Promise<WebSocket> {\n    const connectionId = this.getConnectionId(url);\n    const existingConnection = this.connections.get(connectionId);\n    \n    if (existingConnection?.ws?.readyState === WebSocket.OPEN) {\n      this.log(`Reusing existing connection to ${url}`);\n      return Promise.resolve(existingConnection.ws);\n    }\n    \n    // Merge options with defaults\n    const mergedOptions: Required<ConnectionOptions> = {\n      ...this.defaultOptions,\n      ...options,\n    };\n    \n    return new Promise((resolve, reject) => {\n      try {\n        this.log(`Connecting to ${url}`);\n        \n        const ws = new WebSocket(url);\n        let isConnected = false;\n        \n        // Setup connection timeout\n        const timeout = setTimeout(() => {\n          if (!isConnected) {\n            this.handleConnectionError(connectionId, new Error(`Connection to ${url} timed out`));\n            reject(new Error('Connection timeout'));\n          }\n        }, mergedOptions.timeout);\n        \n        ws.onopen = () => {\n          clearTimeout(timeout);\n          isConnected = true;\n          this.log(`Connected to ${url}`);\n          \n          const connection = this.setupConnection(connectionId, ws, mergedOptions);\n          this.emit('connect', { url, connectionId });\n          resolve(ws);\n        };\n        \n        ws.onerror = (error) => {\n          clearTimeout(timeout);\n          if (!isConnected) {\n            this.handleConnectionError(connectionId, new Error(`Connection error: ${error}`));\n            reject(new Error('Connection error'));\n          }\n        };\n        \n        ws.onclose = (event) => {\n          clearTimeout(timeout);\n          if (isConnected) {\n            this.handleDisconnect(connectionId, event);\n          }\n        };\n        \n      } catch (error) {\n        this.error(`Failed to create WebSocket connection to ${url}:`, error);\n        reject(error);\n      }\n    });\n  }\n  \n  private setupConnection(\n    connectionId: string,\n    ws: WebSocket,\n    options: Required<ConnectionOptions>\n  ) {\n    // Clean up any existing connection\n    this.disconnect(connectionId);\n    \n    const connection = {\n      ws,\n      status: {\n        isConnected: true,\n        lastActivity: Date.now(),\n        reconnectAttempts: 0,\n      },\n      options,\n      reconnectTimeout: null as NodeJS.Timeout | null,\n      pingInterval: null as NodeJS.Timeout | null,\n      messageQueue: [] as Array<{ data: any; resolve: () => void; reject: (error: Error) => void }>,\n    };\n    \n    // Setup ping/pong for connection health\n    connection.pingInterval = setInterval(() => {\n      if (ws.readyState === WebSocket.OPEN) {\n        try {\n          ws.send(JSON.stringify({ type: 'ping', timestamp: Date.now() }));\n        } catch (error) {\n          this.error('Error sending ping:', error);\n        }\n      }\n    }, 30000); // Send ping every 30 seconds\n    \n    // Update last activity on messages\n    const onMessage = () => {\n      connection.status.lastActivity = Date.now();\n    };\n    \n    ws.addEventListener('message', onMessage);\n    \n    // Store the connection\n    this.connections.set(connectionId, connection);\n    \n    // Process any queued messages\n    this.processMessageQueue(connectionId);\n    \n    return connection;\n  }\n  \n  private handleDisconnect(connectionId: string, event: CloseEvent) {\n    const connection = this.connections.get(connectionId);\n    if (!connection) return;\n    \n    connection.status.isConnected = false;\n    \n    // Clean up\n    if (connection.pingInterval) {\n      clearInterval(connection.pingInterval);\n      connection.pingInterval = null;\n    }\n    \n    this.emit('disconnect', { \n      connectionId, \n      code: event.code,\n      reason: event.reason,\n      wasClean: event.wasClean \n    });\n    \n    // Attempt to reconnect if needed\n    if (connection.status.reconnectAttempts < connection.options.maxReconnectAttempts) {\n      this.attemptReconnect(connectionId);\n    } else {\n      this.emit('reconnect_failed', { connectionId, reason: 'Max reconnection attempts reached' });\n      this.cleanupConnection(connectionId);\n    }\n  }\n  \n  private attemptReconnect(connectionId: string) {\n    const connection = this.connections.get(connectionId);\n    if (!connection) return;\n    \n    connection.status.reconnectAttempts++;\n    \n    // Calculate delay with exponential backoff\n    const delay = Math.min(\n      connection.options.reconnectDelay * Math.pow(2, connection.status.reconnectAttempts - 1),\n      connection.options.maxReconnectDelay\n    );\n    \n    this.log(`Attempting to reconnect to ${connectionId} in ${delay}ms (attempt ${connection.status.reconnectAttempts})`);\n    \n    connection.reconnectTimeout = setTimeout(() => {\n      if (connection.ws?.readyState === WebSocket.CLOSED) {\n        this.connect(connectionId, connection.options).catch(error => {\n          this.error(`Reconnection attempt ${connection.status.reconnectAttempts} failed:`, error);\n        });\n      }\n    }, delay);\n  }\n  \n  private handleConnectionError(connectionId: string, error: Error) {\n    const connection = this.connections.get(connectionId);\n    if (!connection) return;\n    \n    connection.status.lastError = error;\n    this.emit('error', { connectionId, error });\n    \n    if (connection.ws) {\n      connection.ws.close();\n    }\n  }\n  \n  private async processMessageQueue(connectionId: string) {\n    const connection = this.connections.get(connectionId);\n    if (!connection || !connection.ws || connection.ws.readyState !== WebSocket.OPEN) {\n      return;\n    }\n    \n    while (connection.messageQueue.length > 0) {\n      const { data, resolve, reject } = connection.messageQueue[0];\n      \n      try {\n        await this.sendMessage(connection.ws, data);\n        connection.messageQueue.shift();\n        resolve();\n      } catch (error) {\n        reject(error as Error);\n        break; // Stop processing on error\n      }\n    }\n  }\n  \n  private sendMessage(ws: WebSocket, data: any): Promise<void> {\n    return new Promise((resolve, reject) => {\n      try {\n        ws.send(JSON.stringify(data));\n        resolve();\n      } catch (error) {\n        reject(error);\n      }\n    });\n  }\n  \n  send(connectionId: string, data: any): Promise<void> {\n    return new Promise((resolve, reject) => {\n      const connection = this.connections.get(connectionId);\n      \n      if (!connection) {\n        reject(new Error(`No connection found for ${connectionId}`));\n        return;\n      }\n      \n      // Queue the message if not connected\n      if (!connection.status.isConnected || !connection.ws || connection.ws.readyState !== WebSocket.OPEN) {\n        connection.messageQueue.push({ data, resolve, reject });\n        return;\n      }\n      \n      // Send immediately if connected\n      this.sendMessage(connection.ws, data)\n        .then(resolve)\n        .catch(reject);\n    });\n  }\n  \n  disconnect(connectionId: string): void {\n    const connection = this.connections.get(connectionId);\n    if (!connection) return;\n    \n    this.log(`Disconnecting from ${connectionId}`);\n    \n    // Clear any pending reconnection\n    if (connection.reconnectTimeout) {\n      clearTimeout(connection.reconnectTimeout);\n      connection.reconnectTimeout = null;\n    }\n    \n    // Clear ping interval\n    if (connection.pingInterval) {\n      clearInterval(connection.pingInterval);\n      connection.pingInterval = null;\n    }\n    \n    // Close the WebSocket\n    if (connection.ws) {\n      try {\n        connection.ws.close();\n      } catch (error) {\n        this.error('Error closing WebSocket:', error);\n      }\n      connection.ws = null;\n    }\n    \n    // Reject any pending messages\n    for (const { reject } of connection.messageQueue) {\n      reject(new Error('Connection closed'));\n    }\n    \n    this.connections.delete(connectionId);\n    this.emit('disconnect', { connectionId });\n  }\n  \n  getConnectionStatus(connectionId: string): ConnectionStatus | null {\n    const connection = this.connections.get(connectionId);\n    return connection ? { ...connection.status } : null;\n  }\n  \n  cleanupIdleConnections(maxIdleTime: number): void {\n    const now = Date.now();\n    \n    for (const [connectionId, connection] of this.connections.entries()) {\n      const idleTime = now - connection.status.lastActivity;\n      \n      if (idleTime > maxIdleTime) {\n        this.log(`Cleaning up idle connection: ${connectionId} (idle for ${idleTime}ms)`);\n        this.disconnect(connectionId);\n      }\n    }\n  }\n  \n  cleanupAll(): void {\n    for (const connectionId of this.connections.keys()) {\n      this.disconnect(connectionId);\n    }\n    \n    this.connections.clear();\n    this.emit('cleanup');\n  }\n  \n  private getConnectionId(url: string): string {\n    // Normalize URL to use as connection ID\n    try {\n      const parsed = new URL(url);\n      return `${parsed.protocol}//${parsed.host}${parsed.pathname}`.toLowerCase();\n    } catch {\n      return url.toLowerCase();\n    }\n  }\n  \n  private cleanupConnection(connectionId: string): void {\n    const connection = this.connections.get(connectionId);\n    if (!connection) return;\n    \n    if (connection.reconnectTimeout) {\n      clearTimeout(connection.reconnectTimeout);\n    }\n    \n    if (connection.pingInterval) {\n      clearInterval(connection.pingInterval);\n    }\n    \n    if (connection.ws) {\n      try {\n        connection.ws.close();\n      } catch (error) {\n        this.error('Error closing WebSocket during cleanup:', error);\n      }\n    }\n    \n    // Reject all queued messages\n    for (const { reject } of connection.messageQueue) {\n      reject(new Error('Connection cleaned up'));\n    }\n    \n    this.connections.delete(connectionId);\n  }\n}\n\n// Export singleton instance\nexport const connectionManager = ConnectionManager.getInstance();\n\n// Add to window for debugging in development\nif (process.env.NODE_ENV === 'development' && typeof window !== 'undefined') {\n  (window as any).__CONNECTION_MANAGER = connectionManager;\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\lib\\connectionStates.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\lib\\databaseHealthMonitor.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'data' is assigned a value but never used.","line":144,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":144,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[4136,4141],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'data' is assigned a value but never used.","line":144,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":144,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'data' is assigned a value but never used.","line":168,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":168,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[4825,4830],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'data' is assigned a value but never used.","line":168,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":168,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { logConnection } from '@/lib/logger';\nimport { supabase } from '@/integrations/supabase/client';\n\n// Database Health Monitoring System\n// Tracks connection health, performance metrics, and provides early warnings\n\ninterface DatabaseMetrics {\n  connectionLatency: number;\n  queryResponseTime: number;\n  errorRate: number;\n  activeConnections: number;\n  connectionPoolSize: number;\n  lastHealthCheck: number;\n  healthScore: number;\n}\n\ninterface HealthThresholds {\n  maxLatency: number;\n  maxQueryTime: number;\n  maxErrorRate: number;\n  minHealthScore: number;\n  checkInterval: number;\n  warningThreshold: number;\n  criticalThreshold: number;\n}\n\ninterface HealthAlert {\n  id: string;\n  type: 'warning' | 'critical' | 'info';\n  message: string;\n  timestamp: number;\n  metrics: Partial<DatabaseMetrics>;\n  resolved: boolean;\n}\n\nexport class DatabaseHealthMonitor {\n  private static instance: DatabaseHealthMonitor;\n  private metrics: DatabaseMetrics = {\n    connectionLatency: 0,\n    queryResponseTime: 0,\n    errorRate: 0,\n    activeConnections: 0,\n    connectionPoolSize: 0,\n    lastHealthCheck: 0,\n    healthScore: 100\n  };\n\n  private thresholds: HealthThresholds = {\n    maxLatency: 5000,        // 5 seconds\n    maxQueryTime: 10000,     // 10 seconds\n    maxErrorRate: 0.1,       // 10%\n    minHealthScore: 70,      // 70%\n    checkInterval: 30000,    // 30 seconds\n    warningThreshold: 80,    // 80%\n    criticalThreshold: 60    // 60%\n  };\n\n  private alerts: Map<string, HealthAlert> = new Map();\n  private healthCheckInterval: NodeJS.Timeout | null = null;\n  private isMonitoring = false;\n  private connectionHistory: Array<{ timestamp: number; latency: number; success: boolean }> = [];\n  private maxHistorySize = 100;\n\n  private constructor() {\n    this.startMonitoring();\n  }\n\n  static getInstance(): DatabaseHealthMonitor {\n    if (!DatabaseHealthMonitor.instance) {\n      DatabaseHealthMonitor.instance = new DatabaseHealthMonitor();\n    }\n    return DatabaseHealthMonitor.instance;\n  }\n\n  // Start health monitoring\n  private startMonitoring(): void {\n    try {\n      if (this.isMonitoring) return;\n\n      this.isMonitoring = true;\n      this.healthCheckInterval = setInterval(() => {\n        this.performHealthCheck();\n      }, this.thresholds.checkInterval);\n\n      logConnection.info('DatabaseHealthMonitor: Health monitoring started');\n    } catch (error) {\n      logConnection.error('DatabaseHealthMonitor: Failed to start monitoring:', error);\n    }\n  }\n\n  // Stop health monitoring\n  stopMonitoring(): void {\n    try {\n      if (this.healthCheckInterval) {\n        clearInterval(this.healthCheckInterval);\n        this.healthCheckInterval = null;\n      }\n      this.isMonitoring = false;\n      logConnection.info('DatabaseHealthMonitor: Health monitoring stopped');\n    } catch (error) {\n      logConnection.error('DatabaseHealthMonitor: Failed to stop monitoring:', error);\n    }\n  }\n\n  // Perform comprehensive health check\n  private async performHealthCheck(): Promise<void> {\n    try {\n      const startTime = Date.now();\n      \n      // Test database connection\n      const connectionResult = await this.testConnection();\n      \n      // Test query performance\n      const queryResult = await this.testQueryPerformance();\n      \n      // Update metrics\n      this.updateMetrics(connectionResult, queryResult);\n      \n      // Calculate health score\n      this.calculateHealthScore();\n      \n      // Check for alerts\n      this.checkAlerts();\n      \n      // Log health status\n      this.logHealthStatus();\n      \n      this.metrics.lastHealthCheck = Date.now();\n      \n      const checkDuration = Date.now() - startTime;\n      logConnection.debug(`DatabaseHealthMonitor: Health check completed in ${checkDuration}ms`);\n    } catch (error) {\n      logConnection.error('DatabaseHealthMonitor: Health check failed:', error);\n      this.metrics.healthScore = 0;\n    }\n  }\n\n  // Test database connection\n  private async testConnection(): Promise<{ success: boolean; latency: number; error?: any }> {\n    try {\n      const startTime = Date.now();\n      \n      // Simple connection test - select 1\n      const { data, error } = await supabase\n        .from('profiles')\n        .select('count')\n        .limit(1);\n      \n      const latency = Date.now() - startTime;\n      \n      if (error) {\n        return { success: false, latency, error };\n      }\n      \n      return { success: true, latency };\n    } catch (error) {\n      const latency = Date.now() - Date.now(); // 0 latency for failed connections\n      return { success: false, latency, error };\n    }\n  }\n\n  // Test query performance\n  private async testQueryPerformance(): Promise<{ success: boolean; responseTime: number; error?: any }> {\n    try {\n      const startTime = Date.now();\n      \n      // Test a more complex query\n      const { data, error } = await supabase\n        .from('air_quality_readings')\n        .select('id, aqi_value, timestamp')\n        .order('timestamp', { ascending: false })\n        .limit(10);\n      \n      const responseTime = Date.now() - startTime;\n      \n      if (error) {\n        return { success: false, responseTime, error };\n      }\n      \n      return { success: true, responseTime };\n    } catch (error) {\n      const responseTime = Date.now() - Date.now(); // 0 response time for failed queries\n      return { success: false, responseTime, error };\n    }\n  }\n\n  // Update metrics based on health check results\n  private updateMetrics(connectionResult: any, queryResult: any): void {\n    try {\n      // Update connection latency\n      if (connectionResult.success) {\n        this.metrics.connectionLatency = connectionResult.latency;\n        this.addToHistory(connectionResult.latency, true);\n      } else {\n        this.addToHistory(0, false);\n      }\n\n      // Update query response time\n      if (queryResult.success) {\n        this.metrics.queryResponseTime = queryResult.responseTime;\n      }\n\n      // Calculate error rate from history\n      this.calculateErrorRate();\n\n      // Update connection pool info (simulated)\n      this.metrics.connectionPoolSize = 10; // Simulated pool size\n      this.metrics.activeConnections = Math.floor(Math.random() * 5) + 1; // Simulated active connections\n    } catch (error) {\n      logConnection.error('DatabaseHealthMonitor: Failed to update metrics:', error);\n    }\n  }\n\n  // Add connection result to history\n  private addToHistory(latency: number, success: boolean): void {\n    try {\n      this.connectionHistory.push({\n        timestamp: Date.now(),\n        latency,\n        success\n      });\n\n      // Keep history size manageable\n      if (this.connectionHistory.length > this.maxHistorySize) {\n        this.connectionHistory.shift();\n      }\n    } catch (error) {\n      logConnection.error('DatabaseHealthMonitor: Failed to add to history:', error);\n    }\n  }\n\n  // Calculate error rate from history\n  private calculateErrorRate(): void {\n    try {\n      if (this.connectionHistory.length === 0) {\n        this.metrics.errorRate = 0;\n        return;\n      }\n\n      const recentHistory = this.connectionHistory.filter(\n        entry => Date.now() - entry.timestamp < 5 * 60 * 1000 // Last 5 minutes\n      );\n\n      if (recentHistory.length === 0) {\n        this.metrics.errorRate = 0;\n        return;\n      }\n\n      const failedConnections = recentHistory.filter(entry => !entry.success).length;\n      this.metrics.errorRate = failedConnections / recentHistory.length;\n    } catch (error) {\n      logConnection.error('DatabaseHealthMonitor: Failed to calculate error rate:', error);\n    }\n  }\n\n  // Calculate overall health score\n  private calculateHealthScore(): void {\n    try {\n      let score = 100;\n\n      // Deduct points for high latency\n      if (this.metrics.connectionLatency > this.thresholds.maxLatency) {\n        const latencyPenalty = Math.min(30, (this.metrics.connectionLatency - this.thresholds.maxLatency) / 1000 * 10);\n        score -= latencyPenalty;\n      }\n\n      // Deduct points for slow queries\n      if (this.metrics.queryResponseTime > this.thresholds.maxQueryTime) {\n        const queryPenalty = Math.min(25, (this.metrics.queryResponseTime - this.thresholds.maxQueryTime) / 1000 * 5);\n        score -= queryPenalty;\n      }\n\n      // Deduct points for high error rate\n      if (this.metrics.errorRate > this.thresholds.maxErrorRate) {\n        const errorPenalty = Math.min(40, this.metrics.errorRate * 100);\n        score -= errorPenalty;\n      }\n\n      // Ensure score is within bounds\n      this.metrics.healthScore = Math.max(0, Math.min(100, score));\n    } catch (error) {\n      logConnection.error('DatabaseHealthMonitor: Failed to calculate health score:', error);\n    }\n  }\n\n  // Check for health alerts\n  private checkAlerts(): void {\n    try {\n      const alerts: HealthAlert[] = [];\n\n      // Check for critical health score\n      if (this.metrics.healthScore <= this.thresholds.criticalThreshold) {\n        alerts.push({\n          id: `critical_health_${Date.now()}`,\n          type: 'critical',\n          message: `Database health is critical: ${this.metrics.healthScore.toFixed(1)}%`,\n          timestamp: Date.now(),\n          metrics: { healthScore: this.metrics.healthScore },\n          resolved: false\n        });\n      }\n\n      // Check for warning health score\n      if (this.metrics.healthScore <= this.thresholds.warningThreshold && \n          this.metrics.healthScore > this.thresholds.criticalThreshold) {\n        alerts.push({\n          id: `warning_health_${Date.now()}`,\n          type: 'warning',\n          message: `Database health is degraded: ${this.metrics.healthScore.toFixed(1)}%`,\n          timestamp: Date.now(),\n          metrics: { healthScore: this.metrics.healthScore },\n          resolved: false\n        });\n      }\n\n      // Check for high latency\n      if (this.metrics.connectionLatency > this.thresholds.maxLatency) {\n        alerts.push({\n          id: `high_latency_${Date.now()}`,\n          type: 'warning',\n          message: `High connection latency: ${this.metrics.connectionLatency}ms`,\n          timestamp: Date.now(),\n          metrics: { connectionLatency: this.metrics.connectionLatency },\n          resolved: false\n        });\n      }\n\n      // Check for high error rate\n      if (this.metrics.errorRate > this.thresholds.maxErrorRate) {\n        alerts.push({\n          id: `high_error_rate_${Date.now()}`,\n          type: 'warning',\n          message: `High error rate: ${(this.metrics.errorRate * 100).toFixed(1)}%`,\n          timestamp: Date.now(),\n          metrics: { errorRate: this.metrics.errorRate },\n          resolved: false\n        });\n      }\n\n      // Add new alerts\n      alerts.forEach(alert => {\n        if (!this.alerts.has(alert.id)) {\n          this.alerts.set(alert.id, alert);\n          this.logAlert(alert);\n        }\n      });\n\n      // Resolve old alerts if conditions improved\n      this.resolveOldAlerts();\n    } catch (error) {\n      logConnection.error('DatabaseHealthMonitor: Failed to check alerts:', error);\n    }\n  }\n\n  // Log health alert\n  private logAlert(alert: HealthAlert): void {\n    try {\n      switch (alert.type) {\n        case 'critical':\n          logConnection.error(`DatabaseHealthMonitor: ${alert.message}`, alert.metrics);\n          break;\n        case 'warning':\n          logConnection.warn(`DatabaseHealthMonitor: ${alert.message}`, alert.metrics);\n          break;\n        case 'info':\n          logConnection.info(`DatabaseHealthMonitor: ${alert.message}`, alert.metrics);\n          break;\n      }\n    } catch (error) {\n      logConnection.error('DatabaseHealthMonitor: Failed to log alert:', error);\n    }\n  }\n\n  // Resolve old alerts when conditions improve\n  private resolveOldAlerts(): void {\n    try {\n      const now = Date.now();\n      const resolvedAlerts: string[] = [];\n\n      for (const [id, alert] of this.alerts) {\n        if (alert.resolved) continue;\n\n        let shouldResolve = false;\n\n        // Resolve health score alerts if improved\n        if (alert.message.includes('health') && this.metrics.healthScore > this.thresholds.warningThreshold) {\n          shouldResolve = true;\n        }\n\n        // Resolve latency alerts if improved\n        if (alert.message.includes('latency') && this.metrics.connectionLatency <= this.thresholds.maxLatency) {\n          shouldResolve = true;\n        }\n\n        // Resolve error rate alerts if improved\n        if (alert.message.includes('error rate') && this.metrics.errorRate <= this.thresholds.maxErrorRate) {\n          shouldResolve = true;\n        }\n\n        // Resolve old alerts (older than 5 minutes)\n        if (now - alert.timestamp > 5 * 60 * 1000) {\n          shouldResolve = true;\n        }\n\n        if (shouldResolve) {\n          alert.resolved = true;\n          resolvedAlerts.push(id);\n          logConnection.info(`DatabaseHealthMonitor: Alert resolved: ${alert.message}`);\n        }\n      }\n\n      // Clean up resolved alerts\n      resolvedAlerts.forEach(id => {\n        this.alerts.delete(id);\n      });\n    } catch (error) {\n      logConnection.error('DatabaseHealthMonitor: Failed to resolve old alerts:', error);\n    }\n  }\n\n  // Log health status\n  private logHealthStatus(): void {\n    try {\n      const status = this.getHealthStatus();\n      \n      if (status === 'healthy') {\n        logConnection.debug('DatabaseHealthMonitor: Database health is good', this.metrics);\n      } else if (status === 'degraded') {\n        logConnection.warn('DatabaseHealthMonitor: Database health is degraded', this.metrics);\n      } else {\n        logConnection.error('DatabaseHealthMonitor: Database health is critical', this.metrics);\n      }\n    } catch (error) {\n      logConnection.error('DatabaseHealthMonitor: Failed to log health status:', error);\n    }\n  }\n\n  // Get current health status\n  getHealthStatus(): 'healthy' | 'degraded' | 'critical' {\n    if (this.metrics.healthScore <= this.thresholds.criticalThreshold) {\n      return 'critical';\n    } else if (this.metrics.healthScore <= this.thresholds.warningThreshold) {\n      return 'degraded';\n    } else {\n      return 'healthy';\n    }\n  }\n\n  // Get current metrics\n  getMetrics(): DatabaseMetrics {\n    return { ...this.metrics };\n  }\n\n  // Get active alerts\n  getActiveAlerts(): HealthAlert[] {\n    return Array.from(this.alerts.values()).filter(alert => !alert.resolved);\n  }\n\n  // Get health summary\n  getHealthSummary(): {\n    status: 'healthy' | 'degraded' | 'critical';\n    score: number;\n    alerts: number;\n    lastCheck: number;\n    recommendations: string[];\n  } {\n    const status = this.getHealthStatus();\n    const activeAlerts = this.getActiveAlerts();\n    const recommendations: string[] = [];\n\n    // Generate recommendations based on metrics\n    if (this.metrics.connectionLatency > this.thresholds.maxLatency) {\n      recommendations.push('Consider optimizing database queries or increasing connection pool size');\n    }\n\n    if (this.metrics.errorRate > this.thresholds.maxErrorRate) {\n      recommendations.push('Investigate connection failures and network issues');\n    }\n\n    if (this.metrics.healthScore < this.thresholds.minHealthScore) {\n      recommendations.push('Database performance needs immediate attention');\n    }\n\n    return {\n      status,\n      score: this.metrics.healthScore,\n      alerts: activeAlerts.length,\n      lastCheck: this.metrics.lastHealthCheck,\n      recommendations\n    };\n  }\n\n  // Configure thresholds\n  configureThresholds(newThresholds: Partial<HealthThresholds>): void {\n    try {\n      this.thresholds = { ...this.thresholds, ...newThresholds };\n      logConnection.info('DatabaseHealthMonitor: Thresholds updated', this.thresholds);\n    } catch (error) {\n      logConnection.error('DatabaseHealthMonitor: Failed to configure thresholds:', error);\n    }\n  }\n\n  // Force health check\n  async forceHealthCheck(): Promise<void> {\n    try {\n      logConnection.info('DatabaseHealthMonitor: Forcing health check...');\n      await this.performHealthCheck();\n    } catch (error) {\n      logConnection.error('DatabaseHealthMonitor: Forced health check failed:', error);\n    }\n  }\n\n  // Clear all alerts\n  clearAlerts(): void {\n    try {\n      this.alerts.clear();\n      logConnection.info('DatabaseHealthMonitor: All alerts cleared');\n    } catch (error) {\n      logConnection.error('DatabaseHealthMonitor: Failed to clear alerts:', error);\n    }\n  }\n\n  // Destroy the monitor\n  destroy(): void {\n    try {\n      this.stopMonitoring();\n      this.alerts.clear();\n      this.connectionHistory.length = 0;\n      DatabaseHealthMonitor.instance = null as any;\n      logConnection.info('DatabaseHealthMonitor: Destroyed');\n    } catch (error) {\n      logConnection.error('DatabaseHealthMonitor: Failed to destroy:', error);\n    }\n  }\n}\n\n// Export singleton instance\nexport const databaseHealthMonitor = DatabaseHealthMonitor.getInstance();\n\n// Utility functions\nexport const getDatabaseHealth = () => databaseHealthMonitor.getHealthStatus();\nexport const getDatabaseMetrics = () => databaseHealthMonitor.getMetrics();\nexport const getDatabaseAlerts = () => databaseHealthMonitor.getActiveAlerts();\nexport const getDatabaseSummary = () => databaseHealthMonitor.getHealthSummary();\nexport const forceDatabaseHealthCheck = () => databaseHealthMonitor.forceHealthCheck();\nexport const configureDatabaseThresholds = (thresholds: Partial<HealthThresholds>) => \n  databaseHealthMonitor.configureThresholds(thresholds);\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\lib\\formatters.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\lib\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\lib\\logger.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\lib\\lru.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\lib\\memoryManager.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\lib\\performanceMonitor.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\lib\\realtimeClient.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":67,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":67,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[2076,2088],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'status' is defined but never used.","line":75,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":75,"endColumn":86,"suggestions":[{"messageId":"removeVar","data":{"varName":"status"},"fix":{"range":[2439,2492],"text":""},"desc":"Remove unused variable 'status'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'channel' is defined but never used.","line":78,"column":53,"nodeType":"Identifier","messageId":"unusedVar","endLine":78,"endColumn":84,"suggestions":[{"messageId":"removeVar","data":{"varName":"channel"},"fix":{"range":[2733,2764],"text":""},"desc":"Remove unused variable 'channel'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":469,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":469,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[17536,17548],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":618,"column":72,"nodeType":"Identifier","messageId":"unusedVar","endLine":618,"endColumn":84,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[23408,23420],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'subscription' is assigned a value but never used.","line":869,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":869,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"subscription"},"fix":{"range":[33041,33861],"text":""},"desc":"Remove unused variable 'subscription'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'subscription' is assigned a value but never used.","line":869,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":869,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":964,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":964,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[36473,36485],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":1081,"column":66,"nodeType":"Identifier","messageId":"unusedVar","endLine":1081,"endColumn":78,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[40565,40577],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'status' is defined but never used.","line":1198,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":1198,"endColumn":92,"suggestions":[{"messageId":"removeVar","data":{"varName":"status"},"fix":{"range":[44542,44595],"text":""},"desc":"Remove unused variable 'status'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'channel' is defined but never used.","line":1264,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":1264,"endColumn":48,"suggestions":[{"messageId":"removeVar","data":{"varName":"channel"},"fix":{"range":[46487,46518],"text":""},"desc":"Remove unused variable 'channel'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":1403,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":1403,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[51040,51052],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'payload' is defined but never used.","line":1414,"column":73,"nodeType":"Identifier","messageId":"unusedVar","endLine":1414,"endColumn":85,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[51321,51333],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'status' is defined but never used.","line":1446,"column":56,"nodeType":"Identifier","messageId":"unusedVar","endLine":1446,"endColumn":109,"suggestions":[{"messageId":"removeVar","data":{"varName":"status"},"fix":{"range":[52338,52391],"text":""},"desc":"Remove unused variable 'status'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":14,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { RealtimeChannel } from '@supabase/supabase-js';\nimport { supabase } from '@/integrations/supabase/client';\nimport { logConnection } from '@/lib/logger';\n\n// Environment flag to disable realtime entirely\nconst REALTIME_ENABLED = (import.meta.env['VITE_SUPABASE_REALTIME_ENABLED'] ?? 'true') !== 'false';\n\n// IMPROVED RETRY CONFIGURATION\nconst MAX_RETRY_ATTEMPTS = 5; // Increased from 3\nconst BASE_RETRY_DELAY = 1000; // 1 second\nconst MAX_RETRY_DELAY = 60000; // 60 seconds (increased from 30)\n\n// WebSocket-specific error handling configuration\nconst WEBSOCKET_ERROR_CONFIG = {\n  // Code 1011 = \"Internal Server Error\" - server terminating connections\n  CODE_1011: {\n    maxRetries: 3,\n    baseDelay: 2000, // Start with 2 seconds for server errors\n    maxDelay: 30000, // Cap at 30 seconds\n    backoffFactor: 2.5, // More aggressive backoff for server errors\n    jitter: true,\n    requireTokenRefresh: true // Always refresh token before retry\n  },\n  // Code 1005 = \"No Status\" - connection issues\n  CODE_1005: {\n    maxRetries: 5,\n    baseDelay: 1000,\n    maxDelay: 60000,\n    backoffFactor: 2,\n    jitter: true,\n    requireTokenRefresh: false\n  },\n  // Code 1006 = \"Abnormal Closure\" - network issues\n  CODE_1006: {\n    maxRetries: 4,\n    baseDelay: 1500,\n    maxDelay: 45000,\n    backoffFactor: 2.2,\n    jitter: true,\n    requireTokenRefresh: false\n  },\n  // Default configuration\n  DEFAULT: {\n    maxRetries: 3,\n    baseDelay: 1000,\n    maxDelay: 30000,\n    backoffFactor: 2,\n    jitter: true,\n    requireTokenRefresh: false\n  }\n} as const;\n\n// Connection pooling and rate limiting\nconst CONNECTION_POOL_CONFIG = {\n  maxConcurrentConnections: 3,\n  connectionCooldown: 5000, // 5 seconds between connection attempts\n  maxRetriesPerMinute: 10,\n  retryWindowMs: 60000 // 1 minute window\n} as const;\n\n// Singleton connection manager with improved WebSocket handling\nclass RealtimeConnectionManager {\n  private static instance: RealtimeConnectionManager;\n  private activeChannels: Map<string, { \n    channel: RealtimeChannel; \n    refs: number; \n    callbacks: Set<(payload: any) => void>;\n    retryCount: number;\n    lastRetryTime: number;\n    isReconnecting: boolean;\n    connectionHealth: 'healthy' | 'unhealthy' | 'unknown';\n    config: any; // Add config property for channel recovery\n  }> = new Map();\n  private connectionStatus: 'connected' | 'reconnecting' | 'disconnected' = 'connected';\n  private statusListeners: Set<(status: 'connected' | 'reconnecting' | 'disconnected') => void> = new Set();\n  private pendingCleanups: Map<string, NodeJS.Timeout> = new Map(); // Track pending cleanups\n  private pendingReadyChecks: Map<string, NodeJS.Timeout> = new Map();\n  private pendingReadyResolvers: Map<string, Array<(channel: RealtimeChannel | null) => void>> = new Map();\n  private isDestroyed: boolean = false; // Track if manager is destroyed\n  private navigationState: { currentView: string; lastViewChange: number } = { currentView: 'dashboard', lastViewChange: Date.now() }; // Track navigation state\n  private globalRetryTimeout: NodeJS.Timeout | null = null; // Global retry mechanism\n\n  private constructor() {\n    // Start with connected status\n    this.setConnectionStatus('connected');\n    \n    // Listen for view changes to prevent duplicate subscriptions during navigation\n    if (typeof window !== 'undefined') {\n      window.addEventListener('viewChange', (event: any) => {\n        const newView = event.detail?.view;\n        if (newView && newView !== this.navigationState.currentView) {\n          this.navigationState.currentView = newView;\n          this.navigationState.lastViewChange = Date.now();\n          console.log(`[Realtime] View changed to: ${newView}, preventing duplicate subscriptions for 2 seconds`);\n        }\n      });\n\n      // Add connection health check with improved WebSocket monitoring\n      this.startConnectionHealthCheck();\n      \n      // Add global connection recovery mechanism\n      this.startGlobalConnectionRecovery();\n      \n      // Add WebSocket reconnection mechanism for code 1011\n      this.startWebSocketReconnection();\n    }\n  }\n\n  private isRealtimeClientReady(): boolean {\n    if (this.isDestroyed || !REALTIME_ENABLED) {\n      return false;\n    }\n\n    try {\n      const hasChannelFactory = typeof (supabase as any)?.channel === 'function';\n      const hasRealtimeInstance = typeof (supabase as any)?.realtime === 'object';\n      return hasChannelFactory && hasRealtimeInstance;\n    } catch (error) {\n      console.warn('[Realtime] Supabase realtime not ready yet:', error);\n      return false;\n    }\n  }\n\n  // Start global connection recovery mechanism\n  private startGlobalConnectionRecovery(): void {\n    setInterval(() => {\n      if (this.isDestroyed) return;\n      \n      // Check if we have unhealthy channels that need recovery\n      let hasUnhealthyChannels = false;\n      for (const [channelName, channelData] of this.activeChannels) {\n        if (channelData.connectionHealth === 'unhealthy') {\n          hasUnhealthyChannels = true;\n          console.log(`[Realtime] Channel '${channelName}' marked as unhealthy, scheduling recovery...`);\n          \n          // Schedule recovery with exponential backoff\n          this.scheduleChannelRecovery(channelName);\n        }\n      }\n      \n      // If we have unhealthy channels, update global status\n      if (hasUnhealthyChannels && this.connectionStatus === 'connected') {\n        this.setConnectionStatus('reconnecting');\n      }\n    }, 30000); // Check every 30 seconds\n  }\n\n  // Schedule channel recovery with exponential backoff\n  private scheduleChannelRecovery(channelName: string): void {\n    const channelData = this.activeChannels.get(channelName);\n    if (!channelData) return;\n    \n    const retryDelay = this.calculateRetryDelay(channelData.retryCount);\n    console.log(`[Realtime] Scheduling recovery for channel '${channelName}' in ${retryDelay}ms (attempt ${channelData.retryCount + 1}/${MAX_RETRY_ATTEMPTS})`);\n    \n    setTimeout(() => {\n      if (this.isDestroyed) return;\n      this.recoverChannel(channelName);\n    }, retryDelay);\n  }\n\n  // Recover a specific channel\n  private async recoverChannel(channelName: string): Promise<void> {\n    const channelData = this.activeChannels.get(channelName);\n    if (!channelData) return;\n    \n    if (channelData.retryCount >= MAX_RETRY_ATTEMPTS) {\n      console.error(`[Realtime] Channel '${channelName}' failed after ${MAX_RETRY_ATTEMPTS} recovery attempts. Marking as permanently failed.`);\n      channelData.connectionHealth = 'unhealthy';\n      return;\n    }\n    \n    console.log(`[Realtime] Attempting to recover channel '${channelName}'...`);\n    \n    try {\n      // Create new channel\n      const newChannel = supabase.channel(channelName);\n      \n      // Re-subscribe with existing callbacks\n      channelData.callbacks.forEach(existingCallback => {\n        (newChannel as any).on('*', (_event: any, payload: any) => {\n          existingCallback(payload);\n        });\n      });\n      \n      // Update channel data\n      channelData.channel = newChannel;\n      channelData.retryCount++;\n      channelData.lastRetryTime = Date.now();\n      channelData.isReconnecting = false;\n      channelData.connectionHealth = 'healthy';\n      \n      console.log(`[Realtime] Successfully recovered channel '${channelName}'`);\n      \n      // Update global status if we were reconnecting\n      if (this.connectionStatus === 'reconnecting') {\n        this.setConnectionStatus('connected');\n      }\n      \n    } catch (error) {\n      console.error(`[Realtime] Failed to recover channel '${channelName}':`, error);\n      channelData.connectionHealth = 'unhealthy';\n      channelData.isReconnecting = true;\n      \n      // Schedule another recovery attempt\n      this.scheduleChannelRecovery(channelName);\n    }\n  }\n\n  // Start periodic connection health check with WebSocket monitoring\n  private startConnectionHealthCheck(): void {\n    setInterval(() => {\n      if (this.isDestroyed) return;\n      \n      const now = Date.now();\n      let hasActiveConnections = false;\n      let hasReconnectingChannels = false;\n      let hasUnhealthyChannels = false;\n\n      // Check all channels for health\n      for (const [channelName, channelData] of this.activeChannels) {\n        if (channelData.isReconnecting) {\n          hasReconnectingChannels = true;\n        }\n        \n        if (channelData.connectionHealth === 'unhealthy') {\n          hasUnhealthyChannels = true;\n        }\n        \n        // Check if channel is stale (no activity for more than 5 minutes)\n        if (now - channelData.lastRetryTime > 5 * 60 * 1000 && channelData.lastRetryTime > 0) {\n          console.warn(`[Realtime] Channel '${channelName}' appears stale, checking health...`);\n          // Trigger a health check by attempting to ping the channel\n          this.checkChannelHealth(channelName);\n        }\n        \n        hasActiveConnections = true;\n      }\n\n      // Update connection status based on channel health\n      if (hasReconnectingChannels || hasUnhealthyChannels) {\n        this.setConnectionStatus('reconnecting');\n      } else if (hasActiveConnections) {\n        this.setConnectionStatus('connected');\n      } else {\n        this.setConnectionStatus('disconnected');\n      }\n      \n      // Log connection health summary\n      if (hasUnhealthyChannels || hasReconnectingChannels) {\n        console.warn(`[Realtime] Connection health: ${hasUnhealthyChannels ? 'Unhealthy channels detected' : ''} ${hasReconnectingChannels ? 'Reconnecting channels detected' : ''}`);\n      }\n    }, 30000); // Check every 30 seconds\n  }\n\n  // Check individual channel health\n  private checkChannelHealth(channelName: string): void {\n    const channelData = this.activeChannels.get(channelName);\n    if (!channelData || !channelData.channel) return;\n\n    try {\n      // Try to access a property to check if the channel is still valid\n      if (channelData.channel && typeof channelData.channel.subscribe === 'function') {\n        // Channel appears healthy\n        channelData.lastRetryTime = Date.now();\n        channelData.connectionHealth = 'healthy';\n      } else {\n        console.warn(`[Realtime] Channel '${channelName}' appears unhealthy, will retry on next error`);\n        channelData.isReconnecting = true;\n        channelData.connectionHealth = 'unhealthy';\n      }\n    } catch (error) {\n      console.warn(`[Realtime] Channel '${channelName}' health check failed:`, error);\n      channelData.isReconnecting = true;\n      channelData.connectionHealth = 'unhealthy';\n    }\n  }\n\n  // Start WebSocket reconnection mechanism for specific error codes\n  private startWebSocketReconnection(): void {\n    // Listen for WebSocket close events on the Supabase client\n    if (typeof window !== 'undefined' && supabase.realtime) {\n      // Monitor the realtime connection status\n      const checkWebSocketStatus = () => {\n        if (this.isDestroyed) return;\n        \n        try {\n          // Check if WebSocket is connected\n          const isConnected = supabase.realtime.isConnected();\n          \n          if (!isConnected && this.connectionStatus === 'connected') {\n            logConnection.info('WebSocket disconnected, attempting reconnection');\n            this.setConnectionStatus('reconnecting');\n            \n            // Attempt to reconnect the WebSocket\n            this.reconnectWebSocket();\n          }\n        } catch (error) {\n          console.warn('🔍 [Diagnostics] Error checking WebSocket status:', error);\n        }\n      };\n      \n      // Check WebSocket status every 10 seconds\n      setInterval(checkWebSocketStatus, 10000);\n    }\n  }\n\n  // Reconnect WebSocket connection\n  private async reconnectWebSocket(): Promise<void> {\n    if (this.isDestroyed) return;\n    \n    try {\n              logConnection.info('Attempting WebSocket reconnection');\n      \n      // Disconnect current connection\n      await supabase.realtime.disconnect();\n      \n      // Wait a moment before reconnecting\n      await new Promise(resolve => setTimeout(resolve, 2000));\n      \n      // Attempt to reconnect\n      await supabase.realtime.connect();\n      \n              logConnection.info('WebSocket reconnection successful');\n      this.setConnectionStatus('connected');\n      \n      // Recover all active channels after reconnection\n      this.recoverAllChannels();\n      \n    } catch (error) {\n      console.error('❌ [Realtime] WebSocket reconnection failed:', error);\n      this.setConnectionStatus('disconnected');\n      \n      // Schedule another reconnection attempt with exponential backoff\n      const retryDelay = Math.min(5000 * Math.pow(2, Math.min(this.getGlobalRetryCount(), 5)), 60000);\n              logConnection.info('Scheduling WebSocket reconnection', { delaySeconds: retryDelay / 1000 });\n      \n      setTimeout(() => {\n        if (!this.isDestroyed) {\n          this.reconnectWebSocket();\n        }\n      }, retryDelay);\n    }\n  }\n\n  // Get global retry count for WebSocket reconnection\n  private getGlobalRetryCount(): number {\n    // This could be enhanced to track global retry attempts\n    return 0;\n  }\n\n  // Recover all active channels after WebSocket reconnection\n  private async recoverAllChannels(): Promise<void> {\n    if (this.isDestroyed) return;\n    \n            logConnection.info('Recovering all active channels after WebSocket reconnection');\n    \n    for (const [channelName, channelData] of this.activeChannels) {\n      if (channelData.refs > 0) {\n        console.log(`🔄 [Realtime] Recovering channel: ${channelName}`);\n        \n        try {\n          // Create new channel\n          const newChannel = supabase.channel(channelName);\n          \n          // Configure postgres changes if config provided\n          if (channelData.config?.event && channelData.config?.schema && channelData.config?.table) {\n            // Use type assertion to bypass TypeScript strict checking\n            (newChannel as any).on(\n              'postgres_changes',\n              {\n                event: channelData.config.event,\n                schema: channelData.config.schema,\n                table: channelData.config.table,\n                filter: channelData.config.filter,\n              },\n              (payload: any) => {\n                // Call all stored callbacks\n                for (const callback of channelData.callbacks) {\n                  callback(payload);\n                }\n              }\n            );\n          } else {\n            // Generic channel for custom events\n            (newChannel as any).on('*', (event: any, payload: any) => {\n              // Call all stored callbacks\n              for (const callback of channelData.callbacks) {\n                callback(payload);\n              }\n            });\n          }\n\n          // Subscribe to the channel\n          const subscription = newChannel.subscribe((status, error) => {\n            if (status === 'SUBSCRIBED') {\n              console.info(`[Realtime] Successfully recovered channel '${channelName}'`);\n            } else if (status === 'CHANNEL_ERROR' || status === 'TIMED_OUT') {\n              console.error(`[Realtime] Recovered channel '${channelName}' subscription error:`, {\n                status,\n                error: error?.message || error,\n                channelName,\n                timestamp: new Date().toISOString()\n              });\n              channelData.connectionHealth = 'unhealthy';\n            } else if (status === 'CLOSED') {\n              console.info(`[Realtime] Recovered channel '${channelName}' closed`);\n            }\n          });\n          \n          // Update the channel reference\n          channelData.channel = subscription;\n          channelData.connectionHealth = 'healthy';\n          channelData.retryCount = 0;\n          channelData.isReconnecting = false;\n          \n          console.log(`✅ [Realtime] Channel recovered: ${channelName}`);\n        } catch (error) {\n          console.error(`❌ [Realtime] Failed to recover channel: ${channelName}`, error);\n          channelData.connectionHealth = 'unhealthy';\n        }\n      }\n    }\n  }\n\n  public static getInstance(): RealtimeConnectionManager {\n    if (!RealtimeConnectionManager.instance) {\n      RealtimeConnectionManager.instance = new RealtimeConnectionManager();\n    }\n    return RealtimeConnectionManager.instance;\n  }\n\n  private setConnectionStatus(status: 'connected' | 'reconnecting' | 'disconnected'): void {\n    if (this.connectionStatus !== status && !this.isDestroyed) {\n      this.connectionStatus = status;\n      this.notifyStatusListeners(status);\n      \n      // Log status changes\n      switch (status) {\n        case 'connected':\n          console.info('[Realtime] Connected ✅');\n          break;\n        case 'reconnecting':\n          console.info('[Realtime] Reconnecting…');\n          break;\n        case 'disconnected':\n          console.warn('[Realtime] Disconnected ❌');\n          break;\n      }\n    }\n  }\n\n  private notifyStatusListeners(status: 'connected' | 'reconnecting' | 'disconnected'): void {\n    if (!this.isDestroyed) {\n      this.statusListeners.forEach(listener => listener(status));\n    }\n  }\n\n  // Calculate exponential backoff delay\n  private calculateRetryDelay(retryCount: number): number {\n    const delay = Math.min(BASE_RETRY_DELAY * Math.pow(2, retryCount), MAX_RETRY_DELAY);\n    // Add jitter to prevent thundering herd\n    return delay + Math.random() * 1000;\n  }\n\n  // Retry channel subscription with exponential backoff\n  private async retryChannelSubscription(\n    channelName: string,\n    callback: (payload: any) => void,\n    config?: {\n      event?: string;\n      schema?: string;\n      table?: string;\n      filter?: string;\n    }\n  ): Promise<void> {\n    const channelData = this.activeChannels.get(channelName);\n    if (!channelData) return;\n\n    if (channelData.retryCount >= MAX_RETRY_ATTEMPTS) {\n      console.error(`[Realtime] Channel '${channelName}' failed after ${MAX_RETRY_ATTEMPTS} retry attempts. Giving up.`);\n      this.setConnectionStatus('disconnected');\n      return;\n    }\n\n    const now = Date.now();\n    const timeSinceLastRetry = now - channelData.lastRetryTime;\n    const retryDelay = this.calculateRetryDelay(channelData.retryCount);\n\n    if (timeSinceLastRetry < retryDelay) {\n      // Wait for the retry delay\n      setTimeout(() => this.retryChannelSubscription(channelName, callback, config), retryDelay - timeSinceLastRetry);\n      return;\n    }\n\n    console.log(`[Realtime] Retrying channel '${channelName}' subscription (attempt ${channelData.retryCount + 1}/${MAX_RETRY_ATTEMPTS})`);\n    \n    try {\n      // Remove the old channel using proper Supabase method\n      if (channelData.channel) {\n        try {\n          // Use the proper Supabase method instead of unsubscribe()\n          supabase.removeChannel(channelData.channel);\n        } catch (removeError) {\n          console.warn(`[Realtime] Error removing channel '${channelName}' from Supabase:`, removeError);\n        }\n      }\n\n      // Create new channel\n      const newChannel = supabase.channel(channelName);\n      \n      // Configure postgres changes if config provided\n      if (config?.event && config?.schema && config?.table) {\n        // Fix: Ensure proper postgres_changes configuration with correct binding\n        (newChannel as any).on(\n          'postgres_changes',\n          {\n            event: config.event,\n            schema: config.schema,\n            table: config.table,\n            filter: config.filter,\n          },\n          (payload: any) => {\n            callback(payload);\n          }\n        );\n      } else {\n        // Generic channel for custom events\n        (newChannel as any).on('*', (event: any, payload: any) => {\n          callback(payload);\n        });\n      }\n\n      // Subscribe to the channel with improved error handling\n      const subscription = newChannel.subscribe((status, error) => {\n        if (status === 'SUBSCRIBED') {\n          console.info(`[Realtime] Successfully resubscribed to '${channelName}' after retry`);\n          this.setConnectionStatus('connected');\n          // Reset retry count on successful subscription\n          channelData.retryCount = 0;\n          channelData.isReconnecting = false;\n        } else if (status === 'CHANNEL_ERROR' || status === 'TIMED_OUT') {\n          console.warn(`[Realtime] Channel '${channelName}' resubscription error:`, status, error);\n          \n          // Enhanced error logging for debugging\n          if (error) {\n            console.error(`[Realtime] Detailed error for '${channelName}':`, {\n              error: error.message || error,\n              code: (error as any).code,\n              details: (error as any).details,\n              hint: (error as any).hint,\n              timestamp: new Date().toISOString()\n            });\n          }\n          \n          // Don't immediately retry on resubscription error, let the main error handler deal with it\n          channelData.isReconnecting = false;\n        } else if (status === 'CLOSED') {\n          console.info(`[Realtime] Channel '${channelName}' closed after retry`);\n          channelData.isReconnecting = false;\n        }\n      });\n\n      // Update channel data\n      channelData.channel = subscription;\n      channelData.retryCount++;\n      channelData.lastRetryTime = now;\n      channelData.isReconnecting = false;\n\n    } catch (error) {\n      console.error(`[Realtime] Failed to retry channel '${channelName}' subscription:`, error);\n      channelData.isReconnecting = false;\n      // Don't call handleChannelError here to avoid infinite loops\n      // Just log and let the next error event handle it\n    }\n  }\n\n  // Handle channel errors with improved retry logic\n  private handleChannelError(channelName: string, error: any): void {\n    const channelData = this.activeChannels.get(channelName);\n    if (!channelData) return;\n\n    // Categorize the error to determine appropriate handling\n    const isNetworkError = this.isNetworkRelatedError(error);\n    const isAuthError = this.isAuthRelatedError(error);\n    const isRateLimitError = this.isRateLimitError(error);\n    const isWebSocketError = this.isWebSocketRelatedError(error);\n\n    // Log detailed error information\n    console.error(`[Realtime] Channel '${channelName}' error:`, {\n      channelName,\n      error: error?.message || error,\n      errorType: isNetworkError ? 'network' : isAuthError ? 'auth' : isRateLimitError ? 'rate_limit' : isWebSocketError ? 'websocket' : 'unknown',\n      retryCount: channelData.retryCount,\n      timestamp: new Date().toISOString(),\n      userAgent: navigator.userAgent,\n      connectionStatus: this.connectionStatus\n    });\n\n    // Handle different error types appropriately\n    if (isAuthError) {\n      console.warn(`[Realtime] Auth error for channel '${channelName}', not retrying`);\n      this.setConnectionStatus('disconnected');\n      return;\n    }\n\n    if (isRateLimitError) {\n      console.warn(`[Realtime] Rate limit error for channel '${channelName}', waiting before retry`);\n      // Wait longer for rate limit errors\n      const retryCallback = Array.from(channelData.callbacks)[0];\n      if (!retryCallback) {\n        console.warn(`[Realtime] No callbacks available for channel '${channelName}' after rate limit error, stopping retry`);\n        return;\n      }\n\n      setTimeout(() => {\n        if (channelData.isReconnecting) {\n          this.retryChannelSubscription(channelName, retryCallback as (payload: any) => void, this.getChannelConfig(channelName));\n        }\n      }, 10000); // Wait 10 seconds for rate limit\n      return;\n    }\n\n    // Handle WebSocket-specific errors with special care\n    if (isWebSocketError) {\n      console.warn(`[Realtime] WebSocket error for channel '${channelName}', implementing special recovery...`);\n      channelData.connectionHealth = 'unhealthy';\n      \n      // For WebSocket errors, use more aggressive recovery\n      if (channelData.retryCount < MAX_RETRY_ATTEMPTS) {\n        const retryDelay = this.calculateRetryDelay(channelData.retryCount);\n        logConnection.info('Scheduling WebSocket recovery for channel', { channelName, delayMs: retryDelay });\n        \n        setTimeout(() => {\n          if (channelData.isReconnecting) {\n            this.recoverChannel(channelName);\n          }\n        }, retryDelay);\n      }\n      return;\n    }\n\n    // Set reconnecting status for network errors\n    if (isNetworkError) {\n      channelData.isReconnecting = true;\n      channelData.connectionHealth = 'unhealthy';\n      this.setConnectionStatus('reconnecting');\n    }\n\n    // Get the first callback to retry with\n    const firstCallback = Array.from(channelData.callbacks)[0];\n    if (!firstCallback) {\n      console.warn(`[Realtime] No callbacks found for channel '${channelName}', cannot retry`);\n      return;\n    }\n\n    // Implement exponential backoff retry for network errors\n    if (isNetworkError && channelData.retryCount < MAX_RETRY_ATTEMPTS) {\n      const retryDelay = this.calculateRetryDelay(channelData.retryCount);\n      console.log(`[Realtime] Scheduling retry for channel '${channelName}' in ${retryDelay}ms (attempt ${channelData.retryCount + 1}/${MAX_RETRY_ATTEMPTS})`);\n      \n      setTimeout(() => {\n        if (channelData.isReconnecting) {\n          this.retryChannelSubscription(channelName, firstCallback, this.getChannelConfig(channelName));\n        }\n      }, retryDelay);\n    } else if (channelData.retryCount >= MAX_RETRY_ATTEMPTS) {\n      console.error(`[Realtime] Channel '${channelName}' exceeded maximum retry attempts, giving up`);\n      this.setConnectionStatus('disconnected');\n      channelData.connectionHealth = 'unhealthy';\n    }\n  }\n\n  // Enhanced error categorization for WebSocket issues\n  private isWebSocketRelatedError(error: any): boolean {\n    if (!error) return false;\n    \n    const errorMessage = error.message || error.toString() || '';\n    const errorCode = error.code || error.closeCode;\n    \n    // Check for WebSocket-specific error patterns\n    const websocketPatterns = [\n      'websocket',\n      'ws://',\n      'wss://',\n      'connection closed',\n      'connection failed',\n      '1005',\n      '1006',\n      '1015',\n      'timeout',\n      'ping',\n      'pong'\n    ];\n    \n    // Check for WebSocket close codes\n    const websocketCloseCodes = [1000, 1001, 1002, 1003, 1005, 1006, 1007, 1008, 1009, 1010, 1011, 1012, 1013, 1014, 1015];\n    \n    return websocketPatterns.some(pattern => \n      errorMessage.toLowerCase().includes(pattern.toLowerCase())\n    ) || websocketCloseCodes.includes(errorCode);\n  }\n\n  // Enhanced WebSocket error handling with code-specific strategies\n  private handleWebSocketError(error: any, channelName: string): void {\n    const errorCode = error.code || error.closeCode;\n    const errorMessage = error.message || error.toString();\n    \n    // Suppress noisy 1011 errors by downgrading them to warnings\n    if (errorCode === 1011) {\n      logConnection.warn(`WebSocket code 1011 (server terminating) for channel '${channelName}' - implementing retry strategy`, { \n        errorCode, \n        channelName \n      });\n    } else {\n      logConnection.error(`WebSocket error for channel '${channelName}'`, { \n        errorCode, \n        errorMessage,\n        channelName \n      });\n    }\n\n    // Get error-specific configuration\n    let config: any = WEBSOCKET_ERROR_CONFIG.DEFAULT;\n    if (errorCode === 1011) {\n      config = WEBSOCKET_ERROR_CONFIG.CODE_1011;\n      // Suppress the verbose warning for 1011 errors\n    } else if (errorCode === 1005) {\n      config = WEBSOCKET_ERROR_CONFIG.CODE_1005;\n      logConnection.warn('Code 1005 detected - connection issue. Implementing standard retry strategy.');\n    } else if (errorCode === 1006) {\n      config = WEBSOCKET_ERROR_CONFIG.CODE_1006;\n      logConnection.warn('Code 1006 detected - abnormal closure. Implementing moderate retry strategy.');\n    }\n\n    // Handle token refresh if required\n    if (config.requireTokenRefresh) {\n      this.refreshAuthTokenBeforeRetry(channelName, config);\n    } else {\n      this.scheduleRetryWithBackoff(channelName, config);\n    }\n  }\n\n  // Refresh authentication token before retry (for code 1011)\n  private async refreshAuthTokenBeforeRetry(channelName: string, config: any): Promise<void> {\n    try {\n      logConnection.info('Refreshing auth token before retry for code 1011');\n      \n      // Get current session and refresh if needed\n      const { data: { session }, error } = await supabase.auth.getSession();\n      \n      if (error) {\n        logConnection.warn('Failed to get session, proceeding with retry', { error: error.message });\n        this.scheduleRetryWithBackoff(channelName, config);\n        return;\n      }\n\n      if (session) {\n        // Check if token is expired or close to expiring\n        const expiresAt = session.expires_at;\n        const now = Math.floor(Date.now() / 1000);\n        \n        if (expiresAt && (expiresAt - now) < 300) { // Less than 5 minutes until expiry\n          logConnection.info('Token expiring soon, refreshing...');\n          const { error: refreshError } = await supabase.auth.refreshSession();\n          \n          if (refreshError) {\n            logConnection.warn('Token refresh failed, proceeding with retry', { error: refreshError.message });\n          } else {\n            logConnection.info('Token refreshed successfully');\n          }\n        }\n      }\n\n      // Schedule retry after token refresh\n      this.scheduleRetryWithBackoff(channelName, config);\n      \n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : String(error);\n      logConnection.warn('Error during token refresh, proceeding with retry', { error: errorMessage });\n      this.scheduleRetryWithBackoff(channelName, config);\n    }\n  }\n\n  // Enhanced retry scheduling with exponential backoff and jitter\n  private scheduleRetryWithBackoff(channelName: string, config: any): void {\n    const channelData = this.activeChannels.get(channelName);\n    if (!channelData) return;\n\n    // Check retry limits\n    if (channelData.retryCount >= config.maxRetries) {\n      logConnection.error(`Max retries (${config.maxRetries}) exceeded for channel '${channelName}'`);\n      channelData.connectionHealth = 'unhealthy';\n      return;\n    }\n\n    // Calculate delay with exponential backoff and jitter\n    const baseDelay = Math.min(\n      config.baseDelay * Math.pow(config.backoffFactor, channelData.retryCount),\n      config.maxDelay\n    );\n    \n    const jitter = config.jitter ? (Math.random() - 0.5) * 1000 : 0;\n    const finalDelay = Math.max(baseDelay + jitter, 1000); // Minimum 1 second\n\n    logConnection.info(`Scheduling retry for channel '${channelName}'`, {\n      retryCount: channelData.retryCount + 1,\n      delay: Math.round(finalDelay),\n      maxRetries: config.maxRetries\n    });\n\n    // Schedule retry\n    setTimeout(() => {\n      this.attemptChannelReconnection(channelName);\n    }, finalDelay);\n\n    channelData.retryCount++;\n    channelData.lastRetryTime = Date.now();\n  }\n\n  // Attempt channel reconnection with connection pooling respect\n  private attemptChannelReconnection(channelName: string): void {\n    const channelData = this.activeChannels.get(channelName);\n    if (!channelData || channelData.isReconnecting) return;\n\n    // Check connection pooling limits\n    const activeConnections = Array.from(this.activeChannels.values())\n      .filter(ch => ch.isReconnecting || ch.connectionHealth === 'healthy').length;\n    \n    if (activeConnections >= CONNECTION_POOL_CONFIG.maxConcurrentConnections) {\n      logConnection.warn(`Connection pool limit reached (${activeConnections}/${CONNECTION_POOL_CONFIG.maxConcurrentConnections}), deferring reconnection for '${channelName}'`);\n      \n      // Schedule retry after cooldown\n      setTimeout(() => {\n        this.attemptChannelReconnection(channelName);\n      }, CONNECTION_POOL_CONFIG.connectionCooldown);\n      return;\n    }\n\n    // Check rate limiting\n    const recentRetries = Array.from(this.activeChannels.values())\n      .filter(ch => Date.now() - ch.lastRetryTime < CONNECTION_POOL_CONFIG.retryWindowMs)\n      .reduce((sum, ch) => sum + ch.retryCount, 0);\n    \n    if (recentRetries >= CONNECTION_POOL_CONFIG.maxRetriesPerMinute) {\n      logConnection.warn(`Rate limit exceeded (${recentRetries}/${CONNECTION_POOL_CONFIG.maxRetriesPerMinute} retries per minute), deferring reconnection for '${channelName}'`);\n      \n      // Schedule retry after rate limit window\n      setTimeout(() => {\n        this.attemptChannelReconnection(channelName);\n      }, CONNECTION_POOL_CONFIG.retryWindowMs);\n      return;\n    }\n\n    logConnection.info(`Attempting reconnection for channel '${channelName}'`);\n    channelData.isReconnecting = true;\n\n    // Attempt reconnection\n    try {\n      // Create new channel subscription\n      const newChannel = supabase.channel(channelName);\n      \n      // Re-add all callbacks\n      channelData.callbacks.forEach(callback => {\n        (newChannel as any).on('*', callback);\n      });\n\n      // Subscribe with enhanced error handling\n      const subscription = newChannel.subscribe((status, error) => {\n        if (status === 'SUBSCRIBED') {\n          logConnection.info(`Channel '${channelName}' reconnected successfully`);\n          channelData.channel = newChannel;\n          channelData.isReconnecting = false;\n          channelData.connectionHealth = 'healthy';\n          channelData.retryCount = 0;\n        } else if (status === 'CHANNEL_ERROR' || status === 'TIMED_OUT') {\n          logConnection.warn(`Channel '${channelName}' reconnection failed`, { status, error });\n          channelData.isReconnecting = false;\n          channelData.connectionHealth = 'unhealthy';\n          \n          // Handle the error with enhanced error handling\n          if (error) {\n            this.handleWebSocketError(error, channelName);\n          }\n        }\n      });\n\n      // Store the subscription\n      channelData.channel = newChannel;\n      \n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : String(error);\n      logConnection.error(`Error during channel reconnection for '${channelName}'`, { error: errorMessage });\n      channelData.isReconnecting = false;\n      channelData.connectionHealth = 'unhealthy';\n      \n      // Schedule another retry\n      this.scheduleRetryWithBackoff(channelName, WEBSOCKET_ERROR_CONFIG.DEFAULT);\n    }\n  }\n\n  // Helper method to get channel configuration based on channel name\n  private getChannelConfig(channelName: string): any {\n    if (channelName.includes('notifications')) {\n      return {\n        event: 'INSERT',\n        schema: 'public',\n        table: 'notifications',\n        filter: `user_id=eq.${channelName.split('-')[2]}`\n      };\n    } else if (channelName.includes('user-points')) {\n      return {\n        event: 'INSERT',\n        schema: 'public',\n        table: 'user_points',\n        filter: `user_id=eq.${channelName.split('-')[2]}`\n      };\n    } else if (channelName.includes('user-profile-points')) {\n      return {\n        event: 'UPDATE',\n        schema: 'public',\n        table: 'profiles',\n        filter: `user_id=eq.${channelName.split('-')[2]}`\n      };\n    }\n    return {};\n  }\n\n  // Helper method to categorize network-related errors\n  private isNetworkRelatedError(error: any): boolean {\n    if (!error) return false;\n    const errorStr = error.toString().toLowerCase();\n    return errorStr.includes('network') || \n           errorStr.includes('connection') || \n           errorStr.includes('timeout') ||\n           errorStr.includes('offline') ||\n           errorStr.includes('fetch') ||\n           errorStr.includes('websocket');\n  }\n\n  // Helper method to categorize auth-related errors\n  private isAuthRelatedError(error: any): boolean {\n    if (!error) return false;\n    const errorStr = error.toString().toLowerCase();\n    return errorStr.includes('auth') || \n           errorStr.includes('unauthorized') || \n           errorStr.includes('forbidden') ||\n           errorStr.includes('token') ||\n           errorStr.includes('jwt');\n  }\n\n  // Helper method to categorize rate limit errors\n  private isRateLimitError(error: any): boolean {\n    if (!error) return false;\n    const errorStr = error.toString().toLowerCase();\n    return errorStr.includes('rate') || \n           errorStr.includes('limit') || \n           errorStr.includes('too many') ||\n           errorStr.includes('429');\n  }\n\n  public subscribeToChannel(\n    channelName: string,\n    callback: (payload: any) => void,\n    config?: {\n      event?: string;\n      schema?: string;\n      table?: string;\n      filter?: string;\n    }\n  ): void {\n    if (!REALTIME_ENABLED || this.isDestroyed) {\n      console.warn(`[Realtime] Realtime disabled or manager destroyed. Channel '${channelName}' not created.`);\n      return;\n    }\n\n    if (!this.isRealtimeClientReady()) {\n      this.enqueueReadySubscription(channelName, () => {\n        this.subscribeToChannel(channelName, callback, config);\n      });\n      return;\n    }\n\n    this.resolvePendingReady(channelName, null);\n\n    // Prevent duplicate subscriptions during rapid navigation changes\n    const timeSinceLastViewChange = Date.now() - this.navigationState.lastViewChange;\n    if (timeSinceLastViewChange < 2000) { // 2 second cooldown after view change\n      console.log(`[Realtime] Skipping channel '${channelName}' subscription - too soon after view change (${timeSinceLastViewChange}ms ago)`);\n      return;\n    }\n\n    // Clear any pending cleanup for this channel\n    if (this.pendingCleanups.has(channelName)) {\n      clearTimeout(this.pendingCleanups.get(channelName)!);\n      this.pendingCleanups.delete(channelName);\n    }\n\n    const channelData = this.activeChannels.get(channelName);\n\n    if (channelData) {\n      // Channel exists, just add callback and increment refs\n      channelData.callbacks.add(callback);\n      channelData.refs++;\n      console.info(`[Realtime] Channel '${channelName}' reused, refs: ${channelData.refs}`);\n      this.resolvePendingReady(channelName, channelData.channel ?? null);\n      return;\n    }\n\n    // Create new channel\n    try {\n      console.info(`[Realtime] Channel '${channelName}' subscribed`);\n      \n      const channel = supabase.channel(channelName);\n      \n      // Configure postgres changes if config provided\n      if (config?.event && config?.schema && config?.table) {\n        // Use type assertion to bypass TypeScript strict checking\n        (channel as any).on(\n          'postgres_changes',\n          {\n            event: config.event,\n            schema: config.schema,\n            table: config.table,\n            filter: config.filter,\n          },\n          (payload: any) => {\n            callback(payload);\n          }\n        );\n      } else {\n        // Generic channel for custom events\n        (channel as any).on('*', (event: any, payload: any) => {\n          callback(payload);\n        });\n      }\n\n      // Subscribe to the channel\n      const subscription = channel.subscribe((status, error) => {\n        if (status === 'SUBSCRIBED') {\n          console.info(`[Realtime] Successfully subscribed to '${channelName}'`);\n          this.setConnectionStatus('connected');\n        } else if (status === 'CHANNEL_ERROR' || status === 'TIMED_OUT') {\n          console.error(`[Realtime] Channel '${channelName}' subscription error:`, {\n            status,\n            error: error?.message || error,\n            channelName,\n            timestamp: new Date().toISOString(),\n            retryCount: 0\n          });\n          this.handleChannelError(channelName, error);\n        } else if (status === 'CLOSED') {\n          console.info(`[Realtime] Channel '${channelName}' closed`);\n        }\n      });\n\n      // Store the channel with reference counting and retry tracking\n      this.activeChannels.set(channelName, {\n        channel: subscription,\n        callbacks: new Set([callback]),\n        retryCount: 0,\n        lastRetryTime: Date.now(),\n        isReconnecting: false,\n        connectionHealth: 'healthy',\n        config: config || {}, // Store the config\n        refs: 1 // Track reference count for the channel\n      });\n      \n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : String(error);\n      console.error(`[Realtime] Failed to create channel '${channelName}':`, {\n        error: errorMessage,\n        channelName,\n        timestamp: new Date().toISOString(),\n        config\n      });\n      this.handleChannelError(channelName, error);\n    }\n  }\n\n  public unsubscribeFromChannel(channelName: string, callback?: (payload: any) => void): void {\n    if (this.isDestroyed) {\n      return;\n    }\n\n    if (this.pendingReadyChecks.has(channelName)) {\n      clearTimeout(this.pendingReadyChecks.get(channelName)!);\n      this.pendingReadyChecks.delete(channelName);\n    }\n\n    const channelData = this.activeChannels.get(channelName);\n    \n    if (!channelData) {\n      // Channel not found - this is normal during cleanup, don't warn\n      return;\n    }\n\n    if (callback) {\n      // Remove specific callback\n      channelData.callbacks.delete(callback);\n    }\n\n    // Decrement reference count\n    channelData.refs--;\n    console.info(`[Realtime] Channel '${channelName}' refs: ${channelData.refs}`);\n\n    // If no more references, schedule removal with a delay to prevent immediate cleanup\n    if (channelData.refs <= 0) {\n      console.info(`[Realtime] Scheduling removal of channel '${channelName}' (no more references)`);\n      \n      // Schedule cleanup with a delay to prevent immediate removal\n      const cleanupTimeout = setTimeout(() => {\n        if (!this.isDestroyed) {\n          this.removeChannel(channelName);\n        }\n      }, 1000); // 1 second delay\n      \n      this.pendingCleanups.set(channelName, cleanupTimeout);\n    }\n  }\n\n  private removeChannel(channelName: string): void {\n    if (this.isDestroyed) {\n      return;\n    }\n\n    const channelData = this.activeChannels.get(channelName);\n    if (!channelData) return;\n\n    console.info(`[Realtime] Removing channel '${channelName}'`);\n    \n    try {\n      // Check if channel is still active before removing\n      if (channelData.channel) {\n        // Use the proper Supabase method instead of unsubscribe()\n        supabase.removeChannel(channelData.channel);\n      }\n      this.activeChannels.delete(channelName);\n      this.pendingCleanups.delete(channelName);\n      if (this.pendingReadyChecks.has(channelName)) {\n        clearTimeout(this.pendingReadyChecks.get(channelName)!);\n        this.pendingReadyChecks.delete(channelName);\n      }\n      this.pendingReadyResolvers.delete(channelName);\n      console.info(`[Realtime] Successfully removed channel '${channelName}'`);\n    } catch (error) {\n      console.error(`[Realtime] Error removing channel '${channelName}':`, error);\n      // Force remove from our tracking even if Supabase removal fails\n      this.activeChannels.delete(channelName);\n      this.pendingCleanups.delete(channelName);\n      if (this.pendingReadyChecks.has(channelName)) {\n        clearTimeout(this.pendingReadyChecks.get(channelName)!);\n        this.pendingReadyChecks.delete(channelName);\n      }\n      this.pendingReadyResolvers.delete(channelName);\n    }\n  }\n\n  public cleanupAllChannels(): void {\n    if (this.isDestroyed) {\n      return;\n    }\n\n    console.info(`[Realtime] Cleaning up ${this.activeChannels.size} active channels`);\n    \n    // Clear all pending cleanups\n    for (const timeout of this.pendingCleanups.values()) {\n      clearTimeout(timeout);\n    }\n    this.pendingCleanups.clear();\n    for (const timeout of this.pendingReadyChecks.values()) {\n      clearTimeout(timeout);\n    }\n    this.pendingReadyChecks.clear();\n    this.pendingReadyResolvers.clear();\n    \n    for (const [channelName, channelData] of this.activeChannels.entries()) {\n      try {\n        // Check if channel is still active before removing\n        if (channelData.channel) {\n          // Use the proper Supabase method instead of unsubscribe()\n          supabase.removeChannel(channelData.channel);\n        }\n        console.info(`[Realtime] Removed channel '${channelName}'`);\n      } catch (error) {\n        console.error(`[Realtime] Error cleaning up channel '${channelName}':`, error);\n      }\n    }\n    \n    this.activeChannels.clear();\n    console.info('[Realtime] All channels cleaned up');\n  }\n\n  public getConnectionStatus(): 'connected' | 'reconnecting' | 'disconnected' {\n    return this.isDestroyed ? 'disconnected' : this.connectionStatus;\n  }\n\n  public addStatusListener(listener: (status: 'connected' | 'reconnecting' | 'disconnected') => void): () => void {\n    if (this.isDestroyed) {\n      return () => {}; // Return no-op cleanup function if destroyed\n    }\n\n    this.statusListeners.add(listener);\n    \n    // Return cleanup function\n    return () => {\n      if (!this.isDestroyed) {\n        this.statusListeners.delete(listener);\n      }\n    };\n  }\n\n  public getChannelStatus(): {\n    enabled: boolean;\n    activeChannels: string[];\n    totalChannels: number;\n    connectionStatus: 'connected' | 'reconnecting' | 'disconnected';\n    reconnectAttempts: number;\n  } {\n    let totalReconnectAttempts = 0;\n    for (const channelData of this.activeChannels.values()) {\n      totalReconnectAttempts += channelData.retryCount;\n    }\n\n    return {\n      enabled: REALTIME_ENABLED && !this.isDestroyed,\n      activeChannels: Array.from(this.activeChannels.keys()),\n      totalChannels: this.activeChannels.size,\n      connectionStatus: this.getConnectionStatus(),\n      reconnectAttempts: totalReconnectAttempts,\n    };\n  }\n\n  public isChannelActive(channelName: string): boolean {\n    return !this.isDestroyed && this.activeChannels.has(channelName);\n  }\n\n  public getActiveChannel(channelName: string): RealtimeChannel | undefined {\n    return this.activeChannels.get(channelName)?.channel ?? undefined;\n  }\n\n  public async ensureChannelReady(channelName: string): Promise<RealtimeChannel | null> {\n    if (this.isDestroyed) {\n      return null;\n    }\n\n    if (this.isRealtimeClientReady()) {\n      const existing = this.getActiveChannel(channelName);\n      if (existing) {\n        return existing;\n      }\n    }\n\n    return new Promise<RealtimeChannel | null>((resolve) => {\n      this.enqueueReadySubscription(channelName, () => {\n        resolve(this.getActiveChannel(channelName) ?? null);\n      }, resolve);\n    });\n  }\n\n  private enqueueReadySubscription(\n    channelName: string,\n    action: () => void,\n    resolver?: (channel: RealtimeChannel | null) => void\n  ): void {\n    if (this.pendingReadyChecks.has(channelName)) {\n      clearTimeout(this.pendingReadyChecks.get(channelName)!);\n    }\n\n    if (resolver) {\n      const resolvers = this.pendingReadyResolvers.get(channelName) ?? [];\n      resolvers.push(resolver);\n      this.pendingReadyResolvers.set(channelName, resolvers);\n    }\n\n    const retryTimer = setTimeout(() => {\n      this.pendingReadyChecks.delete(channelName);\n      if (!this.isDestroyed) {\n        action();\n      }\n    }, 500);\n\n    this.pendingReadyChecks.set(channelName, retryTimer);\n  }\n\n  private resolvePendingReady(channelName: string, channel: RealtimeChannel | null): void {\n    if (this.pendingReadyChecks.has(channelName)) {\n      clearTimeout(this.pendingReadyChecks.get(channelName)!);\n      this.pendingReadyChecks.delete(channelName);\n    }\n\n    const resolvers = this.pendingReadyResolvers.get(channelName);\n    if (resolvers) {\n      resolvers.forEach(resolve => resolve(channel));\n      this.pendingReadyResolvers.delete(channelName);\n    }\n  }\n\n  public resetConnectionState(): void {\n    if (!this.isDestroyed) {\n      console.info('[Realtime] Connection state reset');\n      this.setConnectionStatus('connected');\n    }\n  }\n\n  public destroy(): void {\n    if (this.isDestroyed) {\n      return;\n    }\n\n    console.info('[Realtime] Destroying realtime manager');\n    this.isDestroyed = true;\n    \n    // Clear global retry timeout\n    if (this.globalRetryTimeout) {\n      clearTimeout(this.globalRetryTimeout);\n      this.globalRetryTimeout = null;\n    }\n\n    // Clean up all channels\n    this.cleanupAllChannels();\n    \n    // Clear status listeners\n    this.statusListeners.clear();\n    \n    // Reset instance to allow recreation if needed\n    RealtimeConnectionManager.instance = null as any;\n  }\n\n  public reset(): void {\n    if (this.isDestroyed) {\n      return;\n    }\n\n    console.info('[Realtime] Resetting realtime manager');\n    this.cleanupAllChannels();\n    this.setConnectionStatus('connected');\n  }\n\n  // Validate subscription configuration before attempting recovery\n  private async validateSubscriptionConfig(schema: string, table: string, filter?: string): Promise<boolean> {\n    try {\n      // Basic validation - check if table exists by attempting a simple query\n      // Use a safer approach that doesn't require dynamic table names or custom RPC functions\n      \n      // For now, assume the table is valid to prevent blocking recovery\n      // This is a conservative approach that allows recovery to proceed\n      console.log(`[Realtime] Assuming table '${table}' in schema '${schema}' is valid for recovery`);\n      \n      // If filter is provided, try to validate it\n      if (filter) {\n        try {\n          // Test the filter with a simple query using a safe approach\n          // Since we can't use dynamic table names, we'll validate the filter format\n          if (filter.includes('=')) {\n            const [column, value] = filter.split('=');\n            if (column && value) {\n              // Basic validation - check if the filter format looks correct\n              const trimmedColumn = column.trim();\n              const trimmedValue = value.trim();\n              \n              // Validate column name format (basic check)\n              if (!trimmedColumn.match(/^[a-zA-Z_][a-zA-Z0-9_]*$/)) {\n                console.warn(`[Realtime] Invalid column name in filter '${filter}':`, trimmedColumn);\n                return false;\n              }\n              \n              // Validate value format (basic check)\n              if (trimmedValue.length === 0) {\n                console.warn(`[Realtime] Empty value in filter '${filter}'`);\n                return false;\n              }\n            }\n          }\n        } catch (filterError) {\n          console.warn(`[Realtime] Filter validation error for '${filter}':`, filterError);\n          return false;\n        }\n      }\n      \n      return true;\n    } catch (error) {\n      console.warn(`[Realtime] Subscription config validation error:`, error);\n      // For now, assume valid to prevent blocking recovery\n      return true;\n    }\n  }\n}\n\n// Export singleton instance\nlet realtimeManager: RealtimeConnectionManager | null = null;\n\nfunction getRealtimeManager(): RealtimeConnectionManager {\n  if (!realtimeManager) {\n    realtimeManager = RealtimeConnectionManager.getInstance();\n  }\n  return realtimeManager;\n}\n\n// Export convenience functions that use the singleton\nexport function subscribeToChannel(\n  channelName: string,\n  callback: (payload: any) => void,\n  config?: {\n    event?: string;\n    schema?: string;\n    table?: string;\n    filter?: string;\n  }\n): void {\n  getRealtimeManager().subscribeToChannel(channelName, callback, config);\n}\n\nexport function unsubscribeFromChannel(channelName: string, callback?: (payload: any) => void): void {\n  getRealtimeManager().unsubscribeFromChannel(channelName, callback);\n}\n\nexport function cleanupAllChannels(): void {\n  getRealtimeManager().cleanupAllChannels();\n}\n\nexport function getChannelStatus() {\n  return getRealtimeManager().getChannelStatus();\n}\n\nexport function isChannelActive(channelName: string): boolean {\n  return getRealtimeManager().isChannelActive(channelName);\n}\n\nexport function ensureChannelReady(channelName: string): Promise<RealtimeChannel | null> {\n  return getRealtimeManager().ensureChannelReady(channelName);\n}\n\nexport function getExistingChannel(channelName: string): RealtimeChannel | undefined {\n  return getRealtimeManager().getActiveChannel(channelName);\n}\n\nexport function resetConnectionState(): void {\n  getRealtimeManager().resetConnectionState();\n}\n\nexport function getConnectionStatus(): 'connected' | 'reconnecting' | 'disconnected' {\n  return getRealtimeManager().getConnectionStatus();\n}\n\nexport function addConnectionStatusListener(listener: (status: 'connected' | 'reconnecting' | 'disconnected') => void): () => void {\n  return getRealtimeManager().addStatusListener(listener);\n}\n\nexport function destroyRealtimeManager(): void {\n  if (realtimeManager) {\n    realtimeManager.destroy();\n    realtimeManager = null;\n  }\n}\n\nexport function resetRealtimeManager(): void {\n  if (realtimeManager) {\n    realtimeManager.reset();\n  }\n}\n\n// Export the manager instance for advanced usage\nexport { getRealtimeManager as realtimeManager };\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\lib\\stateSynchronizer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\lib\\weatherBackgrounds.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\lib\\websocketDiagnostics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\lib\\websocketHealth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\pages\\Auth.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'data' is defined but never used.","line":108,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":108,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[4751,4756],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'data' is defined but never used.","line":108,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":108,"endColumn":24},{"ruleId":"no-unused-vars","severity":1,"message":"'handleDevLogin' is assigned a value but never used.","line":339,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":339,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"handleDevLogin"},"fix":{"range":[12196,15491],"text":""},"desc":"Remove unused variable 'handleDevLogin'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleDevLogin' is assigned a value but never used.","line":339,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":339,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { supabase } from '@/integrations/supabase/client';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from '@/components/ui/GlassCard';\nimport { useToast } from '@/components/ui/use-toast';\nimport { Loader2, Eye, EyeOff, Code, AlertTriangle, ArrowLeft, Mail, CheckCircle } from 'lucide-react';\n\nexport default function Auth(): JSX.Element {\n  const [isLoading, setIsLoading] = useState(false);\n  const [isSignUp, setIsSignUp] = useState(false);\n  const [showPassword, setShowPassword] = useState(false);\n  const [showDevLogin, setShowDevLogin] = useState(false);\n  const [showForgotPassword, setShowForgotPassword] = useState(false);\n  const [passwordResetEmail, setPasswordResetEmail] = useState('');\n  const [passwordResetSent, setPasswordResetSent] = useState(false);\n  const [showPasswordResetForm, setShowPasswordResetForm] = useState(false);\n  const [newPassword, setNewPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [showNewPassword, setShowNewPassword] = useState(false);\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\n  const [devFormData, setDevFormData] = useState({\n    email: 'dev@breathsafe.com',\n    password: 'devpassword123'\n  });\n  const [formData, setFormData] = useState({\n    email: '',\n    password: '',\n    fullName: ''\n  });\n  const { toast } = useToast();\n  const navigate = useNavigate();\n\n  // Check if we're in development mode\n  const isDevelopment = import.meta.env.DEV;\n\n  // Check if user is already authenticated and redirect\n  useEffect(() => {\n    const checkAuth = async () => {\n      const { data: { session } } = await supabase.auth.getSession();\n      if (session?.user) {\n        navigate('/dashboard?view=dashboard');\n      }\n    };\n    checkAuth();\n  }, [navigate]);\n\n  // Check for password reset URL parameter and recovery token\n  useEffect(() => {\n    console.log('Checking URL for recovery flow...');\n    console.log('Current URL:', window.location.href);\n    console.log('Search params:', window.location.search);\n    console.log('Hash:', window.location.hash);\n    \n    const urlParams = new URLSearchParams(window.location.search);\n    const isReset = urlParams.get('reset');\n    const accessToken = urlParams.get('access_token');\n    const refreshToken = urlParams.get('refresh_token');\n    const type = urlParams.get('type');\n    const code = urlParams.get('code');\n    \n    // Also check hash fragment for tokens (Supabase sometimes puts them there)\n    const hashParams = new URLSearchParams(window.location.hash.substring(1));\n    const hashAccessToken = hashParams.get('access_token');\n    const hashRefreshToken = hashParams.get('refresh_token');\n    const hashType = hashParams.get('type');\n    \n    console.log('URL Parameters:', { isReset, accessToken: !!accessToken, refreshToken: !!refreshToken, type, code: !!code });\n    console.log('Hash Parameters:', { hashAccessToken: !!hashAccessToken, hashRefreshToken: !!hashRefreshToken, hashType });\n    \n    // Check if this is a password recovery flow\n    if (isReset === 'true' || (accessToken && refreshToken) || (hashAccessToken && hashRefreshToken) || type === 'recovery' || hashType === 'recovery' || code) {\n      console.log('Password reset flow detected:', { \n        isReset, \n        accessToken: !!accessToken, \n        refreshToken: !!refreshToken, \n        hashAccessToken: !!hashAccessToken,\n        hashRefreshToken: !!hashRefreshToken,\n        type,\n        hashType,\n        code: !!code\n      });\n      \n      // Hide all other forms and show only password reset form\n      setIsSignUp(false);\n      setShowForgotPassword(false);\n      setShowPasswordResetForm(true);\n      \n      // If we have a code, exchange it for a session\n      if (code) {\n        console.log('Authorization code detected, exchanging for session...');\n        supabase.auth.exchangeCodeForSession(code).then(({ data, error }) => {\n          if (error) {\n            console.error('Error exchanging code for session:', error);\n          } else {\n            console.log('Code exchanged successfully, session established:', data.session?.user?.id);\n            // The auth state change listener should handle the session\n          }\n        });\n      }\n      // Use tokens from either query params or hash fragment\n      else if (accessToken && refreshToken) {\n        console.log('Setting recovery session with tokens...');\n        supabase.auth.setSession({\n          access_token: accessToken,\n          refresh_token: refreshToken\n        }).then(({ data, error }) => {\n          if (error) {\n            console.error('Error setting recovery session:', error);\n          } else {\n            console.log('Recovery session set successfully');\n          }\n        });\n      } else {\n        console.log('No recovery tokens found, but recovery flow detected');\n        \n        // If we detect recovery flow but no tokens, try to handle it as a recovery request\n        // This might happen when Supabase redirects after processing the verification\n        if (type === 'recovery' || hashType === 'recovery') {\n          console.log('Recovery type detected, waiting for session...');\n          // The auth state change listener should handle this\n        }\n      }\n    } else {\n      console.log('No password reset flow detected');\n    }\n  }, []);\n\n  // Listen for auth state changes to handle recovery flow\n  useEffect(() => {\n    const { data: { subscription } } = supabase.auth.onAuthStateChange((event, session) => {\n      console.log('Auth state change:', event, session?.user?.id);\n      \n      // If we get a recovery event and have a session, show password reset form\n      if (event === 'PASSWORD_RECOVERY' && session?.user) {\n        console.log('Password recovery event detected, showing reset form');\n        setIsSignUp(false);\n        setShowForgotPassword(false);\n        setShowPasswordResetForm(true);\n      }\n      \n      // If we get a token refreshed event and it's a recovery session, show password reset form\n      if (event === 'TOKEN_REFRESHED' && session?.user && window.location.hash.includes('type=recovery')) {\n        console.log('Token refreshed for recovery, showing reset form');\n        setIsSignUp(false);\n        setShowForgotPassword(false);\n        setShowPasswordResetForm(true);\n      }\n      \n      // If we get a session and we're in recovery mode, show password reset form\n      if (event === 'SIGNED_IN' && session?.user && (window.location.hash.includes('type=recovery') || window.location.search.includes('type=recovery'))) {\n        console.log('Signed in with recovery session, showing reset form');\n        setIsSignUp(false);\n        setShowForgotPassword(false);\n        setShowPasswordResetForm(true);\n      }\n      \n      // If we get a session and we have a code parameter (recovery flow), show password reset form\n      if (event === 'SIGNED_IN' && session?.user && window.location.search.includes('code=')) {\n        console.log('Signed in with recovery code, showing reset form');\n        setIsSignUp(false);\n        setShowForgotPassword(false);\n        setShowPasswordResetForm(true);\n      }\n    });\n\n    return () => subscription.unsubscribe();\n  }, []);\n\n  const handleSubmit = async (e: React.FormEvent): Promise<void> => {\n    e.preventDefault();\n    setIsLoading(true);\n\n    try {\n      if (isSignUp) {\n        const { error } = await supabase.auth.signUp({\n          email: formData.email,\n          password: formData.password,\n          options: {\n            data: {\n              full_name: formData.fullName\n            },\n            emailRedirectTo: `${window.location.origin}/`\n          }\n        });\n\n        if (error) throw error;\n\n        toast({\n          title: \"Account created!\",\n          description: \"Please check your email to verify your account.\",\n        });\n      } else {\n        const { error } = await supabase.auth.signInWithPassword({\n          email: formData.email,\n          password: formData.password,\n        });\n\n        if (error) throw error;\n\n        toast({\n          title: \"Welcome back!\",\n          description: \"You have been signed in successfully.\",\n        });\n\n        // Redirect to dashboard after successful login\n        navigate('/dashboard?view=dashboard');\n      }\n    } catch (error: any) {\n      console.error('Authentication error:', error);\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Handle password reset request\n  const handlePasswordReset = async (e: React.FormEvent): Promise<void> => {\n    e.preventDefault();\n    setIsLoading(true);\n\n    try {\n      const { error } = await supabase.auth.resetPasswordForEmail(passwordResetEmail, {\n        redirectTo: `${window.location.origin}/auth`\n      });\n\n      if (error) throw error;\n\n      setPasswordResetSent(true);\n      toast({\n        title: \"Password reset email sent!\",\n        description: \"Check your email for a link to reset your password.\",\n      });\n    } catch (error: any) {\n      console.error('Password reset error:', error);\n      toast({\n        title: \"Error\",\n        description: error.message || 'Failed to send password reset email',\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Reset the forgot password form\n  const handleBackToSignIn = (): void => {\n    setShowForgotPassword(false);\n    setPasswordResetEmail('');\n    setPasswordResetSent(false);\n    setShowPasswordResetForm(false);\n    setNewPassword('');\n    setConfirmPassword('');\n  };\n\n  // Handle actual password reset\n  const handlePasswordResetSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (newPassword !== confirmPassword) {\n      toast({\n        title: \"Passwords don't match\",\n        description: \"Please make sure both passwords are identical.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (newPassword.length < 6) {\n      toast({\n        title: \"Password too short\",\n        description: \"Password must be at least 6 characters long.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsLoading(true);\n\n    try {\n      // Use the recovery flow to set the new password\n      const { error } = await supabase.auth.updateUser({\n        password: newPassword\n      });\n\n      if (error) throw error;\n\n      toast({\n        title: \"Password updated successfully!\",\n        description: \"You can now sign in with your new password.\",\n      });\n\n      // Reset form and show sign in\n      setShowPasswordResetForm(false);\n      setShowForgotPassword(false);\n      setNewPassword('');\n      setConfirmPassword('');\n      setIsSignUp(false);\n      \n      // Clean up the URL by removing the recovery code parameter\n      const url = new URL(window.location.href);\n      url.searchParams.delete('code');\n      url.searchParams.delete('access_token');\n      url.searchParams.delete('refresh_token');\n      url.searchParams.delete('type');\n      url.searchParams.delete('reset');\n      \n      // Update the URL without the recovery parameters\n      window.history.replaceState({}, '', url.toString());\n      console.log('URL cleaned up after successful password reset');\n    } catch (error: any) {\n      console.error('Password reset error:', error);\n      \n      // If session is missing, provide better error message\n      if (error.message?.includes('Auth session missing')) {\n        toast({\n          title: \"Reset link expired\",\n          description: \"The password reset link has expired. Please request a new one.\",\n          variant: \"destructive\",\n        });\n      } else {\n        toast({\n          title: \"Error\",\n          description: error.message || 'Failed to update password',\n          variant: \"destructive\",\n        });\n      }\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Developer login function - handles development authentication\n  const handleDevLogin = async (): Promise<void> => {\n    setIsLoading(true);\n    \n    try {\n      const { email, password } = devFormData;\n      \n      // First, try to sign in with existing account\n      const { data: signInData, error: signInError } = await supabase.auth.signInWithPassword({\n        email,\n        password,\n      });\n\n      if (signInData.user) {\n        // Successfully signed in\n        toast({\n          title: \"Developer Login Successful!\",\n          description: \"Welcome back to development mode!\",\n        });\n        \n        // Redirect to dashboard after successful login\n        navigate('/dashboard?view=dashboard');\n        return;\n      }\n\n      // Log detailed error information\n      if (signInError) {\n        console.error('Sign in error details:', {\n          message: signInError.message,\n          status: signInError.status,\n          name: signInError.name,\n          details: signInError\n        });\n      }\n\n      // If sign in failed due to unverified email, we need to handle this differently\n      if (signInError?.message?.includes('Email not confirmed')) {\n        // Try to resend confirmation email\n        const { error: resendError } = await supabase.auth.resend({\n          type: 'signup',\n          email: email,\n        });\n\n        if (resendError) {\n          console.error('Resend error:', resendError);\n        }\n\n        toast({\n          title: \"Email Verification Required\",\n          description: \"Account exists but email not verified. Check your email or try creating a new account.\",\n          variant: \"destructive\",\n        });\n        return;\n      }\n\n      // If sign in failed for other reasons, try to create a new account\n      if (signInError) {\n        \n        const { data: signUpData, error: signUpError } = await supabase.auth.signUp({\n          email,\n          password,\n          options: {\n            data: {\n              full_name: 'Developer User'\n            }\n          }\n        });\n\n        if (signUpError) {\n          console.error('Signup error details:', {\n            message: signUpError.message,\n            status: signUpError.status,\n            name: signUpError.name,\n            details: signUpError\n          });\n          throw signUpError;\n        }\n\n        if (signUpData.user) {\n          // Account created successfully\n          toast({\n            title: \"Developer Account Created!\",\n            description: \"Account created successfully. Check your email for verification.\",\n          });\n          \n          // In development, we can try to sign in without verification\n          // This might work if the account is auto-confirmed\n          setTimeout(async () => {\n            const { error: retrySignInError } = await supabase.auth.signInWithPassword({\n              email,\n              password,\n            });\n\n            if (retrySignInError) {\n              // Retry signin still requires verification\n            }\n          }, 2000);\n        }\n      }\n    } catch (error: any) {\n      console.error('Developer login error:', error);\n      toast({\n        title: \"Developer Login Error\",\n        description: error.message || 'An error occurred during developer login',\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Development authentication - creates a real Supabase account and handles verification\n  const handleDevAuth = async (): Promise<void> => {\n    setIsLoading(true);\n    \n    try {\n      const { email, password } = devFormData;\n      \n      // First, try to sign in with existing account\n      const { data: signInData, error: signInError } = await supabase.auth.signInWithPassword({\n        email,\n        password,\n      });\n\n      if (signInData.user) {\n        // Successfully signed in\n        toast({\n          title: \"Developer Login Successful!\",\n          description: \"Welcome back to development mode!\",\n        });\n        \n        // Redirect to dashboard after successful login\n        navigate('/dashboard?view=dashboard');\n        return;\n      }\n\n      // If sign in failed, create a new account\n      if (signInError) {\n        \n        const { data: signUpData, error: signUpError } = await supabase.auth.signUp({\n          email,\n          password,\n          options: {\n            data: {\n              full_name: 'Developer User'\n            }\n          }\n        });\n\n        if (signUpError) {\n          console.error('Signup error:', signUpError);\n          throw signUpError;\n        }\n\n        if (signUpData.user) {\n          // Account created successfully\n          toast({\n            title: \"Developer Account Created!\",\n            description: \"Account created successfully. In development, you can sign in immediately.\",\n          });\n          \n          // In development, try to sign in immediately after account creation\n          // This sometimes works if the account is auto-confirmed\n          const { error: immediateSignInError } = await supabase.auth.signInWithPassword({\n            email,\n            password,\n          });\n\n          if (immediateSignInError) {\n            // If immediate sign-in fails, provide instructions\n            toast({\n              title: \"Account Created\",\n              description: \"Account created but requires verification. Check your email or try signing in manually.\",\n            });\n          } else {\n            toast({\n              title: \"Auto-Login Successful!\",\n              description: \"Account created and signed in automatically!\",\n            });\n          }\n        }\n      }\n    } catch (error: any) {\n      console.error('Developer auth error:', error);\n      toast({\n        title: \"Developer Auth Error\",\n        description: error.message || 'An error occurred during developer authentication',\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background flex flex-col\">\n      <div className=\"flex-1 flex items-center justify-center page-padding\">\n        <GlassCard className=\"w-full max-w-md floating-card\">\n        <GlassCardHeader className=\"text-center\">\n          <GlassCardTitle className=\"heading-lg bg-gradient-primary bg-clip-text text-transparent\">\n            {isSignUp ? 'Create Account' : 'Welcome Back'}\n          </GlassCardTitle>\n          <p className=\"body-md text-muted-foreground\">\n            {isSignUp ? 'Join Air Quality Tracker' : 'Sign in to your account'}\n          </p>\n        </GlassCardHeader>\n        \n        <GlassCardContent>\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            {isSignUp && (\n              <div className=\"space-y-2\">\n                <label htmlFor=\"fullName\" className=\"text-sm font-medium\">\n                  Full Name\n                </label>\n                <Input\n                  id=\"fullName\"\n                  type=\"text\"\n                  value={formData.fullName}\n                  onChange={(e) => setFormData({ ...formData, fullName: e.target.value })}\n                  required={isSignUp}\n                  className=\"bg-background border-border\"\n                />\n              </div>\n            )}\n            \n            <div className=\"space-y-2\">\n              <label htmlFor=\"email\" className=\"text-sm font-medium\">\n                Email\n              </label>\n              <Input\n                id=\"email\"\n                type=\"email\"\n                value={formData.email}\n                onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n                required\n                className=\"bg-background border-border\"\n              />\n            </div>\n            \n            <div className=\"space-y-2\">\n              <label htmlFor=\"password\" className=\"text-sm font-medium\">\n                Password\n              </label>\n              <div className=\"relative\">\n                <Input\n                  id=\"password\"\n                  type={showPassword ? 'text' : 'password'}\n                  value={formData.password}\n                  onChange={(e) => setFormData({ ...formData, password: e.target.value })}\n                  required\n                  className=\"bg-background border-border pr-10\"\n                />\n                <Button\n                  type=\"button\"\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent\"\n                  onClick={() => setShowPassword(!showPassword)}\n                >\n                  {showPassword ? (\n                    <EyeOff className=\"h-4 w-4\" />\n                  ) : (\n                    <Eye className=\"h-4 w-4\" />\n                  )}\n                </Button>\n              </div>\n            </div>\n            \n            {/* Forgot Password Link - Only show on sign in */}\n            {!isSignUp && (\n              <div className=\"text-right\">\n                <Button\n                  type=\"button\"\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={() => setShowForgotPassword(true)}\n                  className=\"text-sm text-muted-foreground hover:text-foreground p-0 h-auto\"\n                >\n                  Forgot your password?\n                </Button>\n              </div>\n            )}\n            \n            <Button\n              type=\"submit\"\n              className=\"w-full bg-primary hover:bg-primary/90\"\n              disabled={isLoading}\n            >\n              {isLoading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n              {isSignUp ? 'Create Account' : 'Sign In'}\n            </Button>\n          </form>\n          \n          <div className=\"mt-4 text-center\">\n            <Button\n              variant=\"ghost\"\n              onClick={() => setIsSignUp(!isSignUp)}\n              className=\"text-sm text-muted-foreground hover:text-foreground\"\n            >\n              {isSignUp ? 'Already have an account? Sign in' : \"Don't have an account? Sign up\"}\n            </Button>\n          </div>\n\n          {/* Forgot Password Form */}\n          {showForgotPassword && (\n            <div className=\"mt-6 pt-6 border-t border-border\">\n              <div className=\"text-center space-y-4\">\n                <div className=\"flex items-center justify-center gap-2 text-sm text-muted-foreground\">\n                  <Mail className=\"h-4 w-4\" />\n                  <span>Reset your password</span>\n                </div>\n                \n                {!passwordResetSent ? (\n                  <form onSubmit={handlePasswordReset} className=\"space-y-4\">\n                    <div className=\"space-y-2\">\n                      <label htmlFor=\"resetEmail\" className=\"text-sm font-medium text-left block\">\n                        Email Address\n                      </label>\n                      <Input\n                        id=\"resetEmail\"\n                        type=\"email\"\n                        value={passwordResetEmail}\n                        onChange={(e) => setPasswordResetEmail(e.target.value)}\n                        required\n                        className=\"bg-background border-border\"\n                        placeholder=\"Enter your email address\"\n                      />\n                    </div>\n                    \n                    <Button\n                      type=\"submit\"\n                      variant=\"outline\"\n                      className=\"w-full\"\n                      disabled={isLoading}\n                    >\n                      {isLoading ? (\n                        <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                      ) : (\n                        <Mail className=\"mr-2 h-4 w-4\" />\n                      )}\n                      Send Reset Link\n                    </Button>\n                  </form>\n                ) : (\n                  <div className=\"space-y-4\">\n                    <div className=\"flex items-center justify-center gap-2 text-green-600\">\n                      <CheckCircle className=\"h-5 w-5\" />\n                      <span className=\"font-medium\">Reset email sent!</span>\n                    </div>\n                    <p className=\"text-sm text-muted-foreground\">\n                      Check your email for a link to reset your password. The link will expire in 24 hours.\n                    </p>\n                  </div>\n                )}\n                \n                <Button\n                  type=\"button\"\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={handleBackToSignIn}\n                  className=\"text-sm text-muted-foreground hover:text-foreground\"\n                >\n                  <ArrowLeft className=\"mr-2 h-4 w-4\" />\n                  Back to sign in\n                </Button>\n              </div>\n            </div>\n          )}\n\n          {/* Password Reset Form - Shows when user returns from email link */}\n          {showPasswordResetForm && (\n            <div className=\"mt-6 pt-6 border-t border-border\">\n              <div className=\"text-center space-y-4\">\n                <div className=\"flex items-center justify-center gap-2 text-sm text-muted-foreground\">\n                  <CheckCircle className=\"h-4 w-4\" />\n                  <span>Set your new password</span>\n                </div>\n                \n                <form onSubmit={handlePasswordResetSubmit} className=\"space-y-4\">\n                  <div className=\"space-y-2\">\n                    <label htmlFor=\"newPassword\" className=\"text-sm font-medium text-left block\">\n                      New Password\n                    </label>\n                    <div className=\"relative\">\n                      <Input\n                        id=\"newPassword\"\n                        type={showNewPassword ? 'text' : 'password'}\n                        value={newPassword}\n                        onChange={(e) => setNewPassword(e.target.value)}\n                        required\n                        className=\"bg-background border-border pr-10\"\n                        placeholder=\"Enter your new password\"\n                      />\n                      <Button\n                        type=\"button\"\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        className=\"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent\"\n                        onClick={() => setShowNewPassword(!showNewPassword)}\n                      >\n                        {showNewPassword ? (\n                          <EyeOff className=\"h-4 w-4\" />\n                        ) : (\n                          <Eye className=\"h-4 w-4\" />\n                        )}\n                      </Button>\n                    </div>\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <label htmlFor=\"confirmPassword\" className=\"text-sm font-medium text-left block\">\n                      Confirm New Password\n                    </label>\n                    <div className=\"relative\">\n                      <Input\n                        id=\"confirmPassword\"\n                        type={showConfirmPassword ? 'text' : 'password'}\n                        value={confirmPassword}\n                        onChange={(e) => setConfirmPassword(e.target.value)}\n                        required\n                        className=\"bg-background border-border pr-10\"\n                        placeholder=\"Confirm your new password\"\n                      />\n                      <Button\n                        type=\"button\"\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        className=\"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent\"\n                        onClick={() => setShowConfirmPassword(!showConfirmPassword)}\n                      >\n                        {showConfirmPassword ? (\n                          <EyeOff className=\"h-4 w-4\" />\n                        ) : (\n                          <Eye className=\"h-4 w-4\" />\n                        )}\n                      </Button>\n                    </div>\n                  </div>\n                  \n                  <Button\n                    type=\"submit\"\n                    className=\"w-full bg-primary hover:bg-primary/90\"\n                    disabled={isLoading}\n                  >\n                    {isLoading ? (\n                      <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                    ) : (\n                      <CheckCircle className=\"mr-2 h-4 w-4\" />\n                    )}\n                    Update Password\n                  </Button>\n                </form>\n                \n                <Button\n                  type=\"button\"\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={handleBackToSignIn}\n                  className=\"text-sm text-muted-foreground hover:text-foreground\"\n                >\n                  <ArrowLeft className=\"mr-2 h-4 w-4\" />\n                  Back to sign in\n                </Button>\n              </div>\n            </div>\n          )}\n\n          {/* Developer Login Section - Only visible in development */}\n          {isDevelopment && (\n            <div className=\"mt-6 pt-6 border-t border-border\">\n              <div className=\"text-center space-y-3\">\n                <div className=\"flex items-center justify-center gap-2 text-xs text-muted-foreground\">\n                  <Code className=\"h-3 w-3\" />\n                  <span>Development Mode</span>\n                </div>\n                \n                <Button\n                  type=\"button\"\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={() => setShowDevLogin(!showDevLogin)}\n                  className=\"text-xs text-muted-foreground hover:text-foreground\"\n                >\n                  {showDevLogin ? 'Hide' : 'Show'} Developer Login\n                </Button>\n                \n                {showDevLogin && (\n                  <div className=\"bg-muted/50 rounded-lg p-3 space-y-3\">\n                    <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                      <AlertTriangle className=\"h-3 w-3\" />\n                      <span>Development login (creates account if needed)</span>\n                    </div>\n                    \n                    <div className=\"space-y-2\">\n                      <div className=\"space-y-1\">\n                        <label className=\"text-xs font-medium text-left block\">\n                          Email\n                        </label>\n                        <Input\n                          type=\"email\"\n                          value={devFormData.email}\n                          onChange={(e) => setDevFormData({ ...devFormData, email: e.target.value })}\n                          className=\"h-8 text-xs bg-background border-border\"\n                          placeholder=\"dev@breathsafe.dev\"\n                        />\n                      </div>\n                      \n                      <div className=\"space-y-1\">\n                        <label className=\"text-xs font-medium text-left block\">\n                          Password\n                        </label>\n                        <Input\n                          type=\"password\"\n                          value={devFormData.password}\n                          onChange={(e) => setDevFormData({ ...devFormData, password: e.target.value })}\n                          className=\"h-8 text-xs bg-background border-border\"\n                          placeholder=\"devpassword123\"\n                        />\n                      </div>\n                    </div>\n                    \n                    <Button\n                      type=\"button\"\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={handleDevAuth}\n                      disabled={isLoading}\n                      className=\"w-full text-xs\"\n                    >\n                      {isLoading ? (\n                        <Loader2 className=\"h-3 w-3 animate-spin mr-2\" />\n                      ) : (\n                        <Code className=\"h-3 w-3 mr-2\" />\n                      )}\n                      Developer Authentication\n                    </Button>\n                    \n                    <div className=\"text-xs text-muted-foreground text-left\">\n                      <div>Default: dev@breathsafe.com / devpassword123</div>\n                      <div>Creates a real Supabase account for development</div>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n        </GlassCardContent>\n      </GlassCard>\n      </div>\n      \n      {/* Footer */}\n      \n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\pages\\Contact.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'MapPin' is defined but never used.","line":4,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"MapPin"},"fix":{"range":[215,223],"text":""},"desc":"Remove unused variable 'MapPin'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MapPin' is defined but never used.","line":4,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":29}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { motion } from \"framer-motion\";\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from \"@/components/ui/GlassCard\";\nimport { Button } from \"@/components/ui/button\";\nimport { Mail, Phone, MapPin, Clock, ArrowLeft } from \"lucide-react\";\nimport { Link } from \"react-router-dom\";\nimport Footer from \"@/components/Footer\";\n\nexport default function Contact(): JSX.Element {\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-background via-accent/20 to-secondary/30\">\n      {/* Header */}\n      <div className=\"bg-card border-b border-border backdrop-blur-xl\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\n          <div className=\"flex items-center gap-4\">\n            <Link to=\"/\">\n              <Button variant=\"ghost\" size=\"sm\">\n                <ArrowLeft className=\"h-4 w-4 mr-2\" />\n                Back to Home\n              </Button>\n            </Link>\n            <div>\n              <h1 className=\"text-2xl font-bold text-foreground\">Contact Information</h1>\n              <p className=\"text-muted-foreground\">Get in touch with the Breath Safe team</p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n          {/* Contact Information */}\n          <div className=\"space-y-6\">\n            <motion.div\n              initial={{ opacity: 0, x: -20 }}\n              animate={{ opacity: 1, x: 0 }}\n              transition={{ duration: 0.5, ease: \"easeOut\" }}\n            >\n              <h2 className=\"text-2xl font-bold text-foreground mb-4\">Get in Touch</h2>\n              <p className=\"text-muted-foreground mb-6\">\n                Have questions about air quality monitoring or need support with your Breath Safe account? \n                We're here to help you breathe easier.\n              </p>\n            </motion.div>\n\n            <motion.div\n              className=\"space-y-4\"\n              initial={{ opacity: 0, x: -20 }}\n              animate={{ opacity: 1, x: 0 }}\n              transition={{ duration: 0.5, ease: \"easeOut\", delay: 0.1 }}\n            >\n              <GlassCard className=\"floating-card\">\n                <GlassCardContent className=\"p-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center\">\n                      <Mail className=\"h-5 w-5 text-primary\" />\n                    </div>\n                    <div>\n                      <h3 className=\"font-semibold text-foreground\">Email Support</h3>\n                      <p className=\"text-sm text-muted-foreground\">support@breathsafe.com</p>\n                    </div>\n                  </div>\n                </GlassCardContent>\n              </GlassCard>\n\n              <GlassCard className=\"floating-card\">\n                <GlassCardContent className=\"p-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center\">\n                      <Phone className=\"h-5 w-5 text-primary\" />\n                    </div>\n                    <div>\n                      <h3 className=\"font-semibold text-foreground\">Phone Support</h3>\n                      <p className=\"text-sm text-muted-foreground\">+1 (555) 123-4567</p>\n                    </div>\n                  </div>\n                </GlassCardContent>\n              </GlassCard>\n\n              <GlassCard className=\"floating-card\">\n                <GlassCardContent className=\"p-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center\">\n                      <Clock className=\"h-5 w-5 text-primary\" />\n                    </div>\n                    <div>\n                      <h3 className=\"font-semibold text-foreground\">Support Hours</h3>\n                      <p className=\"text-sm text-muted-foreground\">Monday - Friday: 9 AM - 6 PM EST</p>\n                    </div>\n                  </div>\n                </GlassCardContent>\n              </GlassCard>\n            </motion.div>\n          </div>\n\n          {/* Contact Form */}\n          <motion.div\n            initial={{ opacity: 0, x: 20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ duration: 0.5, ease: \"easeOut\", delay: 0.2 }}\n          >\n            <GlassCard className=\"floating-card\">\n              <GlassCardHeader>\n                <GlassCardTitle className=\"text-xl font-semibold\">Send us a Message</GlassCardTitle>\n                <p className=\"text-sm text-muted-foreground\">\n                  Fill out the form below and we'll get back to you within 24 hours.\n                </p>\n              </GlassCardHeader>\n              <GlassCardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-foreground mb-2\">\n                      First Name\n                    </label>\n                    <input\n                      type=\"text\"\n                      className=\"w-full px-3 py-2 border border-border rounded-md bg-background text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent\"\n                      placeholder=\"John\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"block text-sm font-medium text-foreground mb-2\">\n                      Last Name\n                    </label>\n                    <input\n                      type=\"text\"\n                      className=\"w-full px-3 py-2 border border-border rounded-md bg-background text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent\"\n                      placeholder=\"Doe\"\n                    />\n                  </div>\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-foreground mb-2\">\n                    Email Address\n                  </label>\n                  <input\n                    type=\"email\"\n                    className=\"w-full px-3 py-2 border border-border rounded-md bg-background text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent\"\n                    placeholder=\"john.doe@example.com\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-foreground mb-2\">\n                    Subject\n                  </label>\n                  <select className=\"w-full px-3 py-2 border border-border rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent\">\n                    <option value=\"\">Select a subject</option>\n                    <option value=\"general\">General Inquiry</option>\n                    <option value=\"technical\">Technical Support</option>\n                    <option value=\"billing\">Billing Question</option>\n                    <option value=\"feature\">Feature Request</option>\n                    <option value=\"bug\">Bug Report</option>\n                  </select>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-foreground mb-2\">\n                    Message\n                  </label>\n                  <textarea\n                    rows={4}\n                    className=\"w-full px-3 py-2 border border-border rounded-md bg-background text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent resize-none\"\n                    placeholder=\"Tell us how we can help you...\"\n                  ></textarea>\n                </div>\n\n                <Button className=\"w-full bg-primary hover:bg-primary/90\">\n                  Send Message\n                </Button>\n              </GlassCardContent>\n            </GlassCard>\n          </motion.div>\n        </div>\n\n        {/* Additional Information */}\n        <motion.div\n          className=\"mt-12\"\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5, ease: \"easeOut\", delay: 0.3 }}\n        >\n          <GlassCard className=\"floating-card\">\n            <GlassCardContent className=\"p-6\">\n              <h3 className=\"text-lg font-semibold text-foreground mb-4\">Frequently Asked Questions</h3>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-muted-foreground\">\n                <div>\n                  <p><strong>How accurate is the air quality data?</strong></p>\n                  <p>Our data comes from multiple reliable sources including OpenWeatherMap and government monitoring stations.</p>\n                </div>\n                <div>\n                  <p><strong>Can I use the app without location access?</strong></p>\n                  <p>Yes, but with limited functionality. Location access provides the most accurate local data.</p>\n                </div>\n                <div>\n                  <p><strong>How often is the data updated?</strong></p>\n                  <p>Air quality data is refreshed every 15 minutes for real-time accuracy.</p>\n                </div>\n                <div>\n                  <p><strong>Is my data private?</strong></p>\n                  <p>Absolutely. We never share your personal data or location information with third parties.</p>\n                </div>\n              </div>\n            </GlassCardContent>\n          </GlassCard>\n        </motion.div>\n      </div>\n\n      {/* Footer */}\n      <Footer />\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\pages\\Demo.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'navigate' is assigned a value but never used.","line":116,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":116,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"navigate"},"fix":{"range":[4854,4885],"text":""},"desc":"Remove unused variable 'navigate'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'navigate' is assigned a value but never used.","line":116,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":116,"endColumn":17},{"ruleId":"no-unused-vars","severity":1,"message":"'setSearchParams' is assigned a value but never used.","line":117,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":117,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"setSearchParams"},"fix":{"range":[4907,4924],"text":""},"desc":"Remove unused variable 'setSearchParams'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setSearchParams' is assigned a value but never used.","line":117,"column":24,"nodeType":null,"messageId":"unusedVar","endLine":117,"endColumn":39},{"ruleId":"no-undef","severity":1,"message":"'EventListener' is not defined.","line":129,"column":63,"nodeType":"Identifier","messageId":"undef","endLine":129,"endColumn":76},{"ruleId":"no-undef","severity":1,"message":"'EventListener' is not defined.","line":132,"column":68,"nodeType":"Identifier","messageId":"undef","endLine":132,"endColumn":81},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'currentView' and 'searchParams'. Either include them or remove the dependency array.","line":143,"column":6,"nodeType":"ArrayExpression","endLine":143,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [currentView, searchParams]","fix":{"range":[5837,5839],"text":"[currentView, searchParams]"}}]},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'toggleMobileMenu' was used before it was defined.","line":173,"column":35,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":173,"endColumn":51},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'toggleMobileMenu' was used before it was defined.","line":183,"column":35,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":183,"endColumn":51}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, Suspense, lazy } from \"react\";\nimport { useNavigate, useSearchParams } from \"react-router-dom\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { Button } from \"@/components/ui/button\";\nimport { Lock, ArrowRight, Home, Map, User, Trophy, ShoppingBag, Settings, Newspaper } from \"lucide-react\";\nimport BackgroundManager from \"@/components/BackgroundManager\";\nimport Footer from \"@/components/Footer\";\n\n// Lazy load only the components needed for demo mode\nconst AirQualityDashboard = lazy(() => \n  import(\"@/components/AirQualityDashboard\").then(module => ({\n    default: module.AirQualityDashboard\n  }))\n);\nconst WeatherStats = lazy(() => import(\"@/components/WeatherStats\"));\n\n// Loading skeleton for lazy components\nconst PageSkeleton = () => (\n  <div className=\"min-h-screen bg-background flex items-center justify-center\">\n    <div className=\"text-center space-y-4\">\n      <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto\"></div>\n      <p className=\"text-muted-foreground\">Loading...</p>\n    </div>\n  </div>\n);\n\n// Sign-up prompt component for restricted features\nconst SignUpPrompt = ({ feature }: { feature: string }) => (\n  <motion.div \n    className=\"min-h-screen bg-gradient-to-br from-background via-accent/20 to-secondary/30 flex items-center justify-center p-4\"\n    initial={{ opacity: 0, scale: 0.95 }}\n    animate={{ opacity: 1, scale: 1 }}\n    transition={{ duration: 0.5, ease: \"easeOut\" }}\n  >\n    <div className=\"max-w-2xl mx-auto text-center space-y-8\">\n      <div className=\"w-24 h-24 bg-gradient-to-br from-primary to-secondary rounded-full flex items-center justify-center mx-auto shadow-2xl\">\n        <Lock className=\"h-12 w-12 text-primary-foreground\" />\n      </div>\n      \n      <div className=\"space-y-4\">\n        <h1 className=\"text-4xl md:text-5xl font-black text-foreground\">\n          Unlock {feature}\n        </h1>\n        <p className=\"text-xl text-muted-foreground max-w-lg mx-auto leading-relaxed\">\n          Create your free account to access comprehensive air quality data, track your environmental exposure, and start earning rewards today.\n        </p>\n      </div>\n\n      <div className=\"space-y-4\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 max-w-md mx-auto\">\n          <div className=\"text-left space-y-2\">\n            <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n              <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\n              Real-time AQI data\n            </div>\n            <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n              <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\n              Personal health tracking\n            </div>\n            <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n              <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\n              Achievement system\n            </div>\n          </div>\n          <div className=\"text-left space-y-2\">\n            <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n              <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\n              Data history\n            </div>\n            <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n              <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\n              Rewards store\n            </div>\n            <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n              <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\n              Community features\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"flex flex-col sm:flex-row gap-4 justify-center items-center\">\n        <Button \n          size=\"lg\" \n          onClick={() => window.location.href = \"/onboarding\"}\n          className=\"px-8 py-4 text-lg font-semibold bg-primary hover:bg-primary/90 text-primary-foreground shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105\"\n        >\n          Create Free Account\n          <ArrowRight className=\"ml-2 h-5 w-5\" />\n        </Button>\n        \n        <Button \n          variant=\"outline\" \n          size=\"lg\" \n          onClick={() => window.location.href = \"/auth\"}\n          className=\"px-8 py-4 text-lg font-semibold border-2 hover:bg-accent transition-all duration-300\"\n        >\n          Sign In\n        </Button>\n      </div>\n\n      <div className=\"pt-8\">\n        <Button \n          variant=\"ghost\" \n          onClick={() => window.location.href = \"/demo?view=dashboard\"}\n          className=\"text-muted-foreground hover:text-foreground\"\n        >\n          ← Back to Demo Dashboard\n        </Button>\n      </div>\n    </div>\n  </motion.div>\n);\n\nexport default function Demo(): JSX.Element {\n  const navigate = useNavigate();\n  const [searchParams, setSearchParams] = useSearchParams();\n  const [currentView, setCurrentView] = useState(\"dashboard\");\n  const [showMobileMenu, setShowMobileMenu] = useState(false);\n  \n  // Listen for custom view change events\n  useEffect(() => {\n    const handleViewChange = (event: CustomEvent) => {\n      const newView = event.detail.view;\n      console.log('Demo component - View change event received:', newView);\n      setCurrentView(newView);\n    };\n\n    window.addEventListener('viewChange', handleViewChange as EventListener);\n    \n    return () => {\n      window.removeEventListener('viewChange', handleViewChange as EventListener);\n    };\n  }, []);\n\n  // Initialize current view from URL parameters on mount only\n  useEffect(() => {\n    const view = searchParams.get(\"view\") || \"dashboard\";\n    if (view !== currentView) {\n      console.log('Demo component - Initializing view from URL:', view);\n      setCurrentView(view);\n    }\n  }, []); // Empty dependency array - only run on mount\n\n  const handleViewChange = (view: string) => {\n    setCurrentView(view);\n    // Update URL without page reload\n    const newUrl = new URL(window.location.href);\n    newUrl.searchParams.set('view', view);\n    window.history.pushState({}, '', newUrl.toString());\n  };\n\n  // Demo navigation items - only dashboard and weather are accessible\n  const demoNavItems = [\n    { id: \"dashboard\", label: \"Dashboard\", icon: Home, accessible: true },\n    { id: \"map\", label: \"Weather\", icon: Map, accessible: true },\n    { id: \"history\", label: \"History\", icon: User, accessible: false, feature: \"Data History\" },\n    { id: \"rewards\", label: \"Rewards\", icon: Trophy, accessible: false, feature: \"Rewards System\" },\n    { id: \"store\", label: \"Store\", icon: ShoppingBag, accessible: false, feature: \"Rewards Store\" },\n    { id: \"profile\", label: \"Profile\", icon: User, accessible: false, feature: \"Personal Profile\" },\n    { id: \"settings\", label: \"Settings\", icon: Settings, accessible: false, feature: \"App Settings\" },\n    { id: \"news\", label: \"News\", icon: Newspaper, accessible: false, feature: \"Health News\" },\n  ];\n\n  const renderView = (): JSX.Element => {\n    switch (currentView) {\n      case \"dashboard\":\n        return (\n          <Suspense fallback={<PageSkeleton />}>\n            <AirQualityDashboard \n              onNavigate={handleViewChange} \n              showMobileMenu={showMobileMenu}\n              onMobileMenuToggle={toggleMobileMenu}\n              isDemoMode={true}\n            />\n          </Suspense>\n        );\n      case \"map\":\n        return (\n          <Suspense fallback={<PageSkeleton />}>\n            <WeatherStats \n              showMobileMenu={showMobileMenu}\n              onMobileMenuToggle={toggleMobileMenu}\n              isDemoMode={true}\n            />\n          </Suspense>\n        );\n      default: {\n        // For all other views, show sign-up prompt\n        const navItem = demoNavItems.find(item => item.id === currentView);\n        return <SignUpPrompt feature={navItem?.feature || \"This Feature\"} />;\n      }\n    }\n  };\n\n  const toggleMobileMenu = () => {\n    setShowMobileMenu(!showMobileMenu);\n  };\n\n  return (\n    <BackgroundManager>\n      <div className=\"min-h-screen bg-gradient-to-br from-background via-accent/20 to-secondary/30 flex flex-col\">\n        {/* Demo Navigation Bar */}\n        <motion.nav \n          className=\"bg-card border-b border-border backdrop-blur-xl sticky top-0 z-50\"\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5, ease: \"easeOut\" }}\n        >\n          <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n            <div className=\"flex items-center justify-between h-16\">\n              {/* Logo and Title */}\n              <div className=\"flex items-center gap-3\">\n                <div className=\"w-8 h-8 bg-gradient-to-br from-primary to-secondary rounded-lg flex items-center justify-center\">\n                  <span className=\"text-primary-foreground font-bold text-sm\">B</span>\n                </div>\n                <div>\n                  <h1 className=\"text-lg font-semibold text-foreground\">Breath Safe</h1>\n                  <p className=\"text-xs text-muted-foreground\">Demo Mode</p>\n                </div>\n              </div>\n\n              {/* Demo Navigation */}\n              <div className=\"hidden md:flex items-center space-x-2\">\n                {demoNavItems.map((item) => {\n                  const Icon = item.icon;\n                  const isActive = currentView === item.id;\n                  const isAccessible = item.accessible;\n                  \n                  return (\n                    <Button\n                      key={item.id}\n                      variant={isActive ? \"default\" : \"ghost\"}\n                      size=\"sm\"\n                      onClick={() => handleViewChange(item.id)}\n                      className={`transition-all duration-200 ${\n                        isActive \n                          ? 'bg-gradient-to-br from-primary to-secondary text-primary-foreground' \n                          : isAccessible\n                            ? 'text-muted-foreground hover:text-foreground hover:bg-accent'\n                            : 'text-muted-foreground opacity-50 cursor-not-allowed'\n                      }`}\n                      disabled={!isAccessible}\n                      title={isAccessible ? item.label : `${item.label} - Sign up required`}\n                    >\n                      <Icon className=\"h-4 w-4 mr-2\" />\n                      {item.label}\n                      {!isAccessible && <Lock className=\"h-3 w-3 ml-2\" />}\n                    </Button>\n                  );\n                })}\n              </div>\n\n              {/* CTA Buttons */}\n              <div className=\"flex items-center space-x-2\">\n                <Button \n                  variant=\"outline\" \n                  size=\"sm\"\n                  onClick={() => window.location.href = \"/auth\"}\n                >\n                  Sign In\n                </Button>\n                <Button \n                  size=\"sm\"\n                  onClick={() => window.location.href = \"/onboarding\"}\n                  className=\"bg-primary hover:bg-primary/90\"\n                >\n                  Get Started\n                </Button>\n              </div>\n            </div>\n          </div>\n        </motion.nav>\n        \n        {/* Main Content Area */}\n        <div className=\"flex-1 p-4 sm:p-6 lg:p-8 w-full\">\n          <AnimatePresence mode=\"wait\">\n            <motion.div\n              key={currentView}\n              initial={{ opacity: 0, scale: 0.98 }}\n              animate={{ opacity: 1, scale: 1 }}\n              exit={{ opacity: 0, scale: 0.98 }}\n              transition={{ \n                duration: 0.3, \n                ease: \"easeInOut\"\n              }}\n            >\n              {renderView()}\n            </motion.div>\n          </AnimatePresence>\n        </div>\n\n        {/* Footer */}\n        <Footer />\n      </div>\n    </BackgroundManager>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\pages\\Index.tsx","messages":[{"ruleId":"no-undef","severity":1,"message":"'EventListener' is not defined.","line":56,"column":63,"nodeType":"Identifier","messageId":"undef","endLine":56,"endColumn":76},{"ruleId":"no-undef","severity":1,"message":"'EventListener' is not defined.","line":59,"column":68,"nodeType":"Identifier","messageId":"undef","endLine":59,"endColumn":81},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'currentView' and 'searchParams'. Either include them or remove the dependency array.","line":87,"column":6,"nodeType":"ArrayExpression","endLine":87,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [currentView, searchParams]","fix":{"range":[3459,3461],"text":"[currentView, searchParams]"}}]},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'toggleMobileMenu' was used before it was defined.","line":143,"column":37,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":143,"endColumn":53},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'toggleMobileMenu' was used before it was defined.","line":154,"column":37,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":154,"endColumn":53},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'toggleMobileMenu' was used before it was defined.","line":165,"column":37,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":165,"endColumn":53},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'toggleMobileMenu' was used before it was defined.","line":176,"column":37,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":176,"endColumn":53},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'toggleMobileMenu' was used before it was defined.","line":187,"column":37,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":187,"endColumn":53},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'toggleMobileMenu' was used before it was defined.","line":198,"column":37,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":198,"endColumn":53},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'toggleMobileMenu' was used before it was defined.","line":209,"column":37,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":209,"endColumn":53},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'toggleMobileMenu' was used before it was defined.","line":220,"column":37,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":220,"endColumn":53},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'toggleMobileMenu' was used before it was defined.","line":232,"column":37,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":232,"endColumn":53}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, Suspense, lazy } from \"react\";\nimport { useNavigate, useLocation, useSearchParams } from \"react-router-dom\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport Sidebar from \"@/components/Sidebar\";\nimport Footer from \"@/components/Footer\";\nimport MobileNavigation from \"@/components/MobileNavigation\";\nimport BackgroundManager from \"@/components/BackgroundManager\";\nimport { DeveloperTools } from \"@/components/DeveloperTools\";\nimport { cleanupAllChannels } from \"@/lib/realtimeClient\";\nimport EnhancedErrorBoundary from \"@/components/EnhancedErrorBoundary\";\nimport { logNavigation } from \"@/lib/logger\";\n\n// Lazy load heavy components\nconst AirQualityDashboard = lazy(() => \n  import(\"@/components/AirQualityDashboard\").then(module => ({\n    default: module.AirQualityDashboard\n  }))\n);\nconst HistoryView = lazy(() => import(\"@/components/HistoryView\"));\nconst WeatherStats = lazy(() => import(\"@/components/WeatherStats\"));\nconst ProfileView = lazy(() => import(\"@/components/ProfileView\"));\nconst SettingsView = lazy(() => import(\"@/components/SettingsView\"));\nconst Rewards = lazy(() => import(\"@/pages/Rewards\"));\nconst Store = lazy(() => import(\"@/pages/Store\"));\nconst NewsPage = lazy(() => import(\"@/components/NewsPage\"));\n\n// Loading skeleton for lazy components\nconst PageSkeleton = () => (\n  <div className=\"min-h-screen bg-background flex items-center justify-center\">\n    <div className=\"text-center space-y-4\">\n      <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto\"></div>\n      <p className=\"text-muted-foreground\">Loading...</p>\n    </div>\n  </div>\n);\n\nexport default function Index(): JSX.Element | null {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [searchParams] = useSearchParams();\n  const [currentView, setCurrentView] = useState(\"dashboard\");\n  const [showMobileMenu, setShowMobileMenu] = useState(false);\n  const [showDeveloperTools, setShowDeveloperTools] = useState(false);\n  \n  // Listen for custom view change events\n  useEffect(() => {\n    const handleViewChange = (event: CustomEvent) => {\n      const newView = event.detail.view;\n      logNavigation.debug('View change event received', { newView });\n      \n      // Update view immediately without delay\n      setCurrentView(newView);\n      logNavigation.debug('Current view updated', { newView });\n    };\n\n    window.addEventListener('viewChange', handleViewChange as EventListener);\n    \n    return () => {\n      window.removeEventListener('viewChange', handleViewChange as EventListener);\n    };\n  }, []);\n\n  // Keyboard shortcut for developer tools (Ctrl+Shift+D)\n  useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.ctrlKey && event.shiftKey && event.key === 'D') {\n        event.preventDefault();\n        setShowDeveloperTools(prev => !prev);\n        logNavigation.debug('Developer tools toggled', { showDeveloperTools: !showDeveloperTools });\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    \n    return () => {\n      window.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [showDeveloperTools]);\n\n  // Initialize current view from URL parameters on mount only\n  useEffect(() => {\n    const view = searchParams.get(\"view\") || \"dashboard\";\n    if (view !== currentView) {\n              logNavigation.debug('Initializing view from URL', { view });\n      setCurrentView(view);\n    }\n  }, []); // Empty dependency array - only run on mount\n\n  // Sync URL with component state when view changes\n  useEffect(() => {\n    const currentViewParam = searchParams.get(\"view\") || \"dashboard\";\n    if (currentView !== currentViewParam) {\n      logNavigation.debug('Syncing URL with view state', { currentView });\n      const newUrl = new URL(window.location.href);\n      newUrl.searchParams.set('view', currentView);\n      window.history.replaceState({}, '', newUrl.toString());\n    }\n  }, [currentView, searchParams]);\n\n  // Cleanup realtime channels on unmount\n  useEffect(() => {\n    return () => {\n      logNavigation.debug('Component unmounting - cleaning up realtime channels');\n      cleanupAllChannels();\n    };\n  }, []);\n\n  const handleViewChange = (view: string) => {\n    setCurrentView(view);\n    // Update URL without page reload\n    const newUrl = new URL(window.location.href);\n    newUrl.searchParams.set('view', view);\n    window.history.pushState({}, '', newUrl.toString());\n  };\n\n  // Debug logging\n  useEffect(() => {\n    logNavigation.debug('Current view and URL', { currentView, url: location.pathname + location.search });\n  }, [currentView, location]);\n\n  const renderView = (): JSX.Element => {\n    const makeFallback = (title: string, message: string) => (\n      <div className=\"min-h-[60vh] flex flex-col items-center justify-center gap-4 text-center\">\n        <h2 className=\"text-2xl font-semibold text-red-500\">{title}</h2>\n        <p className=\"text-muted-foreground max-w-md\">{message}</p>\n        <button\n          onClick={() => window.location.reload()}\n          className=\"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90\"\n        >\n          Refresh Page\n        </button>\n      </div>\n    );\n\n    switch (currentView) {\n      case \"dashboard\":\n        return (\n          <EnhancedErrorBoundary fallback={makeFallback(\"Dashboard Error\", \"We couldn't render the air quality dashboard. Refresh to retry.\")}>\n            <Suspense fallback={<PageSkeleton />}>\n              <AirQualityDashboard \n                onNavigate={handleViewChange} \n                showMobileMenu={showMobileMenu}\n                onMobileMenuToggle={toggleMobileMenu}\n              />\n            </Suspense>\n          </EnhancedErrorBoundary>\n        );\n      case \"history\":\n        return (\n          <EnhancedErrorBoundary fallback={makeFallback(\"History Error\", \"Historical data is temporarily unavailable. Please refresh.\" )}>\n            <Suspense fallback={<PageSkeleton />}>\n              <HistoryView \n                showMobileMenu={showMobileMenu}\n                onMobileMenuToggle={toggleMobileMenu}\n              />\n            </Suspense>\n          </EnhancedErrorBoundary>\n        );\n      case \"map\":\n        return (\n          <EnhancedErrorBoundary fallback={makeFallback(\"Weather Stats Error\", \"We couldn't load weather statistics. Try refreshing the page.\" )}>\n            <Suspense fallback={<PageSkeleton />}>\n              <WeatherStats \n                showMobileMenu={showMobileMenu}\n                onMobileMenuToggle={toggleMobileMenu}\n              />\n            </Suspense>\n          </EnhancedErrorBoundary>\n        );\n      case \"rewards\":\n        return (\n          <EnhancedErrorBoundary fallback={makeFallback(\"Rewards Error\", \"Rewards data failed to load. Refresh the page to retry.\" )}>\n            <Suspense fallback={<PageSkeleton />}>\n              <Rewards \n                showMobileMenu={showMobileMenu}\n                onMobileMenuToggle={toggleMobileMenu}\n              />\n            </Suspense>\n          </EnhancedErrorBoundary>\n        );\n      case \"store\":\n        return (\n          <EnhancedErrorBoundary fallback={makeFallback(\"Store Error\", \"The store is temporarily unavailable. Please try again after refreshing.\" )}>\n            <Suspense fallback={<PageSkeleton />}>\n              <Store \n                showMobileMenu={showMobileMenu}\n                onMobileMenuToggle={toggleMobileMenu}\n              />\n            </Suspense>\n          </EnhancedErrorBoundary>\n        );\n      case \"profile\":\n        return (\n          <EnhancedErrorBoundary fallback={makeFallback(\"Profile Error\", \"We hit a snag loading your profile. Refresh to give it another shot.\" )}>\n            <Suspense fallback={<PageSkeleton />}>\n              <ProfileView \n                showMobileMenu={showMobileMenu}\n                onMobileMenuToggle={toggleMobileMenu}\n              />\n            </Suspense>\n          </EnhancedErrorBoundary>\n        );\n      case \"settings\":\n        return (\n          <EnhancedErrorBoundary fallback={makeFallback(\"Settings Error\", \"Settings failed to render. Please refresh the page.\" )}>\n            <Suspense fallback={<PageSkeleton />}>\n              <SettingsView \n                showMobileMenu={showMobileMenu}\n                onMobileMenuToggle={toggleMobileMenu}\n              />\n            </Suspense>\n          </EnhancedErrorBoundary>\n        );\n      case \"news\":\n        return (\n          <EnhancedErrorBoundary fallback={makeFallback(\"News Error\", \"Latest air quality news could not be loaded. Refresh to retry.\" )}>\n            <Suspense fallback={<PageSkeleton />}>\n              <NewsPage \n                showMobileMenu={showMobileMenu}\n                onMobileMenuToggle={toggleMobileMenu}\n              />\n            </Suspense>\n          </EnhancedErrorBoundary>\n        );\n      default:\n        return (\n          <EnhancedErrorBoundary fallback={makeFallback(\"Dashboard Error\", \"We couldn't render the air quality dashboard. Refresh to retry.\" )}>\n            <Suspense fallback={<PageSkeleton />}>\n              <AirQualityDashboard \n                onNavigate={handleViewChange}\n                showMobileMenu={showMobileMenu}\n                onMobileMenuToggle={toggleMobileMenu}\n              />\n            </Suspense>\n          </EnhancedErrorBoundary>\n        );\n    }\n  };\n\n  // Handle products navigation properly\n  if (currentView === \"products\") {\n    navigate(\"/products\");\n    return null;\n  }\n\n  const toggleMobileMenu = () => {\n    setShowMobileMenu(!showMobileMenu);\n  };\n\n  return (\n    <BackgroundManager>\n      <div className=\"min-h-screen bg-gradient-to-br from-background via-accent/20 to-secondary/30 flex flex-col\">\n        {/* Developer Tools */}\n        <DeveloperTools \n          isVisible={showDeveloperTools}\n          onToggle={() => setShowDeveloperTools(false)}\n        />\n        \n        {/* Sidebar Navigation */}\n        <Sidebar currentView={currentView} onViewChange={handleViewChange} />\n        \n        {/* Mobile Navigation */}\n        <MobileNavigation \n          currentView={currentView} \n          onViewChange={handleViewChange}\n          isOpen={showMobileMenu}\n          onClose={() => setShowMobileMenu(false)}\n        />\n        \n        {/* Main Content Area */}\n        <div className=\"flex-1 md:ml-16 ml-0\">\n          <div className=\"p-4 sm:p-6 lg:p-8 w-full\">\n            <AnimatePresence mode=\"wait\">\n              <motion.div\n                key={currentView}\n                initial={{ opacity: 0, scale: 0.98 }}\n                animate={{ opacity: 1, scale: 1 }}\n                exit={{ opacity: 0, scale: 0.98 }}\n                transition={{ \n                  duration: 0.3, \n                  ease: \"easeInOut\"\n                }}\n              >\n                {renderView()}\n              </motion.div>\n            </AnimatePresence>\n          </div>\n        </div>\n\n        {/* Footer */}\n        <Footer />\n      </div>\n    </BackgroundManager>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\pages\\Landing.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"CheckCircle"},"fix":{"range":[431,446],"text":""},"desc":"Remove unused variable 'CheckCircle'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":15,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { Button } from \"@/components/ui/button\";\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from \"@/components/ui/GlassCard\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  Shield, \n  TrendingUp, \n  MapPin, \n  Award, \n  Users, \n  Zap,\n  ArrowRight,\n  CheckCircle\n} from \"lucide-react\";\nimport { useTheme } from \"@/contexts/ThemeContext\";\nimport Footer from \"@/components/Footer\";\n// Development tools - only imported in development\nconst DevToolsWrapper = import.meta.env.DEV \n  ? React.lazy(() => import('@/components/dev/DevToolsWrapper')) \n  : () => null;\n\n\nexport default function Landing(): JSX.Element {\n  const navigate = useNavigate();\n  const { theme } = useTheme();\n  const { user, loading } = useAuth();\n  const [isHovered, setIsHovered] = useState<string | null>(null);\n\n  // Redirect authenticated users to dashboard\n  useEffect(() => {\n    if (user && !loading) {\n      navigate(\"/dashboard?view=dashboard\");\n    }\n  }, [user, loading, navigate]);\n\n  const features = [\n    {\n      icon: Shield,\n      title: \"Real-time Air Quality\",\n      description: \"Get instant updates on air quality in your area with accurate, up-to-date readings.\",\n      color: \"text-blue-600\"\n    },\n    {\n      icon: TrendingUp,\n      title: \"Health Tracking\",\n      description: \"Monitor your environmental exposure and track how air quality affects your health over time.\",\n      color: \"text-green-600\"\n    },\n    {\n      icon: MapPin,\n      title: \"Location Intelligence\",\n      description: \"Find the cleanest air in your city with my interactive map and location-based recommendations.\",\n      color: \"text-purple-600\"\n    },\n    {\n      icon: Award,\n      title: \"Rewards & Achievements\",\n      description: \"Earn points and unlock achievements for making environmentally conscious decisions.\",\n      color: \"text-yellow-600\"\n    },\n    {\n      icon: Users,\n      title: \"Community Insights\",\n      description: \"Join a community of health-conscious individuals sharing air quality knowledge.\",\n      color: \"text-pink-600\"\n    },\n    {\n      icon: Zap,\n      title: \"Instant Alerts\",\n      description: \"Receive notifications when air quality changes or reaches concerning levels.\",\n      color: \"text-orange-600\"\n    }\n  ];\n\n  const stats = [\n    { label: \"Active Users\", value: \"Onboarding\", description: \"Trusting Breath Safe\" },\n    { label: \"Cities Covered\", value: \"500+\", description: \"Worldwide coverage\" },\n    { label: \"Data Source\", value: \"AQICN\", description: \"Real-time readings\" },\n    { label: \"Health Score\", value: \"Pending\", description: \"User satisfaction\" }\n  ];\n\n  const handleGetStarted = () => {\n    navigate(\"/onboarding\");\n  };\n\n  const handleSignIn = () => {\n    navigate(\"/auth\");\n  };\n\n  const handleTryApp = () => {\n    navigate(\"/demo?view=dashboard\");\n  };\n\n  // Show loading while checking authentication\n  if (loading) {\n    return (\n      <div className={`min-h-screen flex flex-col ${theme}`}>\n        {/* Development Tools - Only in development */}\n        {import.meta.env.DEV && (\n          <React.Suspense fallback={null}>\n            <DevToolsWrapper />\n          </React.Suspense>\n        )}\n        \n        {/* Main content */}\n        <main className=\"flex-1\">\n          <div className=\"text-center space-y-4\">\n            <div className=\"animate-spin rounded-full h-16 w-16 border-b-2 border-primary mx-auto\"></div>\n            <p className=\"text-muted-foreground\">Loading...</p>\n          </div>\n        </main>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-background via-accent/20 to-secondary/30\">\n      {/* Hero Section */}\n      <section className=\"relative overflow-hidden\">\n        <div className=\"absolute inset-0 bg-gradient-to-r from-primary/10 via-transparent to-secondary/10\"></div>\n        <div className=\"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-20 pb-16\">\n          <div className=\"text-center\">\n            <Badge \n              variant=\"secondary\" \n              className=\"mb-6 px-4 py-2 text-sm font-medium bg-primary/10 text-primary border-primary/20\"\n            >\n              🌱 Breathe Cleaner, Live Healthier\n            </Badge>\n            \n            <h1 className=\"text-4xl md:text-6xl font-black text-foreground mb-6 leading-tight\">\n              Monitor Air Quality\n              <span className=\"block text-primary\">Protect Your Health</span>\n            </h1>\n            \n            <p className=\"text-xl md:text-2xl text-muted-foreground mb-8 max-w-3xl mx-auto leading-relaxed font-light\">\n              Get real-time air quality data, track your environmental exposure, and earn rewards for making healthy choices. \n              Your lungs will thank you.\n            </p>\n            \n            <div className=\"flex flex-col sm:flex-row gap-4 justify-center items-center\">\n              <Button \n                size=\"lg\" \n                onClick={handleGetStarted}\n                className=\"px-8 py-4 text-lg font-semibold bg-primary hover:bg-primary/90 text-primary-foreground shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105\"\n              >\n                Get Started Free\n                <ArrowRight className=\"ml-2 h-5 w-5\" />\n              </Button>\n              \n              <Button \n                variant=\"outline\" \n                size=\"lg\" \n                onClick={handleTryApp}\n                className=\"px-8 py-4 text-lg font-semibold border-2 hover:bg-accent transition-all duration-300\"\n              >\n                Try the app\n              </Button>\n              \n              <Button \n                variant=\"outline\" \n                size=\"lg\" \n                onClick={handleSignIn}\n                className=\"px-8 py-4 text-lg font-semibold border-2 hover:bg-accent transition-all duration-300\"\n              >\n                Sign In\n              </Button>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Stats Section */}\n      <section className=\"py-16 bg-card/50\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-8\">\n            {stats.map((stat, index) => (\n              <div key={index} className=\"text-center\">\n                <div className=\"text-3xl md:text-4xl font-black text-primary mb-2\">\n                  {stat.value}\n                </div>\n                <div className=\"text-sm font-semibold text-foreground mb-1\">\n                  {stat.label}\n                </div>\n                <div className=\"text-xs text-muted-foreground font-light\">\n                  {stat.description}\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      {/* Features Section */}\n      <section className=\"py-20\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"text-center mb-16\">\n            <h2 className=\"text-3xl md:text-4xl font-bold text-foreground mb-4\">\n              Everything You Need to Breathe Better\n            </h2>\n            <p className=\"text-xl text-muted-foreground max-w-2xl mx-auto font-light\">\n              This webapp is currently under active development. Features may break and/or change regularly.\n            </p>\n          </div>\n          \n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\n            {features.map((feature, index) => {\n              const Icon = feature.icon;\n              return (\n                <GlassCard \n                  key={index}\n                  className={`floating-card relative overflow-hidden transition-all duration-300 cursor-pointer group ${\n                    isHovered === feature.title \n                      ? 'shadow-2xl transform scale-105' \n                      : 'shadow-lg hover:shadow-xl'\n                  }`}\n                  onMouseEnter={() => setIsHovered(feature.title)}\n                  onMouseLeave={() => setIsHovered(null)}\n                >\n                  <GlassCardHeader className=\"pb-4\">\n                    <div className={`w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300`}>\n                      <Icon className={`h-6 w-6 ${feature.color}`} />\n                    </div>\n                    <GlassCardTitle className=\"text-xl font-semibold text-foreground\">\n                      {feature.title}\n                    </GlassCardTitle>\n                  </GlassCardHeader>\n                  <GlassCardContent>\n                    <p className=\"text-muted-foreground leading-relaxed\">\n                      {feature.description}\n                    </p>\n                  </GlassCardContent>\n                  \n                  {/* Hover effect overlay */}\n                  <div className={`absolute inset-0 bg-gradient-to-r from-primary/5 to-secondary/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none`}></div>\n                </GlassCard>\n              );\n            })}\n          </div>\n        </div>\n      </section>\n\n      {/* CTA Section */}\n      <section className=\"py-20 bg-primary/5\">\n        <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center\">\n          <h2 className=\"text-3xl md:text-4xl font-bold text-foreground mb-6\">\n            Ready to Take Control of Your Air Quality?\n          </h2>\n          <p className=\"text-xl text-muted-foreground mb-8\">\n            Try the app now as I develop and roll out improvements and features.\n          </p>\n          \n          <div className=\"flex flex-col sm:flex-row gap-4 justify-center items-center\">\n            <Button \n              size=\"lg\" \n              onClick={handleGetStarted}\n              className=\"px-8 py-4 text-lg font-semibold bg-primary hover:bg-primary/90 text-primary-foreground shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105\"\n            >\n              Start Your Journey\n              <ArrowRight className=\"ml-2 h-5 w-5\" />\n            </Button>\n            \n            <Button \n              variant=\"outline\" \n              size=\"lg\" \n              onClick={handleSignIn}\n              className=\"px-8 py-4 text-lg font-semibold border-2 hover:bg-accent transition-all duration-300\"\n            >\n              I Already Have an Account\n            </Button>\n          </div>\n        </div>\n      </section>\n\n      {/* Footer */}\n      <Footer />\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\pages\\NotFound.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\pages\\Onboarding.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'GlassCardTitle' is defined but never used.","line":6,"column":56,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":70,"suggestions":[{"messageId":"removeVar","data":{"varName":"GlassCardTitle"},"fix":{"range":[304,320],"text":""},"desc":"Remove unused variable 'GlassCardTitle'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'GlassCardTitle' is defined but never used.","line":6,"column":56,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":70},{"ruleId":"no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[451,497],"text":""},"desc":"Remove unused variable 'Badge'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":9,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'Award' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":8,"suggestions":[{"messageId":"removeVar","data":{"varName":"Award"},"fix":{"range":[640,649],"text":""},"desc":"Remove unused variable 'Award'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Award' is defined but never used.","line":18,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":8},{"ruleId":"no-unused-vars","severity":1,"message":"'Users' is defined but never used.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":8,"suggestions":[{"messageId":"removeVar","data":{"varName":"Users"},"fix":{"range":[649,658],"text":""},"desc":"Remove unused variable 'Users'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Users' is defined but never used.","line":19,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":8},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'handleCreateAccount' was used before it was defined.","line":110,"column":9,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":110,"endColumn":28},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'handleComplete' was used before it was defined.","line":112,"column":9,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":112,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { supabase } from \"@/integrations/supabase/client\";\nimport { Button } from \"@/components/ui/button\";\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from \"@/components/ui/GlassCard\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { \n  CheckCircle, \n  ArrowRight, \n  ArrowLeft, \n  MapPin, \n  Shield, \n  TrendingUp,\n  Award,\n  Users,\n  Mail,\n  RefreshCw\n} from \"lucide-react\";\nimport { useToast } from \"@/components/ui/use-toast\";\n\ninterface OnboardingData {\n  email: string;\n  password: string;\n  confirmPassword: string;\n  region: string;\n  city: string;\n  country: string;\n}\n\ninterface OnboardingState {\n  isSubmitting: boolean;\n  emailSent: boolean;\n  isResendingEmail: boolean;\n}\n\nconst regions = [\n  { id: \"north-america\", name: \"North America\", countries: [\"United States\", \"Canada\", \"Mexico\"] },\n  { id: \"europe\", name: \"Europe\", countries: [\"United Kingdom\", \"Germany\", \"France\", \"Spain\", \"Italy\", \"Netherlands\", \"Sweden\", \"Norway\", \"Denmark\", \"Finland\"] },\n  { id: \"asia-pacific\", name: \"Asia Pacific\", countries: [\"China\", \"Japan\", \"South Korea\", \"India\", \"Australia\", \"New Zealand\", \"Singapore\", \"Thailand\", \"Vietnam\"] },\n  { id: \"latin-america\", name: \"Latin America\", countries: [\"Brazil\", \"Argentina\", \"Chile\", \"Colombia\", \"Peru\", \"Venezuela\"] },\n  { id: \"africa\", name: \"Africa\", countries: [\"South Africa\", \"Nigeria\", \"Kenya\", \"Egypt\", \"Morocco\", \"Ghana\"] },\n  { id: \"middle-east\", name: \"Middle East\", countries: [\"Saudi Arabia\", \"UAE\", \"Israel\", \"Turkey\", \"Iran\", \"Egypt\"] }\n];\n\nexport default function Onboarding(): JSX.Element {\n  const navigate = useNavigate();\n  const { user, signUp, loading } = useAuth();\n  const { toast } = useToast();\n  \n  const [currentStep, setCurrentStep] = useState(1);\n  const [formData, setFormData] = useState<OnboardingData>({\n    email: \"\",\n    password: \"\",\n    confirmPassword: \"\",\n    region: \"\",\n    city: \"\",\n    country: \"\"\n  });\n  const [errors, setErrors] = useState<Partial<OnboardingData>>({});\n  const [state, setState] = useState<OnboardingState>({\n    isSubmitting: false,\n    emailSent: false,\n    isResendingEmail: false\n  });\n\n  // Auto-skip if user already authenticated\n  useEffect(() => {\n    if (user && !loading) {\n      navigate(\"/dashboard?view=dashboard\");\n    }\n  }, [user, loading, navigate]);\n\n  const totalSteps = 5;\n  const progress = (currentStep / totalSteps) * 100;\n\n  const validateStep = (step: number): boolean => {\n    const newErrors: Partial<OnboardingData> = {};\n\n    switch (step) {\n      case 2: // Account creation\n        if (!formData.email) newErrors.email = \"Email is required\";\n        else if (!/\\S+@\\S+\\.\\S+/.test(formData.email)) newErrors.email = \"Invalid email format\";\n        \n        if (!formData.password) newErrors.password = \"Password is required\";\n        else if (formData.password.length < 8) newErrors.password = \"Password must be at least 8 characters\";\n        \n        if (!formData.confirmPassword) newErrors.confirmPassword = \"Please confirm your password\";\n        else if (formData.password !== formData.confirmPassword) newErrors.confirmPassword = \"Passwords don't match\";\n        break;\n        \n      case 3: // Region selection\n        if (!formData.region) newErrors.region = \"Please select a region\";\n        if (!formData.country) newErrors.country = \"Please select a country\";\n        if (!formData.city) newErrors.city = \"City is required\";\n        break;\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleNext = () => {\n    if (validateStep(currentStep)) {\n      if (currentStep === 3) {\n        // Step 3 is location - after this, create account\n        handleCreateAccount();\n      } else if (currentStep === totalSteps) {\n        handleComplete();\n      } else {\n        setCurrentStep(currentStep + 1);\n      }\n    }\n  };\n\n  const handleBack = () => {\n    if (currentStep > 1) {\n      setCurrentStep(currentStep - 1);\n    }\n  };\n\n  const handleCreateAccount = async () => {\n    if (!validateStep(currentStep)) return;\n\n    setState(prev => ({ ...prev, isSubmitting: true }));\n    try {\n      await signUp(formData.email, formData.password);\n      setState(prev => ({ ...prev, emailSent: true, isSubmitting: false }));\n      toast({\n        title: \"Account Created!\",\n        description: \"Please check your email to verify your account.\",\n      });\n      // Move to email verification step\n      setCurrentStep(4);\n    } catch (error) {\n      setState(prev => ({ ...prev, isSubmitting: false }));\n      toast({\n        title: \"Signup Failed\",\n        description: error instanceof Error ? error.message : \"Please try again\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleResendEmail = async () => {\n    setState(prev => ({ ...prev, isResendingEmail: true }));\n    try {\n      const { error } = await supabase.auth.resend({\n        type: 'signup',\n        email: formData.email,\n      });\n      \n      if (error) throw error;\n      \n      toast({\n        title: \"Email Sent!\",\n        description: \"A new verification email has been sent to your inbox.\",\n      });\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: error instanceof Error ? error.message : \"Failed to resend email\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setState(prev => ({ ...prev, isResendingEmail: false }));\n    }\n  };\n\n  const handleComplete = () => {\n    // This is called when user has verified their email and wants to go to dashboard\n    navigate(\"/dashboard?view=dashboard\");\n  };\n\n  const updateFormData = (field: keyof OnboardingData, value: string) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n    // Clear error when user starts typing\n    if (errors[field]) {\n      setErrors(prev => ({ ...prev, [field]: undefined }));\n    }\n  };\n\n  const renderStep = () => {\n    switch (currentStep) {\n      case 1:\n        return (\n          <div className=\"text-center space-y-8\">\n            <div className=\"space-y-4\">\n              <div className=\"w-20 h-20 bg-primary/10 rounded-full flex items-center justify-center mx-auto\">\n                <Shield className=\"w-10 h-10 text-primary\" />\n              </div>\n              <h1 className=\"text-3xl md:text-4xl font-bold text-foreground\">\n                Welcome to Breath Safe\n              </h1>\n              <p className=\"text-xl text-muted-foreground max-w-2xl mx-auto\">\n                Your journey to better air quality and healthier living starts here. \n                Let's get you set up in just a few simple steps.\n              </p>\n            </div>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-4xl mx-auto\">\n              <GlassCard className=\"floating-card p-6 text-center hover:shadow-lg transition-shadow\">\n                <div className=\"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4\">\n                  <CheckCircle className=\"h-8 w-8 text-primary\" />\n                </div>\n                <h3 className=\"text-lg font-semibold mb-2\">Account Created</h3>\n                <p className=\"text-sm text-muted-foreground\">Your account has been successfully created</p>\n              </GlassCard>\n\n              <GlassCard className=\"floating-card p-6 text-center hover:shadow-lg transition-shadow\">\n                <div className=\"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4\">\n                  <MapPin className=\"h-8 w-8 text-primary\" />\n                </div>\n                <h3 className=\"text-lg font-semibold mb-2\">Location Set</h3>\n                <p className=\"text-sm text-muted-foreground\">Your region and city preferences are configured</p>\n              </GlassCard>\n\n              <GlassCard className=\"floating-card p-6 text-center hover:shadow-lg transition-shadow\">\n                <div className=\"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4\">\n                  <Shield className=\"h-8 w-8 text-primary\" />\n                </div>\n                <h3 className=\"text-lg font-semibold mb-2\">Privacy Protected</h3>\n                <p className=\"text-sm text-muted-foreground\">Your data is secure and private</p>\n              </GlassCard>\n\n              <GlassCard className=\"floating-card p-6 text-center hover:shadow-lg transition-shadow\">\n                <div className=\"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4\">\n                  <TrendingUp className=\"h-8 w-8 text-primary\" />\n                </div>\n                <h3 className=\"text-lg font-semibold mb-2\">Ready to Track</h3>\n                <p className=\"text-sm text-muted-foreground\">Start monitoring your air quality journey</p>\n              </GlassCard>\n            </div>\n          </div>\n        );\n\n      case 2:\n        return (\n          <div className=\"max-w-md mx-auto space-y-6\">\n            <div className=\"text-center space-y-4\">\n              <h2 className=\"text-2xl font-bold text-foreground\">Create Your Account</h2>\n              <p className=\"text-muted-foreground\">Secure your access to air quality insights</p>\n            </div>\n\n            <div className=\"space-y-4\">\n              <div>\n                <Label htmlFor=\"email\">Email Address</Label>\n                <Input\n                  id=\"email\"\n                  type=\"email\"\n                  placeholder=\"your@email.com\"\n                  value={formData.email}\n                  onChange={(e) => updateFormData(\"email\", e.target.value)}\n                  className={errors.email ? \"border-red-500\" : \"\"}\n                />\n                {errors.email && <p className=\"text-sm text-red-500 mt-1\">{errors.email}</p>}\n              </div>\n\n              <div>\n                <Label htmlFor=\"password\">Password</Label>\n                <Input\n                  id=\"password\"\n                  type=\"password\"\n                  placeholder=\"Create a strong password\"\n                  value={formData.password}\n                  onChange={(e) => updateFormData(\"password\", e.target.value)}\n                  className={errors.password ? \"border-red-500\" : \"\"}\n                />\n                {errors.password && <p className=\"text-sm text-red-500 mt-1\">{errors.password}</p>}\n              </div>\n\n              <div>\n                <Label htmlFor=\"confirmPassword\">Confirm Password</Label>\n                <Input\n                  id=\"confirmPassword\"\n                  type=\"password\"\n                  placeholder=\"Confirm your password\"\n                  value={formData.confirmPassword}\n                  onChange={(e) => updateFormData(\"confirmPassword\", e.target.value)}\n                  className={errors.confirmPassword ? \"border-red-500\" : \"\"}\n                />\n                {errors.confirmPassword && <p className=\"text-sm text-red-500 mt-1\">{errors.confirmPassword}</p>}\n              </div>\n            </div>\n          </div>\n        );\n\n      case 3:\n        return (\n          <div className=\"max-w-md mx-auto space-y-6\">\n            <div className=\"text-center space-y-4\">\n              <h2 className=\"text-2xl font-bold text-foreground\">Set Your Location</h2>\n              <p className=\"text-muted-foreground\">Help us provide accurate air quality data for your area</p>\n            </div>\n\n            <div className=\"space-y-4\">\n              <div>\n                <Label htmlFor=\"region\">Region</Label>\n                <select\n                  id=\"region\"\n                  value={formData.region}\n                  onChange={(e) => {\n                    updateFormData(\"region\", e.target.value);\n                    updateFormData(\"country\", \"\");\n                    updateFormData(\"city\", \"\");\n                  }}\n                  className=\"w-full p-3 border border-input rounded-md bg-background text-foreground\"\n                >\n                  <option value=\"\">Select a region</option>\n                  {regions.map(region => (\n                    <option key={region.id} value={region.id}>{region.name}</option>\n                  ))}\n                </select>\n                {errors.region && <p className=\"text-sm text-red-500 mt-1\">{errors.region}</p>}\n              </div>\n\n              {formData.region && (\n                <div>\n                  <Label htmlFor=\"country\">Country</Label>\n                  <select\n                    id=\"country\"\n                    value={formData.country}\n                    onChange={(e) => {\n                      updateFormData(\"country\", e.target.value);\n                      updateFormData(\"city\", \"\");\n                    }}\n                    className=\"w-full p-3 border border-input rounded-md bg-background text-foreground\"\n                  >\n                    <option value=\"\">Select a country</option>\n                    {regions.find(r => r.id === formData.region)?.countries.map(country => (\n                      <option key={country} value={country}>{country}</option>\n                    ))}\n                  </select>\n                  {errors.country && <p className=\"text-sm text-red-500 mt-1\">{errors.country}</p>}\n                </div>\n              )}\n\n              <div>\n                <Label htmlFor=\"city\">City</Label>\n                <Input\n                  id=\"city\"\n                  type=\"text\"\n                  placeholder=\"Enter your city\"\n                  value={formData.city}\n                  onChange={(e) => updateFormData(\"city\", e.target.value)}\n                  className={errors.city ? \"border-red-500\" : \"\"}\n                />\n                {errors.city && <p className=\"text-sm text-red-500 mt-1\">{errors.city}</p>}\n              </div>\n            </div>\n          </div>\n        );\n\n      case 4:\n        return (\n          <div className=\"text-center space-y-8\">\n            <div className=\"space-y-4\">\n              <div className=\"w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto\">\n                <Mail className=\"w-10 h-10 text-blue-600\" />\n              </div>\n              <h1 className=\"text-3xl md:text-4xl font-bold text-foreground\">\n                Check Your Email\n              </h1>\n              <p className=\"text-xl text-muted-foreground max-w-2xl mx-auto\">\n                We've sent a verification email to <strong>{formData.email}</strong>. \n                Please click the link in the email to verify your account.\n              </p>\n            </div>\n\n            <div className=\"bg-card p-6 rounded-lg max-w-md mx-auto space-y-4\">\n              <div className=\"flex items-center justify-center gap-3 text-blue-600\">\n                <Mail className=\"h-5 w-5\" />\n                <span className=\"font-medium\">Verification Email Sent</span>\n              </div>\n              \n              <div className=\"space-y-3 text-left text-sm text-muted-foreground\">\n                <p>• Check your inbox (and spam folder)</p>\n                <p>• Click the verification link</p>\n                <p>• Return here to continue setup</p>\n              </div>\n              \n              <div className=\"pt-4\">\n                <Button\n                  variant=\"outline\"\n                  onClick={handleResendEmail}\n                  disabled={state.isResendingEmail}\n                  className=\"w-full flex items-center gap-2\"\n                >\n                  {state.isResendingEmail ? (\n                    <RefreshCw className=\"h-4 w-4 animate-spin\" />\n                  ) : (\n                    <Mail className=\"h-4 w-4\" />\n                  )}\n                  {state.isResendingEmail ? \"Sending...\" : \"Resend Email\"}\n                </Button>\n              </div>\n            </div>\n            \n            <div className=\"text-sm text-muted-foreground\">\n              <p>After verifying your email, click \"Next\" to continue.</p>\n            </div>\n          </div>\n        );\n\n      case 5:\n        return (\n          <div className=\"text-center space-y-8\">\n            <div className=\"space-y-4\">\n              <div className=\"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto\">\n                <CheckCircle className=\"w-10 h-10 text-green-600\" />\n              </div>\n              <h1 className=\"text-3xl md:text-4xl font-bold text-foreground\">\n                You're All Set!\n              </h1>\n              <p className=\"text-xl text-muted-foreground max-w-2xl mx-auto\">\n                Your Breath Safe account is ready. We'll start monitoring air quality in {formData.city}, {formData.country} \n                and provide you with personalized insights and recommendations.\n              </p>\n            </div>\n\n            <div className=\"bg-card p-6 rounded-lg max-w-md mx-auto\">\n              <h3 className=\"font-semibold text-foreground mb-4\">What's Next?</h3>\n              <div className=\"space-y-3 text-left\">\n                <div className=\"flex items-center gap-3\">\n                  <CheckCircle className=\"w-5 h-5 text-green-600 flex-shrink-0\" />\n                  <span className=\"text-sm text-muted-foreground\">Access your personalized dashboard</span>\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <CheckCircle className=\"w-5 h-5 text-green-600 flex-shrink-0\" />\n                  <span className=\"text-sm text-muted-foreground\">Set up location preferences</span>\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <CheckCircle className=\"w-5 h-5 text-green-600 flex-shrink-0\" />\n                  <span className=\"text-sm text-muted-foreground\">Start earning rewards</span>\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <CheckCircle className=\"w-5 h-5 text-green-600 flex-shrink-0\" />\n                  <span className=\"text-sm text-muted-foreground\">Receive air quality alerts</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        );\n\n      default:\n        return null;\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <div className=\"text-center space-y-4\">\n          <div className=\"animate-spin rounded-full h-16 w-16 border-b-2 border-primary mx-auto\"></div>\n          <p className=\"text-muted-foreground\">Setting up your experience...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-background via-accent/20 to-secondary/30 flex items-center justify-center p-4\">\n      <GlassCard className=\"floating-card w-full max-w-4xl mx-auto\">\n        <GlassCardHeader className=\"text-center pb-8\">\n          <div className=\"flex items-center justify-center gap-2 mb-4\">\n            <div className=\"w-8 h-8 bg-primary rounded-full flex items-center justify-center\">\n              <Shield className=\"w-4 h-4 text-primary-foreground\" />\n            </div>\n            <span className=\"text-xl font-bold text-foreground\">Breath Safe</span>\n          </div>\n          \n          {/* Progress Bar */}\n          <div className=\"space-y-2\">\n            <div className=\"flex justify-between text-sm text-muted-foreground\">\n              <span>Step {currentStep} of {totalSteps}</span>\n              <span>{Math.round(progress)}% Complete</span>\n            </div>\n            <Progress value={progress} className=\"h-2\" />\n          </div>\n        </GlassCardHeader>\n\n        <GlassCardContent className=\"pb-8\">\n          {renderStep()}\n        </GlassCardContent>\n\n        {/* Navigation Buttons */}\n        <div className=\"flex justify-between items-center px-6 pb-6\">\n          <Button\n            variant=\"outline\"\n            onClick={handleBack}\n            disabled={currentStep === 1}\n            className=\"flex items-center gap-2\"\n          >\n            <ArrowLeft className=\"w-4 h-4\" />\n            Back\n          </Button>\n\n          <div className=\"flex gap-2\">\n            {currentStep === 3 ? (\n              <Button\n                onClick={handleNext}\n                disabled={state.isSubmitting}\n                className=\"flex items-center gap-2\"\n              >\n                {state.isSubmitting ? \"Creating Account...\" : \"Create Account\"}\n                <ArrowRight className=\"w-4 h-4\" />\n              </Button>\n            ) : currentStep < totalSteps ? (\n              <Button\n                onClick={handleNext}\n                className=\"flex items-center gap-2\"\n              >\n                Next\n                <ArrowRight className=\"w-4 h-4\" />\n              </Button>\n            ) : (\n              <Button\n                onClick={handleComplete}\n                className=\"flex items-center gap-2\"\n              >\n                Go to Dashboard\n                <CheckCircle className=\"w-4 h-4\" />\n              </Button>\n            )}\n          </div>\n        </div>\n      </GlassCard>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\pages\\Privacy.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\pages\\Products.tsx","messages":[{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'fetchProducts' was used before it was defined.","line":29,"column":5,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":29,"endColumn":18},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'getUserLocation' was used before it was defined.","line":30,"column":5,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":30,"endColumn":20},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchProducts'. Either include it or remove the dependency array.","line":31,"column":6,"nodeType":"ArrayExpression","endLine":31,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [fetchProducts]","fix":{"range":[980,982],"text":"[fetchProducts]"}}]},{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":43,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":43,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":43,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from '@/components/ui/GlassCard';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Star, ExternalLink, MapPin } from 'lucide-react';\nimport { useToast } from '@/components/ui/use-toast';\nimport Footer from '@/components/Footer';\n\ninterface Product {\n  id: string;\n  name: string;\n  description: string;\n  price_range: string;\n  affiliate_url: string;\n  retailer: string;\n  image_url: string;\n  rating: number;\n  coverage_area: string;\n}\n\nexport default function Products() {\n  const [products, setProducts] = useState<Product[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [userLocation, setUserLocation] = useState<string>('');\n  const { toast } = useToast();\n\n  useEffect(() => {\n    fetchProducts();\n    getUserLocation();\n  }, []);\n\n  const fetchProducts = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('affiliate_products')\n        .select('*')\n        .eq('is_active', true)\n        .order('rating', { ascending: false });\n\n      if (error) throw error;\n      setProducts(data || []);\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to load products\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const getUserLocation = () => {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(\n        async (position) => {\n          try {\n            // Use environment variable for API key\n            const apiKey = import.meta.env.VITE_OPENWEATHERMAP_API_KEY;\n            \n            // If no API key is available, skip the API call and use coordinates\n            if (!apiKey || apiKey.trim() === '') {\n              setUserLocation(`Your Location (${position.coords.latitude.toFixed(4)}, ${position.coords.longitude.toFixed(4)})`);\n              return;\n            }\n\n            const response = await fetch(\n              `https://api.openweathermap.org/geo/1.0/reverse?lat=${position.coords.latitude}&lon=${position.coords.longitude}&limit=1&appid=${apiKey}`\n            );\n            \n            if (!response.ok) {\n              throw new Error(`API request failed: ${response.status}`);\n            }\n            \n            const data = await response.json();\n            setUserLocation(data[0]?.name || 'Your Location');\n          } catch (error) {\n            console.error('Error getting city name:', error);\n            // Fallback to coordinates if API fails\n            setUserLocation(`Your Location (${position.coords.latitude.toFixed(4)}, ${position.coords.longitude.toFixed(4)})`);\n          }\n        },\n        () => setUserLocation('Your Location')\n      );\n    }\n  };\n\n  const handleProductClick = (url: string) => {\n    window.open(url, '_blank', 'noopener,noreferrer');\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-background p-4 space-y-6 pb-24\">\n        <div className=\"animate-pulse space-y-4\">\n          {[1, 2, 3].map((i) => (\n            <div key={i} className=\"h-32 bg-card rounded-lg\"></div>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background flex flex-col\">\n      {/* Sidebar would be here but Products is a separate route */}\n      <div className=\"flex-1 p-6 max-w-7xl mx-auto space-y-card-gap\">\n        {/* Header */}\n        <div>\n          <h1 className=\"heading-lg bg-gradient-primary bg-clip-text text-transparent\">\n            Air Purifiers\n          </h1>\n          <p className=\"body-md text-muted-foreground mt-1 flex items-center gap-1\">\n            <MapPin className=\"h-4 w-4\" />\n            Recommended for {userLocation}\n          </p>\n        </div>\n\n      {/* Local Retailers Notice */}\n      <GlassCard className=\"floating-card border-0\">\n        <GlassCardContent>\n          <div className=\"flex items-center gap-2 mb-2\">\n            <MapPin className=\"h-5 w-5 text-primary\" />\n            <h3 className=\"font-heading\">Local Retailers</h3>\n          </div>\n          <p className=\"body-md text-muted-foreground\">\n            Check local electronics stores, home improvement centers, and department stores near you for immediate availability and to avoid shipping costs.\n          </p>\n        </GlassCardContent>\n      </GlassCard>\n\n      {/* Products Grid */}\n      <div className=\"space-y-card-gap\">\n        {products.length === 0 ? (\n          <GlassCard className=\"floating-card border-0\">\n            <GlassCardHeader>\n              <GlassCardTitle className=\"text-lg\">No Products Available</GlassCardTitle>\n            </GlassCardHeader>\n            <GlassCardContent>\n              <p className=\"text-muted-foreground\">\n                We're currently updating our product recommendations. Please check back soon!\n              </p>\n            </GlassCardContent>\n          </GlassCard>\n        ) : (\n          products.map((product) => (\n            <GlassCard key={product.id} className=\"floating-card border-0\">\n              <GlassCardHeader className=\"pb-3\">\n                <div className=\"flex justify-between items-start gap-4\">\n                  <div className=\"flex-1\">\n                    <GlassCardTitle className=\"text-lg mb-2\">{product.name}</GlassCardTitle>\n                    <p className=\"text-sm text-muted-foreground mb-3\">\n                      {product.description}\n                    </p>\n                    <div className=\"flex items-center gap-2 mb-2\">\n                      <div className=\"flex items-center gap-1\">\n                        <Star className=\"h-4 w-4 fill-yellow-400 text-yellow-400\" />\n                        <span className=\"text-sm font-medium\">{product.rating}</span>\n                      </div>\n                      <Badge variant=\"secondary\" className=\"bg-primary/10 text-primary border-0\">\n                        {product.retailer}\n                      </Badge>\n                    </div>\n                  </div>\n                  <img \n                    src={product.image_url} \n                    alt={product.name}\n                    loading=\"lazy\"\n                    className=\"w-16 h-16 object-cover rounded-lg bg-muted\"\n                  />\n                </div>\n              </GlassCardHeader>\n              \n              <GlassCardContent className=\"pt-0\">\n                <div className=\"flex justify-between items-center mb-3\">\n                  <div className=\"text-sm text-muted-foreground\">\n                    <div>Coverage: {product.coverage_area}</div>\n                    <div className=\"font-semibold text-foreground\">{product.price_range}</div>\n                  </div>\n                </div>\n                \n                <Button\n                  onClick={() => handleProductClick(product.affiliate_url)}\n                  className=\"w-full bg-primary hover:bg-primary/90 gap-2\"\n                >\n                  View on {product.retailer}\n                  <ExternalLink className=\"h-4 w-4\" />\n                </Button>\n              </GlassCardContent>\n            </GlassCard>\n          ))\n        )}\n      </div>\n\n        {/* Disclaimer */}\n        <GlassCard className=\"floating-card border-0\">\n          <GlassCardContent className=\"p-4\">\n            <p className=\"text-xs text-muted-foreground\">\n              * Prices and availability may vary. We may earn a commission from purchases made through affiliate links. \n              This helps support the development of this app while providing you with quality product recommendations.\n            </p>\n          </GlassCardContent>\n        </GlassCard>\n      </div>\n      \n      {/* Footer */}\n      <Footer />\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\pages\\Rewards.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Flame' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":8,"suggestions":[{"messageId":"removeVar","data":{"varName":"Flame"},"fix":{"range":[587,597],"text":""},"desc":"Remove unused variable 'Flame'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Flame' is defined but never used.","line":14,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":8},{"ruleId":"no-unused-vars","severity":1,"message":"'Award' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":8,"suggestions":[{"messageId":"removeVar","data":{"varName":"Award"},"fix":{"range":[608,618],"text":""},"desc":"Remove unused variable 'Award'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Award' is defined but never used.","line":16,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":8},{"ruleId":"no-unused-vars","severity":1,"message":"'TrendingUp' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingUp"},"fix":{"range":[618,632],"text":""},"desc":"Remove unused variable 'TrendingUp'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingUp' is defined but never used.","line":17,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":13},{"ruleId":"no-unused-vars","severity":1,"message":"'Calendar' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":11,"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[632,644],"text":""},"desc":"Remove unused variable 'Calendar'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calendar' is defined but never used.","line":18,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":11},{"ruleId":"no-unused-vars","severity":1,"message":"'Zap' is defined but never used.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":6,"suggestions":[{"messageId":"removeVar","data":{"varName":"Zap"},"fix":{"range":[644,651],"text":""},"desc":"Remove unused variable 'Zap'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Zap' is defined but never used.","line":19,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":6},{"ruleId":"no-unused-vars","severity":1,"message":"'GiftIcon' is defined but never used.","line":22,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":11,"suggestions":[{"messageId":"removeVar","data":{"varName":"GiftIcon"},"fix":{"range":[669,681],"text":""},"desc":"Remove unused variable 'GiftIcon'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'GiftIcon' is defined but never used.","line":22,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":11},{"ruleId":"no-unused-vars","severity":1,"message":"'ExternalLink' is defined but never used.","line":24,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"ExternalLink"},"fix":{"range":[695,711],"text":""},"desc":"Remove unused variable 'ExternalLink'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ExternalLink' is defined but never used.","line":24,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":188,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":188,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":188,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":188,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":212,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":212,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":212,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":212,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":18,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { supabase } from '@/integrations/supabase/client';\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from \"@/components/ui/GlassCard\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport Header from \"@/components/Header\";\nimport { \n  Trophy, \n  DollarSign, \n  Star, \n  Flame, \n  Target, \n  Award,\n  TrendingUp,\n  Calendar,\n  Zap,\n  Crown,\n  Medal,\n  GiftIcon,\n  CreditCard,\n  ExternalLink,\n  Loader2,\n  RefreshCw,\n  CheckCircle,\n  Lock\n} from \"lucide-react\";\nimport { useToast } from '@/components/ui/use-toast';\nimport { useAchievements } from '@/hooks/useAchievements';\nimport { useUserPoints } from '@/hooks/useUserPoints';\n\ninterface RewardsProps {\n  showMobileMenu?: boolean;\n  onMobileMenuToggle?: () => void;\n}\n\ninterface Profile {\n  id: string;\n  user_id: string;\n  full_name: string;\n  email: string;\n  total_points: number;\n  created_at: string;\n  updated_at: string;\n}\n\ninterface WithdrawalRequest {\n  id: string;\n  user_id: string;\n  amount: number;\n  method: string;\n  status: string;\n  paypal_email?: string;\n  mpesa_phone?: string;\n  created_at: string;\n}\n\nexport default function Rewards({ showMobileMenu, onMobileMenuToggle }: RewardsProps) {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const [profile, setProfile] = useState<Profile | null>(null);\n  const [withdrawalRequests, setWithdrawalRequests] = useState<WithdrawalRequest[]>([]);\n  const [showWithdrawalModal, setShowWithdrawalModal] = useState(false);\n  const [withdrawalForm, setWithdrawalForm] = useState({\n    amount: 0,\n    method: 'paypal' as string,\n    paypal_email: '',\n    mpesa_phone: ''\n  });\n  const [loading, setLoading] = useState(true);\n\n  // Use real achievements and badges from the database\n  const { \n    achievements, \n    badges, \n    userAchievements,\n    isLoading: achievementsLoading, \n    error: achievementsError, \n    refreshAchievements, \n    initializeUserAchievements,\n    updateBadges \n  } = useAchievements();\n  \n  const { \n    userPoints, \n    currencyValue, \n    canWithdraw, \n    currentBadge, \n    nextBadge, \n    pointsToNextBadge,\n    streaks\n  } = useUserPoints();\n\n  // Memoize the fetchProfile function to prevent unnecessary re-renders\n  const fetchProfile = useCallback(async () => {\n    if (!user?.id) return;\n    \n    try {\n      const { data, error } = await supabase\n        .from('profiles')\n        .select('*')\n        .eq('user_id', user.id)\n        .single();\n\n      if (error) {\n        if (error.code === 'PGRST116') {\n          console.warn('User profile not found in database');\n          return;\n        }\n        throw error;\n      }\n      \n      setProfile(data);\n    } catch (error: any) {\n      console.error('Error fetching profile:', error);\n    } finally {\n      setLoading(false);\n    }\n  }, [user?.id]);\n\n  // Memoize the fetchWithdrawalRequests function to prevent unnecessary re-renders\n  const fetchWithdrawalRequests = useCallback(async () => {\n    if (!user?.id) return;\n    \n    try {\n      const { data, error } = await supabase\n        .from('withdrawal_requests')\n        .select('*')\n        .eq('user_id', user.id)\n        .order('created_at', { ascending: false });\n\n      if (error) throw error;\n      \n      setWithdrawalRequests(data || []);\n    } catch (error) {\n      console.error('Error fetching withdrawal requests:', error);\n      toast({\n        title: 'Error',\n        description: 'Failed to load withdrawal requests',\n        variant: 'destructive',\n      });\n    }\n  }, [user?.id, toast]);\n\n  // Update badges when user points change\n  useEffect(() => {\n    if (userPoints?.totalPoints !== undefined && updateBadges) {\n      updateBadges(userPoints.totalPoints);\n    }\n  }, [userPoints?.totalPoints, updateBadges]);\n\n  // Debug logging - only in development\n  useEffect(() => {\n    if (process.env.NODE_ENV === 'development') {\n      console.log('Rewards page - Achievements:', achievements);\n      console.log('Rewards page - Badges:', badges);\n      console.log('Rewards page - Loading:', achievementsLoading);\n      console.log('Rewards page - User Points:', userPoints);\n      console.log('Rewards page - Streaks:', streaks);\n    }\n  }, [achievements, badges, achievementsLoading, userPoints, streaks]);\n\n  // Fetch profile and withdrawal requests when user changes\n  useEffect(() => {\n    if (user?.id) {\n      fetchProfile();\n      fetchWithdrawalRequests();\n    }\n  }, [user?.id, fetchProfile, fetchWithdrawalRequests]);\n\n  const handleInitializeAchievements = async () => {\n    try {\n      const result = await initializeUserAchievements();\n      if (result?.success) {\n        toast({\n          title: \"Achievements Initialized\",\n          description: \"Your achievement system has been set up successfully!\",\n        });\n      } else {\n        toast({\n          title: \"Error\",\n          description: result?.error || \"Failed to initialize achievements\",\n          variant: \"destructive\",\n        });\n      }\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to initialize achievements\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleRefreshAchievements = async () => {\n    try {\n      const result = await refreshAchievements();\n      if (result?.success) {\n        toast({\n          title: \"Data Refreshed\",\n          description: \"Achievement data has been refreshed successfully!\",\n        });\n      } else {\n        toast({\n          title: \"Error\",\n          description: result?.error || \"Failed to refresh achievements\",\n          variant: \"destructive\",\n        });\n      }\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to refresh achievements\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleResetAchievements = async () => {\n    if (!user) return;\n    \n    try {\n      // Call the database function to reset achievements to locked\n      const { error } = await supabase.rpc('reset_user_achievements_to_locked', {\n        p_user_id: user.id\n      });\n\n      if (error) throw error;\n\n      toast({\n        title: \"Achievements Reset\",\n        description: \"All achievements have been reset to locked status for testing.\",\n      });\n\n      // Refresh achievements to show updated status\n      await refreshAchievements();\n    } catch (error: any) {\n      console.error('Error resetting achievements:', error);\n      toast({\n        title: \"Error\",\n        description: \"Failed to reset achievements\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleWithdrawal = async () => {\n    if (!user || !profile) return;\n\n    const requiredPoints = withdrawalForm.amount * 10000; // $0.1 per 1000 points = 10000 points per $1\n    \n    if ((userPoints?.totalPoints || 0) < requiredPoints) {\n      toast({\n        title: \"Insufficient Points\",\n        description: `You need ${requiredPoints.toLocaleString()} points to withdraw $${withdrawalForm.amount}`,\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if ((userPoints?.totalPoints || 0) < 500000) {\n      toast({\n        title: \"Minimum Points Required\",\n        description: \"You need at least 500,000 points to withdraw funds\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    try {\n      const { error } = await supabase\n        .from('withdrawal_requests')\n        .insert({\n          user_id: user.id,\n          amount: withdrawalForm.amount,\n          method: withdrawalForm.method,\n          paypal_email: withdrawalForm.method === 'paypal' ? withdrawalForm.paypal_email : null,\n          mpesa_phone: withdrawalForm.method === 'mpesa' ? withdrawalForm.mpesa_phone : null,\n          status: 'pending'\n        });\n\n      if (error) throw error;\n\n      // Deduct points from user profile\n      const { error: updateError } = await supabase\n        .from('profiles')\n        .update({ total_points: (userPoints?.totalPoints || 0) - requiredPoints })\n        .eq('user_id', user.id);\n\n      if (updateError) throw updateError;\n\n      toast({\n        title: \"Withdrawal Request Submitted\",\n        description: \"Your withdrawal request has been submitted and is pending approval\",\n      });\n\n      setShowWithdrawalModal(false);\n      setWithdrawalForm({ amount: 0, method: 'paypal', paypal_email: '', mpesa_phone: '' });\n      fetchProfile(); // Refresh profile to show updated points\n      fetchWithdrawalRequests();\n    } catch (error: any) {\n      console.error('Error submitting withdrawal request:', error);\n      toast({\n        title: \"Error\",\n        description: \"Failed to submit withdrawal request\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  if (loading || !userPoints) {\n    return (\n      <div className=\"min-h-screen bg-background p-4 flex items-center justify-center\">\n        <div className=\"text-center space-y-4\">\n          <div className=\"mx-auto w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center\">\n            <div className=\"w-8 h-8 border-4 border-primary border-t-transparent rounded-full animate-spin\"></div>\n          </div>\n          <p className=\"text-muted-foreground\">Loading your rewards...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!profile) {\n    return (\n      <div className=\"min-h-screen bg-background p-4 flex items-center justify-center\">\n        <div className=\"text-center space-y-4\">\n          <p className=\"text-muted-foreground\">Profile not found</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"page-container\">\n      <Header \n        title=\"Rewards & Achievements\"\n        subtitle=\"Track your progress and unlock badges\"\n        showMobileMenu={showMobileMenu || false} \n        onMobileMenuToggle={onMobileMenuToggle || (() => {})} \n      />\n      <div className=\"page-content space-y-card-gap\">\n        {/* Header */}\n        <div className=\"text-center space-y-4\">\n          <h1 className=\"heading-lg bg-gradient-primary bg-clip-text text-transparent\">\n            Rewards & Achievements\n          </h1>\n          <p className=\"body-md text-muted-foreground\">\n            Track your progress, unlock badges, and earn achievements\n          </p>\n          <div className=\"flex justify-center gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={handleInitializeAchievements}\n              disabled={achievementsLoading}\n              className=\"floating-card\"\n            >\n              {achievementsLoading ? (\n                <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\n              ) : (\n                <RefreshCw className=\"h-4 w-4 mr-2\" />\n              )}\n              Initialize Achievements\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={handleRefreshAchievements}\n              disabled={achievementsLoading}\n              className=\"floating-card\"\n            >\n              {achievementsLoading ? (\n                <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\n              ) : (\n                <RefreshCw className=\"h-4 w-4 mr-2\" />\n              )}\n              Refresh Data\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={handleResetAchievements}\n              disabled={achievementsLoading}\n              className=\"floating-card\"\n            >\n              {achievementsLoading ? (\n                <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\n              ) : (\n                <RefreshCw className=\"h-4 w-4 mr-2\" />\n              )}\n              Reset Achievements\n            </Button>\n          </div>\n          \n          {/* Error Display */}\n          {achievementsError && (\n            <div className=\"mt-4 p-3 floating-card border-red-200 rounded-lg\">\n              <p className=\"text-sm text-red-700\">\n                <strong>Error loading achievements:</strong> {achievementsError}\n              </p>\n            </div>\n          )}\n        </div>\n\n        {/* Stats Overview */}\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4\">\n          <GlassCard className=\"floating-card border-0\">\n            <GlassCardContent className=\"p-4 text-center\">\n              <div className=\"text-3xl font-bold text-primary mb-2\">\n                <Trophy className=\"w-8 h-8 mx-auto mb-2\" />\n                {(userPoints?.totalPoints || 0).toLocaleString()}\n              </div>\n              <p className=\"text-sm text-muted-foreground\">Total Points</p>\n            </GlassCardContent>\n          </GlassCard>\n\n          <GlassCard className=\"floating-card border-0\">\n            <GlassCardContent className=\"p-4 text-center\">\n              <div className=\"text-3xl font-bold text-green-500 mb-2\">\n                <DollarSign className=\"w-8 h-8 mx-auto mb-2\" />\n                ${(currencyValue || 0).toFixed(2)}\n              </div>\n              <p className=\"text-sm text-muted-foreground\">Currency Value</p>\n            </GlassCardContent>\n          </GlassCard>\n\n          <GlassCard className=\"floating-card border-0\">\n            <GlassCardContent className=\"p-4 text-center\">\n              <div className=\"text-3xl font-bold text-purple-500 mb-2\">\n                <Star className=\"w-8 h-8 mx-auto mb-2\" />\n                {achievements ? achievements.length : 0}\n              </div>\n              <p className=\"text-sm text-muted-foreground\">Achievements</p>\n            </GlassCardContent>\n          </GlassCard>\n\n          <GlassCard className=\"floating-card border-0\">\n            <GlassCardContent className=\"p-4 text-center\">\n              <div className=\"text-3xl font-bold text-orange-500 mb-2\">\n                <Crown className=\"w-8 h-8 mx-auto mb-2\" />\n                {badges ? badges.filter(b => b.unlocked).length : 0}\n              </div>\n              <p className=\"text-sm text-muted-foreground\">Badges Unlocked</p>\n            </GlassCardContent>\n          </GlassCard>\n        </div>\n\n        {/* Current Badge Display */}\n        <GlassCard className=\"floating-card border-0\">\n          <GlassCardHeader>\n            <GlassCardTitle className=\"flex items-center gap-2\">\n              <Crown className=\"h-5 w-5 text-yellow-500\" />\n              Current Badge\n            </GlassCardTitle>\n          </GlassCardHeader>\n          <GlassCardContent className=\"text-center space-y-4\">\n            <div className=\"text-6xl mb-4\">{currentBadge.icon}</div>\n            <div className=\"text-2xl font-bold text-primary\">{currentBadge.name}</div>\n            <p className=\"text-muted-foreground\">\n              {nextBadge ? (\n                <>\n                  {pointsToNextBadge.toLocaleString()} points to next badge: {nextBadge.icon} {nextBadge.name}\n                </>\n              ) : (\n                \"You've unlocked all badges! 🎉\"\n              )}\n            </p>\n            {nextBadge && (\n              <div className=\"w-full max-w-md mx-auto\">\n                <Progress \n                  value={((userPoints?.totalPoints || 0) / nextBadge.pointsRequired) * 100} \n                  className=\"h-3\"\n                />\n                <div className=\"text-sm text-muted-foreground mt-2\">\n                  {userPoints?.totalPoints || 0} / {nextBadge.pointsRequired.toLocaleString()} points\n                </div>\n              </div>\n            )}\n          </GlassCardContent>\n        </GlassCard>\n\n        {/* Main Content Tabs */}\n        <Tabs defaultValue=\"badges\" className=\"space-y-4\">\n          <TabsList className=\"grid w-full grid-cols-4\">\n            <TabsTrigger value=\"badges\">Badges</TabsTrigger>\n            <TabsTrigger value=\"achievements\">Achievements</TabsTrigger>\n            <TabsTrigger value=\"rewards\">Rewards</TabsTrigger>\n            <TabsTrigger value=\"withdrawals\">Withdrawals</TabsTrigger>\n          </TabsList>\n\n          {/* Badges Tab */}\n          <TabsContent value=\"badges\" className=\"space-y-4\">\n            <GlassCard className=\"floating-card border-0\">\n              <GlassCardHeader>\n                <GlassCardTitle className=\"flex items-center gap-2\">\n                  <Medal className=\"h-5 w-5 text-yellow-500\" />\n                  Badge Collection\n                </GlassCardTitle>\n              </GlassCardHeader>\n              <GlassCardContent className=\"space-y-4\">\n                {!badges || badges.length === 0 ? (\n                  <div className=\"text-center py-8\">\n                    <div className=\"text-4xl mb-4\">🎯</div>\n                    <p className=\"text-muted-foreground\">No badges found. Start earning points to unlock badges!</p>\n                    <Button \n                      onClick={handleInitializeAchievements} \n                      variant=\"outline\" \n                      className=\"mt-4 floating-card\"\n                      disabled={achievementsLoading}\n                    >\n                      {achievementsLoading ? (\n                        <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\n                      ) : (\n                        <RefreshCw className=\"h-4 w-4 mr-2\" />\n                      )}\n                      Initialize System\n                    </Button>\n                  </div>\n                ) : (\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                    {badges.map((badge) => (\n                      <GlassCard \n                        key={badge.id} \n                        className={`floating-card border-2 transition-all duration-200 ${\n                          badge.unlocked \n                            ? 'border-green-200 shadow-lg scale-105' \n                            : 'border-gray-200 opacity-75'\n                        }`}\n                      >\n                        <GlassCardContent className=\"p-4 text-center\">\n                          <div className={`text-4xl mb-3 ${badge.unlocked ? '' : 'grayscale'}`}>\n                            {badge.icon}\n                          </div>\n                          <div className=\"font-semibold text-lg mb-2\">{badge.name}</div>\n                          <div className=\"text-sm text-muted-foreground mb-3\">\n                            {badge.description}\n                          </div>\n                          <div className=\"text-sm font-medium mb-2\">\n                            {badge.pointsRequired.toLocaleString()} points required\n                          </div>\n                          \n                          {badge.unlocked ? (\n                            <div className=\"flex items-center justify-center gap-2 text-green-600\">\n                              <CheckCircle className=\"h-4 w-4\" />\n                              <span className=\"text-sm font-medium\">Unlocked!</span>\n                            </div>\n                          ) : (\n                            <div className=\"flex items-center justify-center gap-2 text-muted-foreground\">\n                              <Lock className=\"h-4 w-4\" />\n                              <span className=\"text-sm font-medium\">Locked</span>\n                            </div>\n                          )}\n                          \n                          {/* Progress bar for locked badges */}\n                          {!badge.unlocked && (\n                            <div className=\"mt-3\">\n                              <Progress \n                                value={(badge.progress / badge.maxProgress) * 100} \n                                className=\"h-2\"\n                              />\n                              <div className=\"text-xs text-muted-foreground mt-1\">\n                                {badge.progress.toLocaleString()} / {badge.maxProgress.toLocaleString()} points\n                              </div>\n                            </div>\n                          )}\n                        </GlassCardContent>\n                      </GlassCard>\n                    ))}\n                  </div>\n                )}\n              </GlassCardContent>\n            </GlassCard>\n          </TabsContent>\n\n          {/* Achievements Tab */}\n          <TabsContent value=\"achievements\" className=\"space-y-4\">\n            <GlassCard className=\"floating-card border-0\">\n              <GlassCardHeader>\n                <GlassCardTitle className=\"flex items-center gap-2\">\n                  <Target className=\"h-5 w-5 text-blue-500\" />\n                  All Achievements\n                </GlassCardTitle>\n              </GlassCardHeader>\n              <GlassCardContent className=\"space-y-4\">\n                {!achievements || achievements.length === 0 ? (\n                  <div className=\"text-center py-8\">\n                    <div className=\"text-4xl mb-4\">🎯</div>\n                    <p className=\"text-muted-foreground\">No achievements found. They will be created when you first check air quality.</p>\n                    <Button \n                      onClick={handleInitializeAchievements} \n                      variant=\"outline\" \n                      className=\"mt-4 floating-card\"\n                      disabled={achievementsLoading}\n                    >\n                      {achievementsLoading ? (\n                        <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\n                      ) : (\n                        <RefreshCw className=\"h-4 w-4 mr-2\" />\n                      )}\n                      Initialize Achievements\n                    </Button>\n                  </div>\n                                  ) : (\n                    achievements.map((achievement) => {\n                      // Find the user's progress for this achievement\n                      const userAchievement = userAchievements?.find(ua => ua.achievement_id === achievement.id);\n                      const isUnlocked = userAchievement?.unlocked || false;\n                      const progress = userAchievement?.progress || 0;\n                      const maxProgress = userAchievement?.max_progress || achievement.criteria_value;\n                      \n                      return (\n                        <GlassCard key={achievement.id} className={`floating-card border-2 ${isUnlocked ? 'border-green-200' : 'border-gray-200'}`}>\n                          <GlassCardContent className=\"p-4\">\n                            <div className=\"flex items-center gap-4\">\n                              <div className=\"text-4xl\">{achievement.icon}</div>\n                              <div className=\"flex-1\">\n                                <div className=\"flex items-center justify-between mb-2\">\n                                  <div className=\"font-semibold\">{achievement.name}</div>\n                                  <Badge \n                                    variant={isUnlocked ? \"default\" : \"secondary\"} \n                                    className={isUnlocked ? \"bg-green-100 text-green-700 border-green-300\" : \"bg-gray-100 text-gray-700 border-gray-300\"}\n                                  >\n                                    {isUnlocked ? (\n                                      <>\n                                        <CheckCircle className=\"h-3 w-3 mr-1\" />\n                                        Unlocked\n                                      </>\n                                    ) : (\n                                      <>\n                                        <Lock className=\"h-3 w-3 mr-1\" />\n                                        Locked\n                                      </>\n                                    )}\n                                  </Badge>\n                                </div>\n                                <div className=\"text-sm text-muted-foreground mb-3\">\n                                  {achievement.description}\n                                </div>\n                                <div className=\"text-sm text-blue-600 mb-3\">\n                                  Reward: +{achievement.points_reward} points\n                                </div>\n                                \n                                {/* Progress bar for all achievements */}\n                                <div className=\"mt-3\">\n                                  <Progress \n                                    value={(progress / maxProgress) * 100} \n                                    className=\"h-2\"\n                                  />\n                                  <div className=\"text-xs text-muted-foreground mt-1\">\n                                    {progress.toLocaleString()} / {maxProgress.toLocaleString()} {achievement.criteria_unit || 'units'}\n                                  </div>\n                                </div>\n                              </div>\n                            </div>\n                          </GlassCardContent>\n                        </GlassCard>\n                      );\n                    })\n                  )}\n              </GlassCardContent>\n            </GlassCard>\n          </TabsContent>\n\n          {/* Rewards Tab */}\n          <TabsContent value=\"rewards\" className=\"space-y-4\">\n            {/* Currency Rewards */}\n            <GlassCard className=\"floating-card border-0\">\n              <GlassCardHeader>\n                <GlassCardTitle className=\"flex items-center gap-2\">\n                  <DollarSign className=\"h-5 w-5 text-green-500\" />\n                  Currency Rewards\n                </GlassCardTitle>\n              </GlassCardHeader>\n              <GlassCardContent className=\"space-y-4\">\n                <div className=\"text-center space-y-4\">\n                  <div className=\"text-6xl font-bold text-green-500\">\n                    ${(currencyValue || 0).toFixed(2)}\n                  </div>\n                  <p className=\"text-sm text-muted-foreground\">\n                    $0.1 per 1000 points • Withdrawable at 500,000 points\n                  </p>\n                  {canWithdraw ? (\n                    <Badge variant=\"outline\" className=\"bg-green-100 text-green-700 border-green-300\">\n                      🎉 Ready to withdraw!\n                    </Badge>\n                  ) : (\n                    <Badge variant=\"outline\" className=\"bg-yellow-100 text-yellow-700 border-yellow-300\">\n                      {500000 - (userPoints?.totalPoints || 0)} points needed to withdraw\n                    </Badge>\n                  )}\n                </div>\n              </GlassCardContent>\n            </GlassCard>\n\n            {/* Badge Progress Summary */}\n            <GlassCard className=\"floating-card border-0\">\n              <GlassCardHeader>\n                <GlassCardTitle className=\"flex items-center gap-2\">\n                  <Trophy className=\"h-5 w-5 text-yellow-500\" />\n                  Badge Progress\n                </GlassCardTitle>\n              </GlassCardHeader>\n              <GlassCardContent className=\"space-y-4\">\n                <div className=\"text-center\">\n                  <div className=\"text-3xl font-bold text-primary mb-2\">\n                    {badges ? badges.filter(b => b.unlocked).length : 0} / {badges ? badges.length : 0}\n                  </div>\n                  <p className=\"text-sm text-muted-foreground mb-4\">Badges Unlocked</p>\n                  <Progress \n                    value={badges ? (badges.filter(b => b.unlocked).length / badges.length) * 100 : 0} \n                    className=\"h-3 max-w-md mx-auto\"\n                  />\n                </div>\n                \n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mt-6\">\n                  <div className=\"text-center p-4 floating-card border border-blue-200\">\n                    <div className=\"text-2xl font-bold text-blue-600\">\n                      {userPoints?.totalPoints || 0}\n                    </div>\n                    <p className=\"text-sm text-blue-700\">Total Points Earned</p>\n                  </div>\n                  \n                  <div className=\"text-center p-4 floating-card border border-green-200\">\n                    <div className=\"text-2xl font-bold text-green-600\">\n                      {nextBadge ? nextBadge.pointsRequired - (userPoints?.totalPoints || 0) : 0}\n                    </div>\n                    <p className=\"text-sm text-green-700\">Points to Next Badge</p>\n                  </div>\n                </div>\n              </GlassCardContent>\n            </GlassCard>\n          </TabsContent>\n\n          {/* Withdrawals Tab */}\n          <TabsContent value=\"withdrawals\" className=\"space-y-4\">\n            <GlassCard className=\"floating-card border-0\">\n              <GlassCardHeader>\n                <GlassCardTitle className=\"flex items-center gap-2\">\n                  <CreditCard className=\"h-5 w-5 text-blue-500\" />\n                  Withdrawal Requests\n                </GlassCardTitle>\n              </GlassCardHeader>\n              <GlassCardContent className=\"space-y-4\">\n                {canWithdraw ? (\n                  <div className=\"space-y-4\">\n                    <div className=\"text-center p-4 floating-card border border-green-200\">\n                      <p className=\"text-sm text-green-700\">\n                        You have enough points to withdraw! Click the button below to request a withdrawal.\n                      </p>\n                    </div>\n                    \n                    <Button \n                      onClick={() => setShowWithdrawalModal(true)}\n                      className=\"w-full\"\n                      size=\"lg\"\n                    >\n                      <DollarSign className=\"h-4 w-4 mr-2\" />\n                      Request Withdrawal\n                    </Button>\n                  </div>\n                ) : (\n                  <div className=\"text-center p-4 floating-card border border-yellow-200\">\n                    <p className=\"text-sm text-yellow-700\">\n                      You need at least 500,000 points to withdraw funds. \n                      Current points: {profile.total_points.toLocaleString()}\n                    </p>\n                  </div>\n                )}\n\n                {withdrawalRequests.length > 0 && (\n                  <div className=\"space-y-3\">\n                    <h4 className=\"font-semibold\">Recent Withdrawal Requests</h4>\n                    {withdrawalRequests.map((request) => (\n                      <GlassCard key={request.id} className=\"border\">\n                        <GlassCardContent className=\"p-3\">\n                          <div className=\"flex items-center justify-between\">\n                            <div>\n                              <div className=\"font-medium\">${request.amount}</div>\n                              <div className=\"text-sm text-muted-foreground\">\n                                {request.method === 'paypal' ? 'PayPal' : 'M-Pesa'} • {new Date(request.created_at).toLocaleDateString()}\n                              </div>\n                            </div>\n                            <Badge \n                              variant={request.status === 'approved' ? 'default' : request.status === 'pending' ? 'secondary' : 'destructive'}\n                            >\n                              {request.status}\n                            </Badge>\n                          </div>\n                        </GlassCardContent>\n                      </GlassCard>\n                    ))}\n                  </div>\n                )}\n              </GlassCardContent>\n            </GlassCard>\n          </TabsContent>\n        </Tabs>\n\n        {/* Withdrawal Modal */}\n        {showWithdrawalModal && (\n          <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\n            <div className=\"bg-background p-6 rounded-lg max-w-md w-full mx-4\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <h3 className=\"text-lg font-semibold\">Request Withdrawal</h3>\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={() => setShowWithdrawalModal(false)}\n                >\n                  ✕\n                </Button>\n              </div>\n              \n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"text-sm font-medium\">Amount (USD)</label>\n                  <input\n                    type=\"number\"\n                    min=\"1\"\n                    step=\"0.01\"\n                    value={withdrawalForm.amount}\n                    onChange={(e) => setWithdrawalForm({ ...withdrawalForm, amount: parseFloat(e.target.value) || 0 })}\n                    placeholder=\"Enter amount\"\n                    className=\"w-full p-2 border rounded-md mt-1\"\n                  />\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    Points required: {(withdrawalForm.amount * 10000).toLocaleString()}\n                  </p>\n                </div>\n\n                <div>\n                  <label className=\"text-sm font-medium\">Payment Method</label>\n                  <select\n                    value={withdrawalForm.method}\n                    onChange={(e) => setWithdrawalForm({ ...withdrawalForm, method: e.target.value as 'paypal' | 'mpesa' })}\n                    className=\"w-full p-2 border rounded-md mt-1\"\n                  >\n                    <option value=\"paypal\">PayPal</option>\n                    <option value=\"mpesa\">M-Pesa</option>\n                  </select>\n                </div>\n\n                {withdrawalForm.method === 'paypal' && (\n                  <div>\n                    <label className=\"text-sm font-medium\">PayPal Email</label>\n                    <input\n                      type=\"email\"\n                      value={withdrawalForm.paypal_email}\n                      onChange={(e) => setWithdrawalForm({ ...withdrawalForm, paypal_email: e.target.value })}\n                      placeholder=\"your@email.com\"\n                      className=\"w-full p-2 border rounded-md mt-1\"\n                    />\n                  </div>\n                )}\n\n                {withdrawalForm.method === 'mpesa' && (\n                  <div>\n                    <label className=\"text-sm font-medium\">M-Pesa Phone Number</label>\n                    <input\n                      type=\"tel\"\n                      value={withdrawalForm.mpesa_phone}\n                      onChange={(e) => setWithdrawalForm({ ...withdrawalForm, mpesa_phone: e.target.value })}\n                      placeholder=\"+254700000000\"\n                      className=\"w-full p-2 border rounded-md mt-1\"\n                    />\n                  </div>\n                )}\n\n                <div className=\"flex gap-2\">\n                  <Button\n                    onClick={handleWithdrawal}\n                    className=\"flex-1\"\n                    disabled={!withdrawalForm.amount || \n                      (withdrawalForm.method === 'paypal' && !withdrawalForm.paypal_email) ||\n                      (withdrawalForm.method === 'mpesa' && !withdrawalForm.mpesa_phone)\n                    }\n                  >\n                    Submit Request\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => setShowWithdrawalModal(false)}\n                    className=\"flex-1\"\n                  >\n                    Cancel\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\pages\\Store.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":1,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"useEffect"},"fix":{"range":[17,28],"text":""},"desc":"Remove unused variable 'useEffect'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":1,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":29},{"ruleId":"no-unused-vars","severity":1,"message":"'supabase' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"supabase"},"fix":{"range":[95,153],"text":""},"desc":"Remove unused variable 'supabase'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'supabase' is defined but never used.","line":3,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":18},{"ruleId":"no-unused-vars","severity":1,"message":"'GlassCardTitle' is defined but never used.","line":4,"column":56,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":70,"suggestions":[{"messageId":"removeVar","data":{"varName":"GlassCardTitle"},"fix":{"range":[207,223],"text":""},"desc":"Remove unused variable 'GlassCardTitle'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'GlassCardTitle' is defined but never used.","line":4,"column":56,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":70},{"ruleId":"no-unused-vars","severity":1,"message":"'Progress' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"Progress"},"fix":{"range":[356,408],"text":""},"desc":"Remove unused variable 'Progress'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Progress' is defined but never used.","line":7,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":18},{"ruleId":"no-unused-vars","severity":1,"message":"'Tabs' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"Tabs"},"fix":{"range":[418,423],"text":""},"desc":"Remove unused variable 'Tabs'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Tabs' is defined but never used.","line":8,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":14},{"ruleId":"no-unused-vars","severity":1,"message":"'TabsContent' is defined but never used.","line":8,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"TabsContent"},"fix":{"range":[422,435],"text":""},"desc":"Remove unused variable 'TabsContent'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TabsContent' is defined but never used.","line":8,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":27},{"ruleId":"no-unused-vars","severity":1,"message":"'TabsList' is defined but never used.","line":8,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":37,"suggestions":[{"messageId":"removeVar","data":{"varName":"TabsList"},"fix":{"range":[435,445],"text":""},"desc":"Remove unused variable 'TabsList'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TabsList' is defined but never used.","line":8,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":37},{"ruleId":"no-unused-vars","severity":1,"message":"'TabsTrigger' is defined but never used.","line":8,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":50,"suggestions":[{"messageId":"removeVar","data":{"varName":"TabsTrigger"},"fix":{"range":[445,458],"text":""},"desc":"Remove unused variable 'TabsTrigger'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TabsTrigger' is defined but never used.","line":8,"column":39,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":50},{"ruleId":"no-unused-vars","severity":1,"message":"'TrendingUp' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingUp"},"fix":{"range":[739,754],"text":""},"desc":"Remove unused variable 'TrendingUp'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingUp' is defined but never used.","line":17,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":13},{"ruleId":"no-unused-vars","severity":1,"message":"'Users' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":8,"suggestions":[{"messageId":"removeVar","data":{"varName":"Users"},"fix":{"range":[754,764],"text":""},"desc":"Remove unused variable 'Users'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Users' is defined but never used.","line":18,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":8},{"ruleId":"no-unused-vars","severity":1,"message":"'Award' is defined but never used.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":8,"suggestions":[{"messageId":"removeVar","data":{"varName":"Award"},"fix":{"range":[764,774],"text":""},"desc":"Remove unused variable 'Award'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Award' is defined but never used.","line":19,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":8},{"ruleId":"no-unused-vars","severity":1,"message":"'Calendar' is defined but never used.","line":20,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":11,"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[774,786],"text":""},"desc":"Remove unused variable 'Calendar'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calendar' is defined but never used.","line":20,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":11},{"ruleId":"no-unused-vars","severity":1,"message":"'GiftIcon' is defined but never used.","line":24,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":11,"suggestions":[{"messageId":"removeVar","data":{"varName":"GiftIcon"},"fix":{"range":[811,823],"text":""},"desc":"Remove unused variable 'GiftIcon'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'GiftIcon' is defined but never used.","line":24,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":11},{"ruleId":"no-unused-vars","severity":1,"message":"'CreditCard' is defined but never used.","line":25,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"CreditCard"},"fix":{"range":[823,837],"text":""},"desc":"Remove unused variable 'CreditCard'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CreditCard' is defined but never used.","line":25,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":25,"endColumn":13},{"ruleId":"no-unused-vars","severity":1,"message":"'Loader2' is defined but never used.","line":27,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":10,"suggestions":[{"messageId":"removeVar","data":{"varName":"Loader2"},"fix":{"range":[853,864],"text":""},"desc":"Remove unused variable 'Loader2'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Loader2' is defined but never used.","line":27,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":10},{"ruleId":"no-unused-vars","severity":1,"message":"'RefreshCw' is defined but never used.","line":28,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"RefreshCw"},"fix":{"range":[864,877],"text":""},"desc":"Remove unused variable 'RefreshCw'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RefreshCw' is defined but never used.","line":28,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":12},{"ruleId":"no-unused-vars","severity":1,"message":"'user' is assigned a value but never used.","line":192,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":192,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"user"},"fix":{"range":[5732,5759],"text":""},"desc":"Remove unused variable 'user'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used.","line":192,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":192,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'toast' is assigned a value but never used.","line":193,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":193,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"toast"},"fix":{"range":[5762,5791],"text":""},"desc":"Remove unused variable 'toast'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'toast' is assigned a value but never used.","line":193,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":193,"endColumn":16},{"ruleId":"no-unused-vars","severity":1,"message":"'getStatusColor' is assigned a value but never used.","line":243,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":243,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"getStatusColor"},"fix":{"range":[7778,8244],"text":""},"desc":"Remove unused variable 'getStatusColor'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getStatusColor' is assigned a value but never used.","line":243,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":243,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'getStoreColor' is assigned a value but never used.","line":253,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":253,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"getStoreColor"},"fix":{"range":[8248,8633],"text":""},"desc":"Remove unused variable 'getStoreColor'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getStoreColor' is assigned a value but never used.","line":253,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":253,"endColumn":22}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":40,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { supabase } from '@/integrations/supabase/client';\nimport { GlassCard, GlassCardContent, GlassCardHeader, GlassCardTitle } from \"@/components/ui/GlassCard\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport Header from \"@/components/Header\";\nimport { \n  ShoppingBag, \n  Star, \n  DollarSign, \n  Gift, \n  TrendingUp, \n  Users, \n  Award,\n  Calendar,\n  Zap,\n  Crown,\n  Medal,\n  GiftIcon,\n  CreditCard,\n  ExternalLink,\n  Loader2,\n  RefreshCw,\n  Filter,\n  Search\n} from \"lucide-react\";\nimport { useToast } from '@/components/ui/use-toast';\nimport React from 'react'; // Added missing import for React\n\n\ninterface Product {\n  id: string;\n  name: string;\n  description: string;\n  price: string;\n  originalPrice?: string;\n  image: string;\n  category: 'air-purifier' | 'dehumidifier' | 'humidifier' | 'air-filter' | 'monitor' | 'accessory';\n  rating: number;\n  reviewCount: number;\n  affiliateLink: string;\n  store: 'amazon' | 'aliexpress' | 'alibaba' | 'other';\n  inStock: boolean;\n  fastShipping?: boolean;\n  bestSeller?: boolean;\n}\n\nconst products: Product[] = [\n  {\n    id: '1',\n    name: 'HEPA Air Purifier Pro',\n    description: 'Advanced HEPA filtration system removes 99.97% of airborne particles including dust, pollen, pet dander, and smoke.',\n    price: '$89.99',\n    originalPrice: '$129.99',\n    image: '/placeholder.svg',\n    category: 'air-purifier',\n    rating: 4.8,\n    reviewCount: 1247,\n    affiliateLink: 'https://amazon.com/air-purifier-pro',\n    store: 'amazon',\n    inStock: true,\n    fastShipping: true,\n    bestSeller: true\n  },\n  {\n    id: '2',\n    name: 'Smart Dehumidifier 50L',\n    description: 'Large capacity dehumidifier with smart humidity control, perfect for basements and large rooms.',\n    price: '$199.99',\n    image: '/placeholder.svg',\n    category: 'dehumidifier',\n    rating: 4.6,\n    reviewCount: 892,\n    affiliateLink: 'https://aliexpress.com/smart-dehumidifier',\n    store: 'aliexpress',\n    inStock: true,\n    fastShipping: true\n  },\n  {\n    id: '3',\n    name: 'Ultrasonic Humidifier',\n    description: 'Quiet ultrasonic humidifier with adjustable mist levels and auto-shutoff for optimal humidity control.',\n    price: '$45.99',\n    originalPrice: '$59.99',\n    image: '/placeholder.svg',\n    category: 'humidifier',\n    rating: 4.4,\n    reviewCount: 567,\n    affiliateLink: 'https://amazon.com/ultrasonic-humidifier',\n    store: 'amazon',\n    inStock: true\n  },\n  {\n    id: '4',\n    name: 'Premium Air Filter Set',\n    description: 'High-quality air filters compatible with most HVAC systems, captures allergens and improves indoor air quality.',\n    price: '$29.99',\n    image: '/placeholder.svg',\n    category: 'air-filter',\n    rating: 4.7,\n    reviewCount: 2341,\n    affiliateLink: 'https://alibaba.com/premium-air-filters',\n    store: 'alibaba',\n    inStock: true,\n    bestSeller: true\n  },\n  {\n    id: '5',\n    name: 'Air Quality Monitor',\n    description: 'Real-time air quality sensor that measures PM2.5, PM10, CO2, temperature, and humidity levels.',\n    price: '$79.99',\n    image: '/placeholder.svg',\n    category: 'monitor',\n    rating: 4.9,\n    reviewCount: 1567,\n    affiliateLink: 'https://amazon.com/air-quality-monitor',\n    store: 'amazon',\n    inStock: true,\n    fastShipping: true,\n    bestSeller: true\n  },\n  {\n    id: '6',\n    name: 'Portable Air Purifier',\n    description: 'Compact and portable air purifier perfect for small rooms, offices, and travel use.',\n    price: '$34.99',\n    originalPrice: '$49.99',\n    image: '/placeholder.svg',\n    category: 'air-purifier',\n    rating: 4.3,\n    reviewCount: 423,\n    affiliateLink: 'https://aliexpress.com/portable-air-purifier',\n    store: 'aliexpress',\n    inStock: true\n  },\n  {\n    id: '7',\n    name: 'Mini Dehumidifier',\n    description: 'Small dehumidifier ideal for bathrooms, closets, and small spaces up to 200 sq ft.',\n    price: '$39.99',\n    image: '/placeholder.svg',\n    category: 'dehumidifier',\n    rating: 4.2,\n    reviewCount: 298,\n    affiliateLink: 'https://alibaba.com/mini-dehumidifier',\n    store: 'alibaba',\n    inStock: true\n  },\n  {\n    id: '8',\n    name: 'Essential Oil Diffuser',\n    description: 'Aromatherapy diffuser with LED mood lighting, perfect for creating a relaxing atmosphere.',\n    price: '$24.99',\n    image: '/placeholder.svg',\n    category: 'accessory',\n    rating: 4.5,\n    reviewCount: 756,\n    affiliateLink: 'https://amazon.com/essential-oil-diffuser',\n    store: 'amazon',\n    inStock: true\n  }\n];\n\nconst categories = [\n  { value: 'all', label: 'All Products', icon: ShoppingBag },\n  { value: 'air-purifier', label: 'Air Purifiers', icon: Zap },\n  { value: 'dehumidifier', label: 'Dehumidifiers', icon: DollarSign },\n  { value: 'humidifier', label: 'Humidifiers', icon: Gift },\n  { value: 'air-filter', label: 'Air Filters', icon: Crown },\n  { value: 'monitor', label: 'Monitors', icon: Medal },\n  { value: 'accessory', label: 'Accessories', icon: ShoppingBag }\n];\n\nconst stores = [\n  { value: 'all', label: 'All Stores' },\n  { value: 'amazon', label: 'Amazon' },\n  { value: 'aliexpress', label: 'AliExpress' },\n  { value: 'alibaba', label: 'Alibaba' }\n];\n\ninterface StoreProps {\n  showMobileMenu?: boolean;\n  onMobileMenuToggle?: () => void;\n}\n\nexport default function Store({ showMobileMenu, onMobileMenuToggle }: StoreProps) {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedCategory, setSelectedCategory] = useState('all');\n  const [selectedStore, setSelectedStore] = useState('all');\n  const [sortBy, setSortBy] = useState('rating');\n\n  // Filter products based on search, category, and store\n  const filteredProducts = products.filter(product => {\n    const matchesSearch = product.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                         product.description.toLowerCase().includes(searchTerm.toLowerCase());\n    const matchesCategory = selectedCategory === 'all' || product.category === selectedCategory;\n    const matchesStore = selectedStore === 'all' || product.store === selectedStore;\n    \n    return matchesSearch && matchesCategory && matchesStore;\n  });\n\n  const sortedProducts = [...filteredProducts].sort((a, b) => {\n    switch (sortBy) {\n      case 'price-low':\n        return parseFloat(a.price.replace('$', '')) - parseFloat(b.price.replace('$', ''));\n      case 'price-high':\n        return parseFloat(b.price.replace('$', '')) - parseFloat(a.price.replace('$', ''));\n      case 'rating':\n        return b.rating - a.rating;\n      case 'reviews':\n        return b.reviewCount - a.reviewCount;\n      default:\n        return 0;\n    }\n  });\n\n  const handleProductClick = (product: Product) => {\n    // Open affiliate link in new tab\n    window.open(product.affiliateLink, '_blank');\n  };\n\n  const getStoreBadgeColor = (store: string) => {\n    switch (store) {\n      case 'amazon': return 'bg-yellow-100 text-yellow-800 border-yellow-300';\n      case 'aliexpress': return 'bg-red-100 text-red-800 border-red-300';\n      case 'alibaba': return 'bg-blue-100 text-blue-800 border-blue-300';\n      default: return 'bg-gray-100 text-gray-800 border-gray-300';\n    }\n  };\n\n  const getCategoryIcon = (category: string) => {\n    const categoryData = categories.find(c => c.value === category);\n    return categoryData ? categoryData.icon : ShoppingBag;\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status.toLowerCase()) {\n      case 'active': return 'bg-green-100 text-green-800 border-green-300';\n      case 'pending': return 'bg-yellow-100 text-yellow-800 border-yellow-300';\n      case 'completed': return 'bg-blue-100 text-blue-800 border-blue-300';\n      case 'cancelled': return 'bg-red-100 text-red-800 border-red-300';\n      default: return 'bg-slate-100 text-slate-800 border-slate-300';\n    }\n  };\n\n  const getStoreColor = (store: string) => {\n    switch (store.toLowerCase()) {\n      case 'amazon': return 'bg-yellow-100 text-yellow-800 border-yellow-300';\n      case 'aliexpress': return 'bg-red-100 text-red-800 border-red-300';\n      case 'alibaba': return 'bg-blue-100 text-blue-800 border-blue-300';\n      default: return 'bg-slate-100 text-slate-800 border-slate-300';\n    }\n  };\n\n  return (\n    <div className=\"page-container\">\n      <Header \n        title=\"Air Quality Store\"\n        subtitle=\"Discover premium products to improve your indoor air quality\"\n        showMobileMenu={showMobileMenu}\n        onMobileMenuToggle={onMobileMenuToggle}\n      />\n      <div className=\"page-content space-y-card-gap\">\n      {/* Header */}\n      <div className=\"text-center space-y-4\">\n        <h1 className=\"heading-lg bg-gradient-primary bg-clip-text text-transparent\">\n          Air Quality Store\n        </h1>\n        <p className=\"body-md text-muted-foreground\">\n          Discover premium products to improve your indoor air quality\n        </p>\n      </div>\n\n      {/* Search and Filters */}\n      <div className=\"space-y-4\">\n        {/* Search Bar */}\n        <div className=\"relative\">\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4\" />\n          <Input\n            placeholder=\"Search for air purifiers, filters, monitors...\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            className=\"pl-10\"\n          />\n        </div>\n\n        {/* Filters */}\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4\">\n          <Select value={selectedCategory} onValueChange={setSelectedCategory}>\n            <SelectTrigger>\n              <SelectValue placeholder=\"Category\" />\n            </SelectTrigger>\n            <SelectContent>\n              {categories.map((category) => {\n                const Icon = category.icon;\n                return (\n                  <SelectItem key={category.value} value={category.value}>\n                    <div className=\"flex items-center gap-2\">\n                      <Icon className=\"h-4 w-4\" />\n                      {category.label}\n                    </div>\n                  </SelectItem>\n                );\n              })}\n            </SelectContent>\n          </Select>\n\n          <Select value={selectedStore} onValueChange={setSelectedStore}>\n            <SelectTrigger>\n              <SelectValue placeholder=\"Store\" />\n            </SelectTrigger>\n            <SelectContent>\n              {stores.map((store) => (\n                <SelectItem key={store.value} value={store.value}>\n                  {store.label}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n\n          <Select value={sortBy} onValueChange={setSortBy}>\n            <SelectTrigger>\n              <SelectValue placeholder=\"Sort by\" />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"featured\">Featured</SelectItem>\n              <SelectItem value=\"price-low\">Price: Low to High</SelectItem>\n              <SelectItem value=\"price-high\">Price: High to Low</SelectItem>\n              <SelectItem value=\"rating\">Highest Rated</SelectItem>\n              <SelectItem value=\"reviews\">Most Reviews</SelectItem>\n            </SelectContent>\n          </Select>\n\n          <Button variant=\"outline\" className=\"w-full\">\n            <Filter className=\"h-4 w-4 mr-2\" />\n            More Filters\n          </Button>\n        </div>\n      </div>\n\n      {/* Results Count */}\n      <div className=\"flex items-center justify-between\">\n        <p className=\"text-sm text-muted-foreground\">\n          {sortedProducts.length} product{sortedProducts.length !== 1 ? 's' : ''} found\n        </p>\n        <p className=\"text-sm text-muted-foreground\">\n          Showing {Math.min(sortedProducts.length, 20)} of {sortedProducts.length}\n        </p>\n      </div>\n\n      {/* Products Grid */}\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 md:gap-6\">\n        {sortedProducts.map((product) => (\n          <GlassCard key={product.id} className=\"floating-card group hover:shadow-lg transition-all duration-300 cursor-pointer\">\n            <GlassCardHeader className=\"pb-2\">\n              <div className=\"relative\">\n                <img\n                  src={product.image}\n                  alt={product.name}\n                  loading=\"lazy\"\n                  className=\"w-full h-48 object-cover rounded-lg group-hover:scale-105 transition-transform duration-300\"\n                />\n                {product.bestSeller && (\n                  <Badge className=\"absolute top-2 left-2 bg-orange-500 text-white\">\n                    Best Seller\n                  </Badge>\n                )}\n                {product.fastShipping && (\n                  <Badge className=\"absolute top-2 right-2 bg-green-500 text-white\">\n                    Fast Shipping\n                  </Badge>\n                )}\n                {!product.inStock && (\n                  <Badge variant=\"destructive\" className=\"absolute top-2 left-2\">\n                    Out of Stock\n                  </Badge>\n                )}\n              </div>\n                          </GlassCardHeader>\n            \n            <GlassCardContent className=\"space-y-3\">\n              {/* Category and Store */}\n              <div className=\"flex items-center justify-between\">\n                <Badge variant=\"outline\" className=\"text-xs\">\n                  <div className=\"flex items-center gap-1\">\n                    {React.createElement(getCategoryIcon(product.category), { className: \"h-3 w-3\" })}\n                    {categories.find(c => c.value === product.category)?.label}\n                  </div>\n                </Badge>\n                <Badge variant=\"outline\" className={`text-xs ${getStoreBadgeColor(product.store)}`}>\n                  {product.store.charAt(0).toUpperCase() + product.store.slice(1)}\n                </Badge>\n              </div>\n\n              {/* Product Name */}\n              <h3 className=\"font-semibold text-lg line-clamp-2 group-hover:text-primary transition-colors\">\n                {product.name}\n              </h3>\n\n              {/* Description */}\n              <p className=\"text-sm text-muted-foreground line-clamp-3\">\n                {product.description}\n              </p>\n\n              {/* Rating */}\n              <div className=\"flex items-center gap-2\">\n                <div className=\"flex items-center\">\n                  {[...Array(5)].map((_, i) => (\n                    <Star\n                      key={i}\n                      className={`h-4 w-4 ${\n                        i < Math.floor(product.rating)\n                          ? 'text-yellow-400 fill-current'\n                          : 'text-gray-300'\n                      }`}\n                    />\n                  ))}\n                </div>\n                <span className=\"text-sm text-muted-foreground\">\n                  ({product.reviewCount.toLocaleString()})\n                </span>\n              </div>\n\n              {/* Price */}\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-xl font-bold text-primary\">\n                  {product.price}\n                </span>\n                {product.originalPrice && (\n                  <span className=\"text-sm text-muted-foreground line-through\">\n                    {product.originalPrice}\n                  </span>\n                )}\n              </div>\n\n              {/* Action Button */}\n              <Button \n                onClick={() => handleProductClick(product)}\n                className=\"w-full group-hover:bg-primary group-hover:text-white transition-colors\"\n                variant=\"outline\"\n              >\n                <ExternalLink className=\"h-4 w-4 mr-2\" />\n                View on {product.store.charAt(0).toUpperCase() + product.store.slice(1)}\n              </Button>\n            </GlassCardContent>\n          </GlassCard>\n        ))}\n      </div>\n\n      {/* No Results */}\n      {sortedProducts.length === 0 && (\n        <div className=\"text-center py-8\">\n          <div className=\"text-4xl mb-4\">🛍️</div>\n          <p className=\"text-muted-foreground\">No products available at the moment.</p>\n          <p className=\"text-muted-foreground\">Check back later for new rewards and products!</p>\n        </div>\n      )}\n\n      {/* Footer Note */}\n      <div className=\"text-center py-8 border-t border-border\">\n        <p className=\"text-sm text-muted-foreground\">\n          💡 <strong>Affiliate Disclosure:</strong> This page contains affiliate links. \n          We may earn a commission when you make a purchase through these links at no additional cost to you.\n        </p>\n      </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\pages\\Terms.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\services\\api.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\services\\apiService.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'CacheKey' is defined but never used.","line":7,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheKey"},"fix":{"range":[137,154],"text":""},"desc":"Remove unused variable 'CacheKey'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CacheKey' is defined but never used.","line":7,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { supabase } from './supabaseClient';\nimport { \n  generateCacheKey, \n  getCachedData, \n  setCachedData, \n  invalidateCacheForTable,\n  type CacheKey\n} from './cache';\nimport { \n  ExtendedTableName, \n  TableRow, \n  TableInsert, \n  TableUpdate \n} from './types/tables';\n\n// API Response type\nexport interface ApiResponse<T = any> {\n  data: T | null;\n  error: string | null;\n  success: boolean;\n  timestamp: number;\n}\n\nexport interface ApiOptions {\n  cache?: boolean;\n  cacheTTL?: number;\n  retry?: boolean;\n  retryCount?: number;\n  retryDelay?: number;\n  timeout?: number;\n}\n\n// Default options\nconst defaultOptions: Required<ApiOptions> = {\n  cache: true,\n  cacheTTL: 5 * 60 * 1000, // 5 minutes\n  retry: true,\n  retryCount: 3,\n  retryDelay: 1000,\n  timeout: 30000, // 30 seconds\n};\n\n// Retry logic with exponential backoff\nconst retryWithDelay = async <T>(\n  fn: () => Promise<T>,\n  retryCount: number,\n  delay: number\n): Promise<T> => {\n  try {\n    return await fn();\n  } catch (error) {\n    if (retryCount <= 0) throw error;\n    \n    await new Promise(resolve => setTimeout(resolve, delay));\n    return retryWithDelay(fn, retryCount - 1, delay * 2);\n  }\n};\n\n// Timeout wrapper\nconst withTimeout = <T>(\n  promise: Promise<T>,\n  timeout: number\n): Promise<T> => {\n  return Promise.race([\n    promise,\n    new Promise<never>((_, reject) =>\n      setTimeout(() => reject(new Error('Request timeout')), timeout)\n    ),\n  ]);\n};\n\nclass ApiService {\n  private static instance: ApiService;\n  \n  private constructor() {\n    // Private constructor to enforce singleton\n  }\n  \n  static getInstance(): ApiService {\n    if (!ApiService.instance) {\n      ApiService.instance = new ApiService();\n    }\n    return ApiService.instance;\n  }\n\n  async query<T = any, TTable extends ExtendedTableName = any>(\n    table: TTable,\n    query: string = '*',\n    filters: Partial<TableRow<TTable>> = {},\n    options: Partial<ApiOptions> = {}\n  ): Promise<ApiResponse<T>> {\n    const opts = { ...defaultOptions, ...options };\n    const cacheKey = generateCacheKey(String(table), query, filters);\n    \n    // Return cached data if available and valid\n    if (opts.cache) {\n      const cached = getCachedData(cacheKey);\n      if (cached) {\n        return {\n          data: cached as T,\n          error: null,\n          success: true,\n          timestamp: Date.now(),\n        };\n      }\n    }\n\n    try {\n      const executeQuery = async (): Promise<T> => {\n        const { data, error } = await withTimeout(\n          supabase.from(String(table)).select(query).match(filters as any).then(res => ({\n            data: res.data,\n            error: res.error\n          })),\n          opts.timeout\n        );\n\n        if (error) throw error;\n        return data as T;\n      };\n\n      const result = opts.retry\n        ? await retryWithDelay(executeQuery, opts.retryCount, opts.retryDelay)\n        : await executeQuery();\n\n      // Cache the result if caching is enabled\n      if (opts.cache) {\n        setCachedData(cacheKey, result, opts.cacheTTL);\n      }\n\n      return {\n        data: result,\n        error: null,\n        success: true,\n        timestamp: Date.now(),\n      };\n    } catch (error: any) {\n      const errorMessage = error?.message || 'Unknown error occurred';\n      console.error(`API Query Error in ${String(table)}:`, error);\n      \n      return {\n        data: null,\n        error: errorMessage,\n        success: false,\n        timestamp: Date.now(),\n      };\n    }\n  }\n\n  async insert<T = any, TTable extends ExtendedTableName = any>(\n    table: TTable,\n    data: TableInsert<TTable> | TableInsert<TTable>[],\n    options: Partial<ApiOptions> = {}\n  ): Promise<ApiResponse<T>> {\n    const opts = { ...defaultOptions, ...options };\n    \n    try {\n      const executeInsert = async (): Promise<T> => {\n        const query = Array.isArray(data)\n          ? supabase.from(String(table)).insert(data as any[])\n          : supabase.from(String(table)).insert(data as any).select();\n        \n        const { data: result, error } = await withTimeout(\n          query.then((res: any) => ({\n            data: res.data,\n            error: res.error\n          })),\n          opts.timeout\n        );\n\n        if (error) throw error;\n        return result as T;\n      };\n\n      const result = opts.retry\n        ? await retryWithDelay(executeInsert, opts.retryCount, opts.retryDelay)\n        : await executeInsert();\n\n      // Invalidate cache for this table\n      invalidateCacheForTable(String(table));\n\n      return {\n        data: result,\n        error: null,\n        success: true,\n        timestamp: Date.now(),\n      };\n    } catch (error: any) {\n      const errorMessage = error?.message || 'Unknown error occurred';\n      console.error(`API Insert Error in ${String(table)}:`, error);\n      \n      return {\n        data: null,\n        error: errorMessage,\n        success: false,\n        timestamp: Date.now(),\n      };\n    }\n  }\n\n  async update<T = any, TTable extends ExtendedTableName = any>(\n    table: TTable,\n    data: TableUpdate<TTable>,\n    filters: Partial<TableRow<TTable>>,\n    options: Partial<ApiOptions> = {}\n  ): Promise<ApiResponse<T>> {\n    const opts = { ...defaultOptions, ...options };\n    \n    try {\n      const executeUpdate = async (): Promise<T> => {\n        const { data: result, error } = await withTimeout(\n          supabase.from(String(table)).update(data as any).match(filters as any).select()\n            .then((res: any) => ({\n              data: res.data,\n              error: res.error\n            })),\n          opts.timeout\n        );\n\n        if (error) throw error;\n        return result as T;\n      };\n\n      const result = opts.retry\n        ? await retryWithDelay(executeUpdate, opts.retryCount, opts.retryDelay)\n        : await executeUpdate();\n\n      // Invalidate cache for this table\n      invalidateCacheForTable(String(table));\n\n      return {\n        data: result,\n        error: null,\n        success: true,\n        timestamp: Date.now(),\n      };\n    } catch (error: any) {\n      const errorMessage = error?.message || 'Unknown error occurred';\n      console.error(`API Update Error in ${String(table)}:`, error);\n      \n      return {\n        data: null,\n        error: errorMessage,\n        success: false,\n        timestamp: Date.now(),\n      };\n    }\n  }\n\n  async delete<T = any, TTable extends ExtendedTableName = any>(\n    table: TTable,\n    filters: Partial<TableRow<TTable>>,\n    options: Partial<ApiOptions> = {}\n  ): Promise<ApiResponse<T>> {\n    const opts = { ...defaultOptions, ...options };\n    \n    try {\n      const executeDelete = async (): Promise<T> => {\n        const { data, error } = await withTimeout(\n          supabase.from(String(table)).delete().match(filters as any).select()\n            .then((res: any) => ({\n              data: res.data,\n              error: res.error\n            })),\n          opts.timeout\n        );\n\n        if (error) throw error;\n        return data as T;\n      };\n\n      const result = opts.retry\n        ? await retryWithDelay(executeDelete, opts.retryCount, opts.retryDelay)\n        : await executeDelete();\n\n      // Invalidate cache for this table\n      invalidateCacheForTable(String(table));\n\n      return {\n        data: result,\n        error: null,\n        success: true,\n        timestamp: Date.now(),\n      };\n    } catch (error: any) {\n      const errorMessage = error?.message || 'Unknown error occurred';\n      console.error(`API Delete Error in ${String(table)}:`, error);\n      \n      return {\n        data: null,\n        error: errorMessage,\n        success: false,\n        timestamp: Date.now(),\n      };\n    }\n  }\n\n  async rpc<T = any>(\n    functionName: string,\n    params: Record<string, unknown> = {},\n    options: Partial<ApiOptions> = {}\n  ): Promise<ApiResponse<T>> {\n    const opts = { ...defaultOptions, ...options };\n    const cacheKey = generateCacheKey(`rpc_${functionName}`, JSON.stringify(params), {});\n    \n    // Return cached data if available and valid\n    if (opts.cache) {\n      const cached = getCachedData(cacheKey);\n      if (cached) {\n        return {\n          data: cached as T,\n          error: null,\n          success: true,\n          timestamp: Date.now(),\n        };\n      }\n    }\n\n    try {\n      const executeRpc = async (): Promise<{ data: T | null; error: any }> => {\n        const { data, error } = await withTimeout(\n          supabase.rpc(functionName, params).then((res: any) => ({\n            data: res.data,\n            error: res.error\n          })),\n          opts.timeout\n        );\n\n        return { data, error };\n      };\n\n      const { data, error } = opts.retry\n        ? await retryWithDelay(executeRpc, opts.retryCount, opts.retryDelay)\n        : await executeRpc();\n\n      if (error) throw error;\n\n      // Cache the result if caching is enabled\n      if (opts.cache && data) {\n        setCachedData(cacheKey, data, opts.cacheTTL);\n      }\n\n      return {\n        data: data as T,\n        error: null,\n        success: true,\n        timestamp: Date.now(),\n      };\n    } catch (error: any) {\n      const errorMessage = error?.message || 'Unknown error occurred';\n      console.error(`RPC Error in ${functionName}:`, error);\n      \n      return {\n        data: null,\n        error: errorMessage,\n        success: false,\n        timestamp: Date.now(),\n      };\n    }\n  }\n}\n\nexport const apiService = ApiService.getInstance();\nexport default apiService;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\services\\cache.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\services\\enhancedAQICN.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\services\\featureApis.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\services\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\services\\supabaseClient.ts","messages":[{"ruleId":"no-undef","severity":1,"message":"'__TRACK_VARIABLES__' is not defined.","line":9,"column":67,"nodeType":"Identifier","messageId":"undef","endLine":9,"endColumn":86}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createClient } from '@supabase/supabase-js';\nimport { Database } from '@/types/supabase';\nimport { debugLog, debugError } from '@/utils/debugFlags';\nimport { debugTracker } from '@/utils/errorTracker';\n\nconst supabaseUrl = import.meta.env['VITE_SUPABASE_URL'];\nconst supabaseKey = import.meta.env['VITE_SUPABASE_ANON_KEY'];\n\nconst shouldTrack = typeof __TRACK_VARIABLES__ === 'undefined' || __TRACK_VARIABLES__;\n\nif (!supabaseUrl || !supabaseKey) {\n  debugError('Supabase', 'Missing environment variables', { supabaseUrl, supabaseKeyPresent: !!supabaseKey });\n  throw new Error('Missing Supabase environment variables');\n}\n\ndebugLog('Supabase', 'Initializing client', { url: supabaseUrl });\nconsole.log('🔗 [SUPABASE] Initializing client at:', new Date().toISOString());\n\nif (shouldTrack) {\n  debugTracker.trackVariableDeclaration('supabaseClient', 'initializing', 'supabaseClient.ts:init');\n}\n\nexport const supabase = createClient<Database>(supabaseUrl, supabaseKey);\n\ndebugLog('Supabase', 'Client created successfully');\nconsole.log('🔗 [SUPABASE] Client created successfully');\n\nif (shouldTrack) {\n  debugTracker.trackVariableDeclaration('supabaseClient', supabase, 'supabaseClient.ts:created');\n  debugTracker.trackVariableAccess('supabaseClient', 'supabaseClient.ts:export');\n}\n\nexport default supabase;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\services\\types\\tables.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\store\\index.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'loading' is defined but never used.","line":28,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"loading"},"fix":{"range":[608,624],"text":""},"desc":"Remove unused variable 'loading'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":29,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[648,668],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'open' is defined but never used.","line":30,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"open"},"fix":{"range":[698,711],"text":""},"desc":"Remove unused variable 'open'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'user' is defined but never used.","line":34,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"user"},"fix":{"range":[781,797],"text":""},"desc":"Remove unused variable 'user'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'profile' is defined but never used.","line":35,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":35,"endColumn":35,"suggestions":[{"messageId":"removeVar","data":{"varName":"profile"},"fix":{"range":[823,842],"text":""},"desc":"Remove unused variable 'profile'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'aqi' is defined but never used.","line":39,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":37,"suggestions":[{"messageId":"removeVar","data":{"varName":"aqi"},"fix":{"range":[921,939],"text":""},"desc":"Remove unused variable 'aqi'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'location' is defined but never used.","line":40,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":47,"suggestions":[{"messageId":"removeVar","data":{"varName":"location"},"fix":{"range":[973,996],"text":""},"desc":"Remove unused variable 'location'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'reading' is defined but never used.","line":41,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"reading"},"fix":{"range":[1026,1045],"text":""},"desc":"Remove unused variable 'reading'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'key' is defined but never used.","line":44,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":44,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[1091,1103],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'data' is defined but never used.","line":44,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":44,"endColumn":36,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[1102,1113],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'ttl' is defined but never used.","line":44,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":44,"endColumn":50,"suggestions":[{"messageId":"removeVar","data":{"varName":"ttl"},"fix":{"range":[1113,1127],"text":""},"desc":"Remove unused variable 'ttl'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'key' is defined but never used.","line":45,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":45,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[1151,1162],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'key' is defined but never used.","line":46,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":46,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[1194,1206],"text":""},"desc":"Remove unused variable 'key'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { create } from 'zustand';\nimport { devtools, persist } from 'zustand/middleware';\nimport { supabase } from '@/integrations/supabase/client';\nimport { LRUCache } from '@/lib/lru';\n\n// Types\nexport interface AppState {\n  // UI State\n  isLoading: boolean;\n  error: string | null;\n  sidebarOpen: boolean;\n  \n  // User State\n  user: any | null;\n  profile: any | null;\n  \n  // Air Quality State\n  currentAQI: number | null;\n  currentLocation: string | null;\n  lastReading: any | null;\n  \n  // Cache State - Using LRU cache\n  cache: LRUCache;\n}\n\nexport interface AppActions {\n  // UI Actions\n  setLoading: (loading: boolean) => void;\n  setError: (error: string | null) => void;\n  setSidebarOpen: (open: boolean) => void;\n  clearError: () => void;\n  \n  // User Actions\n  setUser: (user: any | null) => void;\n  setProfile: (profile: any | null) => void;\n  logout: () => void;\n  \n  // Air Quality Actions\n  setCurrentAQI: (aqi: number | null) => void;\n  setCurrentLocation: (location: string | null) => void;\n  setLastReading: (reading: any | null) => void;\n  \n  // Cache Actions\n  setCache: (key: string, data: any, ttl?: number) => void;\n  getCache: (key: string) => any | null;\n  clearCache: (key?: string) => void;\n  clearExpiredCache: () => void;\n}\n\nexport type AppStore = AppState & AppActions;\n\n// Initial state\nconst initialState: AppState = {\n  isLoading: false,\n  error: null,\n  sidebarOpen: false,\n  user: null,\n  profile: null,\n  currentAQI: null,\n  currentLocation: null,\n  lastReading: null,\n  cache: new LRUCache(100), // Initialize LRU cache with a size of 100\n};\n\n// Create store\nexport const useAppStore = create<AppStore>()(\n  devtools(\n    persist(\n      (set, get) => ({\n        ...initialState,\n        // Ensure cache is always a proper LRU instance\n        cache: new LRUCache(100),\n        \n        // UI Actions\n        setLoading: (loading) => set({ isLoading: loading }),\n        setError: (error) => set({ error }),\n        setSidebarOpen: (open) => set({ sidebarOpen: open }),\n        clearError: () => set({ error: null }),\n        \n        // User Actions\n        setUser: (user) => set({ user }),\n        setProfile: (profile) => set({ profile }),\n        logout: () => {\n          supabase.auth.signOut();\n          set({\n            user: null,\n            profile: null,\n            currentAQI: null,\n            currentLocation: null,\n            lastReading: null,\n            cache: new LRUCache(100), // Reset cache on logout\n          });\n        },\n        \n        // Air Quality Actions\n        setCurrentAQI: (aqi) => set({ currentAQI: aqi }),\n        setCurrentLocation: (location) => set({ currentLocation: location }),\n        setLastReading: (reading) => set({ lastReading: reading }),\n        \n        // Cache Actions\n        setCache: (key, data, ttl = 5 * 60 * 1000) => {\n          const { cache } = get();\n          cache.set(key, { data, timestamp: Date.now(), ttl });\n        },\n        \n        getCache: (key) => {\n          const { cache } = get();\n          const cached = cache.get(key);\n          \n          if (!cached) return null;\n          \n          const isExpired = Date.now() - cached.timestamp > cached.ttl;\n          if (isExpired) {\n            get().clearCache(key);\n            return null;\n          }\n          \n          return cached.data;\n        },\n        \n        clearCache: (key) => {\n          const { cache } = get();\n          if (key) {\n            cache.delete(key);\n          } else {\n            cache.clear();\n          }\n        },\n        \n        clearExpiredCache: () => {\n          const { cache } = get();\n          cache.clearExpired();\n        },\n      }),\n      {\n        name: 'breath-safe-store',\n        partialize: (state) => ({\n          // Pick only what must survive reloads\n          user: state.user,\n          profile: state.profile,\n          currentLocation: state.currentLocation,\n          // EXCLUDE: cache, lastReading, error, isLoading, etc.\n        }),\n        onRehydrateStorage: () => (state) => {\n          // Reinitialize cache after rehydration since it's not persisted\n          if (state) {\n            state.cache = new LRUCache(100);\n          }\n        },\n      }\n    ),\n    {\n      name: 'breath-safe-store',\n    }\n  )\n);\n\n// Selectors for better performance\nexport const useUser = () => useAppStore((state) => state.user);\nexport const useProfile = () => useAppStore((state) => state.profile);\nexport const useLoading = () => useAppStore((state) => state.isLoading);\nexport const useError = () => useAppStore((state) => state.error);\nexport const useSidebarOpen = () => useAppStore((state) => state.sidebarOpen);\nexport const useCurrentAQI = () => useAppStore((state) => state.currentAQI);\nexport const useCurrentLocation = () => useAppStore((state) => state.currentLocation);\nexport const useLastReading = () => useAppStore((state) => state.lastReading);\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\store\\weatherStore.ts","messages":[{"ruleId":"no-undef","severity":1,"message":"'__TRACK_VARIABLES__' is not defined.","line":5,"column":79,"nodeType":"Identifier","messageId":"undef","endLine":5,"endColumn":98},{"ruleId":"no-unused-vars","severity":1,"message":"'coordinates' is defined but never used.","line":76,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":76,"endColumn":74,"suggestions":[{"messageId":"removeVar","data":{"varName":"coordinates"},"fix":{"range":[1927,1979],"text":""},"desc":"Remove unused variable 'coordinates'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'coordinates' is defined but never used.","line":77,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":77,"endColumn":75,"suggestions":[{"messageId":"removeVar","data":{"varName":"coordinates"},"fix":{"range":[2036,2088],"text":""},"desc":"Remove unused variable 'coordinates'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'data' is defined but never used.","line":80,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":80,"endColumn":37,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[2172,2189],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'data' is defined but never used.","line":81,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":81,"endColumn":41,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[2221,2241],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'loading' is defined but never used.","line":82,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":82,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"loading"},"fix":{"range":[2268,2284],"text":""},"desc":"Remove unused variable 'loading'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":83,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":83,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[2309,2329],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'until' is defined but never used.","line":86,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":86,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"until"},"fix":{"range":[2384,2397],"text":""},"desc":"Remove unused variable 'until'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'coordinates' is defined but never used.","line":90,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":90,"endColumn":72,"suggestions":[{"messageId":"removeVar","data":{"varName":"coordinates"},"fix":{"range":[2481,2533],"text":""},"desc":"Remove unused variable 'coordinates'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { create } from 'zustand';\r\nimport { devtools } from 'zustand/middleware';\r\nimport { debugTracker } from '@/utils/errorTracker';\r\n\r\nconst shouldTrackWeatherState = typeof __TRACK_VARIABLES__ === 'undefined' || __TRACK_VARIABLES__;\r\n\r\nconst trackWeatherState = (action: string, payload: unknown) => {\r\n  console.log(`🏪 [STORE] Weather state changing via ${action}:`, payload);\r\n  if (shouldTrackWeatherState) {\r\n    debugTracker.trackVariableDeclaration(\r\n      'weatherState',\r\n      { action, payload, timestamp: Date.now() },\r\n      'weatherStore.ts'\r\n    );\r\n  }\r\n};\r\n\r\n// Weather data types\r\nexport interface WeatherData {\r\n  temperature: number;\r\n  humidity: number;\r\n  windSpeed: number;\r\n  windDirection: number;\r\n  windGust?: number;\r\n  airPressure?: number;\r\n  rainProbability?: number;\r\n  uvIndex?: number;\r\n  visibility?: number;\r\n  weatherCondition: string;\r\n  feelsLikeTemperature?: number;\r\n  sunriseTime?: string;\r\n  sunsetTime?: string;\r\n  timestamp: string;\r\n  dataSource: string;\r\n}\r\n\r\nexport interface ForecastData {\r\n  date: string;\r\n  temperature: {\r\n    min: number;\r\n    max: number;\r\n    avg: number;\r\n  };\r\n  humidity: number;\r\n  windSpeed: number;\r\n  windDirection: number;\r\n  rainProbability: number;\r\n  weatherCondition: string;\r\n  uvIndex?: number;\r\n}\r\n\r\nexport interface WeatherStoreState {\r\n  // Weather data\r\n  weatherData: WeatherData | null;\r\n  forecastData: ForecastData[];\r\n  \r\n  // Loading and error states\r\n  isLoading: boolean;\r\n  error: string | null;\r\n  \r\n  // Rate limiting and caching\r\n  lastFetchTime: number | null;\r\n  rateLimitUntil: number | null;\r\n  isRateLimited: boolean;\r\n  \r\n  // Coordinates\r\n  currentCoordinates: { latitude: number; longitude: number } | null;\r\n  \r\n  // Cache keys for different data types\r\n  weatherCacheKey: string | null;\r\n  forecastCacheKey: string | null;\r\n}\r\n\r\nexport interface WeatherStoreActions {\r\n  // Data fetching\r\n  fetchWeatherData: (coordinates: { latitude: number; longitude: number }) => Promise<WeatherData | null>;\r\n  fetchForecastData: (coordinates: { latitude: number; longitude: number }) => Promise<ForecastData[] | null>;\r\n  \r\n  // State management\r\n  setWeatherData: (data: WeatherData) => void;\r\n  setForecastData: (data: ForecastData[]) => void;\r\n  setLoading: (loading: boolean) => void;\r\n  setError: (error: string | null) => void;\r\n  \r\n  // Rate limiting\r\n  setRateLimited: (until: number) => void;\r\n  clearRateLimit: () => void;\r\n  \r\n  // Coordinates\r\n  setCoordinates: (coordinates: { latitude: number; longitude: number }) => void;\r\n  \r\n  // Cache management\r\n  clearCache: () => void;\r\n  getCachedWeather: () => WeatherData | null;\r\n  getCachedForecast: () => ForecastData[] | null;\r\n}\r\n\r\nexport type WeatherStore = WeatherStoreState & WeatherStoreActions;\r\n\r\n// Create the weather store\r\nexport const useWeatherStore = create<WeatherStore>()(\r\n  devtools(\r\n    (set, get) => ({\r\n      // Initial state\r\n      weatherData: null,\r\n      forecastData: [],\r\n      isLoading: false,\r\n      error: null,\r\n      lastFetchTime: null,\r\n      rateLimitUntil: null,\r\n      isRateLimited: false,\r\n      currentCoordinates: null,\r\n      weatherCacheKey: null,\r\n      forecastCacheKey: null,\r\n\r\n      // Set weather data\r\n      setWeatherData: (data) => {\r\n        trackWeatherState('setWeatherData', data);\r\n        set({ \r\n          weatherData: data,\r\n          lastFetchTime: Date.now(),\r\n          error: null,\r\n          isLoading: false\r\n        });\r\n      },\r\n\r\n      // Set forecast data\r\n      setForecastData: (data) => {\r\n        trackWeatherState('setForecastData', data);\r\n        set({ \r\n          forecastData: data,\r\n          lastFetchTime: Date.now(),\r\n          error: null,\r\n          isLoading: false\r\n        });\r\n      },\r\n\r\n      // Set loading state\r\n      setLoading: (loading) => {\r\n        trackWeatherState('setLoading', loading);\r\n        set({ isLoading: loading });\r\n      },\r\n\r\n      // Set error state\r\n      setError: (error) => {\r\n        trackWeatherState('setError', error);\r\n        set({ error, isLoading: false });\r\n      },\r\n\r\n      // Set rate limited state\r\n      setRateLimited: (until) => {\r\n        set({ \r\n          rateLimitUntil: until,\r\n          isRateLimited: true\r\n        });\r\n\r\n        trackWeatherState('setRateLimited', until);\r\n        \r\n        // Auto-clear rate limit after the specified time\r\n        setTimeout(() => {\r\n          get().clearRateLimit();\r\n        }, until - Date.now());\r\n      },\r\n\r\n      // Clear rate limit\r\n      clearRateLimit: () => {\r\n        trackWeatherState('clearRateLimit', null);\r\n        set({ \r\n          rateLimitUntil: null,\r\n          isRateLimited: false\r\n        });\r\n      },\r\n\r\n      // Set coordinates\r\n      setCoordinates: (coordinates) => {\r\n        const current = get().currentCoordinates;\r\n        const changed = !current || \r\n          current.latitude !== coordinates.latitude || \r\n          current.longitude !== coordinates.longitude;\r\n        \r\n        if (changed) {\r\n          trackWeatherState('setCoordinates', coordinates);\r\n          set({ \r\n            currentCoordinates: coordinates,\r\n            weatherCacheKey: `weather_${coordinates.latitude}_${coordinates.longitude}`,\r\n            forecastCacheKey: `forecast_${coordinates.latitude}_${coordinates.longitude}`\r\n          });\r\n        }\r\n      },\r\n\r\n      // Clear cache\r\n      clearCache: () => {\r\n        trackWeatherState('clearCache', null);\r\n        set({ \r\n          weatherData: null,\r\n          forecastData: [],\r\n          lastFetchTime: null,\r\n          error: null\r\n        });\r\n      },\r\n\r\n      // Get cached weather data\r\n      getCachedWeather: () => {\r\n        const state = get();\r\n        if (!state.weatherData || !state.lastFetchTime) return null;\r\n        \r\n        // Check if data is still fresh (within 5 minutes)\r\n        const isFresh = Date.now() - state.lastFetchTime < 5 * 60 * 1000;\r\n        return isFresh ? state.weatherData : null;\r\n      },\r\n\r\n      // Get cached forecast data\r\n      getCachedForecast: () => {\r\n        const state = get();\r\n        if (!state.forecastData || !state.lastFetchTime) return null;\r\n        \r\n        // Check if data is still fresh (within 5 minutes)\r\n        const isFresh = Date.now() - state.lastFetchTime < 5 * 60 * 1000;\r\n        return isFresh ? state.forecastData : null;\r\n      },\r\n\r\n      // Fetch weather data with rate limiting and caching\r\n      fetchWeatherData: async (coordinates) => {\r\n        const state = get();\r\n        \r\n        // Set coordinates\r\n        get().setCoordinates(coordinates);\r\n        \r\n        // Check if we're rate limited\r\n        if (state.isRateLimited && state.rateLimitUntil && Date.now() < state.rateLimitUntil) {\r\n          console.log('🌤️ [WeatherStore] Rate limited, using cached weather data');\r\n          return state.getCachedWeather();\r\n        }\r\n        \r\n        // Check if we have recent cached data (within 5 minutes)\r\n        const cachedWeather = state.getCachedWeather();\r\n        if (cachedWeather) {\r\n          console.log('🌤️ [WeatherStore] Using cached weather data (fresh)');\r\n          return cachedWeather;\r\n        }\r\n        \r\n        // Check if we have any cached data (within 15 minutes)\r\n        if (state.weatherData && state.lastFetchTime && Date.now() - state.lastFetchTime < 15 * 60 * 1000) {\r\n          console.log('🌤️ [WeatherStore] Using cached weather data (within 15 minutes)');\r\n          return state.weatherData;\r\n        }\r\n        \r\n        // Set loading state\r\n        trackWeatherState('setLoading', { isLoading: true, error: null });\r\n        set({ isLoading: true, error: null });\r\n        \r\n        try {\r\n          console.log('🌤️ [WeatherStore] Fetching fresh weather data for coordinates:', coordinates);\r\n          \r\n          // Fetch weather data from OpenWeatherMap\r\n          const apiKey = import.meta.env['VITE_OPENWEATHERMAP_API_KEY'];\r\n          if (!apiKey) {\r\n            throw new Error('OpenWeatherMap API key not configured');\r\n          }\r\n\r\n          const response = await fetch(\r\n            `https://api.openweathermap.org/data/2.5/weather?lat=${coordinates.latitude}&lon=${coordinates.longitude}&appid=${apiKey}&units=metric`\r\n          );\r\n\r\n          if (!response.ok) {\r\n            if (response.status === 429) {\r\n              // Rate limited - set rate limit state\r\n              const retryAfter = response.headers.get('Retry-After');\r\n              const retryDelay = retryAfter ? parseInt(retryAfter) * 1000 : 60000; // Default to 1 minute\r\n              get().setRateLimited(Date.now() + retryDelay);\r\n              \r\n              console.log('🌤️ [WeatherStore] Rate limited by API, will retry after:', retryDelay / 1000, 'seconds');\r\n              return state.getCachedWeather(); // Return cached data if available\r\n            }\r\n            throw new Error(`Weather API error: ${response.status}`);\r\n          }\r\n\r\n          const data = await response.json();\r\n          \r\n          const weatherData: WeatherData = {\r\n            temperature: data.main.temp,\r\n            humidity: data.main.humidity,\r\n            windSpeed: data.wind.speed * 3.6, // Convert m/s to km/h\r\n            windDirection: data.wind.deg,\r\n            windGust: data.wind.gust ? data.wind.gust * 3.6 : undefined,\r\n            airPressure: data.main.pressure,\r\n            rainProbability: data.rain ? data.rain['1h'] : undefined,\r\n            uvIndex: undefined, // OpenWeatherMap doesn't provide UV index in basic plan\r\n            visibility: data.visibility / 1000, // Convert m to km\r\n            weatherCondition: data.weather[0].main,\r\n            feelsLikeTemperature: data.main.feels_like,\r\n            sunriseTime: new Date(data.sys.sunrise * 1000).toLocaleTimeString('en-US', { \r\n              hour: '2-digit', \r\n              minute: '2-digit',\r\n              hour12: false \r\n            }),\r\n            sunsetTime: new Date(data.sys.sunset * 1000).toLocaleTimeString('en-US', { \r\n              hour: '2-digit', \r\n              minute: '2-digit',\r\n              hour12: false \r\n            }),\r\n            timestamp: new Date().toISOString(),\r\n            dataSource: 'OpenWeatherMap API'\r\n          };\r\n\r\n          // Update store with new data\r\n          get().setWeatherData(weatherData);\r\n          \r\n          console.log('🌤️ [WeatherStore] Successfully fetched weather data');\r\n          return weatherData;\r\n          \r\n        } catch (error: any) {\r\n          const errorMessage = error.message || 'Failed to fetch weather data';\r\n          console.error('🌤️ [WeatherStore] Error fetching weather data:', errorMessage);\r\n          \r\n          get().setError(errorMessage);\r\n          \r\n          // Return cached data if available\r\n          return state.getCachedWeather();\r\n        }\r\n      },\r\n\r\n      // Fetch forecast data with rate limiting and caching\r\n      fetchForecastData: async (coordinates) => {\r\n        const state = get();\r\n        \r\n        // Set coordinates\r\n        get().setCoordinates(coordinates);\r\n        \r\n        // Check if we're rate limited\r\n        if (state.isRateLimited && state.rateLimitUntil && Date.now() < state.rateLimitUntil) {\r\n          console.log('🌤️ [WeatherStore] Rate limited, using cached forecast data');\r\n          return state.getCachedForecast();\r\n        }\r\n        \r\n        // Check if we have recent cached data (within 5 minutes)\r\n        const cachedForecast = state.getCachedForecast();\r\n        if (cachedForecast) {\r\n          console.log('🌤️ [WeatherStore] Using cached forecast data (fresh)');\r\n          return cachedForecast;\r\n        }\r\n        \r\n        // Check if we have any cached data (within 15 minutes)\r\n        if (state.forecastData && state.lastFetchTime && Date.now() - state.lastFetchTime < 15 * 60 * 1000) {\r\n          console.log('🌤️ [WeatherStore] Using cached forecast data (within 15 minutes)');\r\n          return state.forecastData;\r\n        }\r\n        \r\n        try {\r\n          console.log('🌤️ [WeatherStore] Fetching fresh forecast data for coordinates:', coordinates);\r\n          \r\n          // Fetch forecast from Open-Meteo (free, no rate limiting)\r\n          const response = await fetch(\r\n            `https://api.open-meteo.com/v1/forecast?latitude=${coordinates.latitude}&longitude=${coordinates.longitude}&daily=temperature_2m_max,temperature_2m_min,temperature_2m_mean,precipitation_probability_max,wind_speed_10m_max,wind_direction_10m_dominant&timezone=auto`\r\n          );\r\n\r\n          if (!response.ok) {\r\n            throw new Error(`Forecast API error: ${response.status}`);\r\n          }\r\n\r\n          const data = await response.json();\r\n          \r\n          const forecastData: ForecastData[] = data.daily.time.map((date: string, index: number) => ({\r\n            date,\r\n            temperature: {\r\n              min: data.daily.temperature_2m_min[index],\r\n              max: data.daily.temperature_2m_max[index],\r\n              avg: data.daily.temperature_2m_mean[index]\r\n            },\r\n            humidity: null, // Open-Meteo doesn't provide humidity in daily forecast\r\n            windSpeed: data.daily.wind_speed_10m_max[index],\r\n            windDirection: data.daily.wind_direction_10m_dominant[index],\r\n            rainProbability: data.daily.precipitation_probability_max[index],\r\n            weatherCondition: null, // Open-Meteo doesn't provide weather conditions\r\n            uvIndex: undefined\r\n          }));\r\n\r\n          // Update store with new data\r\n          get().setForecastData(forecastData);\r\n          \r\n          console.log('🌤️ [WeatherStore] Successfully fetched forecast data');\r\n          return forecastData;\r\n          \r\n        } catch (error: any) {\r\n          const errorMessage = error.message || 'Failed to fetch forecast data';\r\n          console.error('🌤️ [WeatherStore] Error fetching forecast data:', errorMessage);\r\n          \r\n          // Return cached data if available\r\n          return state.getCachedForecast();\r\n        }\r\n      }\r\n    }),\r\n    {\r\n      name: 'breath-safe-weather-store',\r\n    }\r\n  )\r\n);\r\n\r\n// Selectors for better performance\r\nexport const useWeatherData = () => useWeatherStore((state) => state.weatherData);\r\nexport const useForecastData = () => useWeatherStore((state) => state.forecastData);\r\nexport const useWeatherLoading = () => useWeatherStore((state) => state.isLoading);\r\nexport const useWeatherError = () => useWeatherStore((state) => state.error);\r\nexport const useWeatherCoordinates = () => useWeatherStore((state) => state.currentCoordinates);\r\nexport const useWeatherRateLimited = () => useWeatherStore((state) => state.isRateLimited);\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\types\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\types\\supabase.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":109,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":109,"endColumn":9,"suggestions":[{"messageId":"removeVar","data":{"varName":"_"},"fix":{"range":[2681,2682],"text":""},"desc":"Remove unused variable '_'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":112,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":112,"endColumn":9,"suggestions":[{"messageId":"removeVar","data":{"varName":"_"},"fix":{"range":[2730,2731],"text":""},"desc":"Remove unused variable '_'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":115,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":115,"endColumn":9,"suggestions":[{"messageId":"removeVar","data":{"varName":"_"},"fix":{"range":[2775,2776],"text":""},"desc":"Remove unused variable '_'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":118,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":118,"endColumn":9,"suggestions":[{"messageId":"removeVar","data":{"varName":"_"},"fix":{"range":[2829,2830],"text":""},"desc":"Remove unused variable '_'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export type Json =\n  | string\n  | number\n  | boolean\n  | null\n  | { [key: string]: Json | undefined }\n  | Json[]\n\nexport interface Database {\n  public: {\n    Tables: {\n      affiliate_products: {\n        Row: {\n          affiliate_url: string\n          coverage_area: string\n          created_at: string\n          description: string\n          id: string\n          image_url: string\n          is_active: boolean\n          name: string\n          price_range: string\n          rating: number\n          retailer: string\n        }\n        Insert: {\n          affiliate_url: string\n          coverage_area: string\n          created_at?: string\n          description: string\n          id?: string\n          image_url: string\n          is_active?: boolean\n          name: string\n          price_range: string\n          rating: number\n          retailer: string\n        }\n        Update: {\n          affiliate_url?: string\n          coverage_area?: string\n          created_at?: string\n          description?: string\n          id?: string\n          image_url?: string\n          is_active?: boolean\n          name?: string\n          price_range?: string\n          rating?: number\n          retailer?: string\n        }\n      }\n      air_quality_readings: {\n        Row: {\n          aqi: number\n          co: number | null\n          created_at: string\n          id: string\n          latitude: number\n          location_name: string\n          longitude: number\n          no2: number | null\n          o3: number | null\n          pm10: number | null\n          pm25: number | null\n          points_awarded: number\n          so2: number | null\n          timestamp: string\n          user_id: string\n        }\n        Insert: {\n          aqi: number\n          co?: number | null\n          created_at?: string\n          id?: string\n          latitude: number\n          location_name: string\n          longitude: number\n          no2?: number | null\n          o3?: number | null\n          pm10?: number | null\n          pm25?: number | null\n          points_awarded: number\n          so2?: number | null\n          timestamp: string\n          user_id: string\n        }\n        Update: {\n          aqi?: number\n          co?: number | null\n          created_at?: string\n          id?: string\n          latitude?: number\n          location_name?: string\n          longitude?: number\n          no2?: number | null\n          o3?: number | null\n          pm10?: number | null\n          pm25?: number | null\n          points_awarded?: number\n          so2?: number | null\n          timestamp?: string\n          user_id?: string\n        }\n      }\n      // Add other tables as needed\n    }\n    Views: {\n      [_ in never]: never\n    }\n    Functions: {\n      [_ in never]: never\n    }\n    Enums: {\n      [_ in never]: never\n    }\n    CompositeTypes: {\n      [_ in never]: never\n    }\n  }\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\utils\\dataProcessing.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'chunk' is defined but never used.","line":10,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"chunk"},"fix":{"range":[342,352],"text":""},"desc":"Remove unused variable 'chunk'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'items' is defined but never used.","line":36,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"items"},"fix":{"range":[1072,1082],"text":""},"desc":"Remove unused variable 'items'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'item' is defined but never used.","line":38,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":38,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"item"},"fix":{"range":[1134,1141],"text":""},"desc":"Remove unused variable 'item'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'value' is defined but never used.","line":39,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":43,"suggestions":[{"messageId":"removeVar","data":{"varName":"value"},"fix":{"range":[1193,1201],"text":""},"desc":"Remove unused variable 'value'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":39,"column":63,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":73,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[1221,1231],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'args' is defined but never used.","line":90,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":90,"endColumn":43,"suggestions":[{"messageId":"removeVar","data":{"varName":"args"},"fix":{"range":[2478,2482],"text":""},"desc":"Remove unused variable 'args'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'args' is defined but never used.","line":95,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":95,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"args"},"fix":{"range":[2613,2617],"text":""},"desc":"Remove unused variable 'args'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'args' is defined but never used.","line":139,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":139,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"args"},"fix":{"range":[3722,3726],"text":""},"desc":"Remove unused variable 'args'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'args' is defined but never used.","line":143,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":143,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"args"},"fix":{"range":[3798,3802],"text":""},"desc":"Remove unused variable 'args'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'args' is defined but never used.","line":171,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":171,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"args"},"fix":{"range":[4382,4386],"text":""},"desc":"Remove unused variable 'args'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'args' is defined but never used.","line":174,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":174,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"args"},"fix":{"range":[4438,4442],"text":""},"desc":"Remove unused variable 'args'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Processes large arrays in chunks to avoid blocking the main thread\n * @param array The array to process\n * @param processFn Function to process each chunk\n * @param chunkSize Number of items per chunk\n * @param delayMs Delay between chunks to avoid blocking\n */\nexport async function processInChunks<T, R>(\n  array: T[],\n  processFn: (chunk: T[]) => Promise<R[]> | R[],\n  chunkSize: number = 100,\n  delayMs: number = 0\n): Promise<R[]> {\n  const results: R[] = [];\n  \n  for (let i = 0; i < array.length; i += chunkSize) {\n    const chunk = array.slice(i, i + chunkSize);\n    const chunkResults = await processFn(chunk);\n    results.push(...chunkResults);\n    \n    // Allow the event loop to breathe between chunks\n    if (delayMs > 0) {\n      await new Promise(resolve => setTimeout(resolve, delayMs));\n    }\n  }\n  \n  return results;\n}\n\n/**\n * Creates a batched version of a function that processes arrays\n * @param processFn Function to batch\n * @param waitMs Time to wait before processing the batch\n */\nexport function createBatchedProcessor<T, R>(\n  processFn: (items: T[]) => Promise<R[]> | R[],\n  waitMs: number = 100\n): (item: T) => Promise<R> {\n  let queue: { item: T; resolve: (value: R) => void; reject: (error: any) => void }[] = [];\n  let timeout: NodeJS.Timeout | null = null;\n  \n  const processBatch = async () => {\n    if (timeout) {\n      clearTimeout(timeout);\n      timeout = null;\n    }\n    \n    if (queue.length === 0) return;\n    \n    const currentBatch = [...queue];\n    queue = [];\n    \n    try {\n      const items = currentBatch.map(entry => entry.item);\n      const results = await processFn(items);\n      \n      currentBatch.forEach((entry, index) => {\n        if (index < results.length) {\n          entry.resolve(results[index]!);\n        } else {\n          entry.reject(new Error('Batched processor received fewer results than expected'));\n        }\n      });\n    } catch (error) {\n      currentBatch.forEach(entry => {\n        entry.reject(error);\n      });\n    }\n  };\n  \n  return (item: T): Promise<R> => {\n    return new Promise((resolve, reject) => {\n      queue.push({ item, resolve, reject });\n      \n      if (!timeout) {\n        timeout = setTimeout(processBatch, waitMs);\n      }\n      \n      // Process immediately if batch size is reached\n      if (queue.length >= 10) {\n        processBatch();\n      }\n    });\n  };\n}\n\n/**\n * Memoizes a function with size and time-based cache invalidation\n */\nexport function memoize<T extends (...args: any[]) => any>(\n  fn: T,\n  options: {\n    maxSize?: number;\n    ttl?: number; // Time to live in milliseconds\n    cacheKey?: (...args: Parameters<T>) => string;\n  } = {}\n): T {\n  const cache = new Map<string, { value: ReturnType<T>; timestamp: number }>();\n  const { maxSize = 100, ttl = 5 * 60 * 1000, cacheKey = JSON.stringify } = options;\n  \n  return ((...args: Parameters<T>): ReturnType<T> => {\n    const key = cacheKey(args);\n    const now = Date.now();\n    \n    // Check cache\n    if (cache.has(key)) {\n      const entry = cache.get(key)!;\n      \n      // Check if entry is still valid\n      if (!ttl || now - entry.timestamp < ttl) {\n        return entry.value;\n      }\n      \n      // Remove expired entry\n      cache.delete(key);\n    }\n    \n    // Clean up if cache is full\n    if (cache.size >= maxSize) {\n      const oldestKey = cache.keys().next().value;\n      if (oldestKey) {\n        cache.delete(oldestKey);\n      }\n    }\n    \n    // Call the original function\n    const result = fn(...args);\n    \n    // Cache the result\n    cache.set(key, { value: result, timestamp: now });\n    \n    return result;\n  }) as T;\n}\n\n/**\n * Debounces a function to limit how often it can be called\n */\nexport function debounce<T extends (...args: any[]) => any>(\n  func: T,\n  wait: number,\n  immediate = false\n): (...args: Parameters<T>) => void {\n  let timeout: NodeJS.Timeout | null = null;\n  \n  return function (this: unknown, ...args: Parameters<T>) {\n    const later = () => {\n      timeout = null;\n      if (!immediate) {\n        func.apply(this, args);\n      }\n    };\n    \n    const callNow = immediate && !timeout;\n    \n    if (timeout) {\n      clearTimeout(timeout);\n    }\n    \n    timeout = setTimeout(later, wait);\n    \n    if (callNow) {\n      func.apply(this, args);\n    }\n  };\n}\n\n/**\n * Throttles a function to limit how often it can be called\n */\nexport function throttle<T extends (...args: any[]) => any>(\n  func: T,\n  limit: number\n): (...args: Parameters<T>) => void {\n  let inThrottle = false;\n  \n  return function (this: unknown, ...args: Parameters<T>) {\n    if (!inThrottle) {\n      func.apply(this, args);\n      inThrottle = true;\n      \n      setTimeout(() => {\n        inThrottle = false;\n      }, limit);\n    }\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\utils\\debugFlags.ts","messages":[{"ruleId":"no-undef","severity":1,"message":"'__DEBUG_BUILD__' is not defined.","line":2,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":2,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export const isDebugBuild = typeof __DEBUG_BUILD__ !== 'undefined'\n  ? __DEBUG_BUILD__\n  : import.meta.env.MODE === 'debug';\n\nexport function debugLog(namespace: string, message: string, ...context: unknown[]) {\n  if (isDebugBuild) {\n    console.log(`🛠️ [${namespace}] ${message}`, ...context);\n  }\n}\n\nexport function debugWarn(namespace: string, message: string, ...context: unknown[]) {\n  if (isDebugBuild) {\n    console.warn(`⚠️ [${namespace}] ${message}`, ...context);\n  }\n}\n\nexport function debugError(namespace: string, message: string, ...context: unknown[]) {\n  if (isDebugBuild) {\n    console.error(`❌ [${namespace}] ${message}`, ...context);\n  }\n}\n\nexport function debugTrace(namespace: string, message: string) {\n  if (isDebugBuild) {\n    console.trace(`🧭 [${namespace}] ${message}`);\n  }\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\utils\\errorTracker.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\utils\\memory.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":113,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":113,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":113,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":113,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Re-export all memory-related utilities\nexport * from './memoryUtils';\nexport * from './memoryProfiler';\nexport * from './renderOptimization';\n\n// Export types\nexport type { MemorySnapshot, MemoryProfile } from './memoryProfiler';\n\n// Initialize memory debugging in development\nif (process.env.NODE_ENV === 'development') {\n  // Enable memory debugging tools\n  if (typeof window !== 'undefined') {\n    // Add memory debugging helpers to window\n    (window as any).__MEMORY_DEBUG__ = {\n      // Force garbage collection (if available)\n      gc: () => {\n        if ((window as any).gc) {\n          (window as any).gc();\n          console.log('Garbage collection forced');\n          return true;\n        }\n        console.warn('Garbage collection not available. Run Chrome with --js-flags=\"--expose-gc\"');\n        return false;\n      },\n      \n      // Take a heap snapshot (Chrome DevTools)\n      takeSnapshot: (label = 'Heap Snapshot') => {\n        if ((window as any).chrome?.devtools?.inspectedWindow) {\n          console.log(`Taking heap snapshot: ${label}`);\n          (window as any).chrome.devtools.inspectedWindow.eval(\n            `console.profile(\"${label}\"); console.profileEnd(\"${label}\")`,\n            () => console.log('Heap snapshot captured in Chrome DevTools')\n          );\n          return true;\n        }\n        console.warn('Heap snapshot not available in this environment');\n        return false;\n      },\n      \n      // Get memory info\n      getMemoryInfo: () => {\n        if ('memory' in performance) {\n          const mem = (performance as any).memory;\n          if (mem) {\n            return {\n              usedJSHeapSize: mem.usedJSHeapSize,\n              totalJSHeapSize: mem.totalJSHeapSize,\n              jsHeapSizeLimit: mem.jsHeapSizeLimit,\n              usedMB: (mem.usedJSHeapSize / 1024 / 1024).toFixed(2) + ' MB',\n              totalMB: (mem.totalJSHeapSize / 1024 / 1024).toFixed(2) + ' MB',\n              limitMB: (mem.jsHeapSizeLimit / 1024 / 1024).toFixed(2) + ' MB',\n              usagePercent: ((mem.usedJSHeapSize / mem.jsHeapSizeLimit) * 100).toFixed(2) + '%',\n            };\n          }\n        }\n        return { error: 'Memory API not available' };\n      },\n      \n      // Check for potential memory leaks\n      checkForLeaks: () => {\n        const leaks: string[] = [];\n        \n        // Check for detached DOM elements\n        const detached = [];\n        const walker = document.createTreeWalker(\n          document,\n          NodeFilter.SHOW_ELEMENT,\n          null,\n          false\n        );\n        \n        const nodes: Element[] = [];\n        let node: Node | null;\n        \n        while ((node = walker.nextNode())) {\n          if (node instanceof Element) {\n            nodes.push(node);\n          }\n        }\n        \n        for (const node of nodes) {\n          if (!document.contains(node)) {\n            detached.push(node);\n          }\n        }\n        \n        if (detached.length > 0) {\n          leaks.push(`Found ${detached.length} potentially detached DOM elements`);\n        }\n        \n        // Check for excessive event listeners\n        let listenerCount = 0;\n        const elements = document.getElementsByTagName('*');\n        for (let i = 0; i < elements.length; i++) {\n          const elem = elements[i];\n          if ((elem as any).__events) {\n            listenerCount += Object.keys((elem as any).__events).length;\n          }\n        }\n        \n        if (listenerCount > 1000) {\n          leaks.push(`Found ${listenerCount} event listeners (may indicate a leak)`);\n        }\n        \n        // Check for large objects in global scope\n        const globalProps = Object.getOwnPropertyNames(window);\n        const largeObjects = globalProps\n          .filter(prop => {\n            try {\n              const value = (window as any)[prop];\n              return value && typeof value === 'object' && \n                Object.keys(value).length > 100;\n            } catch (e) {\n              return false;\n            }\n          })\n          .map(prop => ({\n            name: prop,\n            size: JSON.stringify((window as any)[prop])?.length || 0\n          }))\n          .sort((a, b) => b.size - a.size)\n          .slice(0, 5);\n        \n        if (largeObjects.length > 0) {\n          leaks.push('Large global objects:', ...largeObjects.map(\n            obj => `- ${obj.name}: ${(obj.size / 1024).toFixed(2)} KB`\n          ));\n        }\n        \n        if (leaks.length === 0) {\n          leaks.push('No obvious memory leaks detected');\n        }\n        \n        console.log('Memory Leak Check:');\n        leaks.forEach(leak => console.log(`- ${leak}`));\n        \n        return leaks;\n      },\n    };\n    \n    console.log(\n      '%cMemory debugging tools are available at window.__MEMORY_DEBUG__',\n      'color: #4CAF50; font-weight: bold;'\n    );\n  }\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\utils\\memoryMonitor.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'usage' is defined but never used.","line":13,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":47,"suggestions":[{"messageId":"removeVar","data":{"varName":"usage"},"fix":{"range":[296,314],"text":""},"desc":"Remove unused variable 'usage'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'usage' is defined but never used.","line":89,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":89,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"usage"},"fix":{"range":[2453,2471],"text":""},"desc":"Remove unused variable 'usage'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"interface MemoryUsage {\n  used: number;\n  total: number;\n  limit: number;\n  percentUsed: number;\n  timestamp: number;\n}\n\nexport class MemoryMonitor {\n  private static instance: MemoryMonitor;\n  private highWaterMark = 0;\n  private checkInterval: number | null = null;\n  private listeners: Array<(usage: MemoryUsage) => void> = [];\n  private history: MemoryUsage[] = [];\n  private readonly MAX_HISTORY = 100; // Keep last 100 readings\n\n  private constructor() {\n    this.startMonitoring();\n  }\n\n  static getInstance(): MemoryMonitor {\n    if (!MemoryMonitor.instance) {\n      MemoryMonitor.instance = new MemoryMonitor();\n    }\n    return MemoryMonitor.instance;\n  }\n\n  private getMemoryUsage(): MemoryUsage | null {\n    if (typeof window === 'undefined') return null; // Skip in SSR\n    \n    const performance = window.performance as any;\n    if (!performance?.memory) return null;\n\n    const { usedJSHeapSize, totalJSHeapSize, jsHeapSizeLimit } = performance.memory;\n    \n    return {\n      used: usedJSHeapSize,\n      total: totalJSHeapSize,\n      limit: jsHeapSizeLimit,\n      percentUsed: (usedJSHeapSize / jsHeapSizeLimit) * 100,\n      timestamp: Date.now()\n    };\n  }\n\n  private checkMemory() {\n    const memory = this.getMemoryUsage();\n    if (!memory) return;\n\n    // Update high water mark\n    this.highWaterMark = Math.max(this.highWaterMark, memory.used);\n    \n    // Add to history\n    this.history.push(memory);\n    if (this.history.length > this.MAX_HISTORY) {\n      this.history.shift();\n    }\n\n    // Notify listeners\n    this.notifyListeners(memory);\n\n    // Log warning if memory usage is high\n    if (memory.percentUsed > 80) {\n      console.warn(`High memory usage: ${this.formatMemory(memory.used)} / ${this.formatMemory(memory.total)} (${memory.percentUsed.toFixed(1)}%)`);\n      \n      // Trigger garbage collection if available\n      if (window.gc) {\n        console.log('Triggering garbage collection...');\n        window.gc();\n      }\n    }\n  }\n\n  private notifyListeners(memory: MemoryUsage) {\n    for (const listener of this.listeners) {\n      try {\n        listener(memory);\n      } catch (error) {\n        console.error('Error in memory monitor listener:', error);\n      }\n    }\n  }\n\n  formatMemory(bytes: number): string {\n    if (bytes < 1024) return `${bytes} B`;\n    if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(2)} KB`;\n    return `${(bytes / (1024 * 1024)).toFixed(2)} MB`;\n  }\n\n  addListener(listener: (usage: MemoryUsage) => void): () => void {\n    this.listeners.push(listener);\n    \n    // Send current memory stats to new listener\n    const memory = this.getMemoryUsage();\n    if (memory) {\n      setTimeout(() => listener(memory), 0);\n    }\n    \n    // Return unsubscribe function\n    return () => {\n      this.listeners = this.listeners.filter(l => l !== listener);\n    };\n  }\n\n  startMonitoring(intervalMs: number = 10000) {\n    this.stopMonitoring();\n    this.checkInterval = window.setInterval(() => this.checkMemory(), intervalMs);\n  }\n\n  stopMonitoring() {\n    if (this.checkInterval !== null) {\n      clearInterval(this.checkInterval);\n      this.checkInterval = null;\n    }\n  }\n\n  getHistory(): MemoryUsage[] {\n    return [...this.history];\n  }\n\n  getHighWaterMark(): number {\n    return this.highWaterMark;\n  }\n\n  getStats() {\n    const memory = this.getMemoryUsage();\n    return {\n      current: memory,\n      highWaterMark: this.highWaterMark,\n      history: this.history,\n      listeners: this.listeners.length\n    };\n  }\n}\n\n// Export singleton instance\nexport const memoryMonitor = MemoryMonitor.getInstance();\n\n// Start monitoring by default in development\nif (process.env.NODE_ENV === 'development') {\n  memoryMonitor.startMonitoring(30000); // Check every 30 seconds in development\n}\n\n// Add debug helper in development\nif (process.env.NODE_ENV === 'development' && typeof window !== 'undefined') {\n  (window as any).__MEMORY_MONITOR = memoryMonitor;\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\utils\\memoryProfiler.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\utils\\memoryUtils.ts","messages":[{"ruleId":"no-undef","severity":1,"message":"'EventListenerOrEventListenerObject' is not defined.","line":160,"column":41,"nodeType":"Identifier","messageId":"undef","endLine":160,"endColumn":75},{"ruleId":"no-undef","severity":1,"message":"'EventListener' is not defined.","line":160,"column":77,"nodeType":"Identifier","messageId":"undef","endLine":160,"endColumn":90},{"ruleId":"no-undef","severity":1,"message":"'WindowEventMap' is not defined.","line":163,"column":54,"nodeType":"Identifier","messageId":"undef","endLine":163,"endColumn":68},{"ruleId":"no-unused-vars","severity":1,"message":"'this' is defined but never used.","line":165,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":165,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"this"},"fix":{"range":[4788,4801],"text":""},"desc":"Remove unused variable 'this'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'ev' is defined but never used.","line":165,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":165,"endColumn":59,"suggestions":[{"messageId":"removeVar","data":{"varName":"ev"},"fix":{"range":[4800,4831],"text":""},"desc":"Remove unused variable 'ev'."}]},{"ruleId":"no-undef","severity":1,"message":"'WindowEventMap' is not defined.","line":165,"column":34,"nodeType":"Identifier","messageId":"undef","endLine":165,"endColumn":48},{"ruleId":"no-undef","severity":1,"message":"'AddEventListenerOptions' is not defined.","line":166,"column":25,"nodeType":"Identifier","messageId":"undef","endLine":166,"endColumn":48},{"ruleId":"no-undef","severity":1,"message":"'EventListener' is not defined.","line":176,"column":29,"nodeType":"Identifier","messageId":"undef","endLine":176,"endColumn":42},{"ruleId":"no-undef","severity":1,"message":"'EventListenerOrEventListenerObject' is not defined.","line":183,"column":37,"nodeType":"Identifier","messageId":"undef","endLine":183,"endColumn":71},{"ruleId":"no-undef","severity":1,"message":"'WindowEventMap' is not defined.","line":195,"column":57,"nodeType":"Identifier","messageId":"undef","endLine":195,"endColumn":71},{"ruleId":"no-unused-vars","severity":1,"message":"'this' is defined but never used.","line":197,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":197,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"this"},"fix":{"range":[5803,5816],"text":""},"desc":"Remove unused variable 'this'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'ev' is defined but never used.","line":197,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":197,"endColumn":59,"suggestions":[{"messageId":"removeVar","data":{"varName":"ev"},"fix":{"range":[5815,5846],"text":""},"desc":"Remove unused variable 'ev'."}]},{"ruleId":"no-undef","severity":1,"message":"'WindowEventMap' is not defined.","line":197,"column":34,"nodeType":"Identifier","messageId":"undef","endLine":197,"endColumn":48},{"ruleId":"no-undef","severity":1,"message":"'EventListenerOptions' is not defined.","line":198,"column":25,"nodeType":"Identifier","messageId":"undef","endLine":198,"endColumn":45},{"ruleId":"no-undef","severity":1,"message":"'EventListenerOrEventListenerObject' is not defined.","line":201,"column":37,"nodeType":"Identifier","messageId":"undef","endLine":201,"endColumn":71}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Memory debugging utilities for identifying and tracking memory leaks\n */\n\n// Track component instances to detect leaks\nconst componentInstances = new Map<string, Set<object>>();\n\n/**\n * Track component instance for memory leak detection\n */\nexport function trackComponent(componentName: string, instance: object) {\n  if (process.env['NODE_ENV'] !== 'production') {\n    if (!componentInstances.has(componentName)) {\n      componentInstances.set(componentName, new Set());\n    }\n    \n    const instances = componentInstances.get(componentName);\n    instances?.add(instance);\n    \n    if (process.env['NODE_ENV'] === 'development') {\n      console.log(`[Memory] Tracking ${componentName} instance (total: ${instances?.size})`);\n    }\n  }\n  \n  return () => {\n    componentInstances.get(componentName)?.delete(instance);\n    if (process.env['NODE_ENV'] === 'development') {\n      console.log(`[Memory] ${componentName} unmounted (${componentInstances.get(componentName)?.size} remaining)`);\n    }\n  };\n}\n\n/**\n * Log all tracked component instances (useful for debugging)\n */\nexport function logComponentInstances() {\n  console.group('Component Instances');\n  componentInstances.forEach((instances, name) => {\n    console.log(`${name}: ${instances.size} instances`);\n  });\n  console.groupEnd();\n}\n\n/**\n * Force garbage collection (works in Chrome with --js-flags=\"--expose-gc\")\n */\nexport function forceGarbageCollection() {\n  // Use type assertion to avoid TypeScript errors\n  const win = window as any;\n  \n  // Check for the exposed gc function in different locations\n  if (typeof win.gc === 'function') {\n    win.gc();\n    return true;\n  }\n  \n  // Check for webkit-specific garbage collection\n  if (win.webkit?.memory?.collectGarbage && typeof win.webkit.memory.collectGarbage === 'function') {\n    win.webkit.memory.collectGarbage();\n    return true;\n  }\n  \n  console.warn('Garbage collection not available. Run Chrome with --js-flags=\"--expose-gc\"');\n  return false;\n}\n\n/**\n * Measure memory usage\n * Returns null if memory measurement is not available in this environment\n */\nexport function measureMemory() {\n  try {\n    // Safely check if performance is available\n    if (typeof performance === 'undefined' || !performance) {\n      return null;\n    }\n    \n    // Type assertion for TypeScript\n    const perf = performance as any;\n    \n    // Check for the newer performance.measureMemory API first\n    if (typeof perf.measureMemory === 'function') {\n      return perf.measureMemory();\n    }\n    \n    // Fall back to the older performance.memory API (Chrome)\n    if (perf.memory) {\n      return {\n        usedJSHeapSize: perf.memory.usedJSHeapSize,\n        totalJSHeapSize: perf.memory.totalJSHeapSize,\n        jsHeapSizeLimit: perf.memory.jsHeapSizeLimit,\n      };\n    }\n    \n    // Check for the Node.js memory usage API\n    if (typeof process !== 'undefined' && process.memoryUsage) {\n      const nodeMem = process.memoryUsage();\n      return {\n        usedJSHeapSize: nodeMem.heapUsed,\n        totalJSHeapSize: nodeMem.heapTotal,\n        jsHeapSizeLimit: nodeMem.rss, // Not exactly the same, but gives an idea\n      };\n    }\n    \n    return null;\n  } catch (error) {\n    console.warn('Error measuring memory:', error);\n    return null;\n  }\n}\n\n/**\n * Create a memory leak detector for a specific component\n */\nexport function createLeakDetector(componentName: string) {\n  const instances = new Set<object>();\n  let lastCount = 0;\n  let growthCount = 0;\n  \n  return {\n    track(instance: object) {\n      instances.add(instance);\n      \n      const currentCount = instances.size;\n      if (currentCount > lastCount) {\n        growthCount++;\n      } else {\n        growthCount = 0;\n      }\n      \n      lastCount = currentCount;\n      \n      // If we see consistent growth over multiple renders, it might be a leak\n      if (growthCount > 10) {\n        console.warn(`[Memory Leak?] ${componentName} has grown to ${currentCount} instances`);\n        console.trace('Component instance growth stack trace');\n      }\n      \n      return () => {\n        instances.delete(instance);\n      };\n    },\n    getInstanceCount() {\n      return instances.size;\n    },\n  };\n}\n\n/**\n * Track event listeners to prevent memory leaks\n */\nexport function trackEventListeners() {\n  if (typeof window === 'undefined') return;\n  \n  // Store original methods\n  (window as any)._originalAddEventListener = window.addEventListener.bind(window);\n  (window as any)._originalRemoveEventListener = window.removeEventListener.bind(window);\n  \n  // Track all event listeners\n  const listeners = new Map<string, Map<EventListenerOrEventListenerObject, EventListener>>();\n  \n  // Override addEventListener\n  window.addEventListener = function<K extends keyof WindowEventMap>(\n    type: K | string,\n    listener: (this: Window, ev: WindowEventMap[K] & Event) => any,\n    options?: boolean | AddEventListenerOptions\n  ) {\n    const eventType = type as string;\n    \n    if (!listeners.has(eventType)) {\n      listeners.set(eventType, new Map());\n    }\n    \n    const wrappedListener = function(this: Window, event: Event) {\n      try {\n        return (listener as EventListener).call(this, event);\n      } catch (e) {\n        console.error(`Error in event listener for '${eventType}':`, e);\n        throw e;\n      }\n    };\n    \n    const listenerObj = listener as EventListenerOrEventListenerObject;\n    listeners.get(eventType)?.set(listenerObj, wrappedListener);\n    \n    // Call original addEventListener with wrapped listener\n    return (window as any)._originalAddEventListener(\n      eventType,\n      wrappedListener,\n      options\n    );\n  } as typeof window.addEventListener;\n  \n  // Override removeEventListener\n  window.removeEventListener = function<K extends keyof WindowEventMap>(\n    type: K | string,\n    listener: (this: Window, ev: WindowEventMap[K] & Event) => any,\n    options?: boolean | EventListenerOptions\n  ) {\n    const eventType = type as string;\n    const listenerObj = listener as EventListenerOrEventListenerObject;\n    const wrappedListener = listeners.get(eventType)?.get(listenerObj);\n    \n    const result = (window as any)._originalRemoveEventListener(\n      eventType,\n      wrappedListener || listenerObj,\n      options\n    );\n    \n    if (wrappedListener) {\n      listeners.get(eventType)?.delete(listenerObj);\n    }\n    \n    return result;\n  } as typeof window.removeEventListener;\n  \n  // Log all event listeners (for debugging)\n  const logAllEventListeners = () => {\n    console.group('Event Listeners');\n    listeners.forEach((listeners, type) => {\n      console.log(`%c${type}: ${listeners.size} listeners`, 'color: #4CAF50');\n    });\n    console.groupEnd();\n  };\n  \n  // Log event listeners on unload\n  const beforeUnloadHandler = () => {\n    const totalListeners = Array.from(listeners.values())\n      .reduce((sum, map) => sum + map.size, 0);\n    \n    if (totalListeners > 0) {\n      console.warn(`[Memory] ${totalListeners} event listeners still attached on unload`);\n      logAllEventListeners();\n    }\n  };\n  \n  window.addEventListener('beforeunload', beforeUnloadHandler);\n  \n  // Expose for debugging\n  (window as any).__eventListeners = {\n    list: listeners,\n    log: logAllEventListeners,\n  };\n  \n  return () => {\n    // Restore original methods\n    if ((window as any)._originalAddEventListener) {\n      window.addEventListener = (window as any)._originalAddEventListener;\n      window.removeEventListener = (window as any)._originalRemoveEventListener;\n      delete (window as any)._originalAddEventListener;\n      delete (window as any)._originalRemoveEventListener;\n      delete (window as any).getEventListeners;\n      window.removeEventListener('beforeunload', beforeUnloadHandler);\n      delete (window as any).__eventListeners;\n    }\n  };\n}\n\n// Initialize event listener tracking in development\nif (process.env['NODE_ENV'] === 'development') {\n  trackEventListeners();\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\utils\\refreshLock.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\utils\\renderOptimization.ts","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'debounce' is defined but never used.","line":3,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"debounce"},"fix":{"range":[116,130],"text":""},"desc":"Remove unused variable 'debounce'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'debounce' is defined but never used.","line":3,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":16},{"ruleId":"no-unused-vars","severity":1,"message":"'prevProps' is defined but never used.","line":50,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":50,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"prevProps"},"fix":{"range":[1490,1503],"text":""},"desc":"Remove unused variable 'prevProps'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'nextProps' is defined but never used.","line":50,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":50,"endColumn":40,"suggestions":[{"messageId":"removeVar","data":{"varName":"nextProps"},"fix":{"range":[1502,1516],"text":""},"desc":"Remove unused variable 'nextProps'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'args' is defined but never used.","line":84,"column":52,"nodeType":"Identifier","messageId":"unusedVar","endLine":84,"endColumn":56,"suggestions":[{"messageId":"removeVar","data":{"varName":"args"},"fix":{"range":[2250,2254],"text":""},"desc":"Remove unused variable 'args'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'options'. Either include it or remove the dependency array.","line":103,"column":6,"nodeType":"ArrayExpression","endLine":103,"endColumn":48,"suggestions":[{"desc":"Update the dependencies array to be: [delay, options]","fix":{"range":[2768,2810],"text":"[delay, options]"}}]},{"ruleId":"@typescript-eslint/no-use-before-define","severity":1,"message":"'isEqual' was used before it was defined.","line":121,"column":8,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":121,"endColumn":15},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo received a function whose dependencies are unknown. Pass an inline function instead.","line":133,"column":10,"nodeType":"Identifier","endLine":133,"endColumn":17},{"ruleId":"no-unused-vars","severity":1,"message":"'args' is defined but never used.","line":139,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":139,"endColumn":51,"suggestions":[{"messageId":"removeVar","data":{"varName":"args"},"fix":{"range":[3638,3642],"text":""},"desc":"Remove unused variable 'args'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback received a function whose dependencies are unknown. Pass an inline function instead.","line":144,"column":10,"nodeType":"Identifier","endLine":144,"endColumn":21},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'renderData.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'renderData.current' to a variable inside the effect, and use that variable in the cleanup function.","line":202,"column":20,"nodeType":"Identifier","endLine":202,"endColumn":27}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\r\nimport { useRef, useEffect, useState, useMemo, useCallback } from 'react';\r\nimport debounce from 'lodash/debounce';\r\nimport throttle from 'lodash/throttle';\r\n\r\n/**\r\n * Custom hook to track component renders\r\n */\r\nexport function useRenderCount(componentName: string) {\r\n  const renderCount = useRef(0);\r\n  const lastRenderTime = useRef(performance.now());\r\n  \r\n  renderCount.current++;\r\n  const now = performance.now();\r\n  const timeSinceLastRender = now - lastRenderTime.current;\r\n  lastRenderTime.current = now;\r\n  \r\n  // Log excessive re-renders\r\n  useEffect(() => {\r\n    if (timeSinceLastRender < 16) { // Less than 60fps\r\n      console.warn(\r\n        `[Performance] ${componentName} re-rendered too quickly: ${timeSinceLastRender.toFixed(2)}ms ` +\r\n        `(render #${renderCount.current})`\r\n      );\r\n    }\r\n    \r\n    if (renderCount.current > 100) {\r\n      console.warn(\r\n        `[Performance] ${componentName} has re-rendered ${renderCount.current} times. ` +\r\n        `Consider optimizing to prevent performance issues.`\r\n      );\r\n    }\r\n  }, [componentName, timeSinceLastRender]);\r\n  \r\n  return {\r\n    renderCount: renderCount.current,\r\n    timeSinceLastRender,\r\n    reset: () => {\r\n      renderCount.current = 0;\r\n      lastRenderTime.current = performance.now();\r\n    },\r\n  };\r\n}\r\n\r\n/**\r\n * Memoize a component with a custom comparison function\r\n */\r\nexport function memoWithComparison<T>(\r\n  component: React.ComponentType<T>,\r\n  areEqual: (prevProps: T, nextProps: T) => boolean,\r\n  displayName?: string\r\n) {\r\n  const memoized = React.memo(component, areEqual);\r\n  \r\n  if (displayName) {\r\n    memoized.displayName = `Memoized(${displayName})`;\r\n  }\r\n  \r\n  return memoized;\r\n}\r\n\r\n/**\r\n * Custom hook to debounce a value update\r\n */\r\nexport function useDebouncedValue<T>(value: T, delay: number): T {\r\n  const [debouncedValue, setDebouncedValue] = useState(value);\r\n  \r\n  useEffect(() => {\r\n    const handler = setTimeout(() => {\r\n      setDebouncedValue(value);\r\n    }, delay);\r\n    \r\n    return () => {\r\n      clearTimeout(handler);\r\n    };\r\n  }, [value, delay]);\r\n  \r\n  return debouncedValue;\r\n}\r\n\r\n/**\r\n * Custom hook to throttle a function\r\n */\r\nexport function useThrottledCallback<T extends (...args: any[]) => any>(\r\n  callback: T,\r\n  delay: number,\r\n  options: { leading?: boolean; trailing?: boolean } = {}\r\n): T {\r\n  const callbackRef = useRef(callback);\r\n  \r\n  // Update the callback if it changes\r\n  useEffect(() => {\r\n    callbackRef.current = callback;\r\n  }, [callback]);\r\n  \r\n  // Create the throttled function once and reuse it\r\n  const throttledCallback = useMemo(() => {\r\n    return throttle(\r\n      (...args: Parameters<T>) => callbackRef.current(...args),\r\n      delay,\r\n      options\r\n    );\r\n  }, [delay, options.leading, options.trailing]);\r\n  \r\n  // Clean up the throttle on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      throttledCallback.cancel();\r\n    };\r\n  }, [throttledCallback]);\r\n  \r\n  return throttledCallback as T;\r\n}\r\n\r\n/**\r\n * Custom hook to prevent unnecessary re-renders with deep comparison\r\n */\r\nexport function useDeepCompareMemoize<T>(value: T): T {\r\n  const ref = useRef<T>();\r\n  \r\n  if (!isEqual(value, ref.current)) {\r\n    ref.current = value;\r\n  }\r\n  \r\n  return ref.current as T;\r\n}\r\n\r\n/**\r\n * Custom hook to memoize a value with deep comparison\r\n */\r\nexport function useDeepMemo<T>(factory: () => T, deps: any[]): T {\r\n  const memoizedDeps = useDeepCompareMemoize(deps);\r\n  return useMemo(factory, memoizedDeps);\r\n}\r\n\r\n/**\r\n * Custom hook to memoize a callback with deep comparison\r\n */\r\nexport function useDeepCallback<T extends (...args: any[]) => any>(\r\n  callback: T,\r\n  deps: any[]\r\n): T {\r\n  const memoizedDeps = useDeepCompareMemoize(deps);\r\n  return useCallback(callback, memoizedDeps);\r\n}\r\n\r\n/**\r\n * Deep comparison of two values\r\n */\r\nfunction isEqual(a: any, b: any): boolean {\r\n  // Handle primitive types and null/undefined\r\n  if (a === b) return true;\r\n  if (a == null || b == null) return false;\r\n  if (typeof a !== 'object' || typeof b !== 'object') return a === b;\r\n  \r\n  // Handle arrays\r\n  if (Array.isArray(a) && Array.isArray(b)) {\r\n    if (a.length !== b.length) return false;\r\n    for (let i = 0; i < a.length; i++) {\r\n      if (!isEqual(a[i], b[i])) return false;\r\n    }\r\n    return true;\r\n  }\r\n  \r\n  // Handle objects\r\n  const keysA = Object.keys(a);\r\n  const keysB = Object.keys(b);\r\n  \r\n  if (keysA.length !== keysB.length) return false;\r\n  \r\n  for (const key of keysA) {\r\n    if (!Object.prototype.hasOwnProperty.call(b, key)) return false;\r\n    if (!isEqual(a[key], b[key])) return false;\r\n  }\r\n  \r\n  return true;\r\n}\r\n\r\n/**\r\n * HOC to log when a component re-renders\r\n */\r\nexport function withRenderLogging<P extends object>(\r\n  WrappedComponent: React.ComponentType<P>,\r\n  componentName: string\r\n): React.FC<P> {\r\n  // Create a display name for the HOC\r\n  const displayName = `withRenderLogging(${componentName})`;\r\n\r\n  // Create the component with proper typing\r\n  const WithRenderLogging: React.FC<P> = (props) => {\r\n    // Use a ref to track render count and timing\r\n    const renderData = useRef({\r\n      count: 0,\r\n      lastRenderTime: performance.now(),\r\n      mounted: true\r\n    });\r\n    \r\n    // Track if component is mounted\r\n    useEffect(() => {\r\n      renderData.current.mounted = true;\r\n      return () => {\r\n        renderData.current.mounted = false;\r\n      };\r\n    }, []);\r\n    \r\n    // Calculate render timing\r\n    const now = performance.now();\r\n    const renderInfo = renderData.current;\r\n    const timeSinceLastRender = now - renderInfo.lastRenderTime;\r\n    \r\n    // Update render count and time\r\n    renderInfo.count++;\r\n    renderInfo.lastRenderTime = now;\r\n    \r\n    // Log render information\r\n    if (process.env['NODE_ENV'] === 'development') {\r\n      // Use requestIdleCallback to avoid blocking the main thread\r\n      if (typeof requestIdleCallback === 'function') {\r\n        requestIdleCallback(() => {\r\n          if (renderInfo.mounted) {\r\n            console.log(\r\n              `[Render] ${componentName} #${renderInfo.count} ` +\r\n              `(${timeSinceLastRender.toFixed(2)}ms since last render)`,\r\n              process.env['NODE_ENV'] === 'development' ? props : '[Props hidden in production]'\r\n            );\r\n          }\r\n        });\r\n      } else {\r\n        // Fallback for environments without requestIdleCallback\r\n        setTimeout(() => {\r\n          if (renderInfo.mounted) {\r\n            console.log(\r\n              `[Render] ${componentName} #${renderInfo.count} ` +\r\n              `(${timeSinceLastRender.toFixed(2)}ms since last render)`,\r\n              process.env['NODE_ENV'] === 'development' ? props : '[Props hidden in production]'\r\n            );\r\n          }\r\n        }, 0);\r\n      }\r\n    }\r\n    \r\n    // Render the wrapped component\r\n    return React.createElement(WrappedComponent, props);\r\n  };\r\n  \r\n  // Set the display name for better debugging\r\n  WithRenderLogging.displayName = displayName;\r\n  \r\n  // Return the enhanced component\r\n  return WithRenderLogging;\r\n}\r\n\r\n/**\r\n * Hook to measure render performance\r\n */\r\nexport function useRenderMeasure(componentName: string) {\r\n  const renderCount = useRef(0);\r\n  const lastRenderTime = useRef(performance.now());\r\n  const totalRenderTime = useRef(0);\r\n  \r\n  renderCount.current++;\r\n  const now = performance.now();\r\n  const timeSinceLastRender = now - lastRenderTime.current;\r\n  lastRenderTime.current = now;\r\n  totalRenderTime.current += timeSinceLastRender;\r\n  \r\n  useEffect(() => {\r\n    // Log performance summary every 10 renders\r\n    if (renderCount.current % 10 === 0) {\r\n      const avgRenderTime = totalRenderTime.current / renderCount.current;\r\n      console.log(\r\n        `[Performance] ${componentName}: ` +\r\n        `${renderCount.current} renders, ` +\r\n        `avg: ${avgRenderTime.toFixed(2)}ms, ` +\r\n        `total: ${totalRenderTime.current.toFixed(2)}ms`\r\n      );\r\n    }\r\n  }, [componentName]);\r\n  \r\n  return {\r\n    renderCount: renderCount.current,\r\n    timeSinceLastRender,\r\n    totalRenderTime: totalRenderTime.current,\r\n    reset: () => {\r\n      renderCount.current = 0;\r\n      lastRenderTime.current = performance.now();\r\n      totalRenderTime.current = 0;\r\n    },\r\n  };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\src\\vite-env.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\tailwind.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\test-station-selection.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\tests\\__mocks__\\weatherStore.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\tests\\backgroundManager.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\tests\\setup.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\vite.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\alexa\\Documents\\Vibecoding_Bench\\lovable_breath_safe-master\\lovable_breath_safe-master\\vitest.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]